<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Rinevard</title>
  
  
  <link href="http://rinevard.github.io/atom.xml" rel="self"/>
  
  <link href="http://rinevard.github.io/"/>
  <updated>2025-10-14T12:11:33.133Z</updated>
  <id>http://rinevard.github.io/</id>
  
  <author>
    <name>Rinevard</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>æ¢ç´¢æ—¥å¿—[1]</title>
    <link href="http://rinevard.github.io/wiki/others/thoughts/%E6%8E%A2%E7%B4%A2%E6%97%A5%E5%BF%971/"/>
    <id>http://rinevard.github.io/wiki/others/thoughts/%E6%8E%A2%E7%B4%A2%E6%97%A5%E5%BF%971/</id>
    <published>2025-10-13T12:11:11.000Z</published>
    <updated>2025-10-14T12:11:33.133Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸çŸ¥é“äººä»¬å¹³å¸¸æ˜¯æ€æ ·ä¸ä»–äººç›¸è¯†çš„ã€‚è®¸ä¹…ä»¥å‰æˆ‘å°±åœ¨æƒ³ï¼Œè‡ªå·±çš„ç¤¾äº¤æ–¹å¼æ˜¯å¦æœ‰ç‚¹ä¸å¤ªåƒä¸€èˆ¬äººç±»ğŸ« ğŸ« å’±æ›´åå¥½é‚£ç§â€œå¤§å®¶ä¸€èµ·åšä¸€ä»¶éƒ½æ„Ÿå…´è¶£çš„äº‹æƒ…ç„¶åæ¸æ¸å°±è®¤è¯†äº†â€çš„ç¤¾äº¤æ–¹å¼ï¼Œä½†ä¼¼ä¹è¿™ç§åšæ³•ç›¸å¯¹å°‘è§ï¼Œè€Œä¸”æˆ‘ä»¥å‰ä¹Ÿæ²¡æ€ä¹ˆå› æ­¤è®¤è¯†åˆ°æ–°æœ‹å‹ã€‚</p><p>åœ¨ä¸çŸ­çš„è´¨ç–‘æœŸåï¼Œæ¸æ¸åœ°ä¹Ÿå‘ç°è‡ªå·±ä¹Ÿæ˜¯èƒ½ç”¨è¿™ç§æ–¹æ³•äº¤åˆ°æœ‹å‹çš„ï¼Œè‡³å°‘æ˜¯èƒ½ç»“è¯†äººç±»çš„ã€‚æ¯”å¦‚è¯´è¿™æ¬¡çš„æ¢ç´¢æ—¥å¿—å°±å’Œ GMTK Jam åœ¨å°çº¢ä¹¦æ‹‰åˆ°çš„ç¾æœ¯åŒå­¦æœ‰å…³ï¼ˆèµç¾å°çº¢ä¹¦å–µ</p><p>â€œæˆ‘å¯¹æ™®é€šçš„äººç±»æ²¡æœ‰å…´è¶£ã€‚ä½ ä»¬ä¹‹ä¸­å¦‚æœæœ‰ç”»ç”»äººã€éŸ³ä¹äººã€éŸ³æ•ˆäººæˆ–è€…å¼‚ä¸–ç•Œäººå°±æ¥æ‰¾æˆ‘å§ï¼â€è™½ç„¶æˆ‘ä¸æ˜¯è¿™ä¹ˆæ‹‰äººçš„ï¼ˆæ²¡äººä¼šè¿™ä¹ˆæ‹‰äººå§ï¼ï¼‰ï¼Œä½†æ€»ä¹‹å°±æ˜¯æ‹‰åˆ°äº†è¿™ä½ä¸­ä¼ çš„ç¾æœ¯åŒå­¦ä¸€èµ·æ¥gamejamï¼Œè¿™æ˜¯å…«æœˆçš„äº‹äº†ã€‚</p><p>ä»Šå¤©é¹°è§’åœ¨ä¸­ä¼ å¼€äº†ä¸ªå®£è®²ä¼šï¼Œå’±ä½œä¸ºèµ„æ·±ç²¥ç²¥äººå½“ç„¶æƒ³å»å¬å¬çœ‹ã€‚è®¿å®¢è¿›ä¸­ä¼ éœ€è¦æ‰¾æ ¡å†…åŒå­¦æˆ–è€å¸ˆé¢„çº¦ï¼Œäºæ˜¯å’±å°±æ‰¾äº†è¿™ä½ç¾æœ¯åŒå­¦ç„¶åæˆåŠŸè¿›å…¥ä¸­ä¼ äº†ã€‚</p><p>ä¸€èˆ¬æ¥è¯´æ•…äº‹åº”è¯¥è·Œå®•èµ·ä¼ï¼Œæ¯”æ–¹è¯´æˆ‘ä»¬èµ·ç è¦å†™å†™åœ¨ä¸­ä¼ é‡åˆ°çš„è¶£äº‹ï¼Œç„¶åå†™å†™æœ‰ä»€ä¹ˆç³Ÿç³•çš„åœ°æ–¹ï¼Œç„¶åå†åä¸½æ”¶åœºï¼Œä¸è¿‡äº‹æƒ…å°±æ˜¯å¾ˆå¹³å¹³æ·¡æ·¡ã€‚é¹°è§’çš„å®£è®²ä¼šå¾ˆæ™®é€šï¼Œè™½ç„¶å‘äº†ç‚¹å‘¨è¾¹ä½†æˆ‘å¹¶æ²¡æœ‰æŠ½ä¸­æœ‰è¶£çš„å¥–å“ï¼Œä¸­ä¼ çš„é¥­æ¯”åŒ—ç†çš„å¥½åƒï¼Œä½†å¥½åƒå¾—ä¸å¤šã€‚</p><p>å¯æˆ‘ç¡®å®ä»æ¥æ²¡æœ‰å»å¤–æ ¡ç©çš„ç»å†ï¼Œæ›´åˆ«è¯´è¦æ‰¾å¤–æ ¡åŒå­¦é¢„çº¦æ‰èƒ½è¿›çš„å­¦æ ¡äº†ğŸ« ğŸ« å’±èƒ½ä»ç¤¾æè¿›åŒ–æˆç°åœ¨è¿™æ ·èƒ½ä¸»åŠ¨æ‹‰äººç»„é˜Ÿè¿˜èƒ½è”ç³»åˆ«äººå·²ç»å¾ˆå¥½äº†ä¸æ˜¯å—ï¼ˆï¼‰</p><p>æ¢ç´¢ä¹Ÿä¸æ˜¯æ¬¡æ¬¡æœ‰è¶£ï¼Œå€’ä¸å¦‚è¯´æ¢ç´¢çš„ç»“æœæ™®æ™®é€šé€šæ‰æ˜¯ç†æ‰€åº”å½“çš„å§ã€‚ç°åœ¨æ˜¯æ™šä¸Šåç‚¹äº”ååˆ†ï¼Œæˆ‘åœ¨è‰¯ä¹¡å¤§å­¦åŸåŒ—çš„åœ°é“ç«™æ²¡æœ‰æ‘†æ¸¡è½¦ï¼Œè¦éª‘è½¦å›å­¦æ ¡äº†ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;ä¸çŸ¥é“äººä»¬å¹³å¸¸æ˜¯æ€æ ·ä¸ä»–äººç›¸è¯†çš„ã€‚è®¸ä¹…ä»¥å‰æˆ‘å°±åœ¨æƒ³ï¼Œè‡ªå·±çš„ç¤¾äº¤æ–¹å¼æ˜¯å¦æœ‰ç‚¹ä¸å¤ªåƒä¸€èˆ¬äººç±»ğŸ« ğŸ« å’±æ›´åå¥½é‚£ç§â€œå¤§å®¶ä¸€èµ·åšä¸€ä»¶éƒ½æ„Ÿå…´è¶£çš„äº‹æƒ…ç„¶åæ¸æ¸å°±è®¤è¯†äº†â€çš„ç¤¾äº¤æ–¹å¼ï¼Œä½†ä¼¼ä¹è¿™ç§åšæ³•ç›¸å¯¹å°‘è§ï¼Œè€Œä¸”æˆ‘ä»¥å‰ä¹Ÿæ²¡æ€ä¹ˆå› æ­¤è®¤è¯†åˆ°æ–°æœ‹å‹ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ä¸çŸ­çš„è´¨ç–‘æœŸåï¼Œæ¸æ¸åœ°ä¹Ÿå‘ç°</summary>
      
    
    
    
    <category term="æ‚è°ˆ" scheme="http://rinevard.github.io/categories/%E6%9D%82%E8%B0%88/"/>
    
    <category term="ç¢ç¢å¿µ" scheme="http://rinevard.github.io/categories/%E6%9D%82%E8%B0%88/%E7%A2%8E%E7%A2%8E%E5%BF%B5/"/>
    
    
  </entry>
  
  <entry>
    <title>Assignment 7 Path Tracing</title>
    <link href="http://rinevard.github.io/wiki/learning/open-course/GAMES101/Hw/Hw7-path-tracing/"/>
    <id>http://rinevard.github.io/wiki/learning/open-course/GAMES101/Hw/Hw7-path-tracing/</id>
    <published>2025-10-10T14:10:44.000Z</published>
    <updated>2025-10-10T15:04:14.905Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å¤§è‡´æµç¨‹"><a href="#å¤§è‡´æµç¨‹" class="headerlink" title="å¤§è‡´æµç¨‹"></a>å¤§è‡´æµç¨‹</h1><p>è¿™æ¬¡çš„ä½œä¸šæŒºéš¾çš„ã€‚é¦–å…ˆæˆ‘ä»¬æ¥å¯¹ç…§å…¬å¼è§£é‡Šä¸€ä¸‹å¤§è‡´çš„ä»£ç æµç¨‹ï¼š</p><script type="math/tex; mode=display">\begin{align*}L_o(p, \vec{\omega_o}) = &L_e(p, \vec{\omega_o}) + \int_{\Omega} f_r(p, \vec{\omega_i}, \vec{\omega_o}) L_i(p, \vec{\omega_i}) (\vec{\omega_i} \cdot n) d\omega_i \\= &L_e(p, \vec{\omega_o}) + \int_{\Omega_{å…‰æºæ–¹å‘}} f_r(p, \vec{\omega_i}, \vec{\omega_o}) L_i(p, \vec{\omega_i}) (\vec{\omega_i} \cdot n) d\omega_i \\&+ \int_{\Omega_{éå…‰æºæ–¹å‘}} f_r(p, \vec{\omega_i}, \vec{\omega_o}) L_i(p, \vec{\omega_i}) (\vec{\omega_i} \cdot n) d\omega_i\end{align*}</script><ol><li>å¦‚æœç‚¹ $p$ æ˜¯å…‰æºï¼Œç›´æ¥è¿”å›å…¶è‡ªå‘å…‰é¡¹ $L_e$.</li><li>éšæœºé‡‡æ ·ä¸€ä¸ªå…‰æºæ–¹å‘ $w_s$ï¼Œæ ¹æ®å…¬å¼è®¡ç®— $L_\text{direct}$.</li><li><p>éšæœºé‡‡æ ·ä¸€ä¸ªæ–¹å‘ $w_i$ï¼ŒæŒ‰è½®ç›˜èµŒå†³å®šæ˜¯å¦ç»“æŸå¼¹å°„ã€‚</p><p> å¦‚æœä¸ç»“æŸä¸” $w_i$ æ²¡æ‰“åˆ°å…‰æºï¼Œæ ¹æ®å…¬å¼è®¡ç®— $L_\text{indirect}$.</p></li><li><p>è¿”å› $L_\text{direct}+L_\text{indirect}$</p></li></ol><p>ç„¶åæ”¾ä»£ç ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Vector3f <span class="token class-name">Scene</span><span class="token double-colon punctuation">::</span><span class="token function">castRay</span><span class="token punctuation">(</span><span class="token keyword">const</span> Ray <span class="token operator">&amp;</span>ray<span class="token punctuation">,</span> <span class="token keyword">int</span> depth<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">&#123;</span>    Intersection shade_point_inter <span class="token operator">=</span> <span class="token function">intersect</span><span class="token punctuation">(</span>ray<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>shade_point_inter<span class="token punctuation">.</span>happened<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token function">Vector3f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// ----------------Contribution from emission----------------</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>shade_point_inter<span class="token punctuation">.</span>m<span class="token operator">-></span><span class="token function">hasEmission</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// Light source doesn't reflect light, so we return here</span>        <span class="token keyword">return</span> shade_point_inter<span class="token punctuation">.</span>m<span class="token operator">-></span><span class="token function">getEmission</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// ----------------Contribution from the light source----------------</span>    Vector3f wo <span class="token operator">=</span> <span class="token operator">-</span><span class="token function">normalize</span><span class="token punctuation">(</span>ray<span class="token punctuation">.</span>direction<span class="token punctuation">)</span><span class="token punctuation">;</span>    Vector3f normal <span class="token operator">=</span> <span class="token function">normalize</span><span class="token punctuation">(</span>shade_point_inter<span class="token punctuation">.</span>normal<span class="token punctuation">)</span><span class="token punctuation">;</span>    Vector3f l_direct <span class="token operator">=</span> <span class="token function">Vector3f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Intersection light_sample<span class="token punctuation">;</span>    <span class="token keyword">float</span> pdf_light<span class="token punctuation">;</span>    <span class="token function">sampleLight</span><span class="token punctuation">(</span>light_sample<span class="token punctuation">,</span> pdf_light<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// If the ray is not blocked in the middle, compute its contribution</span>    Vector3f light_normal <span class="token operator">=</span> <span class="token function">normalize</span><span class="token punctuation">(</span>light_sample<span class="token punctuation">.</span>normal<span class="token punctuation">)</span><span class="token punctuation">;</span>    Vector3f shade_point <span class="token operator">=</span> shade_point_inter<span class="token punctuation">.</span>coords<span class="token punctuation">;</span>    Vector3f ws <span class="token operator">=</span> <span class="token function">normalize</span><span class="token punctuation">(</span>light_sample<span class="token punctuation">.</span>coords <span class="token operator">-</span> shade_point<span class="token punctuation">)</span><span class="token punctuation">;</span>    Vector3f direct_ray_origin <span class="token operator">=</span> shade_point <span class="token operator">+</span> ws <span class="token operator">*</span> EPSILON<span class="token punctuation">;</span>    Ray <span class="token function">ray_to_light</span><span class="token punctuation">(</span>direct_ray_origin<span class="token punctuation">,</span> ws<span class="token punctuation">)</span><span class="token punctuation">;</span>    Intersection inter_between_light <span class="token operator">=</span> <span class="token function">intersect</span><span class="token punctuation">(</span>ray_to_light<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">!</span>inter_between_light<span class="token punctuation">.</span>happened<span class="token punctuation">)</span> <span class="token operator">||</span> inter_between_light<span class="token punctuation">.</span>distance <span class="token operator">></span> <span class="token punctuation">(</span>light_sample<span class="token punctuation">.</span>coords <span class="token operator">-</span> direct_ray_origin<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">norm</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> EPSILON<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        l_direct <span class="token operator">=</span> light_sample<span class="token punctuation">.</span>emit <span class="token operator">*</span> shade_point_inter<span class="token punctuation">.</span>m<span class="token operator">-></span><span class="token function">eval</span><span class="token punctuation">(</span>ws<span class="token punctuation">,</span> wo<span class="token punctuation">,</span> normal<span class="token punctuation">)</span> \        <span class="token operator">*</span> std<span class="token double-colon punctuation">::</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token function">dotProduct</span><span class="token punctuation">(</span>ws<span class="token punctuation">,</span> normal<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0f</span><span class="token punctuation">)</span> <span class="token operator">*</span> std<span class="token double-colon punctuation">::</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token function">dotProduct</span><span class="token punctuation">(</span><span class="token operator">-</span>ws<span class="token punctuation">,</span> light_normal<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0f</span><span class="token punctuation">)</span> \        <span class="token operator">/</span> std<span class="token double-colon punctuation">::</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token punctuation">(</span>light_sample<span class="token punctuation">.</span>coords <span class="token operator">-</span> direct_ray_origin<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">norm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">/</span> pdf_light<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// ----------------Contribution from other reflectors----------------</span>    Vector3f l_indirect <span class="token operator">=</span> <span class="token function">Vector3f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// Russian Roulette test</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">get_random_float</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> RussianRoulette<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        Vector3f wi <span class="token operator">=</span> <span class="token function">normalize</span><span class="token punctuation">(</span>shade_point_inter<span class="token punctuation">.</span>m<span class="token operator">-></span><span class="token function">sample</span><span class="token punctuation">(</span>wo<span class="token punctuation">,</span> normal<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Vector3f indirect_ray_origin <span class="token operator">=</span> shade_point <span class="token operator">+</span> wi <span class="token operator">*</span> EPSILON<span class="token punctuation">;</span>        Ray <span class="token function">reflected_ray</span><span class="token punctuation">(</span>indirect_ray_origin<span class="token punctuation">,</span> wi<span class="token punctuation">)</span><span class="token punctuation">;</span>        Intersection reflected_inter <span class="token operator">=</span> <span class="token function">intersect</span><span class="token punctuation">(</span>reflected_ray<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// If reflected_ray hitting a non-emitting object, compute its contribution </span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>reflected_inter<span class="token punctuation">.</span>happened <span class="token operator">&amp;&amp;</span> reflected_inter<span class="token punctuation">.</span>m<span class="token operator">-></span><span class="token function">hasEmission</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            l_indirect <span class="token operator">=</span> <span class="token function">Vector3f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            l_indirect <span class="token operator">=</span> <span class="token function">castRay</span><span class="token punctuation">(</span>reflected_ray<span class="token punctuation">,</span> depth <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> shade_point_inter<span class="token punctuation">.</span>m<span class="token operator">-></span><span class="token function">eval</span><span class="token punctuation">(</span>wi<span class="token punctuation">,</span> wo<span class="token punctuation">,</span> normal<span class="token punctuation">)</span> \            <span class="token operator">*</span> std<span class="token double-colon punctuation">::</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token function">dotProduct</span><span class="token punctuation">(</span>wi<span class="token punctuation">,</span> normal<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0f</span><span class="token punctuation">)</span> \            <span class="token operator">/</span> <span class="token punctuation">(</span>shade_point_inter<span class="token punctuation">.</span>m<span class="token operator">-></span><span class="token function">pdf</span><span class="token punctuation">(</span>wi<span class="token punctuation">,</span> wo<span class="token punctuation">,</span> normal<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> RussianRoulette<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> l_direct <span class="token operator">+</span> l_indirect<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å†æ¥çœ‹çœ‹å›¾</p><p><img src="/images/learning/open-course/GAMES101/Assignments/hw7/screenshot.png" alt=""></p><h1 id="ä»£ç ç»†èŠ‚"><a href="#ä»£ç ç»†èŠ‚" class="headerlink" title="ä»£ç ç»†èŠ‚"></a>ä»£ç ç»†èŠ‚</h1><p>æ¥ä¸‹æ¥æˆ‘ä»¬å†èŠèŠå…·ä½“çš„ä»£ç ç»†èŠ‚ã€‚è‡ªå‘å…‰é¡¹æ¯”è¾ƒç®€å•ï¼Œæˆ‘ä»¬ç•¥è¿‡ã€‚</p><h2 id="L-text-direct"><a href="#L-text-direct" class="headerlink" title="$L_\text{direct}$"></a>$L_\text{direct}$</h2><p>ç›´æ¥å…‰éƒ¨åˆ†ã€‚é¦–å…ˆè¦æ³¨æ„çš„æ˜¯ï¼Œå„ä¸ªå°„çº¿ $w_i, w_o, w_s$ éƒ½æ˜¯ä»ç€è‰²ç‚¹æŒ‡å‘å¤–çš„å•ä½æ–¹å‘å‘é‡ã€‚è¿™æ˜¯ä¸€ä¸ªå›¾å½¢å­¦é‡Œå¸¸ç”¨çš„çº¦å®šï¼Œæ‰€ä»¥ä¸è¦é—®ä¸ºä»€ä¹ˆä¸æ˜¯æŒ‡å‘å†…äº†ï¼ˆï¼‰</p><p><img src="/images/learning/open-course/GAMES101/Assignments/hw7/wiwodir.png" alt=""></p><p>ç„¶ååœ¨å‘å‡ºå°„çº¿æ—¶ï¼Œæœ€å¥½åšä¸€ä¸ªå¾®å°çš„åç§»ä»¥é¿å…å‘å‡ºçš„å°„çº¿å’Œç€è‰²ç‚¹å¹³é¢ç›¸äº¤ã€‚è¿™å°±æ˜¯æˆ‘ä»¬ <code>direct_ray_origin = shade_point + ws * EPSILON</code> åšäº†åŠ æ³•çš„åŸå› ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Vector3f wo <span class="token operator">=</span> <span class="token operator">-</span><span class="token function">normalize</span><span class="token punctuation">(</span>ray<span class="token punctuation">.</span>direction<span class="token punctuation">)</span><span class="token punctuation">;</span>Vector3f normal <span class="token operator">=</span> <span class="token function">normalize</span><span class="token punctuation">(</span>shade_point_inter<span class="token punctuation">.</span>normal<span class="token punctuation">)</span><span class="token punctuation">;</span>Vector3f l_direct <span class="token operator">=</span> <span class="token function">Vector3f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>Intersection light_sample<span class="token punctuation">;</span><span class="token keyword">float</span> pdf_light<span class="token punctuation">;</span><span class="token function">sampleLight</span><span class="token punctuation">(</span>light_sample<span class="token punctuation">,</span> pdf_light<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// If the ray is not blocked in the middle, compute its contribution</span>Vector3f light_normal <span class="token operator">=</span> <span class="token function">normalize</span><span class="token punctuation">(</span>light_sample<span class="token punctuation">.</span>normal<span class="token punctuation">)</span><span class="token punctuation">;</span>Vector3f shade_point <span class="token operator">=</span> shade_point_inter<span class="token punctuation">.</span>coords<span class="token punctuation">;</span>Vector3f ws <span class="token operator">=</span> <span class="token function">normalize</span><span class="token punctuation">(</span>light_sample<span class="token punctuation">.</span>coords <span class="token operator">-</span> shade_point<span class="token punctuation">)</span><span class="token punctuation">;</span>Vector3f direct_ray_origin <span class="token operator">=</span> shade_point <span class="token operator">+</span> ws <span class="token operator">*</span> EPSILON<span class="token punctuation">;</span>Ray <span class="token function">ray_to_light</span><span class="token punctuation">(</span>direct_ray_origin<span class="token punctuation">,</span> ws<span class="token punctuation">)</span><span class="token punctuation">;</span>Intersection inter_between_light <span class="token operator">=</span> <span class="token function">intersect</span><span class="token punctuation">(</span>ray_to_light<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">!</span>inter_between_light<span class="token punctuation">.</span>happened<span class="token punctuation">)</span> <span class="token operator">||</span> inter_between_light<span class="token punctuation">.</span>distance <span class="token operator">></span> <span class="token punctuation">(</span>light_sample<span class="token punctuation">.</span>coords <span class="token operator">-</span> direct_ray_origin<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">norm</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> EPSILON<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    l_direct <span class="token operator">=</span> light_sample<span class="token punctuation">.</span>emit <span class="token operator">*</span> shade_point_inter<span class="token punctuation">.</span>m<span class="token operator">-></span><span class="token function">eval</span><span class="token punctuation">(</span>ws<span class="token punctuation">,</span> wo<span class="token punctuation">,</span> normal<span class="token punctuation">)</span> \    <span class="token operator">*</span> std<span class="token double-colon punctuation">::</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token function">dotProduct</span><span class="token punctuation">(</span>ws<span class="token punctuation">,</span> normal<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0f</span><span class="token punctuation">)</span> <span class="token operator">*</span> std<span class="token double-colon punctuation">::</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token function">dotProduct</span><span class="token punctuation">(</span><span class="token operator">-</span>ws<span class="token punctuation">,</span> light_normal<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0f</span><span class="token punctuation">)</span> \    <span class="token operator">/</span> std<span class="token double-colon punctuation">::</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token punctuation">(</span>light_sample<span class="token punctuation">.</span>coords <span class="token operator">-</span> direct_ray_origin<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">norm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">/</span> pdf_light<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦å¤–ï¼Œæˆ‘ä»¬æœ‰ä»å…‰æºé‡‡æ ·è®¡ç®—ç›´æ¥å…‰çš„å…¬å¼ï¼š</p><script type="math/tex; mode=display">\begin{align*}&\int_{\Omega_{å…‰æºæ–¹å‘}} f_r(p, \vec{\omega_i}, \vec{\omega_o}) L_i(p, \vec{\omega_i}) (\vec{\omega_i} \cdot n) d\omega_i \\=&\int_{A} f_r(p, \vec{\omega_i}, \vec{\omega_o}) L_i(p, \vec{\omega_i}) \frac{\cos\theta\cos\theta_i}{\lVert p'-p \rVert^2} dA \end{align*}</script><p>ç”¨è’™ç‰¹å¡ç½—è¿‘ä¼¼å°±æ˜¯ä»£ç é‡Œå†™çš„ä¸œè¥¿äº†ã€‚</p><p><img src="/images/learning/open-course/GAMES101/Assignments/hw7/nee.png" alt=""></p><h2 id="L-text-indirect"><a href="#L-text-indirect" class="headerlink" title="$L_\text{indirect}$"></a>$L_\text{indirect}$</h2><p>é—´æ¥éƒ¨åˆ†ã€‚é¦–å…ˆè¦åšä¿„ç½—æ–¯è½®ç›˜èµŒï¼Œç„¶åè¦æ£€æŸ¥æ‰“åˆ°çš„æ˜¯å¦æ˜¯å…‰æºã€‚</p><p>å¦‚æœé€šè¿‡äº†è½®ç›˜èµŒï¼Œè€Œä¸”æ‰“åˆ°çš„ä¸æ˜¯å…‰æºï¼Œå°±è¦è®¡ç®—é—´æ¥å…‰ã€‚</p><p>ä¸ç›´æ¥å…‰ä¸€æ ·ï¼Œæˆ‘ä»¬è¦åšå¾®å°åç§»ï¼Œè¿™å°±æ˜¯ <code>indirect_ray_origin = shade_point + wi * EPSILON</code> .</p><p>ç„¶åå¥—å…¬å¼å°±è¡Œã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Vector3f l_indirect <span class="token operator">=</span> <span class="token function">Vector3f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// Russian Roulette test</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">get_random_float</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> RussianRoulette<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    Vector3f wi <span class="token operator">=</span> <span class="token function">normalize</span><span class="token punctuation">(</span>shade_point_inter<span class="token punctuation">.</span>m<span class="token operator">-></span><span class="token function">sample</span><span class="token punctuation">(</span>wo<span class="token punctuation">,</span> normal<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Vector3f indirect_ray_origin <span class="token operator">=</span> shade_point <span class="token operator">+</span> wi <span class="token operator">*</span> EPSILON<span class="token punctuation">;</span>    Ray <span class="token function">reflected_ray</span><span class="token punctuation">(</span>indirect_ray_origin<span class="token punctuation">,</span> wi<span class="token punctuation">)</span><span class="token punctuation">;</span>    Intersection reflected_inter <span class="token operator">=</span> <span class="token function">intersect</span><span class="token punctuation">(</span>reflected_ray<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// If reflected_ray hitting a non-emitting object, compute its contribution </span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>reflected_inter<span class="token punctuation">.</span>happened <span class="token operator">&amp;&amp;</span> reflected_inter<span class="token punctuation">.</span>m<span class="token operator">-></span><span class="token function">hasEmission</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        l_indirect <span class="token operator">=</span> <span class="token function">Vector3f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        l_indirect <span class="token operator">=</span> <span class="token function">castRay</span><span class="token punctuation">(</span>reflected_ray<span class="token punctuation">,</span> depth <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> shade_point_inter<span class="token punctuation">.</span>m<span class="token operator">-></span><span class="token function">eval</span><span class="token punctuation">(</span>wi<span class="token punctuation">,</span> wo<span class="token punctuation">,</span> normal<span class="token punctuation">)</span> \        <span class="token operator">*</span> std<span class="token double-colon punctuation">::</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token function">dotProduct</span><span class="token punctuation">(</span>wi<span class="token punctuation">,</span> normal<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0f</span><span class="token punctuation">)</span> \        <span class="token operator">/</span> <span class="token punctuation">(</span>shade_point_inter<span class="token punctuation">.</span>m<span class="token operator">-></span><span class="token function">pdf</span><span class="token punctuation">(</span>wi<span class="token punctuation">,</span> wo<span class="token punctuation">,</span> normal<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> RussianRoulette<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç»“æœå¯¹ EPSILON æŒºæ•æ„Ÿçš„ï¼Œå¯ä»¥æŠŠ EPSILON é€‚å½“è°ƒå¤§ç‚¹ï¼Œæˆ‘ç”¨çš„æ˜¯ <code>0.00020</code> .</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å¤§è‡´æµç¨‹&quot;&gt;&lt;a href=&quot;#å¤§è‡´æµç¨‹&quot; class=&quot;headerlink&quot; title=&quot;å¤§è‡´æµç¨‹&quot;&gt;&lt;/a&gt;å¤§è‡´æµç¨‹&lt;/h1&gt;&lt;p&gt;è¿™æ¬¡çš„ä½œä¸šæŒºéš¾çš„ã€‚é¦–å…ˆæˆ‘ä»¬æ¥å¯¹ç…§å…¬å¼è§£é‡Šä¸€ä¸‹å¤§è‡´çš„ä»£ç æµç¨‹ï¼š&lt;/p&gt;
&lt;script type=&quot;math/tex; mod</summary>
      
    
    
    
    <category term="å…¬å¼€è¯¾" scheme="http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/"/>
    
    <category term="GAMES101" scheme="http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/"/>
    
    <category term="Assignments" scheme="http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/Assignments/"/>
    
    
  </entry>
  
  <entry>
    <title>Note 6 BRDF and Rendering Eequation</title>
    <link href="http://rinevard.github.io/wiki/learning/open-course/GAMES101/Notes/Note6-BRDF-and-renderingequation/"/>
    <id>http://rinevard.github.io/wiki/learning/open-course/GAMES101/Notes/Note6-BRDF-and-renderingequation/</id>
    <published>2025-10-10T13:45:28.000Z</published>
    <updated>2025-10-10T14:49:51.245Z</updated>
    
    <content type="html"><![CDATA[<p>æˆ‘ä»¬ä¹‹å‰å·²ç»å­¦è¿‡äº† Blinn-Phong å…‰ç…§æ¨¡å‹ï¼Œä½†å®ƒåªæ˜¯ä¸€ä¸ªå¯å‘å¼æ¨¡å‹ï¼Œåœ¨ç‰©ç†ä¸Šæ˜¯ä¸æ­£ç¡®çš„ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹ç‰©ç†ä¸Šæ­£ç¡®çš„å…‰ç…§æ˜¯æ€æ ·çš„ï¼Œä»¥åŠå¦‚ä½•ç”¨è®¡ç®—æœºè¿‘ä¼¼æ±‚è§£æ¥è¿‘æ­£ç¡®çš„å…‰ç…§ã€‚</p><h1 id="è¾å°„åº¦é‡å­¦"><a href="#è¾å°„åº¦é‡å­¦" class="headerlink" title="è¾å°„åº¦é‡å­¦"></a>è¾å°„åº¦é‡å­¦</h1><p>åœ¨äº†è§£å…‰ç…§çš„ç‰©ç†æ¨¡å‹ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ä¸€äº›ç‰©ç†é‡ã€‚æœ€å…³é”®çš„ç‰©ç†é‡æœ‰å››ä¸ªï¼Œåˆ†åˆ«æ˜¯</p><ol><li>Radiant flux/power $\Phi$ï¼Œå•ä½ $W$.</li><li>Radiant intensity $I$ï¼Œå•ä½ $\frac{W}{\text{sr}}$.</li><li>Irradiance $E$ï¼Œå•ä½ $\frac{W}{m^2}$.</li><li>Radiance $L$ï¼Œå•ä½ $\frac{W}{\text{sr}\cdot m^2}$.</li></ol><p>æ¥ä¸‹æ¥è®©æˆ‘ä»¬çœ‹çœ‹å®ƒä»¬çš„å…·ä½“å®šä¹‰ã€‚</p><h2 id="Radiant-flux-power-Phi"><a href="#Radiant-flux-power-Phi" class="headerlink" title="Radiant flux/power $\Phi$"></a>Radiant flux/power $\Phi$</h2><p>Radiant flux/power ç¬¦å· $\Phi$ï¼Œå•ä½ $W$.</p><p>å®šä¹‰ä¸º</p><script type="math/tex; mode=display">\Phi = \frac{dQ}{dt}</script><h2 id="Radiant-intensity-I"><a href="#Radiant-intensity-I" class="headerlink" title="Radiant intensity $I$"></a>Radiant intensity $I$</h2><p>Radiant Intensity ç¬¦å· $I$ï¼Œå•ä½ $\frac{W}{\text{sr}}$ï¼Œè¡¨ç¤ºæŸä¸ªå®šç‚¹æ¥æ”¶/ç©¿è¿‡/å‘å‡ºçš„ï¼Œåœ¨æŒ‡å®šæ–¹å‘ $\vec{\omega}$ ä¸Šçš„ï¼Œå•ä½ç«‹ä½“è§’çš„ Power.</p><p>å®šä¹‰ä¸º</p><script type="math/tex; mode=display">I(\vec{\omega})=\frac{d\Phi}{d\omega}</script><p>è¿™é‡Œçš„ç¬¦å·ç•¥æ˜¾æ··ä¹±ã€‚å·¦è¾¹çš„å‚æ•° $\vec{\omega}$ æ˜¯ä¸€ä¸ªæ–¹å‘å‘é‡ï¼Œå³è¾¹çš„ $d\omega$ åˆ™æ˜¯è¿™ä¸ªæ–¹å‘ä¸Šç«‹ä½“è§’çš„å¾®åˆ†ã€‚</p><p>æˆ‘ä»¬çŸ¥é“æ–¹å‘å‘é‡ $\vec{\omega}$ ä¹Ÿèƒ½åœ¨çƒåæ ‡ä¸‹è¢«è¡¨ç¤ºä¸º $(\theta,\varphi)$ã€‚å¯¹ç»™å®šçš„ $(\theta,\varphi)$ï¼Œæˆ‘ä»¬å¯ä»¥ç®—å‡ºå…¶åœ¨çƒé¢ä¸Šçš„é¢ç§¯å¾®åˆ†ï¼Œä¹Ÿèƒ½è¿›ä¸€æ­¥æ±‚å‡ºç«‹ä½“è§’å¾®åˆ† $d\omega$ï¼Œå¦‚ä¸‹æ‰€ç¤º</p><script type="math/tex; mode=display">\begin{align*}&dA=r^2 \sin \theta \space d\theta \space d\varphi\\&d\omega=\frac{dA}{r^2}=\sin \theta \space d\theta \space d\varphi\end{align*}</script><p>ä¸‹å›¾æ˜¯å¯¹  Solid angle å’Œ Radiant Intensity ä¸¤ä¸ªæ¦‚å¿µçš„å›¾è§£</p><p><img src="/images/learning/open-course/GAMES101/Notes/note6/solid_angle_and_intensity.png" alt=""></p><h2 id="Irradiance-E"><a href="#Irradiance-E" class="headerlink" title="Irradiance $E$"></a>Irradiance $E$</h2><p>Irradiance ç¬¦å· $E$ï¼Œå•ä½ $\frac{W}{m^2}$.</p><p>è¡¨ç¤ºç‚¹ $x$ å‘¨å›´å•ä½é¢ç§¯æ¥æ”¶/ç©¿è¿‡/å‘å‡ºçš„ Powerï¼Œå®šä¹‰ä¸º</p><script type="math/tex; mode=display">E(x)=\frac{d\Phi}{dA}</script><p>ä¸‹å›¾è®¡ç®—å¹¶å¯¹æ¯”äº†å¹³è¡Œå…‰ç©¿è¿‡ä¸¤ä¸ªä¸åŒæˆªé¢æ—¶çš„ irradianceï¼šå‚ç›´æˆªé¢ $A$ï¼Œä»¥åŠä¸å‚ç›´æ–¹å‘æˆ $\theta$ è§’çš„å€¾æ–œæˆªé¢ $Aâ€™$ã€‚</p><p>å…¶ä¸­ $\Phi=\Phiâ€™$ æ˜¯å› ä¸ºèƒ½é‡å®ˆæ’ï¼Œå…‰æŸç©¿è¿‡ä»»ä½•ä¸€ä¸ªå®Œæ•´æˆªé¢çš„åŠŸç‡æ˜¯å›ºå®šçš„ã€‚</p><p><img src="/images/learning/open-course/GAMES101/Notes/note6/irradiance.png" alt=""></p><h2 id="Radiance-L"><a href="#Radiance-L" class="headerlink" title="Radiance $L$"></a>Radiance $L$</h2><p>Radiance $L$ çš„å•ä½æ˜¯ $\frac{W}{\text{sr}\cdot \space m^2}$ï¼Œè¡¨ç¤ºè¡¨é¢æŸç‚¹ $x$ å‘¨å›´å•ä½æŠ•å½±é¢ç§¯æ¥æ”¶/ç©¿è¿‡/å‘å‡ºçš„ï¼Œåœ¨æŒ‡å®šæ–¹å‘ $\vec{w}$ ä¸Šçš„ï¼Œå•ä½ç«‹ä½“è§’çš„ radiant flux.</p><p>å®šä¹‰ä¸º</p><script type="math/tex; mode=display">L(x,\vec{\omega})=\frac{d^2\Phi}{d\omega ds}=\frac{d^2\Phi}{d\omega ds_{0}\cos\theta}</script><p>è¿™é‡Œçš„ $ds$ æ˜¯æŠ•å½±å‰é¢ç§¯ï¼Œ$ds_0 \cos\theta$ æ˜¯æŠ•å½±é¢ç§¯ã€‚</p><p>ä¸‹å›¾æ˜¯å¯¹ Irradiance å’Œ Radianceçš„å›¾è§£</p><p><img src="/images/learning/open-course/GAMES101/Notes/note6/irradiance_and_radiance.png" alt=""></p><h1 id="BRDFå’Œæè´¨"><a href="#BRDFå’Œæè´¨" class="headerlink" title="BRDFå’Œæè´¨"></a>BRDFå’Œæè´¨</h1><p>ç°åœ¨æˆ‘ä»¬å¯ä»¥çœ‹çœ‹å…‰ç…§çš„ç‰©ç†æ¨¡å‹äº†ï¼Œå…¶ä¸­æœ€å…³é”®çš„æ˜¯ BRDFï¼Œå³åŒå‘åå°„åˆ†å¸ƒå‡½æ•°ã€‚å®ƒå®šä¹‰äº†ä»æ–¹å‘ $\vec{\omega_i}$ å°„å…¥çš„å…‰çº¿æ‰“åˆ°æŸä¸ªè¡¨é¢ä¸Šåå°„åˆ° $\vec{\omega_r}$ æ–¹å‘çš„å¼ºåº¦ï¼š</p><script type="math/tex; mode=display">f_r(p,\vec{\omega_i}, \vec{\omega_r}) = \frac{dL_r(p,\vec{\omega_r})}{dE_i(p,\vec{\omega_i})}</script><p>ä½ å¯èƒ½ä¼šç–‘æƒ‘ä¸ºä»€ä¹ˆä¹‹å‰æˆ‘ä»¬è¯´ $E$ æ˜¯å…³äº $x$ çš„å‡½æ•°ï¼Œç°åœ¨å´é™¤äº†åæ ‡ $p$ å¤–è¿˜å¤šäº†ä¸€ä¸ªæ–¹å‘å‚æ•° $\omega_i$ï¼Œè¿™æ˜¯å› ä¸º BRDF é‡Œçš„ $E$ æ˜¯å¾®åˆ†ã€‚å…·ä½“å¯ä»¥çœ‹çœ‹ä¸‹é¢è¿™ä¸ªå¼å­ï¼š</p><script type="math/tex; mode=display">E(x) = \int_{\Omega} L_i(x,\vec{\omega_i}) \cos\theta_i d\omega_i\\dE_i(x, \vec{\omega_i}) = L_i(x, \vec{\omega_i}) \cos\theta_i d\omega_i</script><p>ä½ å¯èƒ½è¿˜ä¼šç–‘æƒ‘ï¼Œä¸ºä»€ä¹ˆåˆ†æ¯ç”¨ $E$ å‘¢ï¼Ÿå’Œåˆ†æ¯ä¸€æ ·ç»Ÿä¸€ç”¨ $L$ ä¸æ˜¯æ›´ä¼˜é›…å—ï¼Ÿ</p><p>æ® <a href="https://www.zhihu.com/question/28476602/answer/41003204">https://www.zhihu.com/question/28476602/answer/41003204</a> è¿™ä¸ªç­”æ¡ˆæ‰€è¯´ï¼Œæµ‹é‡å‡ºå°„çš„ Radiance $L$ å¾ˆæ–¹ä¾¿ï¼Œä½†æµ‹é‡å…¥å°„çš„ Irradiance $L$ å¾ˆå›°éš¾ï¼Œè€Œæµ‹é‡å…¥å°„çš„ $dE$ æŒºæ–¹ä¾¿ï¼Œå› æ­¤æˆ‘ä»¬å°±ä½¿ç”¨äº† $\frac{dL}{dE}$.</p><p>æˆ‘ä»¬æŠŠä¸Šé¢çš„ $dE_i(x,\vec{\omega_i})$ ä»£å…¥ BRDFï¼Œå°±å¾—åˆ°äº†</p><script type="math/tex; mode=display">f_r(p,\vec{\omega_i}, \vec{\omega_r}) = \frac{dL_r(p,\vec{\omega_r})}{L_i(x,\vec{w_i})\cos\theta_i dw_i}</script><p>ç‰©ä½“çš„æè´¨å°±ç”¨ BSDFï¼ˆåå°„çš„BRDF+æŠ˜å°„çš„BTDFï¼‰è¡¨ç¤ºã€‚æˆ‘ä»¬è¿™é‡ŒåªèŠ BRDFï¼Œå› ä¸º BTDF å’Œ BRDF æ¥è¿‘ã€‚BRDF çš„è·å–åŒ…æ‹¬ä½†ä¸é™äºè¿™ä¸¤ç§æ–¹å¼ï¼š</p><ol><li>ç°å®æµ‹é‡ã€‚æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°è®¸å¤šåŒ…å«å¤§é‡ BRDF æµ‹é‡æ•°æ®çš„æ•°æ®é›†ï¼Œæ¯”å¦‚ MERL æ•°æ®é›†ã€‚</li><li>å¾®è¡¨é¢æ¨¡å‹ã€‚ç”¨ç²—ç³™åº¦ã€é‡‘å±åº¦ç­‰å‚æ•°æ¥æ„å»ºå¯å‘å¼çš„ BRDF å‡½æ•°ã€‚</li></ol><p>è¿˜å€¼å¾—ä¸€æçš„æ˜¯ï¼Œç”± Helmholtz Reciprocity Principleï¼Œæœ‰</p><script type="math/tex; mode=display">f_r(p,\vec{\omega_i}, \vec{\omega_o}) = f_r(p,\vec{\omega_o}, \vec{\omega_i})</script><p>ä¹Ÿå°±æ˜¯è¯´äº¤æ¢å…¥å°„å‡ºå°„æ–¹å‘ï¼ŒBRDF å‡½æ•° $f_r$ ä¸å˜ã€‚</p><h1 id="æ¸²æŸ“æ–¹ç¨‹"><a href="#æ¸²æŸ“æ–¹ç¨‹" class="headerlink" title="æ¸²æŸ“æ–¹ç¨‹"></a>æ¸²æŸ“æ–¹ç¨‹</h1><p>ç°åœ¨æˆ‘ä»¬å…ˆçœ‹çœ‹åå°„æ–¹ç¨‹ï¼Œå†çœ‹çœ‹æ¸²æŸ“æ–¹ç¨‹ã€‚</p><p>åå°„æ–¹ç¨‹æ˜¯é€šè¿‡ BRDF æ±‚å‡º $L_r$ çš„æ–¹ç¨‹ï¼Œå¯¹ BRDF çš„å…¬å¼ç§¯åˆ†ä¸€ä¸‹å°±è¡Œï¼š</p><script type="math/tex; mode=display">L_r(p, \vec{\omega_r}) = \int_{\Omega} f_r(p, \vec{\omega_i}, \vec{\omega_r}) L_i(p, \vec{\omega_i}) (\vec{\omega_i} \cdot \vec{n}) d\omega_i</script><p>å…¶ä¸­ $\vec{n}$ æ˜¯ç‚¹ $p$ å¤„çš„æ³•çº¿æ–¹å‘ï¼Œ$\vec{\omega_i} \cdot \vec{n}$ æ˜¯ BRDF å®šä¹‰é‡Œçš„ $\cos\theta_i$.</p><p>è€Œæ¸²æŸ“æ–¹ç¨‹ï¼Œä¸è€ƒè™‘æŠ˜å°„ï¼Œåªæ˜¯æ¯”åå°„æ–¹ç¨‹å¤šäº†ä¸€ä¸ªè‡ªå‘å…‰é¡¹ï¼š</p><script type="math/tex; mode=display">L_o(p, \vec{\omega_o}) = L_e(p, \vec{\omega_o}) + \int_{\Omega} f_r(p, \vec{\omega_i}, \vec{\omega_o}) L_i(p, \vec{\omega_i}) (\vec{\omega_i} \cdot n) d\omega_i</script><p>ä½ å¯èƒ½ä¼šå¥½å¥‡å³ä¾§çš„ $L_i(p,\vec{\omega_i}<br>)$ æ€ä¹ˆæ±‚å‡ºæ¥ã€‚ç”±èƒ½é‡å®ˆæ’ï¼Œæˆ‘ä»¬å¯ä»¥ä» $p$ å‡ºå‘é¡ºç€ $-\vec{\omega_i}$ æ‰¾åˆ°ç¬¬ä¸€ä¸ªäº¤ç‚¹ $q$ï¼Œç„¶åå°±æœ‰</p><script type="math/tex; mode=display">L_i(p,\vec{\omega_i})=L_o(q,-\vec{\omega_i})</script><h1 id="å®é™…ç®—æ³•"><a href="#å®é™…ç®—æ³•" class="headerlink" title="å®é™…ç®—æ³•"></a>å®é™…ç®—æ³•</h1><p>ç”±ä¸Šå¯çŸ¥ï¼Œæˆ‘ä»¬è¦æ±‚è§£ä¸‹é¢çš„æ–¹ç¨‹ï¼š</p><script type="math/tex; mode=display">L_o(p, \vec{\omega_o}) = L_e(p, \vec{\omega_o}) + \int_{\Omega} f_r(p, \vec{\omega_i}, \vec{\omega_o}) L_o(\text{raycast}(p, -\vec{\omega_i}), -\vec{\omega_i}) (\vec{\omega_i} \cdot n) d\vec{\omega_i}</script><p>è¿™æ˜¯ä¸€ä¸ªç§¯åˆ†ï¼Œè¿˜æ˜¯ä¸€ä¸ªé€’å½’ï¼Œæˆ‘ä»¬å…ˆç”¨è’™ç‰¹å¡ç½—ç®—æ³•è¿‘ä¼¼ç§¯åˆ†ï¼Œå¾—åˆ°</p><script type="math/tex; mode=display">L_o(p, \vec{\omega_o}) \approx L_e(p, \vec{\omega_o}) + \frac{1}{N}\sum_{k=1}^{N}\frac{f_r(p, \vec{\omega_i}^{(k)}, \vec{\omega_o}) L_o(\text{raycast}(p, -\vec{\omega_i}^{(k)}), -\vec{\omega_i}^{(k)}) (\vec{\omega_i} ^{(k)}\cdot n) }{p(\vec{\omega_i}^{(k)})}</script><p>å…¶ä¸­ $\vec{\omega_i}^{(k)}$ æ˜¯éšæœºé‡‡æ ·çš„æ–¹å‘å‘é‡ï¼Œ$p(\vec{\omega_i}^{(k)})$ æ˜¯é‡‡æ ·åˆ°å®ƒçš„æ¦‚ç‡ã€‚</p><p>æœ‰äº†è¿™ä¸ªæ±‚å’Œï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹é€’å½’äº†ï¼Œå¤§è‡´ç®—æ³•å¦‚ä¸‹ï¼š</p><ol><li>ä» $p$ å°„å‡ºæœéšæœºæ–¹å‘ $\vec{\omega_i}<br>^{(k)}$ çš„å°„çº¿ï¼Œæ‰“åˆ° $q^{(k)}$.</li><li>è®¡ç®— $L_o(q,-w_i^{(k)})$ï¼Œç„¶åä»£å…¥å¼å­ï¼Œæ±‚å¾— $L_o(p,\vec{\omega_o})$ã€‚</li></ol><p>ç­‰ç­‰ï¼Œè¿™ä¸æ˜¯æ— é™é€’å½’å—ï¼Ÿç¡®å®å¦‚æ­¤ã€‚æ‰€ä»¥æˆ‘ä»¬ä¼šå‡è®¾å¦‚æœå°„çº¿æ‰“åˆ°äº†å…‰æºå°±åªè¿”å›è‡ªå‘å…‰é¡¹ $L_e$.</p><p>ä½†è¿™ä¸è¿˜æ˜¯å¾ˆå¤æ‚å—ï¼Œå‡è®¾æˆ‘ä»¬å¯¹æ¯ä¸ªç‚¹å‘å°„ $10$ æ¡å°„çº¿ï¼Œå¼¹å°„ä»¥åå°±è¦å‘å°„ $10^2$ ä¸ªï¼Œå†å¼¹å°„å°±è¦ $10^3$ ä¸ªï¼</p><p>æ²¡é”™ï¼Œæ‰€ä»¥æˆ‘ä»¬åªå¯¹æ¯ä¸ªç‚¹å‘å‡º $1$ æ¡å°„çº¿å¹¶è®¡ç®—å…¶å¼¹å°„åçš„å®Œæ•´è·¯å¾„ï¼Œç„¶åå¯¹æ¯ä¸ªç‚¹è¿½è¸ªå¤šæ¡è·¯å¾„å¹¶å–å¹³å‡ã€‚è™½ç„¶è¿™ä¸å®Œå…¨ç¬¦åˆä¸Šé¢çš„å…¬å¼ï¼Œä½†å¾ˆæœ‰æ•ˆã€‚</p><p>è®©æˆ‘ä»¬æ¥çœ‹çœ‹æ–°çš„ç®—æ³•å§ï¼š</p><ol><li>å¦‚æœç‚¹ $p$ æ˜¯å…‰æºï¼Œç›´æ¥è¿”å›å…¶è‡ªå‘å…‰é¡¹ã€‚</li><li>éšæœºé‡‡æ ·ä¸€ä¸ªæ–¹å‘ $w_i$ï¼Œä» $p$ å‘å‡ºä¸€æ¡æœå‘ $w_i$ çš„å°„çº¿ï¼Œæ‰“åˆ°ç‚¹ $q$.</li><li>è®¡ç®—ç‚¹ $q$ çš„ $L_o(q,-w_i)$ï¼Œä»£å…¥å…¬å¼ï¼Œæ±‚å¾— $L_o(p,w_o)$.</li><li>å¯¹æ±‚å¾—çš„å¤šä¸ª $L_o(p,w_o)$ å–å¹³å‡ã€‚</li></ol><p>è¿™ä¸ªç®—æ³•å½“ç„¶å¯ä»¥è¿›ä¸€æ­¥ä¼˜åŒ–ï¼Œæ¯”å¦‚è¯´ä¸Šé¢è¿˜æ˜¯æœ‰æ½œåœ¨çš„æ— é™å¼¹å°„é£é™©ï¼Œæ‰€ä»¥è¦ç”¨ä¿„ç½—æ–¯è½®ç›˜èµŒæ¥åœ¨æ¯æ¬¡å¼¹å°„æ—¶éƒ½æœ‰éšæœºæ¦‚ç‡åœæ­¢å¼¹å°„ï¼ˆè¿™è¢«ç§°ä½œRRï¼‰ï¼›åˆæ¯”å¦‚ä¸Šé¢æ‰“åˆ°å…‰æºçš„æ¦‚ç‡å¤ªä½ï¼Œæ‰€ä»¥å¯ä»¥ä»å…‰æºé‡‡æ ·å°„çº¿ï¼ˆè¿™è¢«ç§°ä½œNEEï¼‰ã€‚ä¸è¿‡è¿™äº›ä¸œè¥¿å°±ç•™åˆ°ä½œä¸š 7 çš„è§£æé‡Œå†è¯´å§ã€‚</p><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><p>Stanford CS348B, Spring 2022ï¼š<a href="https://gfxcourses.stanford.edu/cs348b/spring22">https://gfxcourses.stanford.edu/cs348b/spring22</a></p><p>å¤šä¼¦å¤šå¤§å­¦å›¾å½¢å­¦è®²ä¹‰ï¼š<a href="https://www.dgp.toronto.edu/public_user/elf/2522/light.pdf">https://www.dgp.toronto.edu/public_user/elf/2522/light.pdf</a></p><p>Introduction to Radiometry and Photometry</p><p>UE4 çš„ BRDF å®ç°ï¼š<a href="https://blog.selfshadow.com/publications/s2013-shading-course/karis/s2013_pbs_epic_notes_v2.pdf">https://blog.selfshadow.com/publications/s2013-shading-course/karis/s2013_pbs_epic_notes_v2.pdf</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æˆ‘ä»¬ä¹‹å‰å·²ç»å­¦è¿‡äº† Blinn-Phong å…‰ç…§æ¨¡å‹ï¼Œä½†å®ƒåªæ˜¯ä¸€ä¸ªå¯å‘å¼æ¨¡å‹ï¼Œåœ¨ç‰©ç†ä¸Šæ˜¯ä¸æ­£ç¡®çš„ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹ç‰©ç†ä¸Šæ­£ç¡®çš„å…‰ç…§æ˜¯æ€æ ·çš„ï¼Œä»¥åŠå¦‚ä½•ç”¨è®¡ç®—æœºè¿‘ä¼¼æ±‚è§£æ¥è¿‘æ­£ç¡®çš„å…‰ç…§ã€‚&lt;/p&gt;
&lt;h1 id=&quot;è¾å°„åº¦é‡å­¦&quot;&gt;&lt;a href=&quot;#è¾å°„åº¦é‡å­¦&quot; class=&quot;head</summary>
      
    
    
    
    <category term="å…¬å¼€è¯¾" scheme="http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/"/>
    
    <category term="GAMES101" scheme="http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/"/>
    
    <category term="Notes" scheme="http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/Notes/"/>
    
    
  </entry>
  
  <entry>
    <title>æ¢ç´¢æ—¥å¿—[0]</title>
    <link href="http://rinevard.github.io/wiki/others/thoughts/%E6%8E%A2%E7%B4%A2%E6%97%A5%E5%BF%970/"/>
    <id>http://rinevard.github.io/wiki/others/thoughts/%E6%8E%A2%E7%B4%A2%E6%97%A5%E5%BF%970/</id>
    <published>2025-10-10T12:10:11.000Z</published>
    <updated>2025-10-14T12:11:51.068Z</updated>
    
    <content type="html"><![CDATA[<p>ç¬¬äºŒæ¬¡å‚åŠ äº† Ludum Dareï¼Œç¬¬äºŒæ¬¡å‚åŠ äº† Compo èµ›é“ã€‚Compo è¦æ±‚å•äººä»é›¶å¼€å§‹åœ¨ 48 å°æ—¶å†…åšå‡ºä¸€ä¸ªèƒ½ç©çš„ä¸œè¥¿ã€‚ä¸è§‰å¾—è¿™å¾ˆé…·å—ï¼Œä½œä¸ºä¸€ä¸ªç©å®¶æˆ‘è§‰å¾—è¿™å¤ªé…·äº†ï¼Œå¾ˆç¬¦åˆæˆ‘å¯¹æå®¢çš„æƒ³è±¡ã€‚</p><p>ä¸Šä¸€æ¬¡å‚åŠ  Compo ç»“è¯†äº†ä¸€ä½å¾ˆæœ‰è¶£çš„æœ‹å‹ï¼Œæ‰€ä»¥è¿™æ¬¡åˆå‚åŠ äº† Compo è€Œä¸æ˜¯ç»„é˜Ÿçš„ Jamã€‚ä¸è¿‡è¿™æ¬¡ä¼¼ä¹è‡³å°‘åˆ°ç°åœ¨ä¸ºæ­¢è¿˜æ²¡ç»“è¯†åˆ°å¾ˆæœ‰è¶£çš„æœ‹å‹ï¼ˆï¼‰</p><p>ä»ä¸Šå­¦æœŸå°±å¼€å§‹æƒ³ï¼Œå¤§å­¦çš„æ¯å¤©éƒ½å¤ªç›¸ä¼¼ï¼Œæ—¥å¤ä¸€æ—¥ã€‚å› æ­¤æƒ³æ¯å‘¨éƒ½åšä¸€äº›æ²¡åšè¿‡çš„äº‹æƒ…ã€‚è™½ç„¶æ²¡åšæŒå¾ˆä¹…ï¼Œä½†æˆ‘æƒ³è¿™ç¡®å®æ˜¯å€¼å¾—åšçš„ã€‚æ‰€ä»¥ä»ç°åœ¨å¼€å§‹ç®€å•å†™å†™æ¢ç´¢æ—¥å¿—å§ï¼Œæ—¶ä¸æ—¶æ¢ç´¢ä¸€ä¸‹ã€‚</p><p>è¿™æ¬¡é™¤äº†è‡ªå·±å‚åŠ ä¹‹å¤–ï¼Œè¿˜å’Œå¢¨é±¼æ¸¸ç ”ç¤¾çš„åŒå­¦ä»¬ä¸€èµ·ç»„ç»‡äº†ä¸€ä¸ªæ´»åŠ¨ï¼Œå’Œç¤¾å›¢çš„å¤§å®¶ä¸€èµ·å‚åŠ äº†è¿™åœº gamejamï¼Œå’±ä»¬ç¤¾å›¢æœ€åä¸€å…±åšäº†å››ä¸ªæ¸¸æˆã€‚æˆ‘åšäº† <a href="https://ldjam.com/events/ludum-dare/58/swarm-surge">SwarmSurge</a>.</p><p>æ€æ ·çš„ç”Ÿæ´»å€¼å¾—æˆ‘è¿‡ï¼Œæˆ‘è¯¥è¿‡æ€æ ·çš„ç”Ÿæ´»ï¼Ÿæˆ‘ç¡®å®è¿˜æ²¡æƒ³æ˜ç™½ã€‚Jam æ˜¯ç”Ÿæ´»é‡Œä¸ºæ•°ä¸å¤šçš„ä¸€æŠ¹å¥‡å¹»è‰²å½©ï¼ŒæƒŠè‰³åˆçŸ­æš‚ã€‚åœ¨æœ‰è¶£çš„æ•…äº‹ç»“æŸä¹‹åï¼Œæˆ‘ä»¬åˆè¯¥åšä»€ä¹ˆï¼Œåˆè¯¥å»å¾€ä½•æ–¹ï¼Ÿ</p><p>ä¹Ÿéš¾æ€ªä¼šå–œæ¬¢å‡‰å®«æ˜¥æ—¥ã€‚è™½ç„¶å¥¹æ€§æ ¼æ¶åŠ£æƒ³ä¸€å‡ºæ˜¯ä¸€å‡ºï¼Œä½†å¥¹æ˜¯è®©ä¸–ç•Œå˜å¾—æ›´çƒ­é—¹çš„å‡‰å®«æ˜¥æ—¥å›¢å›¢é•¿ï¼é˜¿è™šæ›¾é—®è‡ªå·±ï¼šâ€œå¯¹è¿™ç§è¶…ä¹å¸¸è¯†çš„å­¦å›­ç”Ÿæ´»ï¼Œä½ å°±ä¸è§‰å¾—å¿«ä¹å—ï¼Ÿâ€ä»–çš„å›ç­”æ˜¯ï¼šâ€œå½“ç„¶å¿«ä¹äº†ï¼Œåˆ«é—®æˆ‘è¿™ç§æ˜æ‘†ç€çš„äº‹æƒ…ã€‚â€</p><p>å¯¹è¿™äº›å¥‡å¹»è‰²å½©ï¼Œæˆ‘éš¾é“ä¸æ„Ÿè§‰å¿«ä¹å—ï¼Ÿå½“ç„¶å¿«ä¹äº†ã€‚æˆ‘ä¼šä¸€ç›´æ¢ç´¢ä¸‹å»ï¼Œå³ä½¿æ¯å¤©éƒ½æ˜¯æŸä¸ªé›¨æ—¥ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;ç¬¬äºŒæ¬¡å‚åŠ äº† Ludum Dareï¼Œç¬¬äºŒæ¬¡å‚åŠ äº† Compo èµ›é“ã€‚Compo è¦æ±‚å•äººä»é›¶å¼€å§‹åœ¨ 48 å°æ—¶å†…åšå‡ºä¸€ä¸ªèƒ½ç©çš„ä¸œè¥¿ã€‚ä¸è§‰å¾—è¿™å¾ˆé…·å—ï¼Œä½œä¸ºä¸€ä¸ªç©å®¶æˆ‘è§‰å¾—è¿™å¤ªé…·äº†ï¼Œå¾ˆç¬¦åˆæˆ‘å¯¹æå®¢çš„æƒ³è±¡ã€‚&lt;/p&gt;
&lt;p&gt;ä¸Šä¸€æ¬¡å‚åŠ  Compo ç»“è¯†äº†ä¸€ä½å¾ˆæœ‰è¶£çš„æœ‹å‹ï¼Œæ‰€ä»¥è¿™æ¬¡åˆå‚</summary>
      
    
    
    
    <category term="æ‚è°ˆ" scheme="http://rinevard.github.io/categories/%E6%9D%82%E8%B0%88/"/>
    
    <category term="ç¢ç¢å¿µ" scheme="http://rinevard.github.io/categories/%E6%9D%82%E8%B0%88/%E7%A2%8E%E7%A2%8E%E5%BF%B5/"/>
    
    
  </entry>
  
  <entry>
    <title>Note 5 RayTracing</title>
    <link href="http://rinevard.github.io/wiki/learning/open-course/GAMES101/Notes/Note5-RayTracing/"/>
    <id>http://rinevard.github.io/wiki/learning/open-course/GAMES101/Notes/Note5-RayTracing/</id>
    <published>2025-09-25T13:48:28.000Z</published>
    <updated>2025-09-25T13:51:26.850Z</updated>
    
    <content type="html"><![CDATA[<p>æ¸²æŸ“å¯ä»¥åˆ†ä¸ºä¸¤ä¸ªå¤§ç±»ï¼šobject-order rendering å’Œ Image-order rendering. å‰è€…ä»¥åœºæ™¯ä¸­çš„ç‰©ä½“ï¼ˆé€šå¸¸æ˜¯å¦‚ä¸‰è§’å½¢ï¼‰ä¸ºåŸºæœ¬å•ä½è¿›è¡Œè¿­ä»£ï¼Œéå†åœºæ™¯ä¸­çš„æ¯ä¸€ä¸ªç‰©ä½“ï¼Œç„¶åç¡®å®šè¯¥ç‰©ä½“ä¼šå½±å“å±å¹•ä¸Šçš„å“ªäº›åƒç´ ï¼›åè€…ä»¥å±å¹•ä¸Šçš„åƒç´ ä¸ºåŸºæœ¬å•ä½è¿›è¡Œè¿­ä»£ï¼Œéå†è¾“å‡ºå›¾åƒä¸­çš„æ¯ä¸€ä¸ªåƒç´ ï¼Œç„¶åå¯¹äºæ¯ä¸ªåƒç´ ï¼Œå®ƒä¼šæ‰¾å‡ºåœºæ™¯ä¸­çš„å“ªä¸ªç‰©ä½“æˆ–ç‰©ä½“çš„å“ªä¸ªéƒ¨åˆ†å†³å®šäº†è¯¥åƒç´ çš„é¢œè‰²ã€‚</p><p>æˆ‘ä»¬ä¹‹å‰å­¦çš„å…‰æ …åŒ–æ˜¯å‰è€…ï¼Œè€Œæˆ‘ä»¬æ¥ä¸‹æ¥è¦ä»‹ç»çš„å…‰çº¿è¿½è¸ªå°±æ˜¯åè€…ã€‚</p><h1 id="å…‰çº¿è¿½è¸ª"><a href="#å…‰çº¿è¿½è¸ª" class="headerlink" title="å…‰çº¿è¿½è¸ª"></a>å…‰çº¿è¿½è¸ª</h1><h2 id="åŸºæœ¬æ€æƒ³"><a href="#åŸºæœ¬æ€æƒ³" class="headerlink" title="åŸºæœ¬æ€æƒ³"></a>åŸºæœ¬æ€æƒ³</h2><p>å…‰çº¿è¿½è¸ªçš„æ€æƒ³åŸºäºå…‰è·¯å¯é€†â€”â€”æ—¢ç„¶å…‰è·¯å¯é€†ï¼Œé‚£ä¹ˆæ‰“åˆ°æ‘„åƒæœºé‡Œçš„å…‰å°±å¯ä»¥çœ‹ä½œä»æ‘„åƒæœºå‘å‡ºçš„å°„çº¿ï¼Œæˆ‘ä»¬åªè¦æ‰“å‡ºå°„çº¿ç„¶åè®¡ç®—å°„çº¿æ‰“åˆ°çš„ç‚¹çš„é¢œè‰²å°±å¥½äº†ã€‚</p><p>å…¶å®åŸºæœ¬æ€è·¯çœŸçš„å°±æ˜¯è¿™ä¹ˆç®€å•ï¼å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬ä»çœ¼ç›é‡Œå‘å‡ºç»è¿‡æ¯ä¸ªåƒç´ çš„å°„çº¿ï¼Œç„¶åå°„çº¿æ‰“åˆ°ç‰©ä½“ä¸Šå°±å¾—åˆ°äº†ç‰©ä½“çš„åŸºæœ¬é¢œè‰²ã€‚è€Œå°„çº¿è¿˜ä¼šåå°„ã€æŠ˜å°„ï¼Œæˆ‘ä»¬è®¡ç®—åå°„ã€æŠ˜å°„åçš„å°„çº¿æ‰“åˆ°çš„é¢œè‰²ï¼Œå†åŠ åˆ°åŸºæœ¬é¢œè‰²ä¸Šï¼Œå°±å¾—åˆ°äº†è¿™ä¸ªåƒç´ çš„é¢œè‰²ã€‚</p><p><img src="/images/learning/open-course/GAMES101/Notes/note5/ray_tracing.png" alt=""></p><p>å…‰çº¿è¿½è¸ªä¹Ÿè‡ªç„¶åœ°ç”Ÿæˆäº†é˜´å½±â€”â€”å¦‚æœå°„çº¿æ‰“ä¸­çš„ç‚¹å’Œå…‰æºçš„è¿çº¿é—´æœ‰ç‰©ä½“é®æŒ¡ï¼Œè¿™ç‚¹å°±æ˜¯é˜´å½±ï¼Œå¦åˆ™å°±ä¸æ˜¯é˜´å½±ã€‚</p><h2 id="ç¢°æ’æ£€æµ‹"><a href="#ç¢°æ’æ£€æµ‹" class="headerlink" title="ç¢°æ’æ£€æµ‹"></a>ç¢°æ’æ£€æµ‹</h2><p>æ—¢ç„¶å¦‚æ­¤ï¼Œæˆ‘ä»¬åªè¦æ£€æµ‹å°„çº¿å’Œä¸‰è§’å½¢çš„ç¢°æ’å°±å¥½äº†ã€‚æˆ‘ä»¬å¯ä»¥ç”¨ä¸‹é¢çš„ MÃ¶ller Trumbore Algorithm æ¥åšæ£€æµ‹ï¼Œå…¶æ€è·¯æ˜¯è§£ â€œç›´çº¿ä¸Šçš„ç‚¹ = ä¸‰è§’å½¢é‡å¿ƒåæ ‡è¡¨ç¤ºâ€ è¿™ä¸ªæ–¹ç¨‹ï¼š</p><p>è€ƒè™‘å°„çº¿ $\vec{O} + t\vec{D}$ å’Œä¸‰è§’å½¢ $P_0, P_1, P_2$ï¼Œæˆ‘ä»¬è¦è§£æ–¹ç¨‹</p><script type="math/tex; mode=display">\vec{O} + t\vec{D} = (1-b_1-b_2)\vec{P_0} + b_1\vec{P_1} + b_2\vec{P_2}</script><p>è¿™æ˜¯ä¸€ä¸ªçº¿æ€§æ–¹ç¨‹ç»„ï¼Œè§£ä¸º</p><script type="math/tex; mode=display">\begin{bmatrix} t \\ b_1 \\ b_2 \end{bmatrix} = \frac{1}{\vec{S_1} \cdot \vec{E_1}} \begin{bmatrix} \vec{S_2} \cdot \vec{E_2} \\ \vec{S_1} \cdot \vec{S} \\ \vec{S_2} \cdot \vec{D} \end{bmatrix}</script><p>å…¶ä¸­</p><script type="math/tex; mode=display">\begin{aligned}\vec{E_1} &= \vec{P_1} - \vec{P_0} \\\vec{E_2} &= \vec{P_2} - \vec{P_0} \\\vec{S} &= \vec{O} - \vec{P_0} \\\vec{S_1} &= \vec{D} \times \vec{E_2} \\\vec{S_2} &= \vec{S} \times \vec{E_1}\end{aligned}</script><h1 id="æ€§èƒ½ä¼˜åŒ–"><a href="#æ€§èƒ½ä¼˜åŒ–" class="headerlink" title="æ€§èƒ½ä¼˜åŒ–"></a>æ€§èƒ½ä¼˜åŒ–</h1><p>åœ¨åšå°„çº¿å’Œä¸‰è§’å½¢çš„ç¢°æ’æ£€æµ‹æ—¶ï¼Œç®€å•åœ°éå†åœºæ™¯é‡Œçš„æ¯ä¸ªä¸‰è§’å½¢æ˜¾ç„¶å¤ªæ…¢äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨åŒ…å›´ç›’æ¥ä¼˜åŒ–ã€‚å¦‚æœä¸€ä¸ªå°„çº¿æ²¡æœ‰ç¢°åˆ°åŒ…å›´ç›’ï¼Œè‡ªç„¶å°±ä¸ä¼šç¢°åˆ°ç›’å­é‡Œçš„ç‰©ä½“ï¼›å¦‚æœç¢°åˆ°äº†ï¼Œå†å’Œç›’å­é‡Œçš„ç‰©ä½“åšç¢°æ’æ£€æµ‹ã€‚</p><h2 id="å¸¸è§åŒ…å›´ç›’"><a href="#å¸¸è§åŒ…å›´ç›’" class="headerlink" title="å¸¸è§åŒ…å›´ç›’"></a>å¸¸è§åŒ…å›´ç›’</h2><p>åŒ…å›´ç›’æœ‰ä¸¤ç§æ€è·¯ï¼Œä¸€ç§æ˜¯åŸºäºç©ºé—´çš„åˆ’åˆ†ï¼Œå¦ä¸€ç§æ˜¯åŸºäºç‰©ä½“çš„åˆ’åˆ†ã€‚å‰è€…çš„ä»£è¡¨åŒ…æ‹¬å››å‰æ ‘ã€å…«å‰æ ‘ï¼›åè€…çš„ä»£è¡¨æ˜¯ BVH.</p><p>å››å‰æ ‘ã€å…«å‰æ ‘æŠŠç©ºé—´è¿›è¡Œå¹³åˆ†ï¼Œå½“ä¸€ä¸ªåŒºåŸŸé‡Œè¿˜å‰©è¾ƒå¤šç‰©ä½“æ—¶å°±å†åœ¨è¿™ä¸ªåŒºåŸŸé‡Œå¹³åˆ†ä¸€æ¬¡ã€‚</p><p><img src="/images/learning/open-course/GAMES101/Notes/note5/octree.png" alt=""></p><p>BVH ä¸ºæ¯ç»„ç‰©ä½“å»ºç«‹åŒ…å›´ç›’ï¼Œç„¶åå†æŠŠçˆ¶åŒ…å›´ç›’åˆ’åˆ†æˆå­åŒ…å›´ç›’ã€‚</p><p><img src="/images/learning/open-course/GAMES101/Notes/note5/bvh.png" alt=""></p><h2 id="å°„çº¿å’ŒåŒ…å›´ç›’çš„ç¢°æ’æ£€æµ‹"><a href="#å°„çº¿å’ŒåŒ…å›´ç›’çš„ç¢°æ’æ£€æµ‹" class="headerlink" title="å°„çº¿å’ŒåŒ…å›´ç›’çš„ç¢°æ’æ£€æµ‹"></a>å°„çº¿å’ŒåŒ…å›´ç›’çš„ç¢°æ’æ£€æµ‹</h2><p>åŒ…å›´ç›’æœ‰å…­ä¸ªé¢ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠç›¸å¯¹çš„é¢åˆ’åˆ†æˆä¸€ç»„ä»è€Œå¾—åˆ°ä¸‰ç»„é¢ã€‚è®¡ç®—å°„çº¿ $\vec{O} + t\vec{D}$ ä¸è¿™ä¸‰ç»„é¢çš„äº¤ç‚¹åï¼Œæˆ‘ä»¬ä¼šå¾—åˆ° $[t<em>{x, \text{enter}}, t</em>{x, \text{exit}}],[t<em>{y, \text{enter}}, t</em>{y, \text{exit}}],[t<em>{z, \text{enter}}, t</em>{z, \text{exit}}]$ï¼Œä¹‹åè®¡ç®—ä¸‹é¢çš„äº¤é›†ï¼š</p><script type="math/tex; mode=display">[t_\text{raymin},t_\text{raymax}]\cap[t_{x, \text{enter}}, t_{x, \text{exit}}]\cap[t_{y, \text{enter}}, t_{y, \text{exit}}]\cap[t_{z, \text{enter}}, t_{z, \text{exit}}]</script><p>å¦‚æœäº¤é›†ä¸ºç©ºåˆ™æ— äº¤ç‚¹ï¼Œå¦åˆ™æœ‰äº¤ç‚¹ã€‚</p><p>ä¸ºäº†æ–¹ä¾¿è®¡ç®—ï¼ŒåŒ…å›´ç›’ä¸€èˆ¬æ˜¯ä¸åæ ‡è½´å¹³è¡Œçš„ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æ¸²æŸ“å¯ä»¥åˆ†ä¸ºä¸¤ä¸ªå¤§ç±»ï¼šobject-order rendering å’Œ Image-order rendering. å‰è€…ä»¥åœºæ™¯ä¸­çš„ç‰©ä½“ï¼ˆé€šå¸¸æ˜¯å¦‚ä¸‰è§’å½¢ï¼‰ä¸ºåŸºæœ¬å•ä½è¿›è¡Œè¿­ä»£ï¼Œéå†åœºæ™¯ä¸­çš„æ¯ä¸€ä¸ªç‰©ä½“ï¼Œç„¶åç¡®å®šè¯¥ç‰©ä½“ä¼šå½±å“å±å¹•ä¸Šçš„å“ªäº›åƒç´ ï¼›åè€…ä»¥å±å¹•ä¸Šçš„åƒç´ ä¸ºåŸºæœ¬å•ä½è¿›è¡Œè¿­ä»£ï¼Œ</summary>
      
    
    
    
    <category term="å…¬å¼€è¯¾" scheme="http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/"/>
    
    <category term="GAMES101" scheme="http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/"/>
    
    <category term="Notes" scheme="http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/Notes/"/>
    
    
  </entry>
  
  <entry>
    <title>Assignment 6 Bounding Box</title>
    <link href="http://rinevard.github.io/wiki/learning/open-course/GAMES101/Hw/Hw6-bounding-box/"/>
    <id>http://rinevard.github.io/wiki/learning/open-course/GAMES101/Hw/Hw6-bounding-box/</id>
    <published>2025-09-24T09:46:44.000Z</published>
    <updated>2025-09-24T12:56:28.461Z</updated>
    
    <content type="html"><![CDATA[<p>è¿™æ¬¡çš„ä½œä¸šè¦æ±‚å®ç°ç”¨åŒ…å›´ç›’æ¥åŠ å¿«å…‰çº¿è¿½è¸ªï¼Œå†ç”¨ BVH ä¼˜åŒ–ã€‚</p><p>é¦–å…ˆæˆ‘ä»¬è¦æŠŠ hw5 é‡Œçš„ä»£ç å¤åˆ¶è¿‡æ¥ï¼Œè®©æˆ‘ä¸è§£çš„æ˜¯ä»£ç é‡Œæ˜æ˜å·²ç»æä¾›äº† <code>rayTriangleIntersect</code> å‡½æ•°ï¼ŒPDF é‡Œå´è¿˜è¯´â€œå°†ä½ çš„å…‰çº¿-ä¸‰è§’å½¢ç›¸äº¤å‡½æ•°ç²˜è´´åˆ°æ­¤å¤„â€ï¼Œæ˜æ˜ç›´æ¥è°ƒç”¨å®ƒå°±å¥½äº†ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">inline</span> Intersection <span class="token class-name">Triangle</span><span class="token double-colon punctuation">::</span><span class="token function">getIntersection</span><span class="token punctuation">(</span>Ray ray<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    Intersection inter<span class="token punctuation">;</span>    <span class="token keyword">float</span> u<span class="token punctuation">,</span> v<span class="token punctuation">,</span> t<span class="token punctuation">;</span>    inter<span class="token punctuation">.</span>happened <span class="token operator">=</span> <span class="token function">rayTriangleIntersect</span><span class="token punctuation">(</span>v0<span class="token punctuation">,</span> v1<span class="token punctuation">,</span> v2<span class="token punctuation">,</span> ray<span class="token punctuation">.</span>origin<span class="token punctuation">,</span> ray<span class="token punctuation">.</span>direction<span class="token punctuation">,</span> t<span class="token punctuation">,</span> u<span class="token punctuation">,</span> v<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>inter<span class="token punctuation">.</span>happened<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        inter<span class="token punctuation">.</span>coords <span class="token operator">=</span> ray<span class="token punctuation">.</span>origin <span class="token operator">+</span> t <span class="token operator">*</span> ray<span class="token punctuation">.</span>direction<span class="token punctuation">;</span>        inter<span class="token punctuation">.</span>normal <span class="token operator">=</span> normal<span class="token punctuation">;</span>        inter<span class="token punctuation">.</span>distance <span class="token operator">=</span> t<span class="token punctuation">;</span>        inter<span class="token punctuation">.</span>obj <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>        inter<span class="token punctuation">.</span>m <span class="token operator">=</span> m<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> inter<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åæˆ‘ä¹Ÿä¸å¤ªå–œæ¬¢ä»£ç æ¡†æ¶å¯¹ <code>IntersectP</code> çš„å®šä¹‰ï¼Œåœ¨æˆ‘çœ‹æ¥æ—¢ç„¶å¦å¤–ä¸¤ä¸ªå‚æ•°èƒ½é€šè¿‡ <code>ray</code> ç®—å‡ºæ¥ï¼Œå°±å®Œå…¨æ²¡æœ‰ç†ç”±ä½œä¸ºå‚æ•°ä¼ å…¥ã€‚</p><p>äºæ˜¯æˆ‘å°±æ”¹æˆäº†è¿™ä¸ªåªä¿ç•™ <code>ray</code> å‚æ•°çš„æ ·å­ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">inline</span> <span class="token keyword">bool</span> <span class="token class-name">Bounds3</span><span class="token double-colon punctuation">::</span><span class="token function">IntersectP</span><span class="token punctuation">(</span><span class="token keyword">const</span> Ray<span class="token operator">&amp;</span> ray<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">&#123;</span>    <span class="token comment">// invDir: ray direction(x,y,z), invDir=(1.0/x,1.0/y,1.0/z), use this because Multiply is faster that Division</span>    <span class="token keyword">auto</span> tMinVec <span class="token operator">=</span> <span class="token punctuation">(</span>pMin <span class="token operator">-</span> ray<span class="token punctuation">.</span>origin<span class="token punctuation">)</span> <span class="token operator">*</span> ray<span class="token punctuation">.</span>direction_inv<span class="token punctuation">;</span>    <span class="token keyword">auto</span> tMaxVec <span class="token operator">=</span> <span class="token punctuation">(</span>pMax <span class="token operator">-</span> ray<span class="token punctuation">.</span>origin<span class="token punctuation">)</span> <span class="token operator">*</span> ray<span class="token punctuation">.</span>direction_inv<span class="token punctuation">;</span>    <span class="token keyword">float</span> tMinx <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>std<span class="token double-colon punctuation">::</span><span class="token function">min</span><span class="token punctuation">(</span>tMinVec<span class="token punctuation">.</span>x<span class="token punctuation">,</span> tMaxVec<span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>ray<span class="token punctuation">.</span>t_min<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">float</span> tMiny <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>std<span class="token double-colon punctuation">::</span><span class="token function">min</span><span class="token punctuation">(</span>tMinVec<span class="token punctuation">.</span>y<span class="token punctuation">,</span> tMaxVec<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>ray<span class="token punctuation">.</span>t_min<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">float</span> tMinz <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>std<span class="token double-colon punctuation">::</span><span class="token function">min</span><span class="token punctuation">(</span>tMinVec<span class="token punctuation">.</span>z<span class="token punctuation">,</span> tMaxVec<span class="token punctuation">.</span>z<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>ray<span class="token punctuation">.</span>t_min<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">float</span> tMaxx <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>std<span class="token double-colon punctuation">::</span><span class="token function">max</span><span class="token punctuation">(</span>tMinVec<span class="token punctuation">.</span>x<span class="token punctuation">,</span> tMaxVec<span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>ray<span class="token punctuation">.</span>t_max<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">float</span> tMaxy <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>std<span class="token double-colon punctuation">::</span><span class="token function">max</span><span class="token punctuation">(</span>tMinVec<span class="token punctuation">.</span>y<span class="token punctuation">,</span> tMaxVec<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>ray<span class="token punctuation">.</span>t_max<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">float</span> tMaxz <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>std<span class="token double-colon punctuation">::</span><span class="token function">max</span><span class="token punctuation">(</span>tMinVec<span class="token punctuation">.</span>z<span class="token punctuation">,</span> tMaxVec<span class="token punctuation">.</span>z<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>ray<span class="token punctuation">.</span>t_max<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">float</span> tMin <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>tMinx<span class="token punctuation">,</span> tMiny<span class="token punctuation">,</span> tMinz<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">float</span> tMax <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>tMaxx<span class="token punctuation">,</span> tMaxy<span class="token punctuation">,</span> tMaxz<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>tMin <span class="token operator">&lt;=</span> tMax<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ€è·¯å°±æ˜¯è®¡ç®—è¿™ä¸ªäº¤é›†ï¼š</p><script type="math/tex; mode=display">[t_\text{raymin},t_\text{raymax}]\cap[t_{x, \text{enter}}, t_{x, \text{exit}}]\cap[t_{y, \text{enter}}, t_{y, \text{exit}}]\cap[t_{z, \text{enter}}, t_{z, \text{exit}}]</script><p>å¯¹äºæœ€åçš„ <code>getIntersection</code>ï¼Œå° AI è¯´å¯ä»¥åœ¨å‘ç”Ÿç›¸äº¤æ—¶æ›´æ–° <code>ray</code> çš„ <code>t_max</code>ï¼Œç„¶ååœ¨å°„çº¿å’Œç›’å­çš„äº¤ç‚¹å¤§äº <code>t_max</code> æ—¶ä¸å†æ£€æµ‹ç›’å­å†…éƒ¨çš„ç›¸äº¤ï¼Œè¿™å¯ä»¥ä¼˜åŒ–æ€§èƒ½ã€‚æˆ‘è®¤ä¸ºä»–è¯´å¾—éå¸¸æœ‰é“ç†ï¼Œä½†æ”¹èµ·æ¥æœ‰ç‚¹éº»çƒ¦ï¼Œå°±ä¸æ”¹äº†ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Intersection <span class="token class-name">BVHAccel</span><span class="token double-colon punctuation">::</span><span class="token function">getIntersection</span><span class="token punctuation">(</span>BVHBuildNode<span class="token operator">*</span> node<span class="token punctuation">,</span> <span class="token keyword">const</span> Ray<span class="token operator">&amp;</span> ray<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>node<span class="token operator">-></span>bounds<span class="token punctuation">.</span><span class="token function">IntersectP</span><span class="token punctuation">(</span>ray<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token function">Intersection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// leaf node checks ray's intersection with obj  </span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token operator">-></span>left <span class="token operator">==</span> <span class="token keyword">nullptr</span> <span class="token operator">&amp;&amp;</span> node<span class="token operator">-></span>right <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token operator">-></span>object <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token function">Intersection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> node<span class="token operator">-></span>object<span class="token operator">-></span><span class="token function">getIntersection</span><span class="token punctuation">(</span>ray<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>     <span class="token comment">// parent with only one child returns child's intersection</span>    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token operator">-></span>left <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token function">getIntersection</span><span class="token punctuation">(</span>node<span class="token operator">-></span>right<span class="token punctuation">,</span> ray<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token operator">-></span>right <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token function">getIntersection</span><span class="token punctuation">(</span>node<span class="token operator">-></span>left<span class="token punctuation">,</span> ray<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>     <span class="token comment">// parent with two children returns the closer intersection</span>    <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        Intersection inter1 <span class="token operator">=</span> <span class="token function">getIntersection</span><span class="token punctuation">(</span>node<span class="token operator">-></span>left<span class="token punctuation">,</span> ray<span class="token punctuation">)</span><span class="token punctuation">;</span>        Intersection inter2 <span class="token operator">=</span> <span class="token function">getIntersection</span><span class="token punctuation">(</span>node<span class="token operator">-></span>right<span class="token punctuation">,</span> ray<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>inter1<span class="token punctuation">.</span>happened <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>inter2<span class="token punctuation">.</span>happened<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token function">Intersection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>inter1<span class="token punctuation">.</span>happened<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> inter2<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>inter2<span class="token punctuation">.</span>happened<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> inter1<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span>inter1<span class="token punctuation">.</span>distance <span class="token operator">&lt;</span> inter2<span class="token punctuation">.</span>distance<span class="token punctuation">)</span> <span class="token operator">?</span> inter1 <span class="token operator">:</span> inter2<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å’±è¿˜æ˜¯åœ¨æœ€åæ”¾æ”¾å›¾å›¾</p><p><img src="/images/learning/open-course/GAMES101/Assignments/hw6/bvh.png" alt=""></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;è¿™æ¬¡çš„ä½œä¸šè¦æ±‚å®ç°ç”¨åŒ…å›´ç›’æ¥åŠ å¿«å…‰çº¿è¿½è¸ªï¼Œå†ç”¨ BVH ä¼˜åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆæˆ‘ä»¬è¦æŠŠ hw5 é‡Œçš„ä»£ç å¤åˆ¶è¿‡æ¥ï¼Œè®©æˆ‘ä¸è§£çš„æ˜¯ä»£ç é‡Œæ˜æ˜å·²ç»æä¾›äº† &lt;code&gt;rayTriangleIntersect&lt;/code&gt; å‡½æ•°ï¼ŒPDF é‡Œå´è¿˜è¯´â€œå°†ä½ çš„å…‰çº¿-ä¸‰è§’å½¢ç›¸äº¤å‡½æ•°ç²˜è´´</summary>
      
    
    
    
    <category term="å…¬å¼€è¯¾" scheme="http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/"/>
    
    <category term="GAMES101" scheme="http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/"/>
    
    <category term="Assignments" scheme="http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/Assignments/"/>
    
    
  </entry>
  
  <entry>
    <title>Assignment 5 Raytracing</title>
    <link href="http://rinevard.github.io/wiki/learning/open-course/GAMES101/Hw/Hw5-raytracing/"/>
    <id>http://rinevard.github.io/wiki/learning/open-course/GAMES101/Hw/Hw5-raytracing/</id>
    <published>2025-09-22T11:46:16.000Z</published>
    <updated>2025-09-26T04:09:50.574Z</updated>
    
    <content type="html"><![CDATA[<p>å¦‚æœåªæ˜¯å®ç°è¦æ±‚çš„è¯ï¼Œæ„Ÿè§‰è¿™ä¼šæ˜¯å¾ˆæ— èŠçš„ä¸€æ¬¡ä½œä¸šã€‚ä¸ºäº†è®©äº‹æƒ…æœ‰è¶£ä¸€ç‚¹ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ <code>castRay</code> å‡½æ•°çš„å®ç°å§ã€‚æˆ‘ä»¬ä¼šæŠŠä½œä¸šä»£ç æ”¾åœ¨æ–‡æœ«ã€‚</p><h1 id="castRay-å‡½æ•°çš„åˆ†æ"><a href="#castRay-å‡½æ•°çš„åˆ†æ" class="headerlink" title="castRay å‡½æ•°çš„åˆ†æ"></a>castRay å‡½æ•°çš„åˆ†æ</h1><p>castRay å‡½æ•°å®ç°äº†è¯¾ä¸Šè®²çš„å…‰çº¿è¿½è¸ªï¼Œå®ƒä» <code>orig</code> æ‰“å‡ºæœç€ <code>dir</code> æ–¹å‘çš„å°„çº¿ï¼Œå¹¶è¿”å›é¢œè‰²ã€‚å…¶å·¥ä½œæµç¨‹å¦‚ä¸‹ï¼š</p><ol><li><p>é¦–å…ˆï¼Œæ£€æŸ¥å½“å‰çš„é€’å½’æ·±åº¦<code>depth</code>ã€‚å½“<code>depth</code>è¶…è¿‡åœºæ™¯è®¾å®šçš„æœ€å¤§æ·±åº¦<code>scene.maxDepth</code>æ—¶ï¼Œå‡½æ•°è¿”å›é»‘è‰²ã€‚è¿™å°±æ˜¯å¼€å¤´çš„ä»£ç ï¼š</p> <pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">if</span> <span class="token punctuation">(</span>depth <span class="token operator">></span> scene<span class="token punctuation">.</span>maxDepth<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">Vector3f</span><span class="token punctuation">(</span><span class="token number">0.0</span><span class="token punctuation">,</span><span class="token number">0.0</span><span class="token punctuation">,</span><span class="token number">0.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li><li><p>ç„¶åï¼Œè®¡ç®—å°„çº¿æ˜¯å¦ä¸åœºæ™¯ä¸­çš„ä»»ä½•ç‰©ä½“ç›¸äº¤ã€‚å¦‚æœæ²¡æœ‰å‘ç”Ÿç›¸äº¤ï¼Œè¯´æ˜å°„çº¿å°„å‘äº†åœºæ™¯çš„èƒŒæ™¯ï¼Œå‡½æ•°å°†è¿”å›èƒŒæ™¯é¢œè‰²ã€‚</p></li><li><p>å¦‚æœå°„çº¿å‡»ä¸­äº†æŸä¸ªç‰©ä½“ï¼Œå‡½æ•°å°†æ ¹æ®è¯¥ç‰©ä½“çš„æè´¨ç±»å‹ï¼Œè¿›å…¥ä¸åŒçš„å¤„ç†åˆ†æ”¯è®¡ç®—é¢œè‰²ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬ä¼šåˆ†æè¿™äº›åˆ†æ”¯ã€‚</p></li></ol><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç‰©ä½“è¢«åˆ†ä¸ºäº†ä¸‰ç§æè´¨ï¼Œåˆ†åˆ«æ˜¯æ—¢æœ‰é•œé¢åå°„åˆæœ‰æŠ˜å°„çš„ <code>REFLECTION_AND_REFRACTION</code>ã€åªæœ‰åå°„çš„ <code>REFLECTION</code>ã€åªæœ‰æ¼«åå°„çš„ <code>DIFFUSE_AND_GLOSSY</code>ã€‚<code>REFLECTION_AND_REFRACTION</code> å’Œ <code>REFLECTION</code> éƒ¨åˆ†çš„ä»£ç æ¯”è¾ƒç›¸ä¼¼ï¼Œæˆ‘ä»¬å°±å…ˆè®¨è®º <code>REFLECTION_AND_REFRACTION</code> çš„ä»£ç ï¼Œå†è®¨è®º <code>DIFFUSE_AND_GLOSSY</code> çš„ä»£ç ã€‚</p><h2 id="REFLECTION-AND-REFRACTION"><a href="#REFLECTION-AND-REFRACTION" class="headerlink" title="REFLECTION_AND_REFRACTION"></a>REFLECTION_AND_REFRACTION</h2><p>è¿™é‡Œçš„åå°„/æŠ˜å°„æè´¨è‡ªèº«æ˜¯æ²¡æœ‰é¢œè‰²çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒä»¬åªæ˜¾ç¤ºåå°„/æŠ˜å°„åå°„çº¿æ‰“åˆ°çš„ç‚¹çš„é¢œè‰²ã€‚æ‰€ä»¥ä»£ç æ€è·¯æ¯”è¾ƒç®€å•ï¼Œå¦‚æœå°„çº¿æ‰“åˆ°äº†è¿™ç§æè´¨çš„ç‰©ä½“ä¸Šï¼Œå®ƒä¼šåå°„/æŠ˜å°„ï¼Œæˆ‘ä»¬éœ€è¦è®¡ç®—å‡ºåå°„/æŠ˜å°„åçš„å°„çº¿æ‰“åˆ°çš„é¢œè‰²ï¼Œè¿™å°±å¯¹åº”ç€ä¸‹é¢çš„ä»£ç ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Vector3f reflectionColor <span class="token operator">=</span> <span class="token function">castRay</span><span class="token punctuation">(</span>reflectionRayOrig<span class="token punctuation">,</span> reflectionDirection<span class="token punctuation">,</span> scene<span class="token punctuation">,</span> depth <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>Vector3f refractionColor <span class="token operator">=</span> <span class="token function">castRay</span><span class="token punctuation">(</span>refractionRayOrig<span class="token punctuation">,</span> refractionDirection<span class="token punctuation">,</span> scene<span class="token punctuation">,</span> depth <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ä»£ç é‡Œè¿˜è€ƒè™‘äº†è²æ¶…å°”æ•ˆåº”æ¥è®¡ç®—åå°„å’ŒæŠ˜å°„çš„æ¯”ä¾‹ã€‚è²æ¶…å°”æ•ˆåº”çš„å…¬å¼æœ‰ç‚¹å¤æ‚ï¼Œæˆ‘ä»¬å°±ä¸è®²è§£äº†ã€‚è¿™é‡Œçš„ <code>kr</code> å°±æ˜¯è²æ¶…å°”æ–¹ç¨‹ç®—å‡ºçš„åå°„ç³»æ•°ï¼Œè€Œç”±èƒ½é‡å®ˆæ’ï¼ŒæŠ˜å°„ç³»æ•°å°±æ˜¯ $1-\text{kr}$ã€‚</p><p><code>hitColor</code> å°±æ˜¯è¿™ä¸ªç‚¹çš„æœ€ç»ˆé¢œè‰²ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">float</span> kr <span class="token operator">=</span> <span class="token function">fresnel</span><span class="token punctuation">(</span>dir<span class="token punctuation">,</span> N<span class="token punctuation">,</span> payload<span class="token operator">-></span>hit_obj<span class="token operator">-></span>ior<span class="token punctuation">)</span><span class="token punctuation">;</span>hitColor <span class="token operator">=</span> reflectionColor <span class="token operator">*</span> kr <span class="token operator">+</span> refractionColor <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> kr<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æˆ‘ä»¬ä¹Ÿä¼šæ³¨æ„åˆ°ï¼Œä»£ç åœ¨å¼€å¤´å¯¹åå°„/æŠ˜å°„ç‚¹åšäº†ä¸€ä¸ªå°å°çš„åç§»ï¼Œè¿™ä¼¼ä¹æ˜¯ä¸ºäº†é¿å…åå°„/æŠ˜å°„æ—¶ç«‹å³æ‰“åˆ°è‡ªå·±ï¼ˆå’±ä¹Ÿä¸ç¡®å®šï¼Œè¿™æ˜¯çŒœæµ‹ï¼‰</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Vector3f reflectionRayOrig <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">dotProduct</span><span class="token punctuation">(</span>reflectionDirection<span class="token punctuation">,</span> N<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span>                              hitPoint <span class="token operator">-</span> N <span class="token operator">*</span> scene<span class="token punctuation">.</span>epsilon <span class="token operator">:</span>                              hitPoint <span class="token operator">+</span> N <span class="token operator">*</span> scene<span class="token punctuation">.</span>epsilon<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬éƒ½çœ‹åˆ°è²æ¶…å°”æ•ˆåº”çš„ä»£ç äº†ï¼Œä¸å¦‚å†çœ‹çœ‹çº¯åå°„/çº¯æŠ˜å°„çš„çƒæ˜¯æ€æ ·çš„ã€‚æ³¨æ„é è¿‘æˆ‘ä»¬è§‚å¯Ÿè€…çš„çƒï¼Œæˆ‘ä»¬å¯ä»¥å…ˆæŠŠ <code>kr</code> è®¾ä¸º 1 æ¥çœ‹çœ‹çº¯åå°„çš„ç»“æœï¼š</p><p><img src="/images/learning/open-course/GAMES101/Assignments/hw5/reflection_only.png" alt=""></p><p>å†æ¥çœ‹çœ‹çº¯æŠ˜å°„çš„ç»“æœï¼š</p><p><img src="/images/learning/open-course/GAMES101/Assignments/hw5/refraction_only.png" alt=""></p><p>ä¸æ–‡æœ«çš„å›¾æ¯”è¾ƒä¸€ä¸‹ï¼Œå°±ä¼šå‘ç°è²æ¶…å°”æ•ˆåº”ç¡®å®å°±æ˜¯åå°„å’ŒæŠ˜å°„çš„å åŠ ã€‚</p><h2 id="DIFFUSE-AND-GLOSSY"><a href="#DIFFUSE-AND-GLOSSY" class="headerlink" title="DIFFUSE_AND_GLOSSY"></a>DIFFUSE_AND_GLOSSY</h2><p>å†æ¥çœ‹çœ‹ <code>DIFFUSE_AND_GLOSSY</code> éƒ¨åˆ†ï¼Œè¿™é‡Œæ˜¯æ­£å¸¸çš„ Phong æ¨¡å‹ç€è‰²ã€‚å”¯ä¸€è¦æ³¨æ„çš„æ˜¯ï¼Œè¦åˆ¤æ–­å°„çº¿æ‰“åˆ°çš„ç‚¹å’Œå…‰æºä¹‹é—´æœ‰æ²¡æœ‰ç‰©ä½“é®æŒ¡ï¼Œå¦‚æœæœ‰é®æŒ¡è¿™é‡Œå°±æ˜¯é˜´å½±ã€‚</p><p>æˆ‘è®¤ä¸ºè¿™ä¸€éƒ¨åˆ†çš„ä»£ç æœ‰é—®é¢˜ï¼Œå®ƒåªè€ƒè™‘äº†æ¼«åå°„åˆ†é‡åœ¨ä¸åœ¨é˜´å½±é‡Œï¼Œè€Œæ²¡è€ƒè™‘é•œé¢åå°„åˆ†é‡ã€‚è¿™é‡Œæ˜¯åŸæœ¬çš„ä»£ç ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">// æ¼«åå°„</span>lightAmt <span class="token operator">+=</span> inShadow <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> light<span class="token operator">-></span>intensity <span class="token operator">*</span> LdotN<span class="token punctuation">;</span><span class="token comment">// é•œé¢åå°„</span>Vector3f reflectionDirection <span class="token operator">=</span> <span class="token function">reflect</span><span class="token punctuation">(</span><span class="token operator">-</span>lightDir<span class="token punctuation">,</span> N<span class="token punctuation">)</span><span class="token punctuation">;</span>specularColor <span class="token operator">+=</span> <span class="token function">powf</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token number">0.f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token function">dotProduct</span><span class="token punctuation">(</span>reflectionDirection<span class="token punctuation">,</span> dir<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    payload<span class="token operator">-></span>hit_obj<span class="token operator">-></span>specularExponent<span class="token punctuation">)</span> <span class="token operator">*</span> light<span class="token operator">-></span>intensity<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘æƒ³æˆ‘ä»¬åº”è¯¥åšè¿™æ ·çš„ä¿®æ”¹ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>inShadow<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">// æ¼«åå°„</span>    lightAmt <span class="token operator">+=</span> light<span class="token operator">-></span>intensity <span class="token operator">*</span> LdotN<span class="token punctuation">;</span>        <span class="token comment">// é•œé¢åå°„</span>    Vector3f reflectionDirection <span class="token operator">=</span> <span class="token function">reflect</span><span class="token punctuation">(</span><span class="token operator">-</span>lightDir<span class="token punctuation">,</span> N<span class="token punctuation">)</span><span class="token punctuation">;</span>    specularColor <span class="token operator">+=</span> <span class="token function">powf</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token number">0.f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token function">dotProduct</span><span class="token punctuation">(</span>reflectionDirection<span class="token punctuation">,</span> dir<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        payload<span class="token operator">-></span>hit_obj<span class="token operator">-></span>specularExponent<span class="token punctuation">)</span> <span class="token operator">*</span> light<span class="token operator">-></span>intensity<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="ä½œä¸šä»£ç "><a href="#ä½œä¸šä»£ç " class="headerlink" title="ä½œä¸šä»£ç "></a>ä½œä¸šä»£ç </h1><p>æ¥ä¸‹æ¥å’±å°±ç›´æ¥æ”¾ä½œä¸šä»£ç äº†ã€‚</p><p>é¦–å…ˆæ˜¯ <code>rayTriangleIntersect</code>ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">bool</span> <span class="token function">rayTriangleIntersect</span><span class="token punctuation">(</span><span class="token keyword">const</span> Vector3f<span class="token operator">&amp;</span> v0<span class="token punctuation">,</span> <span class="token keyword">const</span> Vector3f<span class="token operator">&amp;</span> v1<span class="token punctuation">,</span> <span class="token keyword">const</span> Vector3f<span class="token operator">&amp;</span> v2<span class="token punctuation">,</span> <span class="token keyword">const</span> Vector3f<span class="token operator">&amp;</span> orig<span class="token punctuation">,</span>                          <span class="token keyword">const</span> Vector3f<span class="token operator">&amp;</span> dir<span class="token punctuation">,</span> <span class="token keyword">float</span><span class="token operator">&amp;</span> tNear<span class="token punctuation">,</span> <span class="token keyword">float</span><span class="token operator">&amp;</span> u<span class="token punctuation">,</span> <span class="token keyword">float</span><span class="token operator">&amp;</span> v<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">auto</span> e1 <span class="token operator">=</span> v1 <span class="token operator">-</span> v0<span class="token punctuation">;</span>    <span class="token keyword">auto</span> e2 <span class="token operator">=</span> v2 <span class="token operator">-</span> v0<span class="token punctuation">;</span>    <span class="token keyword">auto</span> s <span class="token operator">=</span> orig <span class="token operator">-</span> v0<span class="token punctuation">;</span>    <span class="token keyword">auto</span> s1 <span class="token operator">=</span> <span class="token function">crossProduct</span><span class="token punctuation">(</span>dir<span class="token punctuation">,</span> e2<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">auto</span> s2 <span class="token operator">=</span> <span class="token function">crossProduct</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> e1<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">auto</span> coefficient <span class="token operator">=</span> <span class="token number">1.0</span> <span class="token operator">/</span> <span class="token function">dotProduct</span><span class="token punctuation">(</span>s1<span class="token punctuation">,</span> e1<span class="token punctuation">)</span><span class="token punctuation">;</span>    tNear <span class="token operator">=</span> coefficient <span class="token operator">*</span> <span class="token function">dotProduct</span><span class="token punctuation">(</span>s2<span class="token punctuation">,</span> e2<span class="token punctuation">)</span><span class="token punctuation">;</span>    u <span class="token operator">=</span> coefficient <span class="token operator">*</span> <span class="token function">dotProduct</span><span class="token punctuation">(</span>s1<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>    v <span class="token operator">=</span> coefficient <span class="token operator">*</span> <span class="token function">dotProduct</span><span class="token punctuation">(</span>s2<span class="token punctuation">,</span> dir<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>tNear <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>u <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>v <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> u <span class="token operator">-</span> v<span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åæ˜¯ <code>Render</code> çš„éƒ¨åˆ†ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> scene<span class="token punctuation">.</span>width<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">// generate primary ray direction</span>    <span class="token keyword">float</span> x<span class="token punctuation">;</span>    <span class="token keyword">float</span> y<span class="token punctuation">;</span>    <span class="token comment">// I don't understand what are the guiding comments talking about.</span>    <span class="token comment">// Anyway, the code is assuming the distance between eye and screen is one, since abs(dir.z) == 1</span>    <span class="token comment">// With this assumption we can compute screen's width and height</span>    <span class="token comment">// Then we map x from [0, scene.width - 1] to [-screen_width / 2, screenwidth / 2]</span>    <span class="token comment">// and map y from [0, scene.height - 1] to [screen_height / 2, -screen_height / 2]</span>    <span class="token keyword">float</span> screen_height <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> scale<span class="token punctuation">;</span>    <span class="token keyword">float</span> screen_width <span class="token operator">=</span> imageAspectRatio <span class="token operator">*</span> screen_height<span class="token punctuation">;</span>        x <span class="token operator">=</span> <span class="token punctuation">(</span>screen_width <span class="token operator">/</span> <span class="token punctuation">(</span>scene<span class="token punctuation">.</span>width <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">0.5</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span>screen_width <span class="token operator">/</span> <span class="token number">2.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    y <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">-</span>screen_height <span class="token operator">/</span> <span class="token punctuation">(</span>scene<span class="token punctuation">.</span>height <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> <span class="token number">0.5</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>screen_height <span class="token operator">/</span> <span class="token number">2.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Vector3f dir <span class="token operator">=</span> <span class="token function">normalize</span><span class="token punctuation">(</span><span class="token function">Vector3f</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Don't forget to normalize this direction!</span>    framebuffer<span class="token punctuation">[</span>m<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">castRay</span><span class="token punctuation">(</span>eye_pos<span class="token punctuation">,</span> dir<span class="token punctuation">,</span> scene<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>çœ‹çœ‹ç»“æœå§ï¼å¦‚æœå’Œå‰é¢çš„çº¯åå°„/çº¯æŠ˜å°„å¯¹ç…§ï¼Œä¼šå‘ç°å‰é¢çš„çƒç¡®å®å°±æ˜¯åå°„å’ŒæŠ˜å°„çš„å åŠ ï¼ˆåå°„å¾ˆæ·¡ï¼Œä¸è¿‡ä»”ç»†çœ‹ä¹Ÿæ˜¯èƒ½çœ‹å‡ºæ¥çš„ï¼ï¼‰</p><p><img src="/images/learning/open-course/GAMES101/Assignments/hw5/binary.png" alt=""></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;å¦‚æœåªæ˜¯å®ç°è¦æ±‚çš„è¯ï¼Œæ„Ÿè§‰è¿™ä¼šæ˜¯å¾ˆæ— èŠçš„ä¸€æ¬¡ä½œä¸šã€‚ä¸ºäº†è®©äº‹æƒ…æœ‰è¶£ä¸€ç‚¹ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ &lt;code&gt;castRay&lt;/code&gt; å‡½æ•°çš„å®ç°å§ã€‚æˆ‘ä»¬ä¼šæŠŠä½œä¸šä»£ç æ”¾åœ¨æ–‡æœ«ã€‚&lt;/p&gt;
&lt;h1 id=&quot;castRay-å‡½æ•°çš„åˆ†æ&quot;&gt;&lt;a href=&quot;#castRay-å‡½æ•°çš„åˆ†æ&quot; cl</summary>
      
    
    
    
    <category term="å…¬å¼€è¯¾" scheme="http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/"/>
    
    <category term="GAMES101" scheme="http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/"/>
    
    <category term="Assignments" scheme="http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/Assignments/"/>
    
    
  </entry>
  
  <entry>
    <title>Assignment 4 Geometry</title>
    <link href="http://rinevard.github.io/wiki/learning/open-course/GAMES101/Hw/Hw4-geometry/"/>
    <id>http://rinevard.github.io/wiki/learning/open-course/GAMES101/Hw/Hw4-geometry/</id>
    <published>2025-09-22T11:44:16.000Z</published>
    <updated>2025-09-22T11:44:41.718Z</updated>
    
    <content type="html"><![CDATA[<p>è¿™æ¬¡ä½œä¸šè¿‡äºç®€å•ï¼Œæˆ‘ä»¬ç›´æ¥æ”¾ä»£ç ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">cv<span class="token double-colon punctuation">::</span>Point2f <span class="token function">recursive_bezier</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>cv<span class="token double-colon punctuation">::</span>Point2f<span class="token operator">></span> <span class="token operator">&amp;</span>control_points<span class="token punctuation">,</span> <span class="token keyword">float</span> t<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">// TODO: Implement de Casteljau's algorithm</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>control_points<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> t<span class="token punctuation">)</span> <span class="token operator">*</span> control_points<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> t <span class="token operator">*</span> control_points<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>cv<span class="token double-colon punctuation">::</span>Point2f<span class="token operator">></span> new_control_points <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> control_points<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        new_control_points<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> t<span class="token punctuation">)</span> <span class="token operator">*</span> control_points<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> t <span class="token operator">*</span> control_points<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token function">recursive_bezier</span><span class="token punctuation">(</span>new_control_points<span class="token punctuation">,</span> t<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">bezier</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>cv<span class="token double-colon punctuation">::</span>Point2f<span class="token operator">></span> <span class="token operator">&amp;</span>control_points<span class="token punctuation">,</span> cv<span class="token double-colon punctuation">::</span>Mat <span class="token operator">&amp;</span>window<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">// TODO: Iterate through all t = 0 to t = 1 with small steps, and call de Casteljau's </span>    <span class="token comment">// recursive Bezier algorithm.</span>    <span class="token keyword">float</span> step <span class="token operator">=</span> <span class="token number">0.001</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">float</span> t <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> t <span class="token operator">&lt;=</span> <span class="token number">1</span><span class="token punctuation">;</span> t <span class="token operator">+=</span> step <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">auto</span> point <span class="token operator">=</span> <span class="token function">recursive_bezier</span><span class="token punctuation">(</span>control_points<span class="token punctuation">,</span> t<span class="token punctuation">)</span><span class="token punctuation">;</span>        window<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">at</span><span class="token generic class-name"><span class="token operator">&lt;</span>cv<span class="token double-colon punctuation">::</span>Vec3b<span class="token operator">></span></span></span><span class="token punctuation">(</span>point<span class="token punctuation">.</span>y<span class="token punctuation">,</span> point<span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">255</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦å¤–ï¼Œç”±äºå’±ä»¥å‰åœ¨ Godot é‡Œå¯¼å…¥å­—ä½“æ—¶è§è¿‡å¤šé€šé“ç¬¦å·è·ç¦»åœºçš„è®¾ç½®ï¼Œè€Œä¸”å‘ç°å¼€å¯å¤šé€šé“ç¬¦å·è·ç¦»åœºçš„å­—ä½“æ˜¾ç¤ºæ¸…æ™°äº†ä¸€å¤§æˆªï¼Œæ‰€ä»¥æˆ‘æ‰¾äº†æ‰¾ä¸€äº›å…³äº SDF çš„èµ„æ–™ï¼Œæ„Ÿè§‰è¿™ä¸ªä¸é”™ï¼š<a href="https://www.xianlongok.site/post/4625ed6a/#SDF-font">åŠ¨æ€ SDF å­—ä½“æ¸²æŸ“æ–¹æ³• | åä¸‰</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;è¿™æ¬¡ä½œä¸šè¿‡äºç®€å•ï¼Œæˆ‘ä»¬ç›´æ¥æ”¾ä»£ç ã€‚&lt;/p&gt;
&lt;pre class=&quot;line-numbers language-cpp&quot; data-language=&quot;cpp&quot;&gt;&lt;code class=&quot;language-cpp&quot;&gt;cv&lt;span class=&quot;token double-c</summary>
      
    
    
    
    <category term="å…¬å¼€è¯¾" scheme="http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/"/>
    
    <category term="GAMES101" scheme="http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/"/>
    
    <category term="Assignments" scheme="http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/Assignments/"/>
    
    
  </entry>
  
  <entry>
    <title>Note 4 Geometry</title>
    <link href="http://rinevard.github.io/wiki/learning/open-course/GAMES101/Notes/Note4-Geometry/"/>
    <id>http://rinevard.github.io/wiki/learning/open-course/GAMES101/Notes/Note4-Geometry/</id>
    <published>2025-09-19T12:10:28.000Z</published>
    <updated>2025-09-19T12:13:54.595Z</updated>
    
    <content type="html"><![CDATA[<p>è¯¾ä¸Šåªæ˜¯ç®€å•æäº†ä¸‹å‡ ä½•ä¸“é¢˜ï¼Œæˆ‘ä¹Ÿè®¤ä¸ºè¿™ä¸ªä¸“é¢˜ç›¸è¾ƒäºåˆ«çš„å‡ ä¸ªæ²¡é‚£ä¹ˆé‡è¦ï¼Œæ‰€ä»¥åªæ˜¯è®°ä¸€ä¸‹éšå¼è¡¨ç¤ºå’Œå‚æ•°è¡¨ç¤ºçš„ç›¸å…³å†…å®¹ï¼Œå†ç®€å•æä¸€å¥ç½‘æ ¼å¤„ç†ã€‚</p><h1 id="éšå¼è¡¨ç¤ºå’Œå‚æ•°è¡¨ç¤º"><a href="#éšå¼è¡¨ç¤ºå’Œå‚æ•°è¡¨ç¤º" class="headerlink" title="éšå¼è¡¨ç¤ºå’Œå‚æ•°è¡¨ç¤º"></a>éšå¼è¡¨ç¤ºå’Œå‚æ•°è¡¨ç¤º</h1><p>å¯¹ä¸€ä¸ªå‡ ä½•å›¾å½¢ï¼Œæˆ‘ä»¬ä¸€èˆ¬æœ‰ä¸¤ç§è¡¨ç¤ºæ–¹æ³•ï¼Œä¸€ç§æ˜¯ç”¨æ™®é€šæ–¹ç¨‹ $f(x,y,z)=0$ æ¥è¡¨ç¤ºï¼Œå¦ä¸€ç§æ˜¯ç”¨å‚æ•°æ–¹ç¨‹ $g(u,v)=(x,y,z)$ æ¥è¡¨ç¤ºã€‚å‰è€…æ˜¯éšå¼è¡¨ç¤ºï¼Œå› ä¸ºä¸èƒ½æ–¹ä¾¿åœ°æ±‚å‡ºè¿™ä¸ªæ–¹ç¨‹è¡¨ç¤ºçš„æ‰€æœ‰ç‚¹ï¼›åè€…æ˜¯å‚æ•°è¡¨ç¤ºï¼Œé€šè¿‡å‚æ•° $(u,v)$ çš„å˜åŒ–å¯ä»¥è½»æ˜“æ±‚å‡ºè¿™ä¸ªæ–¹ç¨‹è¡¨ç¤ºçš„æ‰€æœ‰ç‚¹ã€‚</p><p>ä¸è¿‡éšå¼è¡¨ç¤ºä¹Ÿæœ‰ä¼˜ç‚¹ï¼Œå®ƒèƒ½å¾ˆæ–¹ä¾¿åœ°åˆ¤æ–­ä¸€ä¸ªç‚¹ $(x,y,z)$ æ˜¯å¦åœ¨æ›²çº¿ä¸Š / æ›²çº¿å†… / æ›²çº¿å¤–ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹éšå¼è¡¨ç¤ºå’Œå‚æ•°è¡¨ç¤ºçš„ä»£è¡¨åº”ç”¨ã€‚</p><h2 id="éšå¼è¡¨ç¤ºï¼šç¬¦å·è·ç¦»åœº"><a href="#éšå¼è¡¨ç¤ºï¼šç¬¦å·è·ç¦»åœº" class="headerlink" title="éšå¼è¡¨ç¤ºï¼šç¬¦å·è·ç¦»åœº"></a>éšå¼è¡¨ç¤ºï¼šç¬¦å·è·ç¦»åœº</h2><p>ç¬¦å·è·ç¦»åœºï¼ˆSigned Distance Filed, SDFï¼‰æ˜¯éšå¼è¡¨ç¤ºçš„ä»£è¡¨åº”ç”¨ä¹‹ä¸€ï¼Œè‡ª 2007 å¹´ Valve çš„è®ºæ–‡ä»¥æ¥ï¼Œå®ƒä¸€ç›´è¢«ç”¨äºæ¸¸æˆå†…çš„æ–‡æœ¬æ¸²æŸ“ã€‚è™½ç„¶ç°åœ¨ç”¨çš„æ›´å¤šæ˜¯å¤šé€šé“ç¬¦å·è·ç¦»åœºï¼ˆMSDFï¼‰ï¼Œä½†æˆ‘ä»¬è¿™é‡Œåªç®€å•ä»‹ç»ä¸‹ç¬¦å·è·ç¦»åœºï¼Œå› ä¸ºåè€…æ›´åŠ å¤æ‚ã€‚</p><p>ç¬¦å·è·ç¦»åœºå°±æ˜¯å¸¦ç¬¦å·çš„è·ç¦»åœºï¼Œå¯¹ç»™å®šçš„ç‚¹ $(u,v)$ï¼Œæˆ‘ä»¬è®°å½•å®ƒåˆ°å›¾å½¢çš„æœ€è¿‘è·ç¦»â€”â€”å¦‚æœå®ƒåœ¨å›¾å½¢å†…éƒ¨ï¼ˆå›¾å½¢çš„çº¿æ¡æ˜¯æœ‰å®½åº¦çš„ï¼Œè¿™ä¸ªå†…éƒ¨æŒ‡åœ¨çº¿æ¡å†…è€Œéå‡ ä½•é—­ç¯å†…ï¼‰ï¼Œè·ç¦»ä¸ºæ­£å€¼ï¼Œå¦åˆ™ä¸ºè´Ÿå€¼ã€‚</p><p>åœ¨ V ç¤¾çš„è®ºæ–‡ä¸­ï¼Œä»–ä»¬å…ˆå¯¹çŸ¢é‡æ–‡å­—åšäº†å…‰æ …åŒ–å¾—åˆ°äº† $4096\times 4096$ çš„å›¾åƒï¼Œç„¶ååŸºäºè¿™å¼ å›¾å¾—åˆ°äº† $64\times 64$ çš„ç¬¦å·è·ç¦»åœºã€‚</p><p>ä¸‹å›¾å±•ç¤ºäº†åŸå›¾å’Œç¬¦å·è·ç¦»åœºã€‚å›¾åƒä¸é€æ˜åº¦æ˜¯åœ¨ $[0,1]$ é—´çš„éè´Ÿæ•°ï¼Œä¸ºäº†å¯è§†åŒ–ç¬¦å·è·ç¦»åœºï¼Œæˆ‘ä»¬æŠŠè·ç¦»ä¸ºæ­£çš„å†…éƒ¨æ˜ å°„åˆ° $(0.5, 1]$ï¼Œè·ç¦»ä¸º $0$ çš„è¾¹ç¼˜è¢«æ˜ å°„åˆ° $0.5$ï¼Œè·ç¦»ä¸ºè´Ÿçš„å¤–éƒ¨æ˜ å°„åˆ° $[0, 0.5)$.</p><p><img src="/images/learning/open-course/GAMES101/Notes/note4/sdf.png" alt=""></p><p>å¾—åˆ°äº†ç¬¦å·è·ç¦»åœºä¹‹åï¼Œæˆ‘ä»¬å°±èƒ½å¯¹ä»»ä½•ä¸€ä¸ªç‚¹æ’å€¼å‡ºå®ƒä¸å›¾å½¢çš„è·ç¦»ï¼Œç„¶åæ ¹æ®è¿™ä¸ªè·ç¦»å†³å®šå®ƒæ˜¯å¦æ˜¾ç¤ºå‡ºæ¥ã€‚æˆ‘ä»¬ä¹‹å‰å·²ç»æè¿‡äº†è·ç¦»åˆ°ä¸é€æ˜åº¦çš„æ˜ å°„ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•è®¾ç½®ä¸€ä¸ªé˜ˆå€¼æ¥å†³å®šæ˜¯å¦æ˜¾ç¤ºæŸä¸ªåƒç´ ï¼š</p><pre class="line-numbers language-glsl" data-language="glsl"><code class="language-glsl">baseColor<span class="token punctuation">.</span>a <span class="token operator">=</span> distAlphaMask <span class="token operator">>=</span> <span class="token number">0.5</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æˆ‘ä¸ªäººçš„æ€è€ƒæ˜¯ï¼Œä¸è¦å› ä¸ºæˆ‘ä»¬å¯è§†åŒ–äº†ç¬¦å·è·ç¦»åœºå°±æŠŠå®ƒå½“ä½œå›¾åƒã€‚å®ƒæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªè·ç¦»å‡½æ•° $d(u,v)$ï¼Œæˆ‘ä»¬çš„ $64\times 64$ çš„ SDF å›¾åƒçš„æ¯ä¸ªåƒç´ è¡¨ç¤ºçš„ä¸æ˜¯â€œå¹³å‡é¢œè‰²â€ï¼Œè€Œæ˜¯â€œåƒç´ ä¸­å¿ƒç‚¹åˆ°å›¾å½¢çš„è·ç¦»â€ã€‚è¦æŠŠå®ƒçœ‹ä½œç‚¹ï¼Œè€Œéæ–¹å—ã€‚</p><h2 id="å‚æ•°è¡¨ç¤ºï¼šè´å¡å°”æ›²çº¿å’Œæ›²é¢"><a href="#å‚æ•°è¡¨ç¤ºï¼šè´å¡å°”æ›²çº¿å’Œæ›²é¢" class="headerlink" title="å‚æ•°è¡¨ç¤ºï¼šè´å¡å°”æ›²çº¿å’Œæ›²é¢"></a>å‚æ•°è¡¨ç¤ºï¼šè´å¡å°”æ›²çº¿å’Œæ›²é¢</h2><p>è´å¡å°”æ›²çº¿å’Œæ›²é¢æ˜¯å‚æ•°è¡¨ç¤ºçš„å¾ˆå¥½ä¾‹å­ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹è®¡ç®—è´å¡å°”æ›²çº¿çš„å¸¸ç”¨ç®—æ³•å’Œä¸€èˆ¬å…¬å¼ã€‚</p><h3 id="è´å¡å°”æ›²çº¿"><a href="#è´å¡å°”æ›²çº¿" class="headerlink" title="è´å¡å°”æ›²çº¿"></a>è´å¡å°”æ›²çº¿</h3><p>å¸¸ç”¨çš„ç”Ÿæˆè´å¡å°”æ›²çº¿çš„ Casteljau Algorithm å¦‚ä¸‹ï¼Œæˆ‘ä»¬ä»¥å››ä¸ªç‚¹æ±‚ä¸‰é˜¶è´å¡å°”æ›²çº¿ä¸ºä¾‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">bezier</span><span class="token punctuation">(</span>t<span class="token punctuation">:</span> <span class="token builtin">float</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># ç¬¬ä¸€å±‚çº¿æ€§æ’å€¼</span>    p0_1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> t<span class="token punctuation">)</span> <span class="token operator">*</span> p0 <span class="token operator">+</span> t <span class="token operator">*</span> p1    p1_1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> t<span class="token punctuation">)</span> <span class="token operator">*</span> p1 <span class="token operator">+</span> t <span class="token operator">*</span> p2    p2_1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> t<span class="token punctuation">)</span> <span class="token operator">*</span> p2 <span class="token operator">+</span> t <span class="token operator">*</span> p3    <span class="token comment"># ç¬¬äºŒå±‚çº¿æ€§æ’å€¼</span>    p0_2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> t<span class="token punctuation">)</span> <span class="token operator">*</span> p0_1 <span class="token operator">+</span> t <span class="token operator">*</span> p1_1    p1_2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> t<span class="token punctuation">)</span> <span class="token operator">*</span> p1_1 <span class="token operator">+</span> t <span class="token operator">*</span> p2_1    <span class="token comment"># ç¬¬ä¸‰å±‚ï¼ˆæœ€åä¸€å±‚ï¼‰çº¿æ€§æ’å€¼</span>    p_final <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> t<span class="token punctuation">)</span> <span class="token operator">*</span> p0_2 <span class="token operator">+</span> t <span class="token operator">*</span> p1_2    <span class="token keyword">return</span> p_final<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>çœ‹çœ‹è¿™ä¸ªç®—æ³•ä¹Ÿå°±çŸ¥é“è´å¡å°”æ›²çº¿æ˜¯æ€ä¹ˆæ¥çš„äº†ã€‚</p><p>ä¸‰é˜¶å…¬å¼æ˜¯</p><script type="math/tex; mode=display">\mathbf{B}(t) = (1-t)^3 \mathbf{P}_0 + 3(1-t)^2 t \mathbf{P}_1 + 3(1-t) t^2 \mathbf{P}_2 + t^3 \mathbf{P}_3</script><p>ä¸€èˆ¬çš„ $n$ é˜¶å…¬å¼æ˜¯</p><script type="math/tex; mode=display">\mathbf{B}(t) = \sum_{i=0}^{m} \binom{m}{i} (1-t)^{m-i} t^i \mathbf{P}_i</script><p>ä¸‹å›¾ä¸­ï¼Œå·¦å›¾æ˜¯ Godot é‡Œçš„ Curveï¼Œå®ƒå°±ç”¨åˆ°äº†è´å¡å°”æ›²çº¿ï¼›å³å›¾è´å¡å°”æ›²çº¿çš„ç”Ÿæˆæ–¹æ³•ï¼Œå’Œä¸Šé¢æåˆ°çš„ Casteljau Algorithm ä¸€è‡´ã€‚</p><p><img src="/images/learning/open-course/GAMES101/Notes/note4/bezier.png" alt=""></p><p>å†çœ‹çœ‹å·¦å›¾ï¼Œæˆ‘ä»¬ä¼šå‘ç°å®ƒæ˜¯ç”±ä¸‰ä¸ªè´å¡å°”æ›²çº¿æ‹¼æ¥è€Œæˆçš„ï¼Œè€Œä¸”çœ‹èµ·æ¥å¾ˆå¹³æ»‘ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„â€œåˆ†æ®µè´å¡å°”æ›²çº¿â€ã€‚é«˜é˜¶è´å¡å°”æ›²çº¿ä¸å®¹æ˜“æ§åˆ¶ï¼Œæ‰€ä»¥æˆ‘ä»¬æ›´å€¾å‘äºæŠŠå‡ ä¸ªä½é˜¶è´å¡å°”æ›²çº¿æ‹¼æ¥èµ·æ¥å½¢æˆå¤æ‚æ›²çº¿ã€‚</p><h3 id="è´å¡å°”æ›²é¢"><a href="#è´å¡å°”æ›²é¢" class="headerlink" title="è´å¡å°”æ›²é¢"></a>è´å¡å°”æ›²é¢</h3><p>æˆ‘ä»¬åŒæ ·ç”¨ Casteljau Algorithm ç”Ÿæˆè´å¡å°”æ›²é¢ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">_de_casteljau_1d</span><span class="token punctuation">(</span>points<span class="token punctuation">,</span> t<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""å¯¹ä¸€ç»´ç‚¹åºåˆ—æ‰§è¡Œ Casteljau ç®—æ³•ã€‚"""</span>    <span class="token keyword">while</span> <span class="token builtin">len</span><span class="token punctuation">(</span>points<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">:</span>        points <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> t<span class="token punctuation">)</span> <span class="token operator">*</span> p1 <span class="token operator">+</span> t <span class="token operator">*</span> p2 <span class="token keyword">for</span> p1<span class="token punctuation">,</span> p2 <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>points<span class="token punctuation">,</span> points<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>    <span class="token keyword">return</span> points<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">bezier_surface</span><span class="token punctuation">(</span>control_points<span class="token punctuation">,</span> u<span class="token punctuation">,</span> v<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""è®¡ç®—è´å¡å°”æ›²é¢ä¸Šçš„ä¸€ç‚¹ã€‚"""</span>    intermediate_points <span class="token operator">=</span> <span class="token punctuation">[</span>_de_casteljau_1d<span class="token punctuation">(</span>row<span class="token punctuation">,</span> u<span class="token punctuation">)</span> <span class="token keyword">for</span> row <span class="token keyword">in</span> control_points<span class="token punctuation">]</span>    final_point <span class="token operator">=</span> _de_casteljau_1d<span class="token punctuation">(</span>intermediate_points<span class="token punctuation">,</span> v<span class="token punctuation">)</span>    <span class="token keyword">return</span> final_point<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚ä¸‹å›¾ä¸­çš„å³å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬æœ¬è´¨ä¸Šæ˜¯å…ˆæ²¿ç€ä¸€ä¸ªè½´å‘ç”Ÿæˆä¸€ç»„è´å¡å°”æ›²çº¿ï¼Œå†åœ¨æ›²çº¿ä¸Šå–å€¼ç”Ÿæˆä¸€ç»„æ–°çš„æ§åˆ¶ç‚¹ï¼Œç„¶åç”¨è¿™ç»„æ–°æ§åˆ¶ç‚¹å®šä¹‰ä¸€æ¡æ–°çš„æ›²çº¿ï¼Œæœ€ååœ¨æ–°çš„æ›²çº¿ä¸Šå–å€¼å¾—åˆ°æ›²é¢ä¸Šçš„æœ€ç»ˆç‚¹ã€‚</p><p><img src="/images/learning/open-course/GAMES101/Notes/note4/bezier_surface.png" alt=""></p><h1 id="ç½‘æ ¼å¤„ç†"><a href="#ç½‘æ ¼å¤„ç†" class="headerlink" title="ç½‘æ ¼å¤„ç†"></a>ç½‘æ ¼å¤„ç†</h1><p>ç”Ÿæˆä¸‰è§’å½¢ç½‘æ ¼åï¼Œæˆ‘ä»¬ç»å¸¸è¿˜å¸Œæœ›åšä¸€äº›å¤„ç†ï¼Œæ¯”å¦‚ç»†åˆ†æ¥è®©æ¨¡å‹æ›´å…‰æ»‘ï¼›å‡å°‘ä¸‰è§’å½¢æ•°é‡æ¥ç®€åŒ–ç½‘æ ¼ã€‚ä¸‹é¢ç®€å•æä¸€ä¸‹ç½‘æ ¼ç»†åˆ†å’Œç½‘æ ¼ç®€åŒ–çš„å¸¸ç”¨ç®—æ³•ã€‚</p><p><img src="/images/learning/open-course/GAMES101/Notes/note4/mesh_operation.png" alt=""></p><h2 id="ç½‘æ ¼ç»†åˆ†"><a href="#ç½‘æ ¼ç»†åˆ†" class="headerlink" title="ç½‘æ ¼ç»†åˆ†"></a>ç½‘æ ¼ç»†åˆ†</h2><p>ç½‘æ ¼ç»†åˆ†ç®—æ³•çš„ç»å¯¹ä¸»æµæ˜¯ Catmull-Clark ç»†åˆ†ï¼ŒBlender çš„è¡¨é¢ç»†åˆ†ä¿®æ”¹å™¨çš„é»˜è®¤ç®—æ³•å°±æ˜¯è¿™ä¸ªã€‚å®ƒå¯ä»¥ç»†åˆ†ä»»æ„å½¢çŠ¶çš„å¤šè¾¹å½¢ï¼Œä½†åœ¨ç»†åˆ†å››è¾¹å½¢æ—¶æ•ˆæœæœ€å¥½ã€‚</p><p>è¯¾ä¸Šè¿˜æåˆ°äº†ç”¨äºç»†åˆ†ä¸‰è§’å½¢çš„ Loop ç»†åˆ†ï¼Œä¸è¿‡ä¸¤ä¸ªç»†åˆ†éƒ½åªæ˜¯ç®€å•æäº†ææ¦‚å¿µï¼Œæˆ‘ä»¬è¿™é‡Œä¸å¤šè®°ç¬”è®°ã€‚</p><h2 id="ç½‘æ ¼ç®€åŒ–"><a href="#ç½‘æ ¼ç®€åŒ–" class="headerlink" title="ç½‘æ ¼ç®€åŒ–"></a>ç½‘æ ¼ç®€åŒ–</h2><p>ç½‘æ ¼ç®€åŒ–çš„åŸºæœ¬æ€è·¯æ˜¯æ¯æ¬¡æŠŠä¸€æ¡è¾¹åç¼©æˆä¸€ä¸ªç‚¹ã€‚æˆ‘ä»¬ç”¨äºŒæ¬¡è¯¯å·®è¡¡é‡æ¯æ¡è¾¹åç¼©åå¼•å…¥çš„è¯¯å·®ï¼Œç„¶åé€‰æ‹©æœ€å°çš„è¾¹æ¥åç¼©ï¼Œä¹‹åé‡æ–°è®¡ç®—äºŒæ¬¡è¯¯å·®ï¼ˆå› ä¸ºåç¼©åå½¢çŠ¶ä¼šæ”¹å˜ï¼‰ï¼Œç„¶åå†æ¬¡é€‰æ‹©æœ€å°çš„è¾¹ï¼Œå¦‚æ­¤é‡å¤ã€‚è¿™æ˜¯ä¸ªè´ªå©ªç®—æ³•ï¼Œä½†èƒ½æ‹¿åˆ°ä¸é”™çš„ç»“æœã€‚</p><p>å…·ä½“å…¬å¼æˆ‘ä»¬ä¹Ÿä¸å†™ï¼Œå› ä¸ºè¯¾ä¸Šæ²¡è¯¦ç»†è®²ï¼Œæˆ‘ä¹Ÿä¸æ„Ÿå…´è¶£ï¼Œç”¨åˆ°çš„æ—¶å€™å»æŸ¥æŸ¥å°±å¥½äº†ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;è¯¾ä¸Šåªæ˜¯ç®€å•æäº†ä¸‹å‡ ä½•ä¸“é¢˜ï¼Œæˆ‘ä¹Ÿè®¤ä¸ºè¿™ä¸ªä¸“é¢˜ç›¸è¾ƒäºåˆ«çš„å‡ ä¸ªæ²¡é‚£ä¹ˆé‡è¦ï¼Œæ‰€ä»¥åªæ˜¯è®°ä¸€ä¸‹éšå¼è¡¨ç¤ºå’Œå‚æ•°è¡¨ç¤ºçš„ç›¸å…³å†…å®¹ï¼Œå†ç®€å•æä¸€å¥ç½‘æ ¼å¤„ç†ã€‚&lt;/p&gt;
&lt;h1 id=&quot;éšå¼è¡¨ç¤ºå’Œå‚æ•°è¡¨ç¤º&quot;&gt;&lt;a href=&quot;#éšå¼è¡¨ç¤ºå’Œå‚æ•°è¡¨ç¤º&quot; class=&quot;headerlink&quot; title</summary>
      
    
    
    
    <category term="å…¬å¼€è¯¾" scheme="http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/"/>
    
    <category term="GAMES101" scheme="http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/"/>
    
    <category term="Notes" scheme="http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/Notes/"/>
    
    
  </entry>
  
  <entry>
    <title>Note 3 Shading</title>
    <link href="http://rinevard.github.io/wiki/learning/open-course/GAMES101/Notes/Note3-Shading/"/>
    <id>http://rinevard.github.io/wiki/learning/open-course/GAMES101/Notes/Note3-Shading/</id>
    <published>2025-09-17T04:10:28.000Z</published>
    <updated>2025-09-17T04:03:13.842Z</updated>
    
    <content type="html"><![CDATA[<h1 id="×™Ö°×”Ö´×™-××•Ö¹×¨"><a href="#×™Ö°×”Ö´×™-××•Ö¹×¨" class="headerlink" title="×™Ö°×”Ö´×™ ××•Ö¹×¨"></a>×™Ö°×”Ö´×™ ××•Ö¹×¨</h1><p>èµ·åˆï¼Œè®¡ç®—æœºçš„ä¸–ç•Œå°šæœªæ¸²æŸ“ï¼Œæ˜¾ç¤ºå™¨ä¸­ç©ºè™šæ··æ²Œï¼Œæ¸Šé¢é»‘æš—ã€‚</p><p>å”¯æœ‰é¡¶ç‚¹ä¸å¤šè¾¹å½¢æ‚¬äºè™šç©ºï¼Œä¸è§å…¶å½¢ï¼Œä¸è¾¨å…¶è‰²ã€‚</p><p>é‚£å£°éŸ³è¯´ï¼š<strong>â€œè¦æœ‰å…‰ã€‚â€</strong></p><p>å°±æœ‰äº†å…‰ã€‚</p><p>å…‰æ˜¯å¥½çš„ï¼Œäºæ˜¯é‚£å£°éŸ³å°†å…‰ä¸æš—åˆ†å¼€äº†ã€‚å…‰æ‰€ç…§ä¹‹å¤„ï¼Œç‰©ä½“çš„æ­£é¢å¾—ä»¥æ˜¾ç°ï¼›å…‰æ‰€ä¸è‡³çš„èƒŒé¢ï¼Œåˆ™å½’äºé˜´å½±ã€‚ä»æ­¤ï¼Œä¸‰ç»´çš„ä¸–ç•Œæœ‰äº†æ˜æš—ä¸å±‚æ¬¡ã€‚</p><p>è¿™å…‰å¹¶éä¸€ä½“ã€‚</p><p>é‚£æ™®ç…§ä¸‡ç‰©ï¼Œå‡åŒ€æ•£å¼€ï¼Œä½¿ç‰©ä½“æ˜¾å…¶æœ¬è‰²çš„ï¼Œç§°ä¹‹ä¸º<strong>æ¼«åå°„</strong>ã€‚</p><p>é‚£æ±‡äºä¸€ç‚¹ï¼Œé”åˆ©å¤ºç›®ï¼Œä½¿å…‰æ»‘ä¹‹ç‰©å°½æ˜¾å…¶è€€çš„ï¼Œç§°ä¹‹ä¸º<strong>é•œé¢åå°„</strong>ã€‚</p><p>é‚£å¼¥æ¼«äºç¯å¢ƒï¼Œå……ç›ˆäºé˜´å½±ï¼Œä½¿é»‘æš—ä¸è‡³å®Œå…¨åå™¬ä¸€åˆ‡çš„ï¼Œç§°ä¹‹ä¸º<strong>ç¯å¢ƒå…‰</strong>ã€‚</p><p>æœ‰æ¼«åå°„ï¼Œæœ‰é•œé¢åå°„ï¼Œæœ‰ç¯å¢ƒå…‰ï¼Œå…±åŒæ„æˆäº†è¿™è™šæ‹Ÿä¸–ç•Œçš„ç¬¬ä¸€ä¸ªç™½æ˜¼ã€‚</p><h2 id="æ¼«åå°„ï¼ˆDiffuse-Reflectionï¼‰"><a href="#æ¼«åå°„ï¼ˆDiffuse-Reflectionï¼‰" class="headerlink" title="æ¼«åå°„ï¼ˆDiffuse Reflectionï¼‰"></a>æ¼«åå°„ï¼ˆ<strong>Diffuse Reflectionï¼‰</strong></h2><p>åœ¨æ¼«åå°„ä¸­ï¼Œå…‰å‘å››é¢å…«æ–¹æ•£å»ï¼Œæ‰€ä»¥ç‰©ä½“æ¼«åå°„å‡ºçš„å…‰ä¸æ‘„åƒæœºä½ç½®æ— å…³ï¼Œè€Œä»…ä¸ä»¥ä¸‹å‡ é¡¹æœ‰å…³ï¼š</p><ol><li>å…‰å¼º $c_l$.</li><li>ç‰©ä½“æè´¨ $c_r$. ä¸åŒç‰©ä½“å¯¹å…‰çš„åå°„ç‡æ˜¯ä¸åŒçš„ï¼Œå³ä½¿æ˜¯åŒä¸€ä¸ªç‰©ä½“ä¹Ÿå¯¹ä¸åŒé¢œè‰²çš„å…‰æœ‰ä¸åŒåå°„ç‡ã€‚</li><li>ç‰©ä½“è¡¨é¢æ³•çº¿ $\mathbf{n}$.</li><li>å…‰æºæ–¹å‘ $\mathbf{l}$.</li></ol><p>æœ€ç»ˆç»“æœå¯ä»¥å†™æˆ </p><script type="math/tex; mode=display">L_d = c_r c_l \max (0, \mathbf{n} \cdot \mathbf{l})</script><p>ç”±äºå…‰å¼ºä¸€èˆ¬éšè·ç¦»è¡°å‡ï¼Œæ‰€ä»¥ $c_l$ ä¸€èˆ¬åæ¯”äºè·ç¦»çš„å¹³æ–¹ $r^2$. </p><h2 id="é•œé¢åå°„ï¼ˆSpecular-Reflectionï¼‰"><a href="#é•œé¢åå°„ï¼ˆSpecular-Reflectionï¼‰" class="headerlink" title="é•œé¢åå°„ï¼ˆSpecular Reflectionï¼‰"></a>é•œé¢åå°„ï¼ˆSpecular Reflectionï¼‰</h2><p>é•œé¢åå°„ä¸­ï¼Œå…‰ä¸»è¦å‘ä¸€ä¸ªæ–¹å‘åå°„ï¼Œæ‰€ä»¥é•œé¢åå°„çš„å…‰ä¸æ‘„åƒæœºä½ç½®æœ‰å…³ã€‚</p><script type="math/tex; mode=display">L_s = c_pc_l\max(0, \mathbf n \cdot \mathbf h)^p</script><p>å…¶ä¸­ $c_p$ æ˜¯è‡ªå®šä¹‰çš„ RGB å€¼ï¼Œå…è®¸æˆ‘ä»¬æ§åˆ¶é«˜å…‰é¢œè‰²ï¼ŒæŒ‡æ•° $p$ æ˜¯ä¸ºäº†ä¿è¯æˆ‘ä»¬åªåœ¨å°èŒƒå›´å†…çœ‹åˆ°é«˜å…‰ï¼Œ$p$ è¶Šå¤§è¿™ä¸ªé«˜å…‰å¯è§èŒƒå›´è¶Šå°ï¼Œè€Œ $\mathbf h$ çš„å®šä¹‰å¦‚ä¸‹ï¼š</p><script type="math/tex; mode=display">\mathbf h = (\mathbf e + \mathbf l).\text{normalized()}</script><p>è¿˜æœ‰ä¸€ç§å†™æ³•æŠŠ $\mathbf n \cdot \mathbf h$ æ¢æˆäº† $\mathbf r \cdot \mathbf e$ï¼Œç®€å•è®¡ç®—å¯ä»¥å‘ç° $\mathbf<br>n$ å’Œ $\mathbf h$ çš„å¤¹è§’æ˜¯ $\mathbf r$ å’Œ $\mathbf e$ çš„å¤¹è§’çš„ä¸€åŠï¼Œæ‰€ä»¥è¿™ä¸¤ä¸ªå†™æ³•åœ¨æ€è·¯ä¸Šæ˜¯ä¸€æ ·çš„ï¼Œéƒ½åœ¨è€ƒè™‘åå°„å…‰æ–¹å‘å’Œæ‘„åƒæœºæ–¹å‘çš„å¤¹è§’ï¼Œä¸è¿‡åœ¨æ•°å€¼ä¸Šä¼šç•¥æœ‰å·®åˆ«ã€‚æœ¬æ–‡é‡‡ç”¨ $\mathbf n \cdot \mathbf h$ çš„å†™æ³•ã€‚</p><p><img src="/images/learning/open-course/GAMES101/Notes/note3/specular.png" alt=""></p><h2 id="ç¯å¢ƒå…‰ï¼ˆAmbient-Lightingï¼‰"><a href="#ç¯å¢ƒå…‰ï¼ˆAmbient-Lightingï¼‰" class="headerlink" title="ç¯å¢ƒå…‰ï¼ˆAmbient Lightingï¼‰"></a>ç¯å¢ƒå…‰ï¼ˆAmbient Lightingï¼‰</h2><p>å¦‚æœåªè€ƒè™‘æ¼«åå°„å’Œé•œé¢åå°„ï¼Œæˆ‘ä»¬ä¼šå‘ç°æ²¡æœ‰é¢æœå…‰æºçš„ç‰©ä½“å®Œå…¨æ˜¯é»‘è‰²çš„ï¼Œä½†ç°å®é‡Œæ˜¾ç„¶ä¸æ˜¯å¦‚æ­¤ã€‚è¿™æ˜¯å› ä¸ºåœ¨ç°å®é‡Œï¼Œå…‰ç»è¿‡å¤šæ¬¡åå°„è€Œç…§äº®äº†é‚£äº›æ²¡æœ‰é¢æœå…‰æºçš„ç‰©ä½“ã€‚æˆ‘ä»¬å¯ä»¥è¿‘ä¼¼åœ°è®¤ä¸ºæœ‰ä¸€ç§å……æ–¥ç€æ•´ä¸ªç©ºé—´çš„å…‰ï¼Œå¹¶æŠŠå®ƒå«åšç¯å¢ƒå…‰ï¼Œå…¬å¼å¦‚ä¸‹ï¼š</p><script type="math/tex; mode=display">L_a=c_r c_a</script><p>å…¶ä¸­ $c_a$ æ˜¯ç¯å¢ƒå…‰çš„å¼ºåº¦ã€‚</p><h2 id="å†¯æ°å…‰ç…§æ¨¡å‹"><a href="#å†¯æ°å…‰ç…§æ¨¡å‹" class="headerlink" title="å†¯æ°å…‰ç…§æ¨¡å‹"></a>å†¯æ°å…‰ç…§æ¨¡å‹</h2><p>ç»¼åˆæ¥çœ‹ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†<strong>å†¯æ°å…‰ç…§æ¨¡å‹</strong>ï¼Œå…¬å¼å¦‚ä¸‹ï¼š</p><script type="math/tex; mode=display">L=c_r(c_a+c_l\max{(0,\mathbf n \cdot \mathbf l)})+c_pc_l\max(0, \mathbf n \cdot \mathbf h)^p</script><p>å…¶ä¸­ </p><ol><li>$c_r$ æ˜¯ç‰©ä½“æè´¨ï¼Œè¡¨ç¤ºç‰©ä½“å¯¹å…‰çš„åå°„ç‡ï¼Œä¸€èˆ¬æ˜¯ä¸€ä¸ª Vector3f ç±»å‹çš„å€¼ï¼Œå› ä¸ºç‰©ä½“å¯¹ä¸åŒé¢œè‰²çš„å…‰æœ‰ä¸åŒåå°„ç‡ï¼›</li><li>$c_a$ æ˜¯ç¯å¢ƒå…‰å¼ºï¼Œä¸€èˆ¬æ˜¯ä¸€ä¸ª Vector3f ç±»å‹çš„å€¼ï¼›</li><li>$c_l$ æ˜¯å…‰å¼ºï¼Œä¸€èˆ¬ä¸ç‰©ä½“å’Œå…‰æºçš„è·ç¦»æˆåæ¯”ï¼Œä¸€èˆ¬æ˜¯ä¸€ä¸ª Vector3f ç±»å‹çš„å€¼ï¼›</li><li>$c_p$ æ˜¯é«˜å…‰é¢œè‰²ï¼Œä¸€èˆ¬ä¹Ÿæ˜¯ä¸€ä¸ª Vector3f ç±»å‹çš„å€¼ã€‚</li></ol><h1 id="UVæ˜ å°„"><a href="#UVæ˜ å°„" class="headerlink" title="UVæ˜ å°„"></a>UVæ˜ å°„</h1><p>ä¸ºäº†æŠŠè´´å›¾è´´åˆ°æ¨¡å‹ä¸Šï¼Œéœ€è¦æœ‰ä¸€ä¸ª $(x, y, z) \rightarrow (u, v)$ çš„å‡½æ•° $\phi$. æˆ‘ä»¬æœŸæœ›è¿™ä¸ªå‡½æ•°æœ‰è¿™äº›æ€§è´¨ï¼š</p><ol><li>å•å°„ï¼šæˆ‘ä»¬ä¸å¸Œæœ›ä¸¤ä¸ª 3D ç‚¹æ˜ å°„åˆ°åŒä¸€ä¸ª 2D ç‚¹ä¸Š</li><li>å¤§å°ä¸å˜æ€§ï¼šåœ¨ 3D æ¨¡å‹ä¸Šçš„ä¸‰è§’å½¢å¤šå¤§ï¼Œæˆ‘ä»¬å¸Œæœ› 2D çš„ä¸‰è§’å½¢ä¹Ÿå·®ä¸å¤šå¤§å°</li><li>å½¢çŠ¶ä¸å˜æ€§ï¼š3D æ¨¡å‹çš„ä¸‰è§’å½¢æ˜ å°„åˆ° 2D ä¸Šåï¼Œä¸¤ä¸ªä¸‰è§’å½¢åº”å°½é‡ç›¸ä¼¼</li><li>è¿ç»­ï¼šå¦‚æœä¸¤ä¸ªç‚¹åœ¨ 3D ä¸–ç•Œæ¨¡å‹ä¸Šç›¸è¿‘ï¼Œæˆ‘ä»¬å¸Œæœ›å®ƒä»¬åœ¨ 2D ä¸Šä¹Ÿç›¸è¿‘</li></ol><p>è´´å›¾æœ‰è®¸å¤šåº”ç”¨ï¼Œæœ€å®¹æ˜“æƒ³åˆ°çš„æ˜¯é¢œè‰²è´´å›¾ï¼Œå®ƒç›´æ¥æŠŠé¢œè‰²è´´åˆ°æ¨¡å‹ä¸Šï¼Œä¹Ÿè¢«ç§°ä½œæ¼«åå°„è´´å›¾ã€‚</p><p>æ³•çº¿è´´å›¾ã€é‡‘å±åº¦è´´å›¾ã€ç²—ç³™åº¦è´´å›¾åˆ™è¿›ä¸€æ­¥å†³å®šäº†æ¨¡å‹çš„å„ç§å±æ€§ã€‚æ¯”å¦‚æ³•çº¿è´´å›¾å®šä¹‰äº†æ¯ä¸€ç‚¹çš„æ³•çº¿ï¼Œåœ¨è®¡ç®—å…‰ç…§æ—¶ä¼šå€ŸåŠ©è¿™ä¸ªæ³•çº¿æ¥å¾—åˆ°æ›´çœŸå®çš„ç»“æœã€‚</p><p><img src="/images/learning/open-course/GAMES101/Notes/note3/normal-map.jpg" alt=""></p><h1 id="ç€è‰²æ–¹æ³•"><a href="#ç€è‰²æ–¹æ³•" class="headerlink" title="ç€è‰²æ–¹æ³•"></a>ç€è‰²æ–¹æ³•</h1><p>æ¨¡å‹ç”±ä¸‰è§’å½¢åˆ’åˆ†æ¥è¡¨ç¤ºï¼Œé‚£ä¹ˆæ¯ä¸ªä¸‰è§’å½¢ç”¨æ€æ ·çš„é¢œè‰²å‘¢ï¼Ÿ</p><h2 id="å¹³é¢ç€è‰²ï¼ˆFlat-Shadingï¼‰"><a href="#å¹³é¢ç€è‰²ï¼ˆFlat-Shadingï¼‰" class="headerlink" title="å¹³é¢ç€è‰²ï¼ˆFlat Shadingï¼‰"></a>å¹³é¢ç€è‰²ï¼ˆFlat Shadingï¼‰</h2><p>æˆ‘ä»¬é€šè¿‡å…‰ç…§è®¡ç®—é¢œè‰²ï¼Œè€Œè®¡ç®—å…‰ç…§éœ€è¦æ³•çº¿ã€‚å¹³é¢ç€è‰²ç›´æ¥æ±‚è¿™ä¸ªä¸‰è§’å½¢çš„æ³•çº¿ï¼Œç„¶åæŒ‰å…‰ç…§å…¬å¼è®¡ç®—è¿™ä¸ªä¸‰è§’å½¢çš„é¢œè‰²ã€‚è¿™ç§æ–¹æ³•å¾—åˆ°çš„æ¯ä¸ªä¸‰è§’å½¢éƒ½æ˜¯å•è‰²çš„ã€‚</p><h2 id="é€é¡¶ç‚¹ç€è‰²ï¼ˆGouraud-Shadingï¼‰"><a href="#é€é¡¶ç‚¹ç€è‰²ï¼ˆGouraud-Shadingï¼‰" class="headerlink" title="é€é¡¶ç‚¹ç€è‰²ï¼ˆGouraud Shadingï¼‰"></a>é€é¡¶ç‚¹ç€è‰²ï¼ˆGouraud Shadingï¼‰</h2><p>é€é¡¶ç‚¹ç€è‰²åˆ™æ±‚ä¸‰è§’å½¢é¡¶ç‚¹çš„æ³•çº¿ï¼Œå¹¶ä¸ºä¸‰è§’å½¢é¡¶ç‚¹ç€è‰²ï¼Œç„¶åå¯¹å†…éƒ¨çš„æ¯ä¸ªç‚¹æ’å€¼å†…éƒ¨é¢œè‰²ã€‚</p><p>é‚£ä¹ˆé¡¶ç‚¹çš„æ³•çº¿æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿä¸€ä¸ªé¡¶ç‚¹ä¸€èˆ¬åœ¨å¤šä¸ªé¢ä¸Šï¼ŒæŠŠè¿™äº›é¢çš„æ³•çº¿åšåŠ æƒå¹³å‡å°±å¥½ï¼Œæƒå€¼å¯ä»¥æ˜¯é¢çš„é¢ç§¯ã€‚</p><h2 id="é€åƒç´ ç€è‰²ï¼ˆPhong-Shadingï¼‰"><a href="#é€åƒç´ ç€è‰²ï¼ˆPhong-Shadingï¼‰" class="headerlink" title="é€åƒç´ ç€è‰²ï¼ˆPhong Shadingï¼‰"></a>é€åƒç´ ç€è‰²ï¼ˆPhong Shadingï¼‰</h2><p>é€åƒç´ ç€è‰²åŒæ ·æ±‚ä¸‰è§’å½¢é¡¶ç‚¹çš„æ³•çº¿ï¼Œç„¶åå¯¹å†…éƒ¨çš„æ¯ä¸ªç‚¹æ’å€¼å†…éƒ¨æ³•çº¿ï¼Œä»æ³•çº¿å†æ±‚å„ä¸ªç‚¹çš„é¢œè‰²ã€‚</p><p>æ’å€¼æ˜¯é€šè¿‡é‡å¿ƒåæ ‡æ¥æ’å€¼ã€‚å¯¹ä¸‰è§’å½¢ $ABC$ å†…çš„æŸä¸€ç‚¹ $P$ï¼Œå®ƒå¯ä»¥è¡¨ç¤ºä¸º</p><script type="math/tex; mode=display">P=\frac{S_{APB}C+S_{BPC}A+S_{CPA}B}{S_{ABC}}</script><p>è¿™é‡Œçš„ $S$ æ˜¯é¢ç§¯ï¼Œè¿™é‡Œçš„å½¢å¦‚ $S<em>{APB}/S</em>{ABC}$ çš„å¼å­å°±æ˜¯å„ä¸ªç‚¹çš„æƒå€¼ã€‚</p><p>åœ¨æ’å€¼æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨ä¸–ç•Œç©ºé—´ / æ‘„åƒæœºç©ºé—´åšæ’å€¼ï¼Œå³åœ¨ viewing transformation å‰è¿›è¡Œæ’å€¼ï¼Œè€Œä¸æ˜¯ viewing transformation åã€‚</p><p>ä½†æˆ‘ä»¬ä¸€èˆ¬åœ¨å…‰æ …åŒ–æ—¶æ‰è¿›è¡Œæ’å€¼ï¼Œè¿™æ—¶å·²ç»æŠŠç‰©ä½“å˜æ¢åˆ°äº† NDC ç©ºé—´ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜è¦è¿›è¡Œé€è§†çŸ«æ­£ã€‚å…¬å¼å¦‚ä¸‹ï¼Œå…·ä½“æ¨å¯¼å¯ä»¥å‚è€ƒ Homework 3 çš„ç¬”è®°ã€‚</p><script type="math/tex; mode=display">\begin{align*}&\alpha = \frac{\alpha' / w_0}{\alpha' / w_0 + \beta' / w_1 + \gamma' / w_2}\\&\beta= \frac{\beta' / w_1}{\alpha' / w_0 + \beta' / w_1 + \gamma' / w_2}\\&\gamma= \frac{\gamma' / w_2}{\alpha' / w_0 + \beta' / w_1 + \gamma' / w_2}\end{align*}</script><p>å…¶ä¸­ $\alphaâ€™,\betaâ€™,\gammaâ€™$ æ˜¯å±å¹•ç©ºé—´çš„é‡å¿ƒåæ ‡ï¼Œ$\alpha,\beta,\gamma$ æ˜¯ä¸–ç•Œç©ºé—´çš„é‡å¿ƒåæ ‡ã€‚æˆ‘ä»¬ç”¨ä¸–ç•Œç©ºé—´çš„é‡å¿ƒåæ ‡ä½œä¸ºæƒé‡æ¥æ’å€¼ã€‚</p><p><img src="/images/learning/open-course/GAMES101/Notes/note3/shading-freq.png" alt=""></p><h1 id="æ¸²æŸ“ç®¡çº¿"><a href="#æ¸²æŸ“ç®¡çº¿" class="headerlink" title="æ¸²æŸ“ç®¡çº¿"></a>æ¸²æŸ“ç®¡çº¿</h1><p>æ¸²æŸ“æµç¨‹åŸºæœ¬å¦‚ä¸‹ï¼š</p><ol><li>Inputï¼šè¾“å…¥ 3D ä¸–ç•Œçš„é¡¶ç‚¹</li><li>Vertex Processingï¼šç”¨å„ç§å˜æ¢çŸ©é˜µæŠŠé¡¶ç‚¹å˜æ¢åˆ°å±å¹•ç©ºé—´</li><li>Triangle Processingï¼šæ ¹æ®ä¼ å…¥çš„é¡¶ç‚¹è¿æ¥æ–¹å¼åœ¨å±å¹•ç©ºé—´è¿æ¥ä¸‰è§’å½¢</li><li>Rasterizationï¼šæŠŠä¸‰è§’å½¢è½¬åŒ–æˆç‰‡å…ƒ / åƒç´ </li><li>Fragement Processingï¼šåº”ç”¨è´´å›¾ã€å…‰ç…§ç­‰</li><li>Framebuffer Operationsï¼šæ·±åº¦æµ‹è¯•ç­‰</li></ol><p><img src="/images/learning/open-course/GAMES101/Notes/note3/pipeline.png" alt=""></p><h1 id="çº¹ç†æ”¾å¤§å’Œçº¹ç†ç¼©å°"><a href="#çº¹ç†æ”¾å¤§å’Œçº¹ç†ç¼©å°" class="headerlink" title="çº¹ç†æ”¾å¤§å’Œçº¹ç†ç¼©å°"></a>çº¹ç†æ”¾å¤§å’Œçº¹ç†ç¼©å°</h1><p>åœ¨åšçº¹ç†æ˜ å°„æ—¶ï¼Œè´´å›¾å¤ªå°å’Œè´´å›¾å¤ªå¤§éƒ½ä¼šæœ‰é—®é¢˜ã€‚</p><p><img src="/images/learning/open-course/GAMES101/Notes/note3/mag-minification.png" alt=""></p><h2 id="çº¹ç†æ”¾å¤§"><a href="#çº¹ç†æ”¾å¤§" class="headerlink" title="çº¹ç†æ”¾å¤§"></a>çº¹ç†æ”¾å¤§</h2><p>è´´å›¾å¤ªå°æ—¶è¦åšçº¹ç†æ”¾å¤§ï¼Œå¯¹é‡‡æ ·ç‚¹åšåŒçº¿æ€§æ’å€¼å³å¯ã€‚</p><p><img src="/images/learning/open-course/GAMES101/Notes/note3/upsample.png" alt=""></p><h2 id="çº¹ç†ç¼©å°"><a href="#çº¹ç†ç¼©å°" class="headerlink" title="çº¹ç†ç¼©å°"></a>çº¹ç†ç¼©å°</h2><p>è´´å›¾å¤ªå¤§æ—¶ç›´è§‰ä¸Šæ¯”è´´å›¾å¤ªå°æ›´å¥½å¤„ç†ï¼Œä½†æ°æ°ç›¸åã€‚è¿˜è®°å¾—é¢‘è°±å—ï¼Œè´´å›¾å¤ªå¤§ä»£è¡¨é«˜é¢‘æœ‰æ›´å¤šä¿¡æ¯ï¼Œæˆ‘ä»¬ä¼šå› é‡‡æ ·é¢‘ç‡ä¸è¶³è€Œæ— æ³•æ­£ç¡®åæ˜ é«˜é¢‘ä¿¡æ¯ï¼Œå¯¼è‡´ç»“æœå‡ºç°é”¯é½¿ã€æ‘©å°”çº¹ç­‰èµ°æ ·é—®é¢˜ã€‚</p><p>æœ€å¸¸ç”¨çš„ç¼“è§£æ–¹æ³•æ˜¯ Mipmappingã€‚åŸºæœ¬æ€è·¯æ˜¯ï¼Œæˆ‘ä»¬åˆ†æå±å¹•ä¸Šæ¯ä¸ªåƒç´ åœ¨è´´å›¾ä¸Šè¦†ç›–çš„åƒç´ æ•°é‡ï¼Œå¯¹é‚£äº›è¦†ç›–è¾ƒå¤šçš„ï¼Œå°±è®©ä»–ä»¬å»è¢«ç¼©å°çš„è´´å›¾ä¸Šé‡‡æ ·ï¼Œè¿™æ ·å°±èƒ½ç¼“è§£æ¬ é‡‡æ ·é—®é¢˜ã€‚</p><p>é¦–å…ˆæˆ‘ä»¬è¦åˆ›å»ºâ€œç¼©å°çš„è´´å›¾â€ï¼ŒMipmapé“¾åŒ…å«ä¸€ç³»åˆ—çº¹ç† $D_0, D_1, D_2, \ldots, D_N$ï¼Œå…¶ä¸­ $D_i$ çš„åˆ†è¾¨ç‡ä¸º $\frac{W}{2^i} \times \frac{H}{2^i}$ï¼Œç›´åˆ°æœ€å†…å±‚ä¸º $1 \times 1$ åƒç´ ã€‚</p><p>ç„¶åæˆ‘ä»¬è¦åˆ†æå•ä¸ªå±å¹•åƒç´ è¦†ç›–äº†å¤šå°‘çº¹ç†åƒç´ ï¼Œå¤§è‡´æ€è·¯æ˜¯è®¡ç®—å±å¹•ç©ºé—´çš„ç›¸é‚»ç‚¹æ˜ å°„åˆ°è´´å›¾ç©ºé—´åçš„è·ç¦»ã€‚è´´å›¾ç©ºé—´é‡Œç›¸é‚»åƒç´ è·ç¦»ä¸º $1$ï¼Œæ‰€ä»¥å¦‚æœå±å¹•ç©ºé—´çš„ç›¸é‚»ç‚¹æ˜ å°„åˆ°è´´å›¾ç©ºé—´åçš„è·ç¦»ä¸º $x$ï¼Œæˆ‘ä»¬å°±è®¤ä¸ºå®ƒè¦†ç›–äº† $x$ ä¸ªåƒç´ ã€‚</p><p>è¿™ä¸ªâ€œå•ä¸ªå±å¹•åƒç´ è¦†ç›–äº†å¤šå°‘çº¹ç†åƒç´ â€çš„ä¼°ç®—è¢«è®°ä½œ $\rho$ï¼Œå…¬å¼å¦‚ä¸‹ï¼š</p><script type="math/tex; mode=display">\rho = \max\left( \sqrt{\left(\frac{\partial u}{\partial x}\right)^2 + \left(\frac{\partial v}{\partial x}\right)^2}, \sqrt{\left(\frac{\partial u}{\partial y}\right)^2 + \left(\frac{\partial v}{\partial y}\right)^2} \right)</script><p>å– $\max$ æ˜¯ä¸ºäº†å°½å¯èƒ½å–å±‚çº§æ›´ä½çš„ Mipmapã€‚ä¸€ä¸ªå±å¹•åƒç´ è¦†ç›–çš„çº¹ç†åƒç´ è¶Šå¤šï¼Œå®ƒå¯¹åº”çš„ Mipmap å±‚çº§å°±è¶Šå°ã€‚æ€»ä¹‹ï¼Œæˆ‘ä»¬å®å¯æ¨¡ç³Šï¼Œä¹Ÿä¸è¦æ¬ é‡‡æ ·ã€‚</p><p>æœ€åç”¨ $\lambda = \log_2{\rho}$ å°±èƒ½ç®—å‡ºè¿™ä¸ªå±å¹•åƒç´ å¯¹åº”çš„çº¹ç†å±‚çº§ã€‚æ¯”å¦‚å½“ $\lambda = 0$ æ—¶ï¼Œè¡¨ç¤ºä¸€ä¸ªå±å¹•åƒç´ æ°å¥½å¯¹åº”ä¸€ä¸ªçº¹ç†åƒç´ ï¼Œåº”ä½¿ç”¨åŸå§‹çº¹ç† $D_0$.</p><p><img src="/images/learning/open-course/GAMES101/Notes/note3/downsample.png" alt=""></p><p>è®¡ç®—å‡ºå±‚çº§ $\lambda$ åè¿˜è¦åšé‡‡æ ·ã€‚æ˜¾ç„¶ $\lambda$ å¤§å¤šæ•°æ—¶å€™éƒ½ä¸æ˜¯æ•´æ•°ï¼Œæ‰€ä»¥æœ‰ä¸¤ç§å¸¸è§çš„é‡‡æ ·æ–¹æ³•ï¼š</p><ol><li><p>æœ€è¿‘é‚»Mipmapæ»¤æ³¢ï¼ˆNearest Mipmap Filteringï¼‰</p><p> é€‰æ‹©æœ€æ¥è¿‘ $\lambda$ çš„æ•´æ•°å±‚çº§ $d = \text{round}(\lambda)$ åšé‡‡æ ·ï¼Œåœ¨è¿™ä¸€å±‚å¯ä»¥æ˜¯æœ€è¿‘é‚»æˆ–åŒçº¿æ€§æ»¤æ³¢ã€‚</p></li><li><p>ä¸‰çº¿æ€§æ»¤æ³¢ï¼ˆTrilinear Filteringï¼‰</p><p> ç¡®å®š $\lambda$ ä¸¤ä¾§çš„ä¸¤ä¸ªæ•´æ•°å±‚çº§ï¼š$d_1 = \lfloor\lambda\rfloor$ å’Œ $d_2 = \lceil\lambda\rceil = d_1 + 1$ï¼Œåœ¨è¿™ä¸¤å±‚åˆ†åˆ«åšåŒçº¿æ€§æ»¤æ³¢é‡‡æ ·å¾—åˆ°é¢œè‰² $C_1$ å’Œ $C_2$ï¼Œç„¶åå¾—åˆ°æœ€ç»ˆé¢œè‰²</p><script type="math/tex; mode=display"> C = (1 - f) \cdot C_1 + f \cdot C_2</script><p> å…¶ä¸­ $f = \lambda - \lfloor\lambda\rfloor$ ä¸º $\lambda$ çš„å°æ•°éƒ¨åˆ†ã€‚</p></li></ol><h1 id="å…¶ä»–å°çŸ¥è¯†"><a href="#å…¶ä»–å°çŸ¥è¯†" class="headerlink" title="å…¶ä»–å°çŸ¥è¯†"></a>å…¶ä»–å°çŸ¥è¯†</h1><p>è™ä¹¦æåˆ°çš„planar projectionã€spherical coordinatesã€cylindrical coordinatesã€cubemapsæœ¬è´¨ä¸Šéƒ½æ˜¯æŠŠ3dè¡¨é¢æŠ•å½±åˆ°ä¸€ä¸ªç†æƒ³çš„ç®€å•å‡ ä½•ä½“ä¸Šï¼Œç„¶åæŠŠç®€å•å‡ ä½•ä½“å±•å¼€æˆå¹³é¢ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;×™Ö°×”Ö´×™-××•Ö¹×¨&quot;&gt;&lt;a href=&quot;#×™Ö°×”Ö´×™-××•Ö¹×¨&quot; class=&quot;headerlink&quot; title=&quot;×™Ö°×”Ö´×™ ××•Ö¹×¨&quot;&gt;&lt;/a&gt;×™Ö°×”Ö´×™ ××•Ö¹×¨&lt;/h1&gt;&lt;p&gt;èµ·åˆï¼Œè®¡ç®—æœºçš„ä¸–ç•Œå°šæœªæ¸²æŸ“ï¼Œæ˜¾ç¤ºå™¨ä¸­ç©ºè™šæ··æ²Œï¼Œæ¸Šé¢é»‘æš—ã€‚&lt;/p&gt;
&lt;p&gt;å”¯æœ‰</summary>
      
    
    
    
    <category term="å…¬å¼€è¯¾" scheme="http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/"/>
    
    <category term="GAMES101" scheme="http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/"/>
    
    <category term="Notes" scheme="http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/Notes/"/>
    
    
  </entry>
  
  <entry>
    <title>Assignment 3 Pipeline and Shading</title>
    <link href="http://rinevard.github.io/wiki/learning/open-course/GAMES101/Hw/Hw3-pipeline-and-shading/"/>
    <id>http://rinevard.github.io/wiki/learning/open-course/GAMES101/Hw/Hw3-pipeline-and-shading/</id>
    <published>2025-09-13T11:45:16.000Z</published>
    <updated>2025-09-13T12:04:25.374Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬æ¬¡ä½œä¸šå¯¹ bump_fragment_shaderã€displacement_fragment_shader çš„è¦æ±‚éå¸¸ä¸ä¸¥è°¨ï¼Œè‡³å°‘åŒ…æ‹¬è¿™äº›é—®é¢˜ï¼š</p><ol><li>è¿™ä¸¤ä¸ª shdaer éœ€è¦çš„è´´å›¾æ˜¯å‡¹å‡¸è´´å›¾ï¼Œå‡¹å‡¸è´´å›¾æœ¬åº”è¯¥æ˜¯ç°åº¦å›¾ï¼Œè¿™é‡Œä½¿ç”¨ RGB è´´å›¾ã€‚</li><li>åœ¨è®¡ç®—åˆ‡çº¿ç©ºé—´åˆ°ä¸–ç•Œç©ºé—´çš„å˜æ¢çŸ©é˜µ TBN æ—¶ä½¿ç”¨äº†é”™è¯¯çš„å…¬å¼ã€‚æ­£ç¡®çš„å…¬å¼éœ€è¦çŸ¥é“ä¸‰è§’å½¢çš„ä¸‰ä¸ªé¡¶ç‚¹åŠå…¶ UV åæ ‡ã€‚</li><li>displacement æ–¹æ³•æ²¡æœ‰åœ¨å…‰æ …åŒ–å‰åç§»é¡¶ç‚¹ä½ç½®ï¼Œè€Œåªè°ƒæ•´äº†æ˜¾ç¤ºé¢œè‰²ã€‚</li></ol><p>æˆ‘ä»¬å…ˆä»‹ç»ä¸€ä¸‹ TBN çš„æ­£ç¡®è®¡ç®—æ–¹å¼å’Œä» bump texture ç®—å‡ºæ¢¯åº¦çš„æ–¹æ³•ï¼Œå†ä¾æ¬¡ä»‹ç»ä¸€ä¸‹å„ä¸ªä½œä¸šçš„åšæ³•ã€‚</p><h1 id="TBNçš„æ­£ç¡®è®¡ç®—æ–¹å¼"><a href="#TBNçš„æ­£ç¡®è®¡ç®—æ–¹å¼" class="headerlink" title="TBNçš„æ­£ç¡®è®¡ç®—æ–¹å¼"></a>TBNçš„æ­£ç¡®è®¡ç®—æ–¹å¼</h1><p>æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ä»€ä¹ˆæ˜¯ TBN ä»¥åŠä¸ºä»€ä¹ˆéœ€è¦ TBN. ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬å…ˆè€ƒè™‘æ³•çº¿è´´å›¾ã€‚ä¸‹æ–‡æŠŠä¸–ç•Œç©ºé—´é‡ŒæŒ‰æ³•çº¿è´´å›¾ä¿®æ­£åçš„æ³•çº¿ç§°ä½œâ€œ<strong>ä¿®æ­£æ³•çº¿</strong>â€ï¼ŒæŠŠä¸–ç•Œç©ºé—´é‡Œä¿®æ­£å‰çš„æ³•çº¿ç§°ä½œâ€œ<strong>å‡ ä½•æ³•çº¿</strong>â€ï¼Œè¿™é‡Œé»˜è®¤å®ƒä»¬éƒ½æ˜¯å½’ä¸€åŒ–çš„ã€‚</p><p>è€ƒè™‘ä¸–ç•Œç©ºé—´çš„æŸä¸€ç‚¹ $Q$ï¼Œå‡è®¾å®ƒåœ¨æ³•çº¿è´´å›¾ä¸­å¯¹åº”çš„ä¸€ç‚¹ä¸º $Qâ€™$ï¼Œæˆ‘ä»¬çŸ¥é“ç‚¹ $Qâ€™$ å¯¹åº”çš„æ³•çº¿è¢«ç”¨äºè®¡ç®—ä¸–ç•Œç©ºé—´ç‚¹ $Q$ çš„ä¿®æ­£æ³•çº¿ã€‚ä½†ç­‰ç­‰ï¼Œç›´æ¥æŠŠ RGB å€¼å¤åˆ¶è¿‡å»çœ‹èµ·æ¥æ˜¯é”™è¯¯çš„ï¼Œå› ä¸ºéšç€ç‰©ä½“è½¬åŠ¨ï¼Œç‚¹ $Q$ å¯¹åº”çš„æ³•çº¿ä¹Ÿåº”å½“è½¬åŠ¨ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªçŸ©é˜µæ¥å®ç°è¿™ç§ä»æ³•çº¿è´´å›¾ä¸Šçš„æ³•çº¿åˆ°ä¸–ç•Œç©ºé—´çš„ä¿®æ­£æ³•çº¿çš„å˜æ¢ã€‚</p><p>è´´å›¾æ˜¯äºŒç»´çš„ï¼Œå› æ­¤æˆ‘ä»¬å†é¢å¤–å®šä¹‰ä¸€ä¸ªå‚ç›´çº¸é¢å‘å¤–çš„è½´ $n$ï¼Œå®ƒè¡¨ç¤ºæ³•çº¿çš„â€œé»˜è®¤æ–¹å‘â€ï¼Œè¿™å°±å¾—åˆ°äº†ä¸‰ç»´çš„<strong>åˆ‡çº¿ç©ºé—´</strong>ã€‚å¦‚æœç‚¹ $Qâ€™$ å¯¹åº”çš„æ³•çº¿æ˜¯ $(0,0,1)$ï¼Œé‚£ä¹ˆä¸–ç•Œç©ºé—´çš„ç‚¹ $Q$ çš„ä¿®æ­£æ³•çº¿å°±æ˜¯åŸæœ¬çš„å‡ ä½•æ³•çº¿ã€‚</p><p>æ¥ä¸‹æ¥å°±è¦è€ƒè™‘å¦‚ä½•æ‰¾åˆ°è¿™ä¸ªä»åˆ‡çº¿ç©ºé—´åˆ°ä¸–ç•Œç©ºé—´çš„æ—‹è½¬çŸ©é˜µäº†ã€‚ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬å…ˆè€ƒè™‘å•ä¸ªä¸‰è§’å½¢çš„æ—‹è½¬ã€‚ä¹‹åæˆ‘ä»¬ä¼šå¯¹æ¯ä¸ªç‚¹æ±‚å‡ºå®ƒè‡ªå·±çš„æ—‹è½¬çŸ©é˜µã€‚æ²¡é”™ï¼Œæ¯ä¸ªç‚¹çš„æ—‹è½¬çŸ©é˜µä¸åŒï¼Œè¿™æ˜¯å› ä¸ºæ¯ä¸ªç‚¹å¯¹åº”çš„çŸ©é˜µä¼šæŠŠ $(0,0,1)$ æ˜ å°„åˆ°è¯¥ç‚¹çš„å‡ ä½•æ³•çº¿ï¼Œè€Œæ¯ä¸ªç‚¹çš„å‡ ä½•æ³•çº¿ä¸€èˆ¬ä¸åŒã€‚</p><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬å¸Œæœ›æŠŠæ³•çº¿è´´å›¾ä¸Šçš„ $P_0â€™P_1â€™P_2â€™$ æ—‹è½¬ä¸ºä¸–ç•Œç©ºé—´çš„ $P_0P_1P_2$ï¼Œè®¾è¿™é‡Œçš„æ—‹è½¬çŸ©é˜µä¸º $M$ï¼Œä¸–ç•Œç©ºé—´çš„ $P_0P_1P_2$ çš„å‡ ä½•æ³•çº¿ä¸º $\mathbf{n}$ï¼Œåˆ™æœ‰</p><script type="math/tex; mode=display">\begin{align*}&M[0,0,1]^T=\mathbf n\end{align*}</script><p><img src="/images/learning/open-course/GAMES101/Assignments/hw3/tangent-world-space.png" alt=""></p><p>ä½†å…‰é è¿™ä¸€ä¸ªæ–¹ç¨‹å½“ç„¶è§£ä¸å‡º $M$ï¼Œæ‰€ä»¥æˆ‘ä»¬å†è€ƒè™‘ä¸¤ä¸ªé¢å¤–çš„æ–¹ç¨‹ï¼š</p><script type="math/tex; mode=display">\begin{align*}&M (P_1'-P_0')=k(P_1-P_0)\\&M (P_2'-P_0')=k(P_2-P_0)\end{align*}</script><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¸Œæœ›è¿™ä¸ªçŸ©é˜µæŠŠåˆ‡çº¿ç©ºé—´ä¸‰è§’å½¢çš„è¾¹å‘é‡æ—‹è½¬åˆ°ä¸–ç•Œç©ºé—´çš„è¾¹å‘é‡ä¸Šï¼Œè¿™çœ‹èµ·æ¥æ˜¯ä¸€ä¸ªåˆç†çš„è¦æ±‚ã€‚è¿™é‡Œçš„ $k$ æ˜¯è¾¹çš„é•¿åº¦çš„ç¼©æ”¾æ¯”ä¾‹ï¼Œä¸¥æ ¼æ¥è¯´æ¯æ¡è¾¹çš„ç¼©æ”¾æ¯”ä¾‹ä¸ä¸€å®šç›¸ç­‰ï¼Œä½†åªè¦ UV æ˜ å°„å‰åçš„ä¸‰è§’å½¢å¤§ä½“æ˜¯ç›¸ä¼¼ä¸‰è§’å½¢ï¼Œæˆ‘ä»¬å°±å¯ä»¥è®¤ä¸ºç¼©æ”¾æ¯”ä¾‹éƒ½ä¸º $k$.</p><p>ä¸‹é¢æˆ‘ä»¬æ¥è§£æ–¹ç¨‹ã€‚é¦–å…ˆæˆ‘ä»¬è®¾</p><script type="math/tex; mode=display">\begin{align*}&M=\begin{pmatrix}  T & B & N\end{pmatrix}\\&P_1'-P_0'= [\Delta u_1,\Delta v_1,0]^T\\&P_2'-P_0'= [\Delta u_2,\Delta v_2,0]^T\end{align*}</script><p>ä¸‹é¢ä¸¤ä¸ªå¼å­åˆ©ç”¨äº† $P_kâ€™$ çš„ç¬¬ä¸‰ä¸ªåˆ†é‡ä¸º $0$ çš„æ€§è´¨ã€‚</p><p>ç»“åˆç¬¬ä¸€ä¸ªæ–¹ç¨‹å°±èƒ½å¾—åˆ° $N=\mathbf n$ï¼Œè¿™é‡Œçš„ $\mathbf n$ è¡¨ç¤ºä¸–ç•Œç©ºé—´çš„ $P_0P_1P_2$ çš„å‡ ä½•æ³•çº¿ã€‚å†ç»“åˆå¦å¤–ä¸¤ä¸ªæ–¹ç¨‹å°±èƒ½å¾—åˆ°</p><script type="math/tex; mode=display">\begin{align*}&\Delta u_1 T+\Delta v_1 B=k(P_1-P_0)\\&\Delta u_2 T+\Delta v_2 B=k(P_2-P_0)\end{align*}</script><p>ä¹‹åæˆ‘ä»¬å¯ä»¥è§£å‡º $T,B,N$ çš„å€¼</p><script type="math/tex; mode=display">\begin{align*}&T=k\frac{\Delta v_2(P_1-P_0)-\Delta v_1(P_2-P_0)}{\Delta u_1 \Delta v_2-\Delta u_2 \Delta v_1}\\&B=k\frac{\Delta u_2(P_1-P_0)-\Delta u_1(P_2-P_0)}{\Delta u_2 \Delta v_1-\Delta u_1 \Delta v_2}\\&N=\mathbf n\end{align*}</script><p>è¿™ä¸ªå…¬å¼æ˜¯ä¸èƒ½ç”¨çš„ï¼Œå› ä¸ºé‡Œé¢æœ‰æœªçŸ¥æ•° $k$. æ¥ä¸‹æ¥æˆ‘ä»¬è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><p>æˆ‘ä»¬æœŸæœ› TBN çŸ©é˜µæ˜¯ä¸€ä¸ªæ—‹è½¬çŸ©é˜µï¼Œè€Œæ—‹è½¬çŸ©é˜µæ˜¯æ­£äº¤çŸ©é˜µï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼šå¯¹ TBN åšæ–½å¯†ç‰¹æ­£äº¤åŒ–å’Œå½’ä¸€åŒ–ã€‚åªè¦ $P_0P_1P_2$ å’Œ $P_0â€™P_1â€™P_2â€™$ å¤§ä½“æ˜¯ç›¸ä¼¼ä¸‰è§’å½¢ï¼Œé‚£ä¹ˆå®ƒä»¬æœ¬æ¥å°±å·®ä¸å¤šæ­£äº¤ï¼ˆå›é¡¾æˆ‘ä»¬å¯¹ TBN çš„å®šä¹‰ï¼Œä¼šå‘ç°ç›¸ä¼¼è¯´æ˜ TBN åªå¯¹ $P_0â€™P_1â€™P_2â€™$ åšäº†æ—‹è½¬å’Œç¼©æ”¾ï¼Œè¿™è¡¨æ˜ TBN æ­£äº¤ï¼‰ï¼Œæ‰€ä»¥è¿™ç§æ­£äº¤åŒ–ä¸ä¼šæŠŠ TBN å˜åŒ–å¤ªå¤šã€‚è€Œç”±äºæˆ‘ä»¬ä¼šå¯¹ TBN åšå•ä½åŒ–ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ”¾å¿ƒåœ°ä»¤ $k=1$ æ¥ç”¨ä¸‹é¢çš„å…¬å¼æ±‚å‡º TBNï¼š</p><script type="math/tex; mode=display">\begin{align*}&T=\frac{\Delta v_2(P_1-P_0)-\Delta v_1(P_2-P_0)}{\Delta u_1 \Delta v_2-\Delta u_2 \Delta v_1}\\&B=\frac{\Delta u_2(P_1-P_0)-\Delta u_1(P_2-P_0)}{\Delta u_2 \Delta v_1-\Delta u_1 \Delta v_2}\\&N=\mathbf{n}\end{align*}</script><p>æœ€åï¼Œæˆ‘ä»¬å¸Œæœ› N åœ¨æ­£äº¤åŒ–å‰åä¸å˜ï¼Œæ‰€ä»¥åœ¨æ­£äº¤åŒ–åæˆ‘ä»¬æœ‰</p><script type="math/tex; mode=display">\begin{align*}&T'=T-(N\cdot T)N\\&B'=B-(N\cdot B)N-(T'\cdot B)T'/T'^2\\&N'=\mathbf n\end{align*}</script><p>å†åšä¸ªå•ä½åŒ–å°±èƒ½å¾—åˆ°é¡¶ç‚¹çš„ TBN çŸ©é˜µäº†ã€‚è¿˜è®°å¾— TBN çŸ©é˜µæ˜¯åšä»€ä¹ˆçš„å—ï¼Œæˆ‘ä»¬ç”¨å®ƒæ¥å®ç°ä»åˆ‡çº¿ç©ºé—´åˆ°ä¸–ç•Œç©ºé—´çš„å˜æ¢ã€‚æ‰€ä»¥å¯¹ç‚¹ $Q$ï¼Œå‡è®¾å…¶æ³•çº¿è´´å›¾å¯¹åº”çš„æ³•çº¿ä¸º $\mathbf nâ€™$ï¼Œé‚£ä¹ˆä¿®æ­£åçš„æ³•çº¿å°±æ˜¯ $M_{\text{TBN}}\mathbf nâ€™$.</p><p>å¾ˆå¥½ï¼Œæˆ‘ä»¬ç°åœ¨èƒ½æŠŠå•ä¸ªä¸‰è§’å½¢åšå˜æ¢äº†ï¼Œä½†åœ¨çœŸæ­£çš„æ¨¡å‹ä¸­ï¼Œæ¯ä¸ªç‚¹çš„å‡ ä½•æ³•çº¿æ–¹å‘ä¸€èˆ¬éƒ½ä¸åŒï¼Œè¿™å°±æ„å‘³ç€å®ƒä»¬ä¸€èˆ¬éƒ½æœ‰ä¸åŒçš„ TBN çŸ©é˜µã€‚ä¸è®¡ç®—é¡¶ç‚¹æ³•çº¿ç±»ä¼¼ï¼Œæˆ‘ä»¬ä¼šæ‰¾åˆ°æ¯ä¸ªé¡¶ç‚¹ç›¸é‚»çš„æ‰€æœ‰ä¸‰è§’å½¢ï¼Œå¹¶å¯¹å®ƒä»¬çš„ $T$ å’Œ $B$ åšåŠ æƒå¹³å‡æ¥å¾—åˆ°è¿™ä¸ªé¡¶ç‚¹çš„ $T$ å’Œ $B$.</p><p>åœ¨å®è·µä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬åªè®¡ç®—å‡ºæ¯ä¸ªé¡¶ç‚¹çš„ $T$ï¼Œç„¶ååœ¨éœ€è¦ $B$ æ—¶é€šè¿‡å‰ä¹˜ $N\times T$ æ¥è®¡ç®—ã€‚å¯¹é‚£äº›éé¡¶ç‚¹çš„ç‚¹ï¼Œæˆ‘ä»¬ç”¨é‡å¿ƒåæ ‡æ’å€¼æ¥ç®—å‡ºå…¶ $N$ å’Œ $T$ï¼Œç„¶åä¹Ÿåšæ­£äº¤åŒ–å’Œå•ä½åŒ–æ¥ä¿è¯ TBN çŸ©é˜µçš„æ­£äº¤æ€§ã€‚</p><p>æœ€åæˆ‘ä»¬å†ç®€å•åˆ†æä¸€ä¸‹æ€ä¹ˆæ ¹æ®å‡¹å‡¸è´´å›¾åšæ³•çº¿ä¿®æ­£ã€‚åœ¨ä¿®æ­£æ³•çº¿æ—¶ï¼Œå‡¹å‡¸è´´å›¾ä¸æ³•çº¿è´´å›¾çš„å”¯ä¸€åŒºåˆ«å°±æ˜¯æ²¡æœ‰ç›´æ¥ç»™å‡ºæ³•çº¿ã€‚å›é¡¾ä¸€ä¸‹åˆ‡çº¿ç©ºé—´çš„å®šä¹‰ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç»™å‡¹å‡¸è´´å›¾åŒæ ·è®¾ç½®æ²¿çº¸é¢å‘å¤–çš„ $n$ è½´ï¼Œç„¶åæŠŠå‡¹å‡¸è´´å›¾æƒ³è±¡æˆä¸€ä¸ªæŒ‰ç°åº¦å€¼èµ·ä¼çš„æ›²é¢ï¼Œè¿™ä¸ªæ›²é¢çš„æ³•çº¿å°±å’Œæ³•çº¿è´´å›¾æä¾›çš„æ³•çº¿ç›¸å¯¹åº”ã€‚</p><p>å…·ä½“æ¥è¯´ï¼Œç‚¹ $(u,v)$ å¤„çš„æ³•çº¿å¯ä»¥ç”¨ $(h(u)-h(u+1,v),h(v)-h(u,v+1),1)$ æ¥è¿‘ä¼¼ï¼Œå…¶ä¸­ $h(u,v)$ è¡¨ç¤ºå‡¹å‡¸è´´å›¾åœ¨ç‚¹ $(u,v)$ å¤„çš„ç°åº¦å€¼ï¼Œ$h(u+1,v)$ è¡¨ç¤º $(u,v)$ å³è¾¹ä¸€æ ¼çš„ç°åº¦å€¼ã€‚</p><p>æœ‰æ—¶ç”±äºæˆ‘ä»¬æŠŠè´´å›¾åšäº†å½’ä¸€åŒ–ï¼Œæˆ‘ä»¬ä¼šæ”¹ç”¨ $h(u+1/\text{width},v)$ï¼Œä½†è®°ä½å®ƒè¡¨ç¤ºç›¸é‚»æ ¼å­çš„ç°åº¦å€¼å°±è¡Œã€‚</p><p>æœ€åæŠŠè¿™ä¸ªæ³•çº¿å’Œ TBN çŸ©é˜µç›¸ä¹˜å³å¯å¾—åˆ°ä¿®æ­£æ³•çº¿ã€‚</p><p>å‚è€ƒ <a href="https://terathon.com/blog/tangent-space.html">Computing Tangent Space Basis Vectors for an Arbitrary Mesh - Eric Lengyel</a></p><h1 id="ä½œä¸šä»£ç "><a href="#ä½œä¸šä»£ç " class="headerlink" title="ä½œä¸šä»£ç "></a>ä½œä¸šä»£ç </h1><h2 id="rasterize-triangle"><a href="#rasterize-triangle" class="headerlink" title="rasterize_triangle"></a>rasterize_triangle</h2><p>æ³¨æ„è¿™é‡Œçš„æ’å€¼ç®—æ³•è¦å¯¹æ‰€æœ‰çš„å±æ€§éƒ½åšé€è§†çŸ«æ­£ï¼Œæˆ‘ä»¬ç®€å•æ¨å¯¼ä¸€ä¸‹é€è§†çŸ«æ­£çš„å…¬å¼ï¼š</p><p>å‡è®¾æˆ‘ä»¬åœ¨å¯¹ç‚¹ $Q$ çš„æŸä¸ªå±æ€§è¿›è¡Œæ’å€¼ï¼Œåœ¨ä¸–ç•Œç©ºé—´ä¸­ï¼Œå®ƒæ‰€åœ¨çš„ä¸‰è§’å½¢ä¸º $P_0P_1P_2$. æŠ•å½±å˜æ¢åï¼Œå®ƒä»¬åˆ†åˆ«å˜æˆäº† $Qâ€™$ å’Œ $P_0â€™P_1â€™P_2â€™$. ç”¨é‡å¿ƒåæ ‡åˆ†åˆ«è¡¨ç¤º $Q$ å’Œ $Qâ€™$ï¼Œä¼šå¾—åˆ°</p><script type="math/tex; mode=display">\begin{align*}&Q=\alpha P_0+\beta P_1+\gamma P_2\\&Q'=\alpha' P_0'+\beta' P_1'+\gamma' P_2'\end{align*}</script><p>è¿™é‡Œçš„ $Q,Qâ€™,P_k,P_kâ€™$ éƒ½æ˜¯å½¢å¦‚ $[x,y,z,1]^T$ çš„å‘é‡ã€‚</p><p>åœ¨æ’å€¼å±æ€§æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›ç”¨ $\alpha, \beta,\gamma$ æ¥æ’å€¼ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ $\alphaâ€™, \betaâ€™,\gammaâ€™$ æ’å€¼ï¼Œå› ä¸ºæˆ‘ä»¬å½“ç„¶ä¸å¸Œæœ›å±æ€§ä¼šå› é€è§†ä½ç½®ä¸åŒè€Œä¸åŒã€‚è¿™å°±éœ€è¦æˆ‘ä»¬æ ¹æ® $\alphaâ€™, \betaâ€™,\gammaâ€™$ ç®—å‡º $\alpha, \beta,\gamma$.</p><p>ä¸å¦¨è®¾æŠ•å½±å˜æ¢çŸ©é˜µä¸º $M$ï¼Œåˆ™æœ‰ </p><script type="math/tex; mode=display">\begin{align*}&MQ=\alpha MP_0+\beta MP_1+\gamma MP_2\end{align*}</script><p>è¿™é‡Œçš„ $MP_k$ æ˜¯å½¢å¦‚ $[x_k,y_k,z_k,w_k]^T$ çš„ç”¨é½æ¬¡åæ ‡è¡¨ç¤ºçš„å‘é‡ï¼Œå®ƒä¸å½¢å¦‚ $[x,y,z,1]^T$ çš„ $P_kâ€™$ è™½ç„¶åœ¨æ•°å­¦ä¸Šè¡¨ç¤ºåŒä¸€ä¸ªç‚¹ï¼Œä½†åœ¨æ•°å€¼ä¸Šä¸åŒã€‚ï¼ˆè¿˜è®°å¾—å—ï¼Œé½æ¬¡åæ ‡ä¸‹çš„ $[x,y,z,1<br>]$ å’Œ $[ax,ay,az,a]$ è¡¨ç¤ºåŒä¸€ä¸ªç‚¹ï¼‰</p><p>å› æ­¤æˆ‘ä»¬å¸Œæœ›å¯¹å‘é‡çš„ç³»æ•°åšä¸€äº›è°ƒæ•´ï¼Œæ¥è®©å„ä¸ªå‘é‡å˜æˆ $[x,y,z,1]^T$ çš„å½¢å¼ï¼Œä»è€Œæ‰¾å‡º $\alphaâ€™, \betaâ€™,\gammaâ€™$ å’Œ $\alpha, \beta,\gamma$ çš„å…³ç³»ã€‚</p><p> ç®€å•å˜æ¢ä¸€ä¸‹ï¼Œæˆ‘ä»¬èƒ½æŠŠä¸Šé¢çš„å¼å­å†™æˆ</p><script type="math/tex; mode=display">\begin{align*}&MQ=\alpha w_0\frac{MP_0}{w_0}+\beta w_1\frac{MP_1}{w_1}+\gamma w_2\frac{MP_2}{w_2}\end{align*}</script><p>ç°åœ¨å³è¾¹çš„å„ä¸ªå‘é‡ $\frac{MP_k}{w_k}$ éƒ½å·²ç»æ˜¯ $[x,y,z,1]^T$ çš„å½¢å¼äº†ï¼Œæˆ‘ä»¬ç»™å®ƒä»¬çš„ç³»æ•°åšä¸ªå½’ä¸€åŒ–å°±èƒ½è®©å·¦è¾¹çš„å‘é‡ä¹Ÿå˜æˆ $[x,y,z,1]^T$ çš„å½¢å¼ï¼š</p><script type="math/tex; mode=display">\frac{MQ}{\alpha w_0 + \beta w_1 + \gamma w_2}=\frac{1}{\alpha w_0 + \beta w_1 + \gamma w_2}\bigg(\alpha w_0\frac{MP_0}{w_0}+\beta w_1\frac{MP_1}{w_1}+\gamma w_2\frac{MP_2}{w_2}\bigg)</script><p>ç”±æ­¤æˆ‘ä»¬å°±æœ‰</p><script type="math/tex; mode=display">\begin{align*}&\frac{\alpha w_0}{\alpha w_0 + \beta w_1 + \gamma w_2}=\alpha'\\&\frac{\beta w_1}{\alpha w_0 + \beta w_1 + \gamma w_2}=\beta'\\&\frac{\gamma w_2}{\alpha w_0 + \beta w_1 + \gamma w_2}=\gamma'\end{align*}</script><p>è§£ä¸Šé¢çš„æ–¹ç¨‹çš„å°æŠ€å·§æ˜¯å€ŸåŠ©é™¤æ³•å’Œé‡å¿ƒåæ ‡å’Œä¸º $1$ çš„æ€§è´¨å¾—åˆ°ä¸‹é¢çš„ç­‰ä»·çš„æ–¹ç¨‹ç»„</p><script type="math/tex; mode=display">\begin{align*}&\frac{\alpha'}{\beta'}=\frac{\alpha w_0}{\beta w_1}\\&\frac{\alpha'}{\gamma'}=\frac{\alpha w_0}{\gamma w_2}\\&\alpha + \beta + \gamma = 1\end{align*}</script><p>ç„¶åå°±èƒ½æ±‚å‡º</p><script type="math/tex; mode=display">\begin{align*}&\alpha = \frac{\alpha' / w_0}{\alpha' / w_0 + \beta' / w_1 + \gamma' / w_2}\\&\beta= \frac{\beta' / w_1}{\alpha' / w_0 + \beta' / w_1 + \gamma' / w_2}\\&\gamma= \frac{\gamma' / w_2}{\alpha' / w_0 + \beta' / w_1 + \gamma' / w_2}\end{align*}</script><p>ç”±æ­¤ï¼Œæˆ‘ä»¬å°±ä»å±å¹•ç©ºé—´çš„é‡å¿ƒåæ ‡ $\alphaâ€™,\betaâ€™,\gammaâ€™$ ç®—å‡ºäº†ä¸–ç•Œç©ºé—´çš„é‡å¿ƒåæ ‡ $\alpha,\beta,\gamma$ï¼Œä¹‹åå°±èƒ½ç”¨ä¸–ç•Œç©ºé—´çš„é‡å¿ƒåæ ‡æ¥æ­£ç¡®æ’å€¼äº†ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">//Screen space rasterization</span><span class="token keyword">void</span> rst<span class="token double-colon punctuation">::</span>rasterizer<span class="token double-colon punctuation">::</span><span class="token function">rasterize_triangle</span><span class="token punctuation">(</span><span class="token keyword">const</span> Triangle<span class="token operator">&amp;</span> t<span class="token punctuation">,</span> <span class="token keyword">const</span> std<span class="token double-colon punctuation">::</span>array<span class="token operator">&lt;</span>Eigen<span class="token double-colon punctuation">::</span>Vector3f<span class="token punctuation">,</span> <span class="token number">3</span><span class="token operator">></span><span class="token operator">&amp;</span> view_pos<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">auto</span> v <span class="token operator">=</span> t<span class="token punctuation">.</span><span class="token function">toVector4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// Find bounding box</span>    <span class="token keyword">float</span> left <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">float</span> right <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">float</span> bottom <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">float</span> top <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span><span class="token operator">&amp;</span> vec<span class="token operator">:</span> v<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        left <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span><span class="token function">min</span><span class="token punctuation">(</span>left<span class="token punctuation">,</span> vec<span class="token punctuation">.</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        right <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span><span class="token function">max</span><span class="token punctuation">(</span>right<span class="token punctuation">,</span> vec<span class="token punctuation">.</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        bottom <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span><span class="token function">min</span><span class="token punctuation">(</span>bottom<span class="token punctuation">,</span> vec<span class="token punctuation">.</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        top <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span><span class="token function">max</span><span class="token punctuation">(</span>top<span class="token punctuation">,</span> vec<span class="token punctuation">.</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// Update pixels in bounding box</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>left<span class="token punctuation">)</span><span class="token punctuation">;</span> x <span class="token operator">&lt;=</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>right<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> x<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> y <span class="token operator">=</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>bottom<span class="token punctuation">)</span><span class="token punctuation">;</span> y <span class="token operator">&lt;=</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>top<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> y<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">auto</span><span class="token punctuation">[</span>alpha<span class="token punctuation">,</span> beta<span class="token punctuation">,</span> gamma<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">computeBarycentric2D</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> t<span class="token punctuation">.</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// If (x, y) is not inside triangle, continue</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>alpha <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> beta <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> gamma <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">continue</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token comment">// Interpolate z value, color, normal, texcoords, shadingcoords, viewpos</span>            <span class="token keyword">float</span> alpha_corrected <span class="token operator">=</span> alpha <span class="token operator">/</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">w</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">float</span> beta_corrected <span class="token operator">=</span> beta <span class="token operator">/</span> v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">w</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">float</span> gamma_corrected <span class="token operator">=</span> gamma <span class="token operator">/</span> v<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">w</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">float</span> w_reciprocal <span class="token operator">=</span> alpha_corrected <span class="token operator">+</span> beta_corrected <span class="token operator">+</span> gamma_corrected<span class="token punctuation">;</span>            <span class="token keyword">auto</span> z_interpolated <span class="token operator">=</span> <span class="token function">interpolate</span><span class="token punctuation">(</span>alpha_corrected<span class="token punctuation">,</span> beta_corrected<span class="token punctuation">,</span> gamma_corrected<span class="token punctuation">,</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">z</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">z</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> v<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">z</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> w_reciprocal<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">auto</span> color_interpolated <span class="token operator">=</span> <span class="token function">interpolate</span><span class="token punctuation">(</span>alpha_corrected<span class="token punctuation">,</span> beta_corrected<span class="token punctuation">,</span> gamma_corrected<span class="token punctuation">,</span> t<span class="token punctuation">.</span>color<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t<span class="token punctuation">.</span>color<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t<span class="token punctuation">.</span>color<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> w_reciprocal<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">auto</span> normal_interpolated <span class="token operator">=</span> <span class="token function">interpolate</span><span class="token punctuation">(</span>alpha_corrected<span class="token punctuation">,</span> beta_corrected<span class="token punctuation">,</span> gamma_corrected<span class="token punctuation">,</span> t<span class="token punctuation">.</span>normal<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t<span class="token punctuation">.</span>normal<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t<span class="token punctuation">.</span>normal<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> w_reciprocal<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">auto</span> texcoordes_interpolated <span class="token operator">=</span> <span class="token function">interpolate</span><span class="token punctuation">(</span>alpha_corrected<span class="token punctuation">,</span> beta_corrected<span class="token punctuation">,</span> gamma_corrected<span class="token punctuation">,</span> t<span class="token punctuation">.</span>tex_coords<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t<span class="token punctuation">.</span>tex_coords<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t<span class="token punctuation">.</span>tex_coords<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> w_reciprocal<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">auto</span> viewpos_interpolated <span class="token operator">=</span> <span class="token function">interpolate</span><span class="token punctuation">(</span>alpha_corrected<span class="token punctuation">,</span> beta_corrected<span class="token punctuation">,</span> gamma_corrected<span class="token punctuation">,</span> view_pos<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> view_pos<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> view_pos<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> w_reciprocal<span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token comment">// A lower z-value means it is displayed in front</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>z_interpolated <span class="token operator">&lt;</span> depth_buf<span class="token punctuation">[</span>y <span class="token operator">*</span> width <span class="token operator">+</span> x<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                depth_buf<span class="token punctuation">[</span>y <span class="token operator">*</span> width <span class="token operator">+</span> x<span class="token punctuation">]</span> <span class="token operator">=</span> z_interpolated<span class="token punctuation">;</span>                fragment_shader_payload <span class="token function">payload</span><span class="token punctuation">(</span> color_interpolated<span class="token punctuation">,</span> normal_interpolated<span class="token punctuation">,</span> texcoordes_interpolated<span class="token punctuation">,</span> texture <span class="token operator">?</span> <span class="token operator">&amp;</span><span class="token operator">*</span>texture <span class="token operator">:</span> <span class="token keyword">nullptr</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>                payload<span class="token punctuation">.</span>view_pos <span class="token operator">=</span> viewpos_interpolated<span class="token punctuation">;</span>                <span class="token keyword">auto</span> pixel_color <span class="token operator">=</span> <span class="token function">fragment_shader</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token function">set_pixel</span><span class="token punctuation">(</span><span class="token function">Vector2i</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">,</span> pixel_color<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="phong-å’Œ-texture"><a href="#phong-å’Œ-texture" class="headerlink" title="phong å’Œ texture"></a>phong å’Œ texture</h2><p>phong çš„ä»£ç æŒ‰ç€ phong æ¨¡å‹å®ç°å³å¯ã€‚texture çš„ä»£ç å‡ ä¹æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ã€‚</p><p>æˆ‘å”¯ä¸€å¥½å¥‡çš„åœ°æ–¹æ˜¯ä¸ºä»€ä¹ˆæœ«å°¾ä¹˜äº† 255.0fï¼Œéš¾é“å…‰ç…§æ¨¡å‹çš„å„ä¸ªæ•°å€¼å–å€¼éƒ½åœ¨ $(0,1)$ ä¹‹é—´ï¼Ÿä½†çœ‹å…‰å¼ºä¼¼ä¹åˆä¸æ˜¯è¿™æ ·ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Eigen<span class="token double-colon punctuation">::</span>Vector3f <span class="token function">phong_fragment_shader</span><span class="token punctuation">(</span><span class="token keyword">const</span> fragment_shader_payload<span class="token operator">&amp;</span> payload<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    Eigen<span class="token double-colon punctuation">::</span>Vector3f ka <span class="token operator">=</span> <span class="token class-name">Eigen</span><span class="token double-colon punctuation">::</span><span class="token function">Vector3f</span><span class="token punctuation">(</span><span class="token number">0.005</span><span class="token punctuation">,</span> <span class="token number">0.005</span><span class="token punctuation">,</span> <span class="token number">0.005</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Eigen<span class="token double-colon punctuation">::</span>Vector3f kd <span class="token operator">=</span> payload<span class="token punctuation">.</span>color<span class="token punctuation">;</span>    Eigen<span class="token double-colon punctuation">::</span>Vector3f ks <span class="token operator">=</span> <span class="token class-name">Eigen</span><span class="token double-colon punctuation">::</span><span class="token function">Vector3f</span><span class="token punctuation">(</span><span class="token number">0.7937</span><span class="token punctuation">,</span> <span class="token number">0.7937</span><span class="token punctuation">,</span> <span class="token number">0.7937</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">auto</span> l1 <span class="token operator">=</span> light<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token keyword">auto</span> l2 <span class="token operator">=</span> light<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>light<span class="token operator">></span> lights <span class="token operator">=</span> <span class="token punctuation">&#123;</span>l1<span class="token punctuation">,</span> l2<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    Eigen<span class="token double-colon punctuation">::</span>Vector3f amb_light_intensity<span class="token punctuation">&#123;</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    Eigen<span class="token double-colon punctuation">::</span>Vector3f eye_pos<span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token keyword">float</span> p <span class="token operator">=</span> <span class="token number">150</span><span class="token punctuation">;</span>    Eigen<span class="token double-colon punctuation">::</span>Vector3f color <span class="token operator">=</span> payload<span class="token punctuation">.</span>color<span class="token punctuation">;</span>    Eigen<span class="token double-colon punctuation">::</span>Vector3f point <span class="token operator">=</span> payload<span class="token punctuation">.</span>view_pos<span class="token punctuation">;</span>    Eigen<span class="token double-colon punctuation">::</span>Vector3f normal <span class="token operator">=</span> payload<span class="token punctuation">.</span>normal<span class="token punctuation">;</span>    Eigen<span class="token double-colon punctuation">::</span>Vector3f result_color <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    Eigen<span class="token double-colon punctuation">::</span>Vector3f ambient <span class="token operator">=</span> ka<span class="token punctuation">.</span><span class="token function">cwiseProduct</span><span class="token punctuation">(</span>amb_light_intensity<span class="token punctuation">)</span><span class="token punctuation">;</span>    result_color <span class="token operator">+=</span> ambient<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span><span class="token operator">&amp;</span> light <span class="token operator">:</span> lights<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token comment">// TODO: For each light source in the code, calculate what the *ambient*, *diffuse*, and *specular* </span>        <span class="token comment">// components are. Then, accumulate that result on the *result_color* object.</span>        Eigen<span class="token double-colon punctuation">::</span>Vector3f vec_to_light <span class="token operator">=</span> light<span class="token punctuation">.</span>position <span class="token operator">-</span> point<span class="token punctuation">;</span>        Eigen<span class="token double-colon punctuation">::</span>Vector3f diffuse <span class="token operator">=</span> kd<span class="token punctuation">.</span><span class="token function">cwiseProduct</span><span class="token punctuation">(</span>light<span class="token punctuation">.</span>intensity <span class="token operator">/</span> vec_to_light<span class="token punctuation">.</span><span class="token function">squaredNorm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">MAX</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> normal<span class="token punctuation">.</span><span class="token function">normalized</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">dot</span><span class="token punctuation">(</span>vec_to_light<span class="token punctuation">.</span><span class="token function">normalized</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Eigen<span class="token double-colon punctuation">::</span>Vector3f vec_to_eye <span class="token operator">=</span> eye_pos <span class="token operator">-</span> point<span class="token punctuation">;</span>        Eigen<span class="token double-colon punctuation">::</span>Vector3f h <span class="token operator">=</span> vec_to_light<span class="token punctuation">.</span><span class="token function">normalized</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> vec_to_eye<span class="token punctuation">.</span><span class="token function">normalized</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Eigen<span class="token double-colon punctuation">::</span>Vector3f specular <span class="token operator">=</span> ks<span class="token punctuation">.</span><span class="token function">cwiseProduct</span><span class="token punctuation">(</span>light<span class="token punctuation">.</span>intensity <span class="token operator">/</span> vec_to_light<span class="token punctuation">.</span><span class="token function">squaredNorm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">pow</span><span class="token punctuation">(</span><span class="token function">MAX</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> normal<span class="token punctuation">.</span><span class="token function">normalized</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">dot</span><span class="token punctuation">(</span>h<span class="token punctuation">.</span><span class="token function">normalized</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// The ambient component is only added once before the for loop</span>        result_color <span class="token operator">+=</span> <span class="token punctuation">(</span>diffuse <span class="token operator">+</span> specular<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> result_color <span class="token operator">*</span> <span class="token number">255.f</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Eigen<span class="token double-colon punctuation">::</span>Vector3f <span class="token function">texture_fragment_shader</span><span class="token punctuation">(</span><span class="token keyword">const</span> fragment_shader_payload<span class="token operator">&amp;</span> payload<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    Eigen<span class="token double-colon punctuation">::</span>Vector3f texture_color <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>payload<span class="token punctuation">.</span>texture<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token comment">// TODO: Get the texture value at the texture coordinates of the current fragment</span>        texture_color <span class="token operator">=</span> payload<span class="token punctuation">.</span>texture<span class="token operator">-></span><span class="token function">getColor</span><span class="token punctuation">(</span>payload<span class="token punctuation">.</span>tex_coords<span class="token punctuation">.</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> payload<span class="token punctuation">.</span>tex_coords<span class="token punctuation">.</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    Eigen<span class="token double-colon punctuation">::</span>Vector3f ka <span class="token operator">=</span> <span class="token class-name">Eigen</span><span class="token double-colon punctuation">::</span><span class="token function">Vector3f</span><span class="token punctuation">(</span><span class="token number">0.005</span><span class="token punctuation">,</span> <span class="token number">0.005</span><span class="token punctuation">,</span> <span class="token number">0.005</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Eigen<span class="token double-colon punctuation">::</span>Vector3f kd <span class="token operator">=</span> texture_color <span class="token operator">/</span> <span class="token number">255.f</span><span class="token punctuation">;</span>    Eigen<span class="token double-colon punctuation">::</span>Vector3f ks <span class="token operator">=</span> <span class="token class-name">Eigen</span><span class="token double-colon punctuation">::</span><span class="token function">Vector3f</span><span class="token punctuation">(</span><span class="token number">0.7937</span><span class="token punctuation">,</span> <span class="token number">0.7937</span><span class="token punctuation">,</span> <span class="token number">0.7937</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">auto</span> l1 <span class="token operator">=</span> light<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token keyword">auto</span> l2 <span class="token operator">=</span> light<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>light<span class="token operator">></span> lights <span class="token operator">=</span> <span class="token punctuation">&#123;</span>l1<span class="token punctuation">,</span> l2<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    Eigen<span class="token double-colon punctuation">::</span>Vector3f amb_light_intensity<span class="token punctuation">&#123;</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    Eigen<span class="token double-colon punctuation">::</span>Vector3f eye_pos<span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token keyword">float</span> p <span class="token operator">=</span> <span class="token number">150</span><span class="token punctuation">;</span>    Eigen<span class="token double-colon punctuation">::</span>Vector3f color <span class="token operator">=</span> texture_color<span class="token punctuation">;</span>    Eigen<span class="token double-colon punctuation">::</span>Vector3f point <span class="token operator">=</span> payload<span class="token punctuation">.</span>view_pos<span class="token punctuation">;</span>    Eigen<span class="token double-colon punctuation">::</span>Vector3f normal <span class="token operator">=</span> payload<span class="token punctuation">.</span>normal<span class="token punctuation">;</span>    Eigen<span class="token double-colon punctuation">::</span>Vector3f result_color <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    Eigen<span class="token double-colon punctuation">::</span>Vector3f ambient <span class="token operator">=</span> ka<span class="token punctuation">.</span><span class="token function">cwiseProduct</span><span class="token punctuation">(</span>amb_light_intensity<span class="token punctuation">)</span><span class="token punctuation">;</span>    result_color <span class="token operator">+=</span> ambient<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span><span class="token operator">&amp;</span> light <span class="token operator">:</span> lights<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token comment">// TODO: For each light source in the code, calculate what the *ambient*, *diffuse*, and *specular* </span>        <span class="token comment">// components are. Then, accumulate that result on the *result_color* object.</span>        Eigen<span class="token double-colon punctuation">::</span>Vector3f vec_to_light <span class="token operator">=</span> light<span class="token punctuation">.</span>position <span class="token operator">-</span> point<span class="token punctuation">;</span>        Eigen<span class="token double-colon punctuation">::</span>Vector3f diffuse <span class="token operator">=</span> kd<span class="token punctuation">.</span><span class="token function">cwiseProduct</span><span class="token punctuation">(</span>light<span class="token punctuation">.</span>intensity <span class="token operator">/</span> vec_to_light<span class="token punctuation">.</span><span class="token function">squaredNorm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">MAX</span><span class="token punctuation">(</span><span class="token number">0.0f</span><span class="token punctuation">,</span> normal<span class="token punctuation">.</span><span class="token function">normalized</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">dot</span><span class="token punctuation">(</span>vec_to_light<span class="token punctuation">.</span><span class="token function">normalized</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Eigen<span class="token double-colon punctuation">::</span>Vector3f vec_to_eye <span class="token operator">=</span> eye_pos <span class="token operator">-</span> point<span class="token punctuation">;</span>        Eigen<span class="token double-colon punctuation">::</span>Vector3f h <span class="token operator">=</span> vec_to_light<span class="token punctuation">.</span><span class="token function">normalized</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> vec_to_eye<span class="token punctuation">.</span><span class="token function">normalized</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Eigen<span class="token double-colon punctuation">::</span>Vector3f specular <span class="token operator">=</span> ks<span class="token punctuation">.</span><span class="token function">cwiseProduct</span><span class="token punctuation">(</span>light<span class="token punctuation">.</span>intensity <span class="token operator">/</span> vec_to_light<span class="token punctuation">.</span><span class="token function">squaredNorm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">pow</span><span class="token punctuation">(</span><span class="token function">MAX</span><span class="token punctuation">(</span><span class="token number">0.0f</span><span class="token punctuation">,</span> normal<span class="token punctuation">.</span><span class="token function">normalized</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">dot</span><span class="token punctuation">(</span>h<span class="token punctuation">.</span><span class="token function">normalized</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// The ambient component is only added once before the for loop</span>        result_color <span class="token operator">+=</span> <span class="token punctuation">(</span>diffuse <span class="token operator">+</span> specular<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> result_color <span class="token operator">*</span> <span class="token number">255.f</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="bump-å’Œ-displacement"><a href="#bump-å’Œ-displacement" class="headerlink" title="bump å’Œ displacement"></a>bump å’Œ displacement</h2><p>å¦‚å¼€å¤´æ‰€è¨€ï¼Œæœ¬æ¬¡ä½œä¸šå¯¹è¿™ä¸¤ä¸ª shader çš„è¦æ±‚éå¸¸ä¸ä¸¥è°¨ï¼Œæˆ‘ä»¬å°±ç®€å•æ”¾ä¸‹ä»£ç ï¼Œä¸å¤šè§£é‡Šäº†ã€‚åœ¨ä¸€äº›ä¸ä¸¥è°¨çš„åœ°æ–¹æˆ‘å·²ç»å†™äº†æ³¨é‡Šã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Eigen<span class="token double-colon punctuation">::</span>Vector3f <span class="token function">bump_fragment_shader</span><span class="token punctuation">(</span><span class="token keyword">const</span> fragment_shader_payload<span class="token operator">&amp;</span> payload<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        Eigen<span class="token double-colon punctuation">::</span>Vector3f ka <span class="token operator">=</span> <span class="token class-name">Eigen</span><span class="token double-colon punctuation">::</span><span class="token function">Vector3f</span><span class="token punctuation">(</span><span class="token number">0.005</span><span class="token punctuation">,</span> <span class="token number">0.005</span><span class="token punctuation">,</span> <span class="token number">0.005</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Eigen<span class="token double-colon punctuation">::</span>Vector3f kd <span class="token operator">=</span> payload<span class="token punctuation">.</span>color<span class="token punctuation">;</span>    Eigen<span class="token double-colon punctuation">::</span>Vector3f ks <span class="token operator">=</span> <span class="token class-name">Eigen</span><span class="token double-colon punctuation">::</span><span class="token function">Vector3f</span><span class="token punctuation">(</span><span class="token number">0.7937</span><span class="token punctuation">,</span> <span class="token number">0.7937</span><span class="token punctuation">,</span> <span class="token number">0.7937</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">auto</span> l1 <span class="token operator">=</span> light<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token keyword">auto</span> l2 <span class="token operator">=</span> light<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>light<span class="token operator">></span> lights <span class="token operator">=</span> <span class="token punctuation">&#123;</span>l1<span class="token punctuation">,</span> l2<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    Eigen<span class="token double-colon punctuation">::</span>Vector3f amb_light_intensity<span class="token punctuation">&#123;</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    Eigen<span class="token double-colon punctuation">::</span>Vector3f eye_pos<span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token keyword">float</span> p <span class="token operator">=</span> <span class="token number">150</span><span class="token punctuation">;</span>    Eigen<span class="token double-colon punctuation">::</span>Vector3f color <span class="token operator">=</span> payload<span class="token punctuation">.</span>color<span class="token punctuation">;</span>     Eigen<span class="token double-colon punctuation">::</span>Vector3f point <span class="token operator">=</span> payload<span class="token punctuation">.</span>view_pos<span class="token punctuation">;</span>    Eigen<span class="token double-colon punctuation">::</span>Vector3f normal <span class="token operator">=</span> payload<span class="token punctuation">.</span>normal<span class="token punctuation">;</span>    <span class="token keyword">float</span> kh <span class="token operator">=</span> <span class="token number">0.2</span><span class="token punctuation">,</span> kn <span class="token operator">=</span> <span class="token number">0.1</span><span class="token punctuation">;</span>    <span class="token comment">// TODO: Implement bump mapping here</span>    <span class="token comment">// Let n = normal = (x, y, z)</span>    <span class="token comment">// Vector t = (x*y/sqrt(x*x+z*z),sqrt(x*x+z*z),z*y/sqrt(x*x+z*z))</span>    <span class="token comment">// Vector b = n cross product t</span>    <span class="token comment">// Matrix TBN = [t b n]</span>    <span class="token comment">// dU = kh * kn * (h(u+1/w,v)-h(u,v))</span>    <span class="token comment">// dV = kh * kn * (h(u,v+1/h)-h(u,v))</span>    <span class="token comment">// Vector ln = (-dU, -dV, 1)</span>    <span class="token comment">// Normal n = normalize(TBN * ln)</span>    <span class="token comment">// Note: The formula is WRONG in theory</span>    <span class="token comment">// To calculate the TBN matrix correctly, we need the triangle's vertices and their corresponding UV coordinates</span>    <span class="token comment">// read https://learnopengl.com/Advanced-Lighting/Normal-Mapping and </span>    <span class="token comment">// https://terathon.com/blog/tangent-space.html for more details</span>    <span class="token keyword">float</span> x <span class="token operator">=</span> normal<span class="token punctuation">.</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">float</span> y <span class="token operator">=</span> normal<span class="token punctuation">.</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">float</span> z <span class="token operator">=</span> normal<span class="token punctuation">.</span><span class="token function">z</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">float</span> u <span class="token operator">=</span> payload<span class="token punctuation">.</span>tex_coords<span class="token punctuation">.</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">float</span> v <span class="token operator">=</span> payload<span class="token punctuation">.</span>tex_coords<span class="token punctuation">.</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">float</span> w <span class="token operator">=</span> payload<span class="token punctuation">.</span>texture<span class="token operator">-></span>width<span class="token punctuation">;</span>    <span class="token keyword">float</span> h <span class="token operator">=</span> payload<span class="token punctuation">.</span>texture<span class="token operator">-></span>height<span class="token punctuation">;</span>    Eigen<span class="token double-colon punctuation">::</span>Vector3f t <span class="token operator">=</span> <span class="token class-name">Eigen</span><span class="token double-colon punctuation">::</span><span class="token function">Vector3f</span><span class="token punctuation">(</span>x<span class="token operator">*</span>y<span class="token operator">/</span><span class="token function">sqrt</span><span class="token punctuation">(</span>x<span class="token operator">*</span>x<span class="token operator">+</span>z<span class="token operator">*</span>z<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">sqrt</span><span class="token punctuation">(</span>x<span class="token operator">*</span>x<span class="token operator">+</span>z<span class="token operator">*</span>z<span class="token punctuation">)</span><span class="token punctuation">,</span>z<span class="token operator">*</span>y<span class="token operator">/</span><span class="token function">sqrt</span><span class="token punctuation">(</span>x<span class="token operator">*</span>x<span class="token operator">+</span>z<span class="token operator">*</span>z<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Eigen<span class="token double-colon punctuation">::</span>Vector3f b <span class="token operator">=</span> normal<span class="token punctuation">.</span><span class="token function">cross</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>    Eigen<span class="token double-colon punctuation">::</span>Matrix3f TBN<span class="token punctuation">;</span>        TBN <span class="token operator">&lt;&lt;</span> t<span class="token punctuation">,</span> b<span class="token punctuation">,</span> normal<span class="token punctuation">;</span>    <span class="token comment">// In theory the texture should be a grayscale image</span>    <span class="token comment">// However we use an ordinary RGB image here, so we take norm</span>    <span class="token comment">// read https://games-cn.org/forums/topic/frequently-asked-questionskeep-updating/ for more details</span>    <span class="token keyword">float</span> dU <span class="token operator">=</span> kh <span class="token operator">*</span> kn <span class="token operator">*</span> <span class="token punctuation">(</span>payload<span class="token punctuation">.</span>texture<span class="token operator">-></span><span class="token function">getColor</span><span class="token punctuation">(</span>u<span class="token operator">+</span><span class="token number">1.0f</span><span class="token operator">/</span>w<span class="token punctuation">,</span> v<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">norm</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> payload<span class="token punctuation">.</span>texture<span class="token operator">-></span><span class="token function">getColor</span><span class="token punctuation">(</span>u<span class="token punctuation">,</span> v<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">norm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">float</span> dV <span class="token operator">=</span> kh <span class="token operator">*</span> kn <span class="token operator">*</span> <span class="token punctuation">(</span>payload<span class="token punctuation">.</span>texture<span class="token operator">-></span><span class="token function">getColor</span><span class="token punctuation">(</span>u<span class="token punctuation">,</span> v<span class="token operator">+</span><span class="token number">1.0f</span><span class="token operator">/</span>h<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">norm</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> payload<span class="token punctuation">.</span>texture<span class="token operator">-></span><span class="token function">getColor</span><span class="token punctuation">(</span>u<span class="token punctuation">,</span> v<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">norm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Eigen<span class="token double-colon punctuation">::</span>Vector3f ln <span class="token operator">=</span> <span class="token class-name">Eigen</span><span class="token double-colon punctuation">::</span><span class="token function">Vector3f</span><span class="token punctuation">(</span><span class="token operator">-</span>dU<span class="token punctuation">,</span> <span class="token operator">-</span>dV<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    normal <span class="token operator">=</span> <span class="token punctuation">(</span>TBN <span class="token operator">*</span> ln<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">normalized</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Eigen<span class="token double-colon punctuation">::</span>Vector3f result_color <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    result_color <span class="token operator">=</span> normal<span class="token punctuation">;</span>    <span class="token keyword">return</span> result_color <span class="token operator">*</span> <span class="token number">255.f</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Eigen<span class="token double-colon punctuation">::</span>Vector3f <span class="token function">displacement_fragment_shader</span><span class="token punctuation">(</span><span class="token keyword">const</span> fragment_shader_payload<span class="token operator">&amp;</span> payload<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        Eigen<span class="token double-colon punctuation">::</span>Vector3f ka <span class="token operator">=</span> <span class="token class-name">Eigen</span><span class="token double-colon punctuation">::</span><span class="token function">Vector3f</span><span class="token punctuation">(</span><span class="token number">0.005</span><span class="token punctuation">,</span> <span class="token number">0.005</span><span class="token punctuation">,</span> <span class="token number">0.005</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Eigen<span class="token double-colon punctuation">::</span>Vector3f kd <span class="token operator">=</span> payload<span class="token punctuation">.</span>color<span class="token punctuation">;</span>    Eigen<span class="token double-colon punctuation">::</span>Vector3f ks <span class="token operator">=</span> <span class="token class-name">Eigen</span><span class="token double-colon punctuation">::</span><span class="token function">Vector3f</span><span class="token punctuation">(</span><span class="token number">0.7937</span><span class="token punctuation">,</span> <span class="token number">0.7937</span><span class="token punctuation">,</span> <span class="token number">0.7937</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">auto</span> l1 <span class="token operator">=</span> light<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token keyword">auto</span> l2 <span class="token operator">=</span> light<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>light<span class="token operator">></span> lights <span class="token operator">=</span> <span class="token punctuation">&#123;</span>l1<span class="token punctuation">,</span> l2<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    Eigen<span class="token double-colon punctuation">::</span>Vector3f amb_light_intensity<span class="token punctuation">&#123;</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    Eigen<span class="token double-colon punctuation">::</span>Vector3f eye_pos<span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token keyword">float</span> p <span class="token operator">=</span> <span class="token number">150</span><span class="token punctuation">;</span>    Eigen<span class="token double-colon punctuation">::</span>Vector3f color <span class="token operator">=</span> payload<span class="token punctuation">.</span>color<span class="token punctuation">;</span>     Eigen<span class="token double-colon punctuation">::</span>Vector3f point <span class="token operator">=</span> payload<span class="token punctuation">.</span>view_pos<span class="token punctuation">;</span>    Eigen<span class="token double-colon punctuation">::</span>Vector3f normal <span class="token operator">=</span> payload<span class="token punctuation">.</span>normal<span class="token punctuation">;</span>    <span class="token keyword">float</span> kh <span class="token operator">=</span> <span class="token number">0.2</span><span class="token punctuation">,</span> kn <span class="token operator">=</span> <span class="token number">0.1</span><span class="token punctuation">;</span>        <span class="token comment">// TODO: Implement displacement mapping here</span>    <span class="token comment">// Let n = normal = (x, y, z)</span>    <span class="token comment">// Vector t = (x*y/sqrt(x*x+z*z),sqrt(x*x+z*z),z*y/sqrt(x*x+z*z))</span>    <span class="token comment">// Vector b = n cross product t</span>    <span class="token comment">// Matrix TBN = [t b n]</span>    <span class="token comment">// dU = kh * kn * (h(u+1/w,v)-h(u,v))</span>    <span class="token comment">// dV = kh * kn * (h(u,v+1/h)-h(u,v))</span>    <span class="token comment">// Vector ln = (-dU, -dV, 1)</span>    <span class="token comment">// Position p = p + kn * n * h(u,v)</span>    <span class="token comment">// Normal n = normalize(TBN * ln)</span>    <span class="token comment">// Note: The formula is WRONG in theory</span>    <span class="token comment">// When using Displacement Mapping, the points should be offset in the camera space before rasterizing, </span>    <span class="token comment">// instead of only changing its color</span>    <span class="token comment">// read https://learnopengl.com/Advanced-Lighting/Normal-Mapping and </span>    <span class="token comment">// https://terathon.com/blog/tangent-space.html for more details</span>    <span class="token keyword">float</span> x <span class="token operator">=</span> normal<span class="token punctuation">.</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">float</span> y <span class="token operator">=</span> normal<span class="token punctuation">.</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">float</span> z <span class="token operator">=</span> normal<span class="token punctuation">.</span><span class="token function">z</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">float</span> u <span class="token operator">=</span> payload<span class="token punctuation">.</span>tex_coords<span class="token punctuation">.</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">float</span> v <span class="token operator">=</span> payload<span class="token punctuation">.</span>tex_coords<span class="token punctuation">.</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">float</span> w <span class="token operator">=</span> payload<span class="token punctuation">.</span>texture<span class="token operator">-></span>width<span class="token punctuation">;</span>    <span class="token keyword">float</span> h <span class="token operator">=</span> payload<span class="token punctuation">.</span>texture<span class="token operator">-></span>height<span class="token punctuation">;</span>    Eigen<span class="token double-colon punctuation">::</span>Vector3f t <span class="token operator">=</span> <span class="token class-name">Eigen</span><span class="token double-colon punctuation">::</span><span class="token function">Vector3f</span><span class="token punctuation">(</span>x<span class="token operator">*</span>y<span class="token operator">/</span><span class="token function">sqrt</span><span class="token punctuation">(</span>x<span class="token operator">*</span>x<span class="token operator">+</span>z<span class="token operator">*</span>z<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">sqrt</span><span class="token punctuation">(</span>x<span class="token operator">*</span>x<span class="token operator">+</span>z<span class="token operator">*</span>z<span class="token punctuation">)</span><span class="token punctuation">,</span>z<span class="token operator">*</span>y<span class="token operator">/</span><span class="token function">sqrt</span><span class="token punctuation">(</span>x<span class="token operator">*</span>x<span class="token operator">+</span>z<span class="token operator">*</span>z<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Eigen<span class="token double-colon punctuation">::</span>Vector3f b <span class="token operator">=</span> normal<span class="token punctuation">.</span><span class="token function">cross</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>    Eigen<span class="token double-colon punctuation">::</span>Matrix3f TBN<span class="token punctuation">;</span>        TBN <span class="token operator">&lt;&lt;</span> t<span class="token punctuation">,</span> b<span class="token punctuation">,</span> normal<span class="token punctuation">;</span>    <span class="token comment">// In theory the texture should be a grayscale image</span>    <span class="token comment">// However we use an ordinary RGB image here, so we take norm</span>    <span class="token comment">// read https://games-cn.org/forums/topic/frequently-asked-questionskeep-updating/ for more details</span>    <span class="token keyword">float</span> dU <span class="token operator">=</span> kh <span class="token operator">*</span> kn <span class="token operator">*</span> <span class="token punctuation">(</span>payload<span class="token punctuation">.</span>texture<span class="token operator">-></span><span class="token function">getColor</span><span class="token punctuation">(</span>u<span class="token operator">+</span><span class="token number">1.0f</span><span class="token operator">/</span>w<span class="token punctuation">,</span> v<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">norm</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> payload<span class="token punctuation">.</span>texture<span class="token operator">-></span><span class="token function">getColor</span><span class="token punctuation">(</span>u<span class="token punctuation">,</span> v<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">norm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">float</span> dV <span class="token operator">=</span> kh <span class="token operator">*</span> kn <span class="token operator">*</span> <span class="token punctuation">(</span>payload<span class="token punctuation">.</span>texture<span class="token operator">-></span><span class="token function">getColor</span><span class="token punctuation">(</span>u<span class="token punctuation">,</span> v<span class="token operator">+</span><span class="token number">1.0f</span><span class="token operator">/</span>h<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">norm</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> payload<span class="token punctuation">.</span>texture<span class="token operator">-></span><span class="token function">getColor</span><span class="token punctuation">(</span>u<span class="token punctuation">,</span> v<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">norm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Eigen<span class="token double-colon punctuation">::</span>Vector3f ln <span class="token operator">=</span> <span class="token class-name">Eigen</span><span class="token double-colon punctuation">::</span><span class="token function">Vector3f</span><span class="token punctuation">(</span><span class="token operator">-</span>dU<span class="token punctuation">,</span> <span class="token operator">-</span>dV<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// In theory we should bias the point using the original normal</span>    <span class="token comment">// but to match the homework answer, we bias the point using the corrected normal</span>    normal <span class="token operator">=</span> <span class="token punctuation">(</span>TBN <span class="token operator">*</span> ln<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">normalized</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    point <span class="token operator">+=</span> kn <span class="token operator">*</span> normal <span class="token operator">*</span> payload<span class="token punctuation">.</span>texture<span class="token operator">-></span><span class="token function">getColor</span><span class="token punctuation">(</span>u<span class="token punctuation">,</span> v<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">norm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Eigen<span class="token double-colon punctuation">::</span>Vector3f result_color <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    Eigen<span class="token double-colon punctuation">::</span>Vector3f ambient <span class="token operator">=</span> ka<span class="token punctuation">.</span><span class="token function">cwiseProduct</span><span class="token punctuation">(</span>amb_light_intensity<span class="token punctuation">)</span><span class="token punctuation">;</span>    result_color <span class="token operator">+=</span> ambient<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span><span class="token operator">&amp;</span> light <span class="token operator">:</span> lights<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token comment">// TODO: For each light source in the code, calculate what the *ambient*, *diffuse*, and *specular* </span>        <span class="token comment">// components are. Then, accumulate that result on the *result_color* object.</span>        Eigen<span class="token double-colon punctuation">::</span>Vector3f vec_to_light <span class="token operator">=</span> light<span class="token punctuation">.</span>position <span class="token operator">-</span> point<span class="token punctuation">;</span>        Eigen<span class="token double-colon punctuation">::</span>Vector3f diffuse <span class="token operator">=</span> kd<span class="token punctuation">.</span><span class="token function">cwiseProduct</span><span class="token punctuation">(</span>light<span class="token punctuation">.</span>intensity <span class="token operator">/</span> vec_to_light<span class="token punctuation">.</span><span class="token function">squaredNorm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">MAX</span><span class="token punctuation">(</span><span class="token number">0.0f</span><span class="token punctuation">,</span> normal<span class="token punctuation">.</span><span class="token function">normalized</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">dot</span><span class="token punctuation">(</span>vec_to_light<span class="token punctuation">.</span><span class="token function">normalized</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Eigen<span class="token double-colon punctuation">::</span>Vector3f vec_to_eye <span class="token operator">=</span> eye_pos <span class="token operator">-</span> point<span class="token punctuation">;</span>        Eigen<span class="token double-colon punctuation">::</span>Vector3f h <span class="token operator">=</span> vec_to_light<span class="token punctuation">.</span><span class="token function">normalized</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> vec_to_eye<span class="token punctuation">.</span><span class="token function">normalized</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Eigen<span class="token double-colon punctuation">::</span>Vector3f specular <span class="token operator">=</span> ks<span class="token punctuation">.</span><span class="token function">cwiseProduct</span><span class="token punctuation">(</span>light<span class="token punctuation">.</span>intensity <span class="token operator">/</span> vec_to_light<span class="token punctuation">.</span><span class="token function">squaredNorm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">pow</span><span class="token punctuation">(</span><span class="token function">MAX</span><span class="token punctuation">(</span><span class="token number">0.0f</span><span class="token punctuation">,</span> normal<span class="token punctuation">.</span><span class="token function">normalized</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">dot</span><span class="token punctuation">(</span>h<span class="token punctuation">.</span><span class="token function">normalized</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// The ambient component is only added once before the for loop</span>        result_color <span class="token operator">+=</span> <span class="token punctuation">(</span>diffuse <span class="token operator">+</span> specular<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> result_color <span class="token operator">*</span> <span class="token number">255.f</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æœ¬æ¬¡ä½œä¸šå¯¹ bump_fragment_shaderã€displacement_fragment_shader çš„è¦æ±‚éå¸¸ä¸ä¸¥è°¨ï¼Œè‡³å°‘åŒ…æ‹¬è¿™äº›é—®é¢˜ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è¿™ä¸¤ä¸ª shdaer éœ€è¦çš„è´´å›¾æ˜¯å‡¹å‡¸è´´å›¾ï¼Œå‡¹å‡¸è´´å›¾æœ¬åº”è¯¥æ˜¯ç°åº¦å›¾ï¼Œè¿™é‡Œä½¿ç”¨ RGB è´´å›¾ã€‚&lt;/l</summary>
      
    
    
    
    <category term="å…¬å¼€è¯¾" scheme="http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/"/>
    
    <category term="GAMES101" scheme="http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/"/>
    
    <category term="Assignments" scheme="http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/Assignments/"/>
    
    
  </entry>
  
  <entry>
    <title>Assignment 2 Rasterizing</title>
    <link href="http://rinevard.github.io/wiki/learning/open-course/GAMES101/Hw/Hw2-rasterizing/"/>
    <id>http://rinevard.github.io/wiki/learning/open-course/GAMES101/Hw/Hw2-rasterizing/</id>
    <published>2025-08-26T12:15:16.000Z</published>
    <updated>2025-08-26T12:21:11.482Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬æ¬¡ä½œä¸šè¦æ±‚æˆ‘ä»¬å®ç° Z-buffer ã€æ …æ ¼åŒ–å’Œ SSAAï¼ˆä¹Ÿå°±æ˜¯è¶…é‡‡æ ·ï¼‰ã€‚æˆ‘ä»¬å…ˆçœ‹çœ‹å‰ä¸¤ä¸ªä¸œè¥¿ï¼Œå†çœ‹çœ‹ SSAAã€‚</p><h1 id="Z-bufferå’Œæ …æ ¼åŒ–"><a href="#Z-bufferå’Œæ …æ ¼åŒ–" class="headerlink" title="Z-bufferå’Œæ …æ ¼åŒ–"></a>Z-bufferå’Œæ …æ ¼åŒ–</h1><h2 id="ä»£ç æ¡†æ¶"><a href="#ä»£ç æ¡†æ¶" class="headerlink" title="ä»£ç æ¡†æ¶"></a>ä»£ç æ¡†æ¶</h2><p>æˆ‘ä»¬è¦è¡¥å…¨çš„ <code>rasterize_triangle</code> å‡½æ•°åœ¨ <code>draw</code> å‡½æ•°å†…è¢«è°ƒç”¨ï¼Œå¯ä»¥çœ‹åˆ° <code>draw</code> å‡½æ•°å·²ç»åšå¥½äº†ä¸‰è§’å½¢çš„æŠ•å½±å˜æ¢ï¼Œæˆ‘ä»¬åªè¦æŠŠ $[0, \text{width}] \times [0,\text{height}] \times [n,f]$ é‡Œçš„ä¸‰è§’å½¢æ¸²æŸ“åˆ°å±å¹•ä¸Šå°±å¥½ã€‚è¾“å…¥çš„ä¸‰è§’å½¢å¤§æ¦‚å½¢å¦‚è¿™æ ·ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>input triangle<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token number">529.259</span>    <span class="token number">350</span><span class="token number">49.3857</span>      <span class="token number">1</span><span class="token operator">--</span>    <span class="token number">350</span><span class="token number">529.259</span><span class="token number">49.3857</span>      <span class="token number">1</span><span class="token operator">--</span><span class="token number">170.741</span>    <span class="token number">350</span><span class="token number">49.3857</span>      <span class="token number">1</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="insideTriangle-å‡½æ•°"><a href="#insideTriangle-å‡½æ•°" class="headerlink" title="insideTriangle å‡½æ•°"></a>insideTriangle å‡½æ•°</h2><p>ç”¨è¯¾ä¸Šè®²çš„å‰ä¹˜æ³•åˆ¤æ–­ç‚¹æ˜¯å¦åœ¨ä¸‰è§’å½¢å†…ã€‚â€œåœ¨ä¸‰è§’å½¢å†…â€è¿™ä¸ªè¯´æ³•ä¹Ÿä¸æ˜¯ç‰¹åˆ«ä¸¥è°¨ï¼Œæ›´å‡†ç¡®åœ°è¯´åº”è¯¥æ˜¯åˆ¤æ–­ä¸‰è§’å½¢åœ¨å±å¹•ä¸Šçš„äºŒç»´æŠ•å½±æ˜¯å¦åŒ…å«è¿™ä¸ªç‚¹ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">/*    Return whether (x, y) is in the triangle, ignoring its z value.*/</span><span class="token keyword">static</span> <span class="token keyword">bool</span> <span class="token function">insideTriangle</span><span class="token punctuation">(</span><span class="token keyword">float</span> x<span class="token punctuation">,</span> <span class="token keyword">float</span> y<span class="token punctuation">,</span> <span class="token keyword">const</span> std<span class="token double-colon punctuation">::</span>array<span class="token operator">&lt;</span>Vector4f<span class="token punctuation">,</span> <span class="token number">3</span><span class="token operator">></span><span class="token operator">&amp;</span> triangle<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    Vector2f point1 <span class="token operator">=</span> <span class="token punctuation">&#123;</span>triangle<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> triangle<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    Vector2f point2 <span class="token operator">=</span> <span class="token punctuation">&#123;</span>triangle<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> triangle<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    Vector2f point3 <span class="token operator">=</span> <span class="token punctuation">&#123;</span>triangle<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> triangle<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    Vector2f checked_point <span class="token operator">=</span> <span class="token punctuation">&#123;</span>x<span class="token punctuation">,</span> y<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>        <span class="token keyword">auto</span> cross_product <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">const</span> Vector2f<span class="token operator">&amp;</span> v1<span class="token punctuation">,</span> <span class="token keyword">const</span> Vector2f<span class="token operator">&amp;</span> v2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> v1<span class="token punctuation">.</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> v2<span class="token punctuation">.</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> v1<span class="token punctuation">.</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> v2<span class="token punctuation">.</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token keyword">float</span> side1 <span class="token operator">=</span> <span class="token function">cross_product</span><span class="token punctuation">(</span>point1 <span class="token operator">-</span> checked_point<span class="token punctuation">,</span> point1 <span class="token operator">-</span> point2<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">float</span> side2 <span class="token operator">=</span> <span class="token function">cross_product</span><span class="token punctuation">(</span>point2 <span class="token operator">-</span> checked_point<span class="token punctuation">,</span> point2 <span class="token operator">-</span> point3<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">float</span> side3 <span class="token operator">=</span> <span class="token function">cross_product</span><span class="token punctuation">(</span>point3 <span class="token operator">-</span> checked_point<span class="token punctuation">,</span> point3 <span class="token operator">-</span> point1<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>side1 <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> side2 <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> side3 <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>side1 <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> side2 <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> side3 <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="rasterize-triangle-å‡½æ•°"><a href="#rasterize-triangle-å‡½æ•°" class="headerlink" title="rasterize_triangle å‡½æ•°"></a>rasterize_triangle å‡½æ•°</h2><p>è¿™ä¸ªå®ç°å¥½åƒæ²¡ä»€ä¹ˆç‰¹åˆ«å€¼å¾—è¯´çš„åœ°æ–¹ï¼Œç®€ç®€å•å•é‡‡é‡‡æ ·ï¼Œç„¶åç”¨ <code>depth_buf</code> å®ç° z-buffer å°±å¥½ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">//Screen space rasterization</span><span class="token keyword">void</span> rst<span class="token double-colon punctuation">::</span>rasterizer<span class="token double-colon punctuation">::</span><span class="token function">rasterize_triangle</span><span class="token punctuation">(</span><span class="token keyword">const</span> Triangle<span class="token operator">&amp;</span> t<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">auto</span> v <span class="token operator">=</span> t<span class="token punctuation">.</span><span class="token function">toVector4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// Find bounding box</span>    <span class="token keyword">float</span> left <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">float</span> right <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">float</span> bottom <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">float</span> top <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span><span class="token operator">&amp;</span> vec<span class="token operator">:</span> v<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        left <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span><span class="token function">min</span><span class="token punctuation">(</span>left<span class="token punctuation">,</span> vec<span class="token punctuation">.</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        right <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span><span class="token function">max</span><span class="token punctuation">(</span>right<span class="token punctuation">,</span> vec<span class="token punctuation">.</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        bottom <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span><span class="token function">min</span><span class="token punctuation">(</span>bottom<span class="token punctuation">,</span> vec<span class="token punctuation">.</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        top <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span><span class="token function">max</span><span class="token punctuation">(</span>top<span class="token punctuation">,</span> vec<span class="token punctuation">.</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// Update pixels in bounding box</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>left<span class="token punctuation">)</span><span class="token punctuation">;</span> x <span class="token operator">&lt;=</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>right<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> x<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> y <span class="token operator">=</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>bottom<span class="token punctuation">)</span><span class="token punctuation">;</span> y <span class="token operator">&lt;=</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>top<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> y<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">insideTriangle</span><span class="token punctuation">(</span>x<span class="token operator">+</span><span class="token number">0.5</span><span class="token punctuation">,</span> y<span class="token operator">+</span><span class="token number">0.5</span><span class="token punctuation">,</span> v<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">continue</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token comment">// Interpolate z value </span>            <span class="token keyword">auto</span><span class="token punctuation">[</span>alpha<span class="token punctuation">,</span> beta<span class="token punctuation">,</span> gamma<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">computeBarycentric2D</span><span class="token punctuation">(</span>x<span class="token operator">+</span><span class="token number">0.5</span><span class="token punctuation">,</span> y<span class="token operator">+</span><span class="token number">0.5</span><span class="token punctuation">,</span> t<span class="token punctuation">.</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">float</span> w_reciprocal <span class="token operator">=</span> <span class="token number">1.0</span><span class="token operator">/</span><span class="token punctuation">(</span>alpha <span class="token operator">/</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">w</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> beta <span class="token operator">/</span> v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">w</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> gamma <span class="token operator">/</span> v<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">w</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">float</span> z_interpolated <span class="token operator">=</span> alpha <span class="token operator">*</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">z</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">w</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> beta <span class="token operator">*</span> v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">z</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">w</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> gamma <span class="token operator">*</span> v<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">z</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> v<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">w</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            z_interpolated <span class="token operator">*=</span> w_reciprocal<span class="token punctuation">;</span>            <span class="token comment">// A lower z-value means it is displayed in front</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>z_interpolated <span class="token operator">&lt;</span> depth_buf<span class="token punctuation">[</span>y <span class="token operator">*</span> width <span class="token operator">+</span> x<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                depth_buf<span class="token punctuation">[</span>y <span class="token operator">*</span> width <span class="token operator">+</span> x<span class="token punctuation">]</span> <span class="token operator">=</span> z_interpolated<span class="token punctuation">;</span>                <span class="token function">set_pixel</span><span class="token punctuation">(</span><span class="token function">Vector3f</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z_interpolated<span class="token punctuation">)</span><span class="token punctuation">,</span> t<span class="token punctuation">.</span><span class="token function">getColor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="SSAAçš„å®ç°"><a href="#SSAAçš„å®ç°" class="headerlink" title="SSAAçš„å®ç°"></a>SSAAçš„å®ç°</h1><p>SSAA çš„å®ç°ç›¸è¾ƒè€Œè¨€æ›´å›°éš¾ä¸€äº›ï¼Œç”±äºæ‚ä¸ƒæ‚å…«è¦æ”¹çš„åœ°æ–¹æ¯”è¾ƒå¤šï¼Œæˆ‘å°±å…ˆè¯´ä¸‹å¤§è‡´æ€è·¯ï¼Œå†èŠèŠå’±è¸©çš„ä¸¤ä¸ªå‘ã€‚</p><p>ä¸è¿‡åœ¨æ­¤ä¹‹å‰ï¼Œå…ˆæ¥çœ‹çœ‹æˆ‘ä»¬çš„æˆæœå§ï¼ï¼ˆè¿™æ˜¯åŠ¨å›¾</p><p><img src="/images/learning/open-course/GAMES101/Assignments/hw2/new-vs-orig.gif" alt=""></p><h2 id="å¤§è‡´æ€è·¯"><a href="#å¤§è‡´æ€è·¯" class="headerlink" title="å¤§è‡´æ€è·¯"></a>å¤§è‡´æ€è·¯</h2><p>æˆ‘ä»¬è¦å…ˆæŠŠæ‰€æœ‰å†…å®¹æ¸²æŸ“åˆ°å¤§å°ä¸º $(\text{width} * 2, \text{height} * 2<br>)$ çš„è‡ªå®šä¹‰ buffer é‡Œï¼Œå†æ ¹æ®è‡ªå®šä¹‰ buffer çš„å†…å®¹å¡«å……å±å¹•ä¸Šçš„åƒç´ ã€‚</p><p>è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬ä¸èƒ½ç›´æ¥åœ¨ <code>rasterize_triangle</code> é‡ŒæŠŠä¸‰è§’å½¢ç”»åˆ°å±å¹•ä¸Šï¼ˆå…·ä½“åŸå› è§â€œè¸©å‘1â€é‚£ä¸€èŠ‚ï¼‰ï¼Œè€Œæ˜¯è¦åœ¨ <code>rasterize_triangle</code> ä¸­æŠŠä¸‰è§’å½¢ç”»åˆ°è‡ªå®šä¹‰çš„ buffer é‡Œï¼Œå†æ–°å¢ä¸€ä¸ª <code>resolve</code> å‡½æ•°å¹¶æŠŠå®ƒæ”¾åˆ° draw çš„æœ€åï¼Œä»è€ŒæŠŠè‡ªå®šä¹‰ buffer é‡Œçš„å†…å®¹ç”»åˆ°å±å¹•ä¸Šï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">void</span> rst<span class="token double-colon punctuation">::</span>rasterizer<span class="token double-colon punctuation">::</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> y <span class="token operator">&lt;</span> height<span class="token punctuation">;</span> y<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> x <span class="token operator">&lt;</span> width<span class="token punctuation">;</span> x<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            frame_buf<span class="token punctuation">[</span>y <span class="token operator">*</span> width <span class="token operator">+</span> x<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token class-name">Vector3f</span><span class="token double-colon punctuation">::</span><span class="token function">Zero</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                frame_buf<span class="token punctuation">[</span>y <span class="token operator">*</span> width <span class="token operator">+</span> x<span class="token punctuation">]</span> <span class="token operator">+=</span> ssaa_frame_buf<span class="token punctuation">[</span><span class="token punctuation">(</span>y <span class="token operator">*</span> width <span class="token operator">+</span> x<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">+</span> i<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            frame_buf<span class="token punctuation">[</span>y <span class="token operator">*</span> width <span class="token operator">+</span> x<span class="token punctuation">]</span> <span class="token operator">/=</span> <span class="token number">4.0</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ›´ç»†èŠ‚ä¸€äº›çš„è¯ï¼Œæˆ‘ä»¬éœ€è¦åšè¿™äº›å·¥ä½œï¼š</p><ol><li>åœ¨ rasterizer.hpp é‡ŒåŠ å…¥ ssaa_frame_buf å’Œ resolve çš„å®šä¹‰ã€‚</li><li>ä¿®æ”¹ rasterizer çš„åˆå§‹åŒ–å‡½æ•°å’Œ clear å‡½æ•°ï¼Œæ­£ç¡®åˆå§‹åŒ–å’Œé‡ç½® ssaa_frame_bufã€‚</li><li>ä¿®æ”¹ set_pixel å‡½æ•°ï¼Œè®©å®ƒæŠŠå†…å®¹ç”»åˆ° ssaa_frame_buf é‡Œï¼Œè€Œé frame_buf é‡Œã€‚</li><li>ä¿®æ”¹ rasterize_triangleï¼Œè®©å®ƒç”¨ä½¿ç”¨æ›´é«˜çš„é‡‡æ ·ç‡ã€‚</li><li>å®ç° resolve å‡½æ•°ã€‚</li></ol><p>æ‚ä¸ƒæ‚å…«è¦æ”¹çš„åœ°æ–¹æ¯”è¾ƒå¤šï¼Œè¿™é‡Œå°±ä¸æ”¾æ›´å¤šä»£ç äº†ã€‚</p><h2 id="è¸©å‘1"><a href="#è¸©å‘1" class="headerlink" title="è¸©å‘1"></a>è¸©å‘1</h2><p>SSAAã€filtering éƒ½å»ºç«‹åœ¨â€œæˆ‘ä»¬å¯¹ç†æƒ³å›¾åƒè¿›è¡Œæ»¤æ³¢â€çš„åŸºç¡€ä¸Šã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¦å…ˆæŠŠä¸–ç•Œé‡Œçš„å¯¹è±¡æŒ‰æ­£ç¡®çš„å‰åé¡ºåºå˜ä¸ºä¸€ä¸ªäºŒç»´å›¾åƒï¼Œç„¶åå†æ»¤æ³¢ã€‚æ‰€ä»¥ç›´æ¥åœ¨ <code>rasterize_triangle</code> é‡ŒæŠŠåƒç´ åˆ’åˆ†æˆå­åƒç´ ç„¶åå–å¹³å‡å¹¶ä¸èƒ½å®ç° SSAAï¼Œè€Œæ˜¯ä¼šåœ¨ä¸‰è§’å½¢é‡å çš„åœ°æ–¹æ˜¾ç¤ºå‡ºé»‘è¾¹ã€‚</p><p><img src="/images/learning/open-course/GAMES101/Assignments/hw2/black-ssaa.png" alt=""></p><p>è®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªå…·ä½“ä¾‹å­ã€‚è€ƒè™‘ä¸€ä¸ª 1/4 è¢«ç»¿è‰²ä¸‰è§’å½¢å æ®ã€3/4 è¢«è“è‰²ä¸‰è§’å½¢å æ®çš„åƒç´ ï¼ŒSSAA ä¼šæŠŠ 1/4 ç»¿ + 3/4 è“ ä½œä¸ºè¿™ä¸ªåƒç´ çš„é¢œè‰²ã€‚</p><p>è€Œå¦‚æœç›´æ¥åœ¨ <code>rasterize_triangle</code> é‡ŒæŠŠåƒç´ åˆ’åˆ†æˆå­åƒç´ ç„¶åå–å¹³å‡ï¼Œé‚£ä¹ˆæ …æ ¼åŒ–è“è‰²ä¸‰è§’å½¢æ—¶ï¼Œè¿™ä¸ªåƒç´ è¢«å½“æˆ 3/4 è“ï¼›æ …æ ¼åŒ–ç»¿è‰²ä¸‰è§’å½¢æ—¶ï¼Œè¿™ä¸ªåƒç´ è¢«å½“æˆ 1/4 ç»¿ã€‚æ— è®ºè°åœ¨å‰é¢ï¼Œæœ€ç»ˆç»“æœè¦ä¹ˆæ˜¯ 3/4 è“ï¼Œè¦ä¹ˆæ˜¯ 1/4 ç»¿ï¼Œæ€»ä¸ SSAA çš„ç»“æœ 1/4 ç»¿ + 3/4 è“ ä¸åŒã€‚</p><h2 id="è¸©å‘2"><a href="#è¸©å‘2" class="headerlink" title="è¸©å‘2"></a>è¸©å‘2</h2><p><code>insideTriangle</code> çš„å‚æ•° x å’Œ y çš„ç±»å‹åŸæœ¬æ˜¯ intï¼Œè€Œåœ¨ SSAA é‡Œæˆ‘ä»¬æŠŠåƒç´ åˆ’åˆ†æˆäº†å››ä¸ªå­åƒç´ ï¼Œè¿™äº›å­åƒç´ çš„åæ ‡å¤§å¤šä¸æ˜¯æ•´æ•°ã€‚å› æ­¤æˆ‘ä»¬è¦æŠŠ <code>insideTriangle</code> çš„ x å’Œ y çš„ç±»å‹æ”¹æˆ float. </p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">static</span> <span class="token keyword">bool</span> <span class="token function">insideTriangle</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">,</span> <span class="token keyword">const</span> Vector3f<span class="token operator">*</span> _v<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>       <span class="token comment">// TODO : Implement this function to check if the point (x, y) is inside the triangle represented by _v[0], _v[1], _v[2]</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æœ¬æ¬¡ä½œä¸šè¦æ±‚æˆ‘ä»¬å®ç° Z-buffer ã€æ …æ ¼åŒ–å’Œ SSAAï¼ˆä¹Ÿå°±æ˜¯è¶…é‡‡æ ·ï¼‰ã€‚æˆ‘ä»¬å…ˆçœ‹çœ‹å‰ä¸¤ä¸ªä¸œè¥¿ï¼Œå†çœ‹çœ‹ SSAAã€‚&lt;/p&gt;
&lt;h1 id=&quot;Z-bufferå’Œæ …æ ¼åŒ–&quot;&gt;&lt;a href=&quot;#Z-bufferå’Œæ …æ ¼åŒ–&quot; class=&quot;headerlink&quot; title=&quot;Z</summary>
      
    
    
    
    <category term="å…¬å¼€è¯¾" scheme="http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/"/>
    
    <category term="GAMES101" scheme="http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/"/>
    
    <category term="Assignments" scheme="http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/Assignments/"/>
    
    
  </entry>
  
  <entry>
    <title>Note 2 Rasterizing</title>
    <link href="http://rinevard.github.io/wiki/learning/open-course/GAMES101/Notes/Note2-Rasterizing/"/>
    <id>http://rinevard.github.io/wiki/learning/open-course/GAMES101/Notes/Note2-Rasterizing/</id>
    <published>2025-08-25T08:10:28.000Z</published>
    <updated>2025-09-23T07:19:39.089Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨ Transformation éƒ¨åˆ†ï¼Œæˆ‘ä»¬å·²ç»å¯ä»¥æŠŠä¸€ä¸ªä¸‰ç»´ç©ºé—´é‡Œçš„ä¸‰è§’å½¢æŠ•å½±åˆ°å¹³é¢ä¸Šã€‚ä½†æ€ä¹ˆæŠŠä¸€ä¸ªçº¯è‰²ä¸‰è§’å½¢ç»˜åˆ¶åˆ°å±å¹•ä¸Šå‘¢ï¼Ÿæˆ‘ä»¬çŸ¥é“å±å¹•ç”±å¤§é‡çš„åƒç´ ç‚¹ç»„æˆï¼Œé‚£ä¹ˆæ€ä¹ˆç¡®å®šæ¯ä¸ªåƒç´ ç‚¹æ˜¯ä»€ä¹ˆé¢œè‰²å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬é€šè¿‡é‡‡æ ·ç»™æ¯ä¸ªåƒç´ ç‚¹æ¶‚ä¸Šé¢œè‰²ã€‚æˆ‘ä»¬å¯ä»¥æ£€æŸ¥æ¯ä¸ªåƒç´ çš„ä¸­å¿ƒç‚¹æ˜¯å¦åœ¨è¿™ä¸ªä¸‰è§’å½¢å†…éƒ¨ï¼Œå¦‚æœåœ¨åˆ™æ¶‚ä¸Šä¸‰è§’å½¢çš„é¢œè‰²ã€‚è™½ç„¶è¿™æ ·ç»˜åˆ¶çš„ä¸‰è§’å½¢ä¼šæœ‰é”¯é½¿ï¼Œæ•ˆæœä¸€èˆ¬ï¼Œä½†åŸºæœ¬æ€æƒ³å°±æ˜¯è¿™æ ·ã€‚</p><p>é‚£ä¹ˆå¦‚æœæœ‰å¤šä¸ªä¸‰è§’å½¢ï¼Œè€Œä¸”ä»–ä»¬ä¹‹é—´æœ‰é®æŒ¡å…³ç³»å‘¢ï¼Ÿè¿™å°±éœ€è¦ Z-Buffer å‡ºåœºäº†ã€‚</p><h1 id="Z-Buffer"><a href="#Z-Buffer" class="headerlink" title="Z-Buffer"></a>Z-Buffer</h1><p>Z-Buffer çš„ç®—æ³•å¦‚ä¸‹é¢çš„ä¼ªä»£ç æ‰€ç¤ºã€‚æ€è·¯æ˜¯å¯¹æ¯ä¸ªåƒç´ æ‰€åœ¨çš„æ‰€æœ‰ä¸‰è§’å½¢ï¼Œå– z å€¼æœ€å°çš„ä¸‰è§’å½¢çš„é¢œè‰²ä½œä¸ºè¿™ä¸ªåƒç´ çš„é¢œè‰²ã€‚</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name">Triangle</span> triangle <span class="token keyword">in</span> triangles<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name">Vector3</span> sample <span class="token keyword">in</span> triangle<span class="token punctuation">.</span><span class="token function">GetSamples</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// z å€¼è¶Šå°æ˜¾ç¤ºè¶Šé å‰</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>sample<span class="token punctuation">.</span>z <span class="token operator">&lt;</span> zBuffer<span class="token punctuation">[</span>sample<span class="token punctuation">.</span>x<span class="token punctuation">,</span> sample<span class="token punctuation">.</span>y<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            frameBuffer<span class="token punctuation">[</span>sample<span class="token punctuation">.</span>x<span class="token punctuation">,</span> sample<span class="token punctuation">.</span>y<span class="token punctuation">]</span> <span class="token operator">=</span> sample<span class="token punctuation">.</span>rgb<span class="token punctuation">;</span>            zBuffer<span class="token punctuation">[</span>sample<span class="token punctuation">.</span>x<span class="token punctuation">,</span> sample<span class="token punctuation">.</span>y<span class="token punctuation">]</span> <span class="token operator">=</span> sample<span class="token punctuation">.</span>z<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ä¹Ÿæœ‰è‰¯å¥½çš„å¹¶è¡Œæ€§ï¼Œå› ä¸ºä¸‰è§’å½¢çš„éå†é¡ºåºå’Œæœ€ç»ˆç»“æœæ— å…³ï¼Œåƒç´ çš„ç»˜åˆ¶é¡ºåºä¹Ÿå’Œæœ€ç»ˆç»“æœæ— å…³ã€‚</p><p>è™ä¹¦è¿˜æåˆ°æˆ‘ä»¬ä¼šå°† $z$ å€¼æ˜ å°„åˆ° $[0, B-1]$ï¼Œç”¨æ•´æ•°å­˜å‚¨ $z$ å€¼ï¼Œä½†å…¶å®è¿™æ˜¯ç°åœ¨ä¸å†ä½¿ç”¨çš„æ–¹æ³•ï¼Œæˆ‘ä»¬ç°åœ¨é€šå¸¸ä½¿ç”¨ 24 ä½æˆ– 32 ä½çš„æµ®ç‚¹æ•°æ¥å­˜å‚¨æ·±åº¦å€¼ã€‚ï¼ˆæ€ªä¸å¾—æˆ‘æŸ¥äº†å¥½ä¹…èµ„æ–™éƒ½æ²¡æŸ¥åˆ°â€œæ•´æ•°æ˜ å°„â€çš„å…·ä½“ä»£ç ï¼ŒåŸæ¥æ—©å°±ä¸ç”¨äº†ï¼ï¼ï¼ï¼‰</p><h1 id="èµ°æ ·ç°è±¡"><a href="#èµ°æ ·ç°è±¡" class="headerlink" title="èµ°æ ·ç°è±¡"></a>èµ°æ ·ç°è±¡</h1><p>æˆ‘ä»¬ä¹‹å‰è¯´è¿‡ï¼Œç®€å•çš„é‡‡æ ·ä¼šå‡ºç°é”¯é½¿ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src="/images/learning/open-course/GAMES101/Notes/note2/jaggies.png" alt=""></p><p>é”¯é½¿ã€æ‘©å°”çº¹ä¹‹ç±»çš„é‡‡æ ·å›¾åƒä¸åŸå›¾ä¸ç¬¦çš„ç°è±¡è¢«ç»Ÿç§°ä¸ºèµ°æ ·ï¼ˆAliasingï¼‰ç°è±¡ï¼Œèµ°æ ·çš„å®è´¨æ˜¯åŸå›¾çš„é«˜é¢‘ä¿¡å·è¢«é”™è¯¯é‡‡æ ·ã€‚ä¸ºäº†æ˜ç¡®ä»€ä¹ˆæ˜¯â€é«˜é¢‘ä¿¡å·â€å¹¶æ‰¾åˆ°ç¼“è§£èµ°æ ·ç°è±¡çš„æ–¹æ³•ï¼Œæˆ‘ä»¬å…ˆçœ‹çœ‹ä¸€äº›æ•°å­¦çŸ¥è¯†ã€‚</p><h1 id="æ•°å­¦çŸ¥è¯†"><a href="#æ•°å­¦çŸ¥è¯†" class="headerlink" title="æ•°å­¦çŸ¥è¯†"></a>æ•°å­¦çŸ¥è¯†</h1><p>ä¸ºäº†ä¸è®©æ–‡ç« å¤ªé•¿ï¼Œè¿™é‡Œæˆ‘ä»¬çœç•¥æ‰€æœ‰çš„è¯æ˜ã€‚ä¸è¿‡æ‰€æœ‰çš„è¯æ˜éƒ½å¹¶ä¸å›°éš¾ï¼Œæœ‰ç©ºçš„è¯å¯ä»¥è‡ªå·±è¯ä¸€ä¸‹è¯•è¯•ã€‚åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ä»¬ä¼šé—®ï¼šè¿™äº›æ•°å­¦çŸ¥è¯†æœ‰ç”¨å—ï¼Ÿ</p><blockquote><p>In a word, mostly no, sometimes yes, and occasionally, maybe.<br>â€” <a href="https://www.dgp.toronto.edu/public_user/elf/2522/sampling.pdf">https://www.dgp.toronto.edu/public_user/elf/2522/sampling.pdf</a></p></blockquote><h2 id="å·ç§¯"><a href="#å·ç§¯" class="headerlink" title="å·ç§¯"></a>å·ç§¯</h2><p>æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ä¸‰ç§å·ç§¯â€”â€”ç¦»æ•£-ç¦»æ•£å·ç§¯ã€è¿ç»­-è¿ç»­å·ç§¯ã€ç¦»æ•£-è¿ç»­å·ç§¯ã€‚ä¸‹é¢çš„ $f_{\rightarrow t}$ è¡¨ç¤ºå°†å‡½æ•° $f$ å‘å³å¹³ç§» $t$ é•¿åº¦å¾—åˆ°çš„æ–°å‡½æ•°ï¼š</p><p>ç¦»æ•£-ç¦»æ•£å·ç§¯</p><script type="math/tex; mode=display">\begin{align*}&(a*b)[i]=\sum_{j}a[j]b[i-j]\\&(a*b)=\sum_{j}a[j]b_{\rightarrow j}\end{align*}</script><p>è¿ç»­-è¿ç»­å·ç§¯</p><script type="math/tex; mode=display">\begin{align*}&(f*g)(x)=\int_{-\infty}^{\infty}f(t)g(x-t)dt\\&(f*g)=\int_{-\infty}^{\infty}f(t)g_{\rightarrow t}dt\end{align*}</script><p>ç¦»æ•£-è¿ç»­å·ç§¯</p><script type="math/tex; mode=display">\begin{align*}&(a*f)(x)=\sum_{i}a[i]f(x-i)\\&(a*f)=\sum_{i}a[i]f_{\rightarrow i}\end{align*}</script><p>æˆ‘ä»¬ä¼šæ³¨æ„åˆ°ï¼Œå·ç§¯å¯ä»¥è¡¨ç¤ºä¸ºå‡½æ•°å¹³ç§»åçš„åŠ æƒå’Œã€‚</p><p><img src="/images/learning/open-course/GAMES101/Notes/note2/convlution.png" alt=""></p><p>å·ç§¯æ˜¯è¿‡ä¼šå„¿ä¼šç”¨åˆ°çš„å¦™å¦™å°å·¥å…·ã€‚</p><h2 id="å‚…é‡Œå¶çº§æ•°å’Œå‚…é‡Œå¶å˜æ¢"><a href="#å‚…é‡Œå¶çº§æ•°å’Œå‚…é‡Œå¶å˜æ¢" class="headerlink" title="å‚…é‡Œå¶çº§æ•°å’Œå‚…é‡Œå¶å˜æ¢"></a>å‚…é‡Œå¶çº§æ•°å’Œå‚…é‡Œå¶å˜æ¢</h2><p>æˆ‘ä»¬ä¹‹å‰æåˆ°ï¼Œèµ°æ ·çš„å®è´¨æ˜¯åŸå›¾çš„é«˜é¢‘ä¿¡å·è¢«é”™è¯¯é‡‡æ ·ã€‚å›¾åƒä½œä¸ºä¸€ä¸ª $R^2\rightarrow \text{RGBA<br>}$çš„å‡½æ•°ï¼Œæ€ä¹ˆä¼šæœ‰é«˜é¢‘å’Œä½é¢‘ä¹‹åˆ†å‘¢ï¼Ÿuh actuallyâ˜ï¸ğŸ¤“ æˆ‘ä»¬å¤„ç†çš„ç»å¤§å¤šæ•°å‡½æ•°éƒ½æœ‰é¢‘åŸŸï¼Œè¿™ä¸ªé¢‘åŸŸå¯ä»¥é€šè¿‡å‚…é‡Œå¶å˜æ¢å¾—åˆ°ã€‚</p><p>å…ˆå›é¡¾ä¸€ä¸‹<strong>å‚…é‡Œå¶çº§æ•°</strong>ã€‚ç†ŸçŸ¥åœ¨ $[-\frac{T}{2},\frac{T}{2}]$ å†…ï¼Œå‡½æ•° $f(x)$ å¯ä»¥è¡¨ç¤ºä¸º</p><script type="math/tex; mode=display">f(x)=\sum_{n=-\infty}^{\infty}c_n e^{inw_0 x}</script><p>å…¶ä¸­</p><script type="math/tex; mode=display">\begin{align*}&c_n=\frac{1}{T}\int_{-\frac{T}{2}}^{\frac{T}{2}} f(t)e^{-inw_0t}dt\\&w_0=\frac{2\pi}{T}\end{align*}</script><p>è¿™æœ¬è´¨ä¸Šæ˜¯å‡½æ•°åœ¨é—­åŒºé—´å†…çš„æ­£äº¤åŸºå±•å¼€ï¼Œè¿™ä¸ªå±•å¼€çš„å‘¨æœŸä¸º $T$.</p><p>å½“ $T \rightarrow \infty$ æ—¶ï¼Œä»¤ $w_n=nw_0$ï¼Œ$\Delta w=w_n-w_{n-1}=w_0$ å†ç»“åˆç§¯åˆ†çš„å®šä¹‰ï¼Œæˆ‘ä»¬å°±èƒ½ï¼ˆä¸å¤ªä¸¥è°¨åœ°ï¼‰æ±‚å‡º</p><script type="math/tex; mode=display">f(x)=\frac{1}{2\pi}\int_{-\infty}^{\infty}\bigg(\int_{-\infty}^{\infty}f(t)e^{-iwt}dt \bigg)e^{iwx}dw</script><p>æˆ‘ä»¬å¯ä»¥ä»¤ $u=\frac{w}{2\pi}$ ä»è€Œå»æ‰ç§¯åˆ†å¤–é¢çš„é‚£ä¸ªç³»æ•°</p><script type="math/tex; mode=display">f(x)=\int_{-\infty}^{\infty}\bigg(\int_{-\infty}^{\infty}f(t)e^{-2\pi iut}dt \bigg)e^{2\pi iux}du</script><p>è€Œ $e^{2\pi iux}$ çš„ç³»æ•°</p><script type="math/tex; mode=display">\hat f(u)=\int_{-\infty}^{\infty}f(t)e^{-2\pi iut}dt</script><p>å°±æ˜¯ $f$ çš„<strong>å‚…é‡Œå¶å˜æ¢</strong>äº†ï¼Œå®ƒä¹Ÿè®°ä½œ $\mathcal{F}(f)$.</p><p>æŠŠ $\hat f$ ä»£å…¥å°±å¾—åˆ°äº†<strong>é€†å‚…é‡Œå¶å˜æ¢</strong></p><script type="math/tex; mode=display">f(x)=\int_{-\infty}^{\infty}\hat f(u)e^{2\pi iux}du</script><p>é€†å‚…é‡Œå¶å˜æ¢æŠŠå‡½æ•°å˜æˆäº†ä¸åŒé¢‘ç‡çš„ä¸‰è§’å‡½æ•°çš„ç§¯åˆ†/æ±‚å’Œï¼Œè¿™å°±æ˜¯æˆ‘ä»¬ä¹‹å‰æ‰€è¯´çš„â€œé«˜é¢‘ä¿¡å·â€å’Œâ€œä½é¢‘ä¿¡å·â€çš„å«ä¹‰ã€‚ä¹‹åæˆ‘ä»¬ä¼šä»‹ç»é‡‡æ ·å¯¼è‡´é«˜é¢‘ä¿¡å·ä¸¢å¤±çš„åŸå› ï¼Œä¸è¿‡åœ¨æ­¤ä¹‹å‰æˆ‘ä»¬å…ˆçœ‹çœ‹å‚…é‡Œå¶å˜æ¢çš„ä¸€äº›æ€§è´¨ã€‚</p><p><img src="/images/learning/open-course/GAMES101/Notes/note2/fourier.png" alt=""></p><h2 id="å‚…é‡Œå¶å˜æ¢çš„æ€§è´¨"><a href="#å‚…é‡Œå¶å˜æ¢çš„æ€§è´¨" class="headerlink" title="å‚…é‡Œå¶å˜æ¢çš„æ€§è´¨"></a>å‚…é‡Œå¶å˜æ¢çš„æ€§è´¨</h2><p>æˆ‘ä»¬åˆ—ä¸¾å‚…é‡Œå¶å˜æ¢çš„å‡ ä¸ªå¸¸ç”¨çš„æ€§è´¨ã€‚</p><ol><li>å¦‚æœ $f$ æ˜¯å®å‡½æ•°ï¼Œ$\hat f$ æ˜¯å¶å‡½æ•°ã€‚</li><li><p>å‡½æ•°å’Œå‚…é‡Œå¶å˜æ¢çš„å¹³æ–¹ç§¯åˆ†ç›¸ç­‰</p><script type="math/tex; mode=display"> \int (f(x))^2dx=\int (\hat f(u))^2du</script></li><li><p>åŸå‡½æ•°æ‹‰é•¿ï¼Œå‚…é‡Œå¶å˜æ¢æ”¶ç´§</p><script type="math/tex; mode=display"> \mathcal{F}(f(x/b))=b\hat f(bu)</script></li></ol><h2 id="ç‹„æ‹‰å…‹è„‰å†²å‡½æ•°å’Œå†²æ¿€ä¸²"><a href="#ç‹„æ‹‰å…‹è„‰å†²å‡½æ•°å’Œå†²æ¿€ä¸²" class="headerlink" title="ç‹„æ‹‰å…‹è„‰å†²å‡½æ•°å’Œå†²æ¿€ä¸²"></a>ç‹„æ‹‰å…‹è„‰å†²å‡½æ•°å’Œå†²æ¿€ä¸²</h2><p>ç‹„æ‹‰å…‹è„‰å†²å‡½æ•°çš„å®šä¹‰å¦‚ä¸‹ï¼š</p><script type="math/tex; mode=display">\delta(t) =\begin{cases}\infty, & t = 0 \\0, & t \neq 0\end{cases}</script><p>æˆ‘ä»¬å¯ä»¥æŠŠè¿ç»­ä¿¡å·çš„å‡åŒ€é—´éš”é‡‡æ ·è¡¨ç¤ºä¸ºå†²æ¿€ä¸²</p><script type="math/tex; mode=display">s_T(x) = \sum_{n=-\infty}^{\infty}\delta(x-nT)</script><p>ä¸åŸå‡½æ•° $f$ çš„ä¹˜ç§¯ï¼Œè¿™é‡Œçš„ $T$ è¡¨ç¤ºä¸¤ä¸ªé‡‡æ ·ç‚¹ä¹‹é—´çš„é—´éš”ã€‚</p><p>$s_T$ çš„å‚…é‡Œå¶å˜æ¢ä¸º</p><script type="math/tex; mode=display">\hat s_T(u)=\frac{1}{T}\sum_{n=-\infty}^{\infty}\delta(u-\frac{n}{T})</script><p>å®ƒä»ç„¶æ˜¯ä¸€ç³»åˆ—ç‹„æ‹‰å…‹å‡½æ•°çš„å’Œã€‚</p><p><img src="/images/learning/open-course/GAMES101/Notes/note2/dirac.png" alt=""></p><h2 id="å·ç§¯å®šç†"><a href="#å·ç§¯å®šç†" class="headerlink" title="å·ç§¯å®šç†"></a>å·ç§¯å®šç†</h2><p>ä¹‹å‰è¯´è¿‡ï¼Œå°† $s_T$ å’ŒåŸå‡½æ•° $f$ ç›¸ä¹˜èƒ½è·å¾—è®¸å¤šé‡è¦çš„é‡‡æ ·æ€§è´¨ï¼Œæˆ‘ä»¬å¾ˆå¿«å°±ä¼šè®¨è®ºä»–ä»¬äº†ï¼Œåœ¨æ­¤ä¹‹å‰æˆ‘ä»¬è¿˜è¦è¡¥å……æœ€åä¸€ä¸ªçŸ¥è¯†â€”â€”å·ç§¯å®šç†ã€‚</p><script type="math/tex; mode=display">\begin{align*}&\mathcal{F}(f * g)=\hat f\hat g\\&\mathcal{F}(fg)=\hat f * \hat g\end{align*}</script><p>è¿™å°±æ˜¯è¯´ï¼Œæ—¶åŸŸçš„å·ç§¯å¯¹åº”é¢‘åŸŸçš„ä¹˜ç§¯ï¼Œé¢‘åŸŸçš„ä¹˜ç§¯å¯¹åº”æ—¶åŸŸçš„å·ç§¯ã€‚</p><h1 id="èµ°æ ·çš„åŸå› "><a href="#èµ°æ ·çš„åŸå› " class="headerlink" title="èµ°æ ·çš„åŸå› "></a>èµ°æ ·çš„åŸå› </h1><p>ä¸€å¼€å§‹æˆ‘ä»¬å°±è¯´è¿‡ï¼Œèµ°æ ·çš„å®è´¨æ˜¯åŸå›¾çš„é«˜é¢‘ä¿¡å·è¢«é”™è¯¯é‡‡æ ·ã€‚ç°åœ¨æˆ‘ä»¬çš„æ•°å­¦å·¥å…·å·²ç»è¶³ä»¥åˆ†æç©¶ç«Ÿä¸ºä»€ä¹ˆå‘ç”Ÿäº†é”™è¯¯é‡‡æ ·ï¼Œä»¥åŠå¦‚ä½•ç¼“è§£ä»–ä»¬äº†ã€‚</p><p>å…ˆæ¥çœ‹çœ‹ä¸ºä»€ä¹ˆæˆ‘ä»¬æ²¡æœ‰æ­£ç¡®é‡‡æ ·é«˜é¢‘ä¿¡å·ã€‚</p><p>å‡è®¾æˆ‘ä»¬å¸Œæœ›å¯¹è¿™æ ·çš„å‡½æ•°è¿›è¡Œé‡‡æ ·ï¼Œé€šè¿‡å‚…é‡Œå¶å˜æ¢æˆ‘ä»¬å¯ä»¥å¾—åˆ°å…¶é¢‘åŸŸï¼ˆå³ä¸€ï¼‰</p><p><img src="/images/learning/open-course/GAMES101/Notes/note2/sample-origin.png" alt=""></p><p>æˆ‘ä»¬ä¹‹å‰è¯´è¿‡ï¼Œå¯ä»¥æŠŠè¿ç»­å‡½æ•°çš„å‡åŒ€é—´éš”é‡‡æ ·è¡¨ç¤ºä¸ºå†²æ¿€ä¸² $s_{T}(x)=\sum_{n=-\infty}^{\infty}\delta(x-nT)$ å’ŒåŸå‡½æ•° $f$ çš„ä¹˜ç§¯ï¼Œè€Œæˆ‘ä»¬ä¹Ÿå·²ç»çŸ¥é“å†²æ¿€ä¸²çš„å‚…é‡Œå¶å˜æ¢è¿˜æ˜¯å†²æ¿€ä¸²</p><script type="math/tex; mode=display">\hat s_T(u)=\frac{1}{T}\sum_{n=-\infty}^{\infty}\delta(u-\frac{n}{T})</script><p>å†ç»“åˆå·ç§¯å®šç† $\mathcal{F}(s_Tf)=\hat s_T * \hat f$ï¼Œä»¥åŠâ€œå·ç§¯å°±æ˜¯å‡½æ•°å¹³ç§»åçš„åŠ æƒå’Œâ€ï¼Œæˆ‘ä»¬å°±èƒ½æ¨å‡ºï¼Œé‡‡æ ·ç»“æœçš„å‚…é‡Œå¶å˜æ¢å°±æ˜¯åŸå‡½æ•°çš„å‚…é‡Œå¶å˜æ¢çš„æ— ç©·ä¸ªå¤åˆ¶å„æŒ‰ $\frac{n}{T}$ å¹³ç§»çš„å’Œã€‚</p><p><img src="/images/learning/open-course/GAMES101/Notes/note2/sample-sampled.png" alt=""></p><p>ç”±äºæˆ‘ä»¬çš„é‡‡æ ·é—´éš” $T$ ä¸å¤Ÿå°ï¼Œå³é‡‡æ ·ç‡ $\frac{1}{T}$ ä¸å¤Ÿå¤§ï¼Œæ‰€ä»¥ç›¸é‚»çš„ä¸¤ä¸ªå¤åˆ¶é—´å‘ç”Ÿäº†é‡å ï¼Œå¯¼è‡´é«˜é¢‘ä¿¡å·å’Œä½é¢‘ä¿¡å·äº§ç”Ÿæ··åˆï¼Œè¿™å°±å¼•èµ·äº†èµ°æ ·ã€‚è€Œè¿™æ­£æ˜¯â€œé«˜é¢‘ä¿¡å·è¢«é”™è¯¯é‡‡æ ·â€çš„å®è´¨ã€‚</p><p>å½“æˆ‘ä»¬åœ¨å…‰æ …åŒ–æ—¶ï¼Œæˆ‘ä»¬è¿˜æŠŠåƒç´ å¡«ä¸Šäº†é¢œè‰²ï¼Œè¿™æ˜¯åœ¨â€œreconstructionâ€å³é‡å»ºå›¾åƒã€‚ä¸è¿‡ç”±äºåœ¨é‡‡æ ·æ—¶æˆ‘ä»¬å·²ç»å‘ç”Ÿäº†èµ°æ ·ï¼Œæ— è®ºæ€ä¹ˆé‡å»ºéƒ½ä¸ä¼šæœ‰ä¸€ä¸ªéå¸¸å®Œç¾çš„ç»“æœäº†ã€‚</p><p><img src="/images/l earning/open-course/GAMES101/Notes/note2/sample-recons.png" alt=""></p><h1 id="æ»¤æ³¢å™¨å’Œèµ°æ ·çš„ç¼“è§£æ–¹æ³•"><a href="#æ»¤æ³¢å™¨å’Œèµ°æ ·çš„ç¼“è§£æ–¹æ³•" class="headerlink" title="æ»¤æ³¢å™¨å’Œèµ°æ ·çš„ç¼“è§£æ–¹æ³•"></a>æ»¤æ³¢å™¨å’Œèµ°æ ·çš„ç¼“è§£æ–¹æ³•</h1><p>ä¸ºäº†ç¼“è§£èµ°æ ·ï¼Œæˆ‘ä»¬è‡ªç„¶å°±è¦é¿å…å‘ç”Ÿé‡å ã€‚é¿å…å‘ç”Ÿé‡å çš„æ€è·¯ä¸»è¦æœ‰ä¸¤ç§ï¼š</p><ol><li>å¢åŠ é‡‡æ ·ç‡ï¼Œè¿™æ ·å°±èƒ½è®©ç›¸é‚»çš„ä¸¤ä¸ªå¤åˆ¶è·ç¦»å¢å¤§ã€‚</li><li>ç”¨æ»¤æ³¢å™¨å‡å¼±é«˜é¢‘ä¿¡å·çš„å¼ºåº¦ã€‚</li></ol><p>å¯¹å›¾åƒçš„å…‰æ …åŒ–æ¥è¯´ï¼Œå¢åŠ åˆ†è¾¨ç‡å°±å¯¹åº”å‰è€…ï¼›åœ¨é‡‡æ ·å‰å¯¹åŸå›¾åº”ç”¨å„ç§æ»¤æ³¢å™¨å°±å¯¹åº”åè€…ã€‚</p><p>æˆ‘ä»¬å½“ç„¶ä¼šé—®ï¼Œå¢åŠ é‡‡æ ·ç‡èƒ½ç¼“è§£èµ°æ ·ï¼Œé‚£å¢åŠ åˆ°å¤šå¤§åˆé€‚å‘¢ï¼Ÿæˆ‘ä»¬å¸Œæœ›ç›¸é‚»çš„ä¸¤ä¸ªå¤åˆ¶é—´çš„è·ç¦»è¶³å¤Ÿå¤§ä»¥è‡³äºä¸å‘ç”Ÿé‡å ï¼Œè¿™å°±éœ€è¦è¾“å…¥ä¿¡å·çš„æœ€é«˜é¢‘ç‡å°äºé‡‡æ ·é¢‘ç‡çš„ä¸€åŠã€‚é‡‡æ ·é¢‘ç‡çš„ä¸€åŠä¹Ÿè¢«ç§°ä¸º<strong>å¥ˆå¥æ–¯ç‰¹é¢‘ç‡</strong>ã€‚ç†è®ºä¸Šè¯´ï¼Œåªè¦å¥ˆå¥æ–¯ç‰¹é¢‘ç‡é«˜äºè¢«é‡‡æ ·ä¿¡å·çš„æœ€é«˜é¢‘ç‡ï¼Œæˆ‘ä»¬å°±èƒ½å®Œç¾å¤åŸåŸä¿¡å·ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹å‡ ä¸ªå¸¸è§çš„æ»¤æ³¢å™¨ï¼Œå®ƒä»¬å¸¸è¢«ç”¨äºå’Œåˆ«çš„å‡½æ•°åšå·ç§¯ã€‚ç”±äºæˆ‘ä»¬çŸ¥é“å·ç§¯å¯ä»¥è¢«ç†è§£ä¸ºä¸€ç§â€œåŠ æƒå¹³å‡â€ï¼Œæ‰€ä»¥æˆ‘ä»¬å¸Œæœ›æ»¤æ³¢å™¨éƒ½æ˜¯å½’ä¸€åŒ–çš„ã€‚</p><table>  <thead>    <tr>      <th>åç§°</th>      <th>å…¬å¼</th>    </tr>  </thead>  <tbody>    <tr>      <td>Box filterï¼ˆç¦»æ•£ï¼‰</td>      <td>$a_{\text{box},r}[i] =\begin{cases}1/(2r + 1) & |i| \le r, \\0 & \text{otherwise}.\end{cases}$</td>    </tr>    <tr>      <td>Box filterï¼ˆè¿ç»­ï¼‰</td>      <td>$f_{\text{box},r}(x) =\begin{cases}1/(2r) & -r \le x < r, \\0 & \text{otherwise}.\end{cases}$</td>    </tr>    <tr>      <td>Tent filter</td>      <td>$f_{\text{tent}}(x) =\begin{cases}1 - |x| & |x| < 1, \\0 & \text{otherwise};\end{cases}$</td>    </tr>    <tr>      <td>Gaussian filter</td>      <td>$f_{g, \sigma}(x) = \frac{1}{\sigma\sqrt{2\pi}}e^{-x^2/2\sigma^2}$</td>    </tr>  </tbody></table><p><img src="/images/learning/open-course/GAMES101/Notes/note2/filters1.png" alt=""></p><table>  <thead>    <tr>      <th>åç§°</th>      <th>å…¬å¼</th>    </tr>  </thead>  <tbody>    <tr>      <td>B-Spline Cubic Filter</td>      <td>$f_B(x) = \frac{1}{6}\begin{cases}-3(1 - |x|)^3 + 3(1 - |x|)^2 + 3(1 - |x|) + 1 & -1 \le x \le 1, \\(2 - |x|)^3 & 1 \le |x| \le 2, \\0 & \text{otherwise}.\end{cases}$</td>    </tr>    <tr>      <td>Catmull-Rom Cubic Filter</td>      <td>$f_C(x) = \frac{1}{2}\begin{cases}-3(1 - |x|)^3 + 4(1 - |x|)^2 + (1 - |x|) & -1 \le x \le 1, \\(2 - |x|)^3 - (2 - |x|)^2 & 1 \le |x| \le 2, \\0 & \text{otherwise}.\end{cases}$</td>    </tr>    <tr>      <td>Mitchell-Netravali Cubic Filter</td>      <td>$f_M(x) = \frac{1}{3}f_B(x) + \frac{2}{3}f_C(x)\\= \frac{1}{18}\begin{cases} -21(1 - |x|)^3 + 27(1 - |x|)^2 + 9(1 - |x|) + 1 & -1 \le x \le 1, \\7(2 - |x|)^3 - 6(2 - |x|)^2 & 1 \le |x| \le 2, \\0 & \text{otherwise}.\end{cases}$</td>    </tr>  </tbody></table><p><img src="/images/learning/open-course/GAMES101/Notes/note2/filters2.png" alt=""></p><p>é™¤äº†è¿‡æ»¤é«˜é¢‘ä¿¡å·ä¹‹å¤–ï¼Œæ»¤æ³¢å™¨è¿˜åœ¨é‡å»ºå›¾åƒæ—¶å‘æŒ¥ç€é‡è¦ä½œç”¨ã€‚è¿˜è®°å¾—å—ï¼Œç¦»æ•£-è¿ç»­å·ç§¯èƒ½æŠŠä¸€ç³»åˆ—ç¦»æ•£ç‚¹å˜æˆä¸€ä¸ªè¿ç»­å‡½æ•°ã€‚åœ¨æ ¹æ®é‡‡æ ·ç‚¹é‡å»ºå›¾åƒæ—¶ï¼Œæˆ‘ä»¬åŸºæœ¬å°±æ˜¯åœ¨åšé‡‡æ ·ç‚¹å’Œæ»¤æ³¢å™¨çš„å·ç§¯ã€‚åœ¨å…‰æ …åŒ–çš„â€œæŠŠæ¯ä¸ªåƒç´ ç‚¹çš„ä¸­å¿ƒé‡‡æ ·é¢œè‰²å¡«åˆ°åƒç´ ç‚¹ä¸Šâ€è¿™ä¸€æ­¥ä¸­ï¼Œæˆ‘ä»¬å°±æ˜¯åœ¨å°†é‡‡æ ·ç‚¹å’Œ Box filter åšå·ç§¯ã€‚</p><p>æ€»è€Œè¨€ä¹‹ï¼Œä¸ºäº†ç¼“è§£èµ°æ ·ï¼Œæˆ‘ä»¬å¯ä»¥ä»¥å›¾åƒç»†èŠ‚ä¸°å¯Œåº¦ä¸ºä»£ä»·ï¼Œå…ˆç”¨ä½é€šæ»¤æ³¢å™¨æ»¤æ³¢ï¼Œå†é‡‡æ ·+é‡å»ºã€‚å½“ç„¶ï¼Œå¦‚æœæˆ‘ä»¬æœ‰æ›´é«˜åˆ†è¾¨ç‡çš„å±å¹•å°±æ›´å¥½äº†~</p><h1 id="å…¶ä»–å°çŸ¥è¯†"><a href="#å…¶ä»–å°çŸ¥è¯†" class="headerlink" title="å…¶ä»–å°çŸ¥è¯†"></a>å…¶ä»–å°çŸ¥è¯†</h1><h2 id="å¸¸è§æ»¤æ³¢å™¨çš„å‚…é‡Œå¶å˜æ¢"><a href="#å¸¸è§æ»¤æ³¢å™¨çš„å‚…é‡Œå¶å˜æ¢" class="headerlink" title="å¸¸è§æ»¤æ³¢å™¨çš„å‚…é‡Œå¶å˜æ¢"></a>å¸¸è§æ»¤æ³¢å™¨çš„å‚…é‡Œå¶å˜æ¢</h2><p><img src="/images/learning/open-course/GAMES101/Notes/note2/fourier-all.png" alt=""></p><h2 id="å·ç§¯çš„å•ä½å…ƒ"><a href="#å·ç§¯çš„å•ä½å…ƒ" class="headerlink" title="å·ç§¯çš„å•ä½å…ƒ"></a>å·ç§¯çš„å•ä½å…ƒ</h2><p>ä»»ä½•ç¦»æ•£ä¿¡å·å’Œå•ä½è„‰å†²åºåˆ—åšå·ç§¯ï¼Œç»“æœè¿˜æ˜¯åŸæœ¬çš„ç¦»æ•£ä¿¡å·</p><script type="math/tex; mode=display">\delta[n] =\begin{cases}1, & n = 0 \\0, & n \neq 0\end{cases}</script><p>ä»»ä½•è¿ç»­ä¿¡å·å’Œç‹„æ‹‰å…‹å‡½æ•°åšå·ç§¯ï¼Œç»“æœè¿˜æ˜¯åŸæœ¬çš„è¿ç»­ä¿¡å·</p><script type="math/tex; mode=display">\delta(t) =\begin{cases}\infty, & t = 0 \\0, & t \neq 0\end{cases}</script><h2 id="äºŒç»´å·ç§¯å’ŒäºŒç»´æ»¤æ³¢å™¨"><a href="#äºŒç»´å·ç§¯å’ŒäºŒç»´æ»¤æ³¢å™¨" class="headerlink" title="äºŒç»´å·ç§¯å’ŒäºŒç»´æ»¤æ³¢å™¨"></a>äºŒç»´å·ç§¯å’ŒäºŒç»´æ»¤æ³¢å™¨</h2><p>æˆ‘ä»¬è¿™é‡Œåªç»™å‡ºè¿ç»­-è¿ç»­çš„äºŒç»´å·ç§¯ï¼Œåˆ«çš„æƒ…å†µéƒ½å·®ä¸å¤šã€‚</p><script type="math/tex; mode=display">\begin{align*}&(f*g)(x,y)=\int\intf(x-x',y-y')g(x',y')dx'dy'\end{align*}</script><p>å¯¹æ»¤æ³¢å™¨ $f(x)$ï¼Œæˆ‘ä»¬ç®€å•åœ°å®šä¹‰ $g(x,y)=f(x)f(y)$ å°±å¾—åˆ°äº†è¿™ä¸ªæ»¤æ³¢å™¨å¯¹åº”çš„äºŒç»´æ»¤æ³¢å™¨ã€‚ä¸€ä¸ªæ¯”è¾ƒå¥½çš„æ€§è´¨æ˜¯ï¼Œå¦‚æœ $f$ æ˜¯å½’ä¸€åŒ–çš„ï¼Œé‚£ä¹ˆ $g$ ä¹Ÿæ˜¯å½’ä¸€åŒ–çš„ã€‚</p><h2 id="ä¼½é©¬å€¼"><a href="#ä¼½é©¬å€¼" class="headerlink" title="ä¼½é©¬å€¼"></a>ä¼½é©¬å€¼</h2><p>æ˜¾ç¤ºå™¨çš„æ˜¾ç¤ºäº®åº¦å…³äºè¾“å…¥ä¿¡å·ä¸æ˜¯çº¿æ€§å…³ç³»ã€‚å‡è®¾è¾“å…¥ä¿¡å·ä¸º $a\in[0,1]$ï¼Œåˆ™æœ‰</p><script type="math/tex; mode=display">\text{Displayed intensity}=(\text{Maximum intensity})a^\gamma</script><p>è¿™é‡Œçš„ $\gamma$ ä¸€èˆ¬åœ¨ $2.2$ å·¦å³ã€‚è™½ç„¶åœ¨æœ€å¼€å§‹è¿™æ˜¯ CRT æ˜¾ç¤ºå™¨çš„ç‰©ç†ç‰¹æ€§æ‰€è‡´ï¼Œä½†æœ‰è¶£çš„æ˜¯ï¼Œäººçœ¼ä¹Ÿæ°å¥½å¯¹æš—éƒ¨å˜åŒ–æ¯”äº®éƒ¨å˜åŒ–æ›´æ•æ„Ÿï¼Œæ‰€ä»¥å®ƒç°åœ¨ä½œä¸ºä¸€ä¸ªåˆ»æ„çš„è®¾è®¡ä¿ç•™äº†ä¸‹æ¥ã€‚</p><p>ä¼½é©¬çŸ«æ­£åœ¨å½±åƒç³»ç»Ÿä¸­ä¹Ÿæœ‰æå¤§ä½œç”¨ã€‚å‡è®¾æˆ‘ä»¬åœ¨æ‹æ‘„ä¸€ä¸ªè‹¹æœçš„ç…§ç‰‡ï¼Œè‹¹æœçš„ç‰©ç†äº®åº¦æ˜¯ $0.5$ï¼Œç›¸æœºå¿ å®åœ°æŠŠå®ƒè®°å½•äº†ä¸‹æ¥ã€‚è€Œå½“æ˜¾ç¤ºå™¨æ˜¾ç¤ºæ—¶ï¼Œå°±æ˜¾ç¤ºå‡ºäº† $0.5^{2.2}\approx<br> 0.22$ çš„ç‰©ç†äº®åº¦ï¼Œè¿™æ˜¾ç„¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚å› æ­¤åœ¨æˆ‘ä»¬æ‹æ‘„ç…§ç‰‡ä¹‹åï¼Œç›¸æœºçš„å›¾åƒå¤„ç†å™¨å°±ä¼šè‡ªåŠ¨å¯¹ç…§ç‰‡è¿›è¡Œä¼½é©¬çŸ«æ­£ã€‚</p><h2 id="å›¾åƒé”åŒ–"><a href="#å›¾åƒé”åŒ–" class="headerlink" title="å›¾åƒé”åŒ–"></a>å›¾åƒé”åŒ–</h2><p>Unsharp Mask æ˜¯ä¸€ä¸ªç»å…¸çš„å›¾åƒé”åŒ–ç®—æ³•ã€‚ä»¤é«˜æ–¯æ¨¡ç³Šæ ¸ä¸º $G$ï¼Œå†²æ¿€å‡½æ•°ä¸º $\delta$ï¼Œå®ƒå…ˆæå–åŸå§‹å›¾åƒçš„é«˜é¢‘ä¿¡å·</p><script type="math/tex; mode=display">I_{detail} = I_{orig} - I_{orig} * G</script><p>å†æŠŠè¿™äº›é«˜é¢‘ä¿¡å·åŠ å…¥å›åŸå›¾ä¸­</p><script type="math/tex; mode=display">I_{sharp} = I_{orig} + \alpha I_{detail}</script><p>ç»¼åˆèµ·æ¥å°±æ˜¯</p><script type="math/tex; mode=display">I_{sharp}=I_{orig}*((1+\alpha)\delta-G)</script><h2 id="å›¾åƒç¼©æ”¾"><a href="#å›¾åƒç¼©æ”¾" class="headerlink" title="å›¾åƒç¼©æ”¾"></a>å›¾åƒç¼©æ”¾</h2><p>ç›´æ¥å¯¹ä¸€ä¸ªåƒç´ åŒ–çš„å›¾åƒé‡‡æ ·è™½ç„¶æ•ˆç‡å¾ˆé«˜ï¼Œä½†æ•ˆæœä¸ä½³ã€‚å…ˆç”¨è¿ç»­çš„æ»¤æ³¢å™¨é‡å»ºä¿¡å·ï¼Œå†ç”¨ä½é€šæ»¤æ³¢å™¨è¿‡æ»¤é«˜é¢‘ä¿¡å·ï¼Œå†é‡‡æ ·ä¼šå¾—åˆ°æ›´å¥½çš„ç»“æœï¼Œè¿™è¢«ç§°ä¸º resamplingï¼Œé‡é‡‡æ ·ã€‚</p><p><img src="/images/learning/open-course/GAMES101/Notes/note2/resample.png" alt=""></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;åœ¨ Transformation éƒ¨åˆ†ï¼Œæˆ‘ä»¬å·²ç»å¯ä»¥æŠŠä¸€ä¸ªä¸‰ç»´ç©ºé—´é‡Œçš„ä¸‰è§’å½¢æŠ•å½±åˆ°å¹³é¢ä¸Šã€‚ä½†æ€ä¹ˆæŠŠä¸€ä¸ªçº¯è‰²ä¸‰è§’å½¢ç»˜åˆ¶åˆ°å±å¹•ä¸Šå‘¢ï¼Ÿæˆ‘ä»¬çŸ¥é“å±å¹•ç”±å¤§é‡çš„åƒç´ ç‚¹ç»„æˆï¼Œé‚£ä¹ˆæ€ä¹ˆç¡®å®šæ¯ä¸ªåƒç´ ç‚¹æ˜¯ä»€ä¹ˆé¢œè‰²å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬é€šè¿‡é‡‡æ ·ç»™æ¯ä¸ªåƒç´ ç‚¹æ¶‚ä¸Šé¢œè‰²ã€‚æˆ‘ä»¬å¯ä»¥æ£€æŸ¥æ¯ä¸ªåƒç´ çš„ä¸­å¿ƒç‚¹</summary>
      
    
    
    
    <category term="å…¬å¼€è¯¾" scheme="http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/"/>
    
    <category term="GAMES101" scheme="http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/"/>
    
    <category term="Notes" scheme="http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/Notes/"/>
    
    
  </entry>
  
  <entry>
    <title>Assignment 1 Transformation</title>
    <link href="http://rinevard.github.io/wiki/learning/open-course/GAMES101/Hw/Hw1-transformation/"/>
    <id>http://rinevard.github.io/wiki/learning/open-course/GAMES101/Hw/Hw1-transformation/</id>
    <published>2025-08-22T03:00:58.000Z</published>
    <updated>2025-08-22T03:14:43.978Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬æ¬¡ä½œä¸šè¦æ±‚æˆ‘ä»¬å®ç°æ—‹è½¬çŸ©é˜µã€æŠ•å½±çŸ©é˜µã€‚æˆ‘ä»¬å…ˆç®€å•çœ‹ä¸‹ä½œä¸šæ˜¯æ€ä¹ˆåšçš„ï¼Œå†çœ‹çœ‹ä»£ç æ¡†æ¶é‡Œçš„å‡ ä¸ªæœ‰è¶£çš„åœ°æ–¹ã€‚</p><h1 id="ä½œä¸šå®ç°"><a href="#ä½œä¸šå®ç°" class="headerlink" title="ä½œä¸šå®ç°"></a>ä½œä¸šå®ç°</h1><h2 id="ä¸¤ä¸ªæ—‹è½¬çŸ©é˜µ"><a href="#ä¸¤ä¸ªæ—‹è½¬çŸ©é˜µ" class="headerlink" title="ä¸¤ä¸ªæ—‹è½¬çŸ©é˜µ"></a>ä¸¤ä¸ªæ—‹è½¬çŸ©é˜µ</h2><p>ç»• $z$ è½´çš„æ—‹è½¬çŸ©é˜µå®ç°èµ·æ¥å¾ˆç®€å•ï¼ŒæŠŠè¯¾ä¸Šçš„å†…å®¹ç¿»è¯‘æˆä»£ç å°±å¥½ã€‚åœ¨ä½¿ç”¨ std çš„ sin å’Œ cos æ—¶è¦æ³¨æ„æŠŠè§’åº¦è½¬æ¢æˆå¼§åº¦ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Eigen<span class="token double-colon punctuation">::</span>Matrix4f <span class="token function">get_model_matrix</span><span class="token punctuation">(</span><span class="token keyword">float</span> rotation_angle<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    Eigen<span class="token double-colon punctuation">::</span>Matrix4f model <span class="token operator">=</span> Eigen<span class="token double-colon punctuation">::</span><span class="token class-name">Matrix4f</span><span class="token double-colon punctuation">::</span><span class="token function">Identity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">float</span> angle_rad <span class="token operator">=</span> rotation_angle <span class="token operator">*</span> MY_PI <span class="token operator">/</span> <span class="token number">180.0</span><span class="token punctuation">;</span>    Eigen<span class="token double-colon punctuation">::</span>Matrix4f rotate<span class="token punctuation">;</span>    <span class="token keyword">float</span> sine <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span><span class="token function">sin</span><span class="token punctuation">(</span>angle_rad<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">float</span> cosine <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span><span class="token function">cos</span><span class="token punctuation">(</span>angle_rad<span class="token punctuation">)</span><span class="token punctuation">;</span>    rotate <span class="token operator">&lt;&lt;</span> cosine<span class="token punctuation">,</span> <span class="token operator">-</span>sine<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>            sine<span class="token punctuation">,</span> cosine<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>             <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>             <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">;</span>    model <span class="token operator">=</span> rotate <span class="token operator">*</span> model<span class="token punctuation">;</span>    <span class="token keyword">return</span> model<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æé«˜é¡¹é‡Œçš„æ—‹è½¬çŸ©é˜µç”¨è¯¾ä¸Šè®²çš„ Rodriguesâ€™ rotation formula å°±è¡Œï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">/*    Computes the 4x4 rotation matrix representing a rotation of rotation_angle (in degree)     around a given normalized axis vector that passes through the origin,     using Rodrigues' rotation formula.*/</span>Eigen<span class="token double-colon punctuation">::</span>Matrix4f <span class="token function">get_rotation</span><span class="token punctuation">(</span>Vector3f axis<span class="token punctuation">,</span> <span class="token keyword">float</span> rotation_angle<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">float</span> angle_rad <span class="token operator">=</span> rotation_angle <span class="token operator">*</span> MY_PI <span class="token operator">/</span> <span class="token number">180.0</span><span class="token punctuation">;</span>        Eigen<span class="token double-colon punctuation">::</span>Matrix3f rot_mat <span class="token operator">=</span> std<span class="token double-colon punctuation">::</span><span class="token function">cos</span><span class="token punctuation">(</span>angle_rad<span class="token punctuation">)</span> <span class="token operator">*</span> Eigen<span class="token double-colon punctuation">::</span><span class="token class-name">Matrix3f</span><span class="token double-colon punctuation">::</span><span class="token function">Identity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    rot_mat <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> std<span class="token double-colon punctuation">::</span><span class="token function">cos</span><span class="token punctuation">(</span>angle_rad<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> axis <span class="token operator">*</span> axis<span class="token punctuation">.</span><span class="token function">transpose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Eigen<span class="token double-colon punctuation">::</span>Matrix3f cross_product_mat<span class="token punctuation">;</span>    cross_product_mat <span class="token operator">&lt;&lt;</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span>axis<span class="token punctuation">.</span><span class="token function">z</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> axis<span class="token punctuation">.</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                        axis<span class="token punctuation">.</span><span class="token function">z</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span>axis<span class="token punctuation">.</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                         <span class="token operator">-</span>axis<span class="token punctuation">.</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> axis<span class="token punctuation">.</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">;</span>    rot_mat <span class="token operator">+=</span> std<span class="token double-colon punctuation">::</span><span class="token function">sin</span><span class="token punctuation">(</span>angle_rad<span class="token punctuation">)</span> <span class="token operator">*</span> cross_product_mat<span class="token punctuation">;</span>    Eigen<span class="token double-colon punctuation">::</span>Matrix4f trans_mat <span class="token operator">=</span> Eigen<span class="token double-colon punctuation">::</span><span class="token class-name">Matrix4f</span><span class="token double-colon punctuation">::</span><span class="token function">Identity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    trans_mat<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">topLeftCorner</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> rot_mat<span class="token punctuation">;</span>    <span class="token keyword">return</span> trans_mat<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="æŠ•å½±çŸ©é˜µ"><a href="#æŠ•å½±çŸ©é˜µ" class="headerlink" title="æŠ•å½±çŸ©é˜µ"></a>æŠ•å½±çŸ©é˜µ</h2><p>æŠ•å½±çŸ©é˜µå°±ç›¸å¯¹å¤æ‚ä¸€äº›äº†ï¼Œå…ˆä¸Šä»£ç </p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">Eigen<span class="token double-colon punctuation">::</span>Matrix4f <span class="token function">get_projection_matrix</span><span class="token punctuation">(</span><span class="token keyword">float</span> eye_fov<span class="token punctuation">,</span> <span class="token keyword">float</span> aspect_ratio<span class="token punctuation">,</span>                                      <span class="token keyword">float</span> zNear<span class="token punctuation">,</span> <span class="token keyword">float</span> zFar<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">// Students will implement this function</span>    Eigen<span class="token double-colon punctuation">::</span>Matrix4f projection <span class="token operator">=</span> Eigen<span class="token double-colon punctuation">::</span><span class="token class-name">Matrix4f</span><span class="token double-colon punctuation">::</span><span class="token function">Identity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Eigen<span class="token double-colon punctuation">::</span>Matrix4f perspective<span class="token punctuation">;</span>    <span class="token keyword">float</span> cotangent <span class="token operator">=</span> <span class="token number">1.0</span> <span class="token operator">/</span> std<span class="token double-colon punctuation">::</span><span class="token function">tan</span><span class="token punctuation">(</span>eye_fov <span class="token operator">/</span> <span class="token number">2.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">float</span> z_delta <span class="token operator">=</span> zFar <span class="token operator">-</span> zNear<span class="token punctuation">;</span>    perspective <span class="token operator">&lt;&lt;</span> cotangent <span class="token operator">/</span> aspect_ratio<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>                     <span class="token number">0</span><span class="token punctuation">,</span> cotangent<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>                     <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token punctuation">(</span>zFar <span class="token operator">+</span> zNear<span class="token punctuation">)</span> <span class="token operator">/</span> z_delta<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span> <span class="token operator">*</span> zFar <span class="token operator">*</span> zNear <span class="token operator">/</span> z_delta<span class="token punctuation">,</span>                    <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">;</span>    projection <span class="token operator">=</span> perspective <span class="token operator">*</span> projection<span class="token punctuation">;</span>    <span class="token keyword">return</span> projection<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é¦–å…ˆæˆ‘ä»¬ä¼šå‘ç°è¾“å…¥çš„ zNear å’Œ zFar éƒ½æ˜¯æ­£æ•°ï¼Œä»–ä»¬è¡¨ç¤ºè¿‘å¹³é¢å’Œè¿œå¹³é¢åˆ°åŸç‚¹çš„è·ç¦»ï¼Œè¿™ä¸è¯¾ä¸Šè®²çš„ä¸åŒã€‚è¯¾ä¸Šè®²çš„ $n$ å’Œ $f$ è¡¨ç¤ºè¿‘å¹³é¢å’Œè¿œå¹³é¢åœ¨ $z$ è½´çš„åæ ‡ï¼Œä»–ä»¬æ˜¯è´Ÿæ•°ã€‚</p><p>ç„¶åæˆ‘ä»¬åˆ†æ rasterizer.cpp é‡Œçš„ draw å‡½æ•°ï¼Œä¸‹é¢è¿™æ®µä»£ç é‡Œï¼Œv æ˜¯ä¸‰è§’å½¢çš„ä¸‰ä¸ªé¡¶ç‚¹æ„æˆçš„æ•°ç»„ï¼Œä¸‰ä¸ªé¡¶ç‚¹éƒ½å·²ç»è¢«å˜æ¢åˆ°äº† $[-1,1]^3$ çš„æ­£æ–¹ä½“ä¸­ã€‚</p><p>æ³¨æ„ <code>vert.z() = vert.z() * f1 + f2</code> è¿™è¡Œä»£ç ï¼ŒæŠŠ $-1$ ä»£å…¥å³è¾¹å¾—åˆ° $-n$ï¼Œ$1$ ä»£å…¥å³è¾¹å¾—åˆ° $-f$ï¼Œå› æ­¤æˆ‘ä»¬æœ‰ç†ç”±çŒœæµ‹ $[-n,-f]$ è¢«æ˜ å°„åˆ°äº† $[-1,1]$. </p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">float</span> f1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">100</span> <span class="token operator">-</span> <span class="token number">0.1</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2.0</span><span class="token punctuation">;</span><span class="token keyword">float</span> f2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">100</span> <span class="token operator">+</span> <span class="token number">0.1</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2.0</span><span class="token punctuation">;</span><span class="token comment">// ...</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> <span class="token operator">&amp;</span> vert <span class="token operator">:</span> v<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    vert<span class="token punctuation">.</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0.5</span><span class="token operator">*</span>width<span class="token operator">*</span><span class="token punctuation">(</span>vert<span class="token punctuation">.</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    vert<span class="token punctuation">.</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0.5</span><span class="token operator">*</span>height<span class="token operator">*</span><span class="token punctuation">(</span>vert<span class="token punctuation">.</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    vert<span class="token punctuation">.</span><span class="token function">z</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> vert<span class="token punctuation">.</span><span class="token function">z</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> f1 <span class="token operator">+</span> f2<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ€»ç»“ä¸€ä¸‹æˆ‘ä»¬çš„å‘ç°ï¼š</p><ol><li>è¾“å…¥çš„ zNear å’Œ zFar éƒ½æ˜¯æ­£æ•°ï¼Œè¡¨ç¤ºè¿‘å¹³é¢å’Œè¿œå¹³é¢åˆ°åŸç‚¹çš„è·ç¦»</li><li>$[-n,-f]$ è¢«æ˜ å°„åˆ°äº† $[-1,1]$</li></ol><p>æœ€ç»ˆæˆ‘ä»¬èƒ½å†™å‡ºè¿™æ ·çš„æŠ•å½±çŸ©é˜µï¼š</p><script type="math/tex; mode=display">\large\text{M}_\text{per} =\begin{bmatrix}\frac{1}{\text{aspect} \times \tan(\frac{\text{fov}}{2})} & 0 & 0 & 0 \\0 & \frac{1}{\tan(\frac{\text{fov}}{2})} & 0 & 0 \\0 & 0 & -\frac{f+n}{f-n} & -\frac{2fn}{f-n} \\0 & 0 & -1 & 0\end{bmatrix}</script><p>ç¿»è¯‘æˆä»£ç å°±å¥½ã€‚</p><h1 id="ä»£ç æ¡†æ¶é‡Œæœ‰è¶£çš„åœ°æ–¹"><a href="#ä»£ç æ¡†æ¶é‡Œæœ‰è¶£çš„åœ°æ–¹" class="headerlink" title="ä»£ç æ¡†æ¶é‡Œæœ‰è¶£çš„åœ°æ–¹"></a>ä»£ç æ¡†æ¶é‡Œæœ‰è¶£çš„åœ°æ–¹</h1><h2 id="ind-çš„ä½œç”¨"><a href="#ind-çš„ä½œç”¨" class="headerlink" title="ind çš„ä½œç”¨"></a>ind çš„ä½œç”¨</h2><p>é¦–å…ˆæˆ‘ä»¬çœ‹å‘ main.cpp çš„ main å‡½æ•°é‡Œçš„è¿™æ®µä»£ç </p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>Eigen<span class="token double-colon punctuation">::</span>Vector3f<span class="token operator">></span> pos<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>Eigen<span class="token double-colon punctuation">::</span>Vector3i<span class="token operator">></span> ind<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>pos æ˜¾ç„¶æ˜¯ä¸‰è§’å½¢çš„ä¸‰ä¸ªé¡¶ç‚¹ï¼Œä½† ind æ˜¯åšä»€ä¹ˆçš„ï¼Ÿuh actuallyğŸ¤“â˜ï¸å®ƒå®šä¹‰äº†å¦‚ä½•å°†é¡¶ç‚¹è¿æ¥èµ·æ¥ã€‚å¯¹ä¸‰è§’å½¢æ¥è¯´å®ƒå½“ç„¶æ²¡ä»€ä¹ˆç”¨ï¼Œä½†å¯¹å¤šè¾¹å½¢æ¥è¯´ï¼Œå®ƒå°±å¾ˆæœ‰ç”¨äº†ã€‚</p><p>æ¯”å¦‚è¯´ï¼Œæƒ³è±¡ä¸€ä¸‹æˆ‘ä»¬åœ¨ç”»ä¸€ä¸ªå…­è¾¹å½¢ï¼Œæˆ‘ä»¬éœ€è¦å…­ä¸ªé¡¶ç‚¹ã€‚ä½†ç”±äºåœ¨æ¸²æŸ“æ—¶æˆ‘ä»¬ä¸»è¦ç»˜åˆ¶ä¸‰è§’å½¢ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æŠŠå…­è¾¹å½¢æ‹†åˆ†æˆå¤šä¸ªä¸‰è§’å½¢ï¼Œè€Œæ‹†åˆ†å‡ºçš„æ¯ä¸ªä¸‰è§’å½¢å°±å¯¹åº”ç€ ind é‡Œçš„ä¸€ä¸ªå…ƒç´ äº†ã€‚</p><p>å¯¹å…­è¾¹å½¢æ¥è¯´ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå®šä¹‰ä¸‹é¢è¿™æ ·çš„ pos å’Œ ind</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>Eigen<span class="token double-colon punctuation">::</span>Vector3f<span class="token operator">></span> pos<span class="token punctuation">&#123;</span>    <span class="token punctuation">&#123;</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>      <span class="token comment">// 0: å³</span>    <span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1.732</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>  <span class="token comment">// 1: å³ä¸Š</span>    <span class="token punctuation">&#123;</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1.732</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token comment">// 2: å·¦ä¸Š</span>    <span class="token punctuation">&#123;</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>     <span class="token comment">// 3: å·¦</span>    <span class="token punctuation">&#123;</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.732</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token comment">// 4: å·¦ä¸‹</span>    <span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.732</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">&#125;</span>  <span class="token comment">// 5: å³ä¸‹</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>Eigen<span class="token double-colon punctuation">::</span>Vector3i<span class="token operator">></span> ind<span class="token punctuation">&#123;</span>    <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="id-çš„ä½œç”¨"><a href="#id-çš„ä½œç”¨" class="headerlink" title="id çš„ä½œç”¨"></a>id çš„ä½œç”¨</h2><p>ç»§ç»­çœ‹å‘ main.cpp çš„ main å‡½æ•°ï¼ŒæŠŠç›®å…‰æŠ•å‘è¿™æ®µä»£ç </p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">auto</span> pos_id <span class="token operator">=</span> r<span class="token punctuation">.</span><span class="token function">load_positions</span><span class="token punctuation">(</span>pos<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">auto</span> ind_id <span class="token operator">=</span> r<span class="token punctuation">.</span><span class="token function">load_indices</span><span class="token punctuation">(</span>ind<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// ...</span>r<span class="token punctuation">.</span><span class="token function">draw</span><span class="token punctuation">(</span>pos_id<span class="token punctuation">,</span> ind_id<span class="token punctuation">,</span> rst<span class="token double-colon punctuation">::</span>Primitive<span class="token double-colon punctuation">::</span>Triangle<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬æŠŠ id ä¼ å…¥äº† draw å‡½æ•°æ¥ç”»å›¾ã€‚ä½†ä¸ºä»€ä¹ˆè¦ç”¨ id å‘¢ï¼Ÿç›´æ¥ &amp; ä¼ å‚ä¸è¡Œå—ï¼Ÿ</p><p>ã€TODOï¼šæˆ‘ä¸çŸ¥é“ã€‚AIè¯´åœ¨æ­£å¼çš„æ¸²æŸ“ä»£ç é‡Œï¼Œæˆ‘ä»¬ä¼šåœ¨loadæ—¶åšä¸€äº›æ“ä½œè¯¸å¦‚æŠŠæ•°æ®ä¸Šä¼ åˆ°æ˜¾å­˜ï¼Œæˆ–è€…é‡æ–°ç»„ç»‡ä¸Šä¼ çš„å„ä¸ªæ•°æ®æ¥æé«˜æ•ˆç‡ï¼Œä½†å’±ä¹Ÿä¸çŸ¥é“æ˜¯ä¸æ˜¯çœŸçš„ã€‚ã€‘</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æœ¬æ¬¡ä½œä¸šè¦æ±‚æˆ‘ä»¬å®ç°æ—‹è½¬çŸ©é˜µã€æŠ•å½±çŸ©é˜µã€‚æˆ‘ä»¬å…ˆç®€å•çœ‹ä¸‹ä½œä¸šæ˜¯æ€ä¹ˆåšçš„ï¼Œå†çœ‹çœ‹ä»£ç æ¡†æ¶é‡Œçš„å‡ ä¸ªæœ‰è¶£çš„åœ°æ–¹ã€‚&lt;/p&gt;
&lt;h1 id=&quot;ä½œä¸šå®ç°&quot;&gt;&lt;a href=&quot;#ä½œä¸šå®ç°&quot; class=&quot;headerlink&quot; title=&quot;ä½œä¸šå®ç°&quot;&gt;&lt;/a&gt;ä½œä¸šå®ç°&lt;/h1&gt;&lt;h2 i</summary>
      
    
    
    
    <category term="å…¬å¼€è¯¾" scheme="http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/"/>
    
    <category term="GAMES101" scheme="http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/"/>
    
    <category term="Assignments" scheme="http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/Assignments/"/>
    
    
  </entry>
  
  <entry>
    <title>Note 1 Transformation</title>
    <link href="http://rinevard.github.io/wiki/learning/open-course/GAMES101/Notes/Note1-transformation/"/>
    <id>http://rinevard.github.io/wiki/learning/open-course/GAMES101/Notes/Note1-transformation/</id>
    <published>2025-08-19T07:10:28.000Z</published>
    <updated>2025-08-22T03:14:43.967Z</updated>
    
    <content type="html"><![CDATA[<h1 id="2D-Transformation"><a href="#2D-Transformation" class="headerlink" title="2D Transformation"></a>2D Transformation</h1><p>åœ¨äºŒç»´ç©ºé—´ä¸­ï¼Œæˆ‘ä»¬èƒ½ç”¨äºŒç»´çŸ©é˜µè¡¨ç¤ºæ‰€æœ‰çš„çº¿æ€§å˜æ¢ã€‚ä½†äºŒç»´ç©ºé—´ä¸­çš„å¹³ç§»åœ¨äºŒç»´ç©ºé—´ä¸­ä¸æ˜¯çº¿æ€§å˜æ¢ï¼Œå› æ­¤æˆ‘ä»¬å¸Œæœ›æ‰¾åˆ°å¦ä¸€ä¸ªç©ºé—´ï¼Œå¹¶å°†äºŒç»´ç©ºé—´åµŒå…¥ï¼Œè®©äºŒç»´å¹³ç§»åœ¨è¿™ä¸ªç©ºé—´ä¸­å˜ä¸ºçº¿æ€§å˜æ¢ã€‚æŠŠç¬›å¡å°”åæ ‡æ‰©å±•ä¸ºé½æ¬¡åæ ‡ï¼Œå°±å¾—åˆ°äº†è¿™æ ·çš„ç©ºé—´ã€‚</p><p>å¯¹äºŒç»´ç©ºé—´çš„ä¸€ç‚¹ $(x,y)$ï¼Œä¸‰å…ƒç»„ $(xZ,yZ,Z)$ å³ä¸ºè¯¥ç‚¹çš„é½æ¬¡åæ ‡ã€‚å¦‚ $(1,2)$ å¯è¡¨ç¤ºä¸º $(1,2,1)$ æˆ– $(100,200,100)$. æ¢å¥è¯è¯´ï¼ŒäºŒç»´ç©ºé—´çš„ä»»ä½•ç‚¹éƒ½èƒ½è¡¨ç¤ºä¸ºé½æ¬¡åæ ‡ $(X,Y,Z)$ï¼Œå…¶ä¸­ $Z\neq 0$.</p><p>å¦å¤–ï¼Œå¦‚æœæˆ‘ä»¬æŠŠæ— ç©·è¿œç‚¹ä¹Ÿè€ƒè™‘è¿›æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨ $(x,y,0)$ è¡¨ç¤ºæ— ç©·è¿œç‚¹ã€‚</p><p>å½é‡Œå’•å™œè¯´ä»€ä¹ˆå‘¢ï¼Œå¿«å‘Šè¯‰æˆ‘æ€ä¹ˆç”¨çº¿æ€§å˜æ¢è¡¨ç¤ºå¹³ç§»ï¼</p><p>å¯¹äºŒç»´ç©ºé—´çš„ä¸€ç‚¹ $(x,y)$ï¼Œé¦–å…ˆå°†å®ƒè½¬åŒ–ä¸ºé½æ¬¡åæ ‡å¾—åˆ° $(x,y,1)$ï¼Œç„¶åä¸ä¸‹é¢çš„çŸ©é˜µç›¸ä¹˜</p><script type="math/tex; mode=display">M = \begin{bmatrix}1 & 0 & t_x \\0 & 1 & t_y \\0 & 0 & 1\end{bmatrix}</script><p>å°±å¾—åˆ°äº† $(x+t_x,y+t_y,1)$. ç„¶åå†è½¬æ¢å›ç¬›å¡å°”åæ ‡ï¼Œå°±å¾—åˆ°äº† $(x+t_x,y+t_y)$.</p><p>è¿™æ ·ä¸€æ¥ï¼Œæ—‹è½¬ã€å¹³ç§»å°±èƒ½ç»Ÿä¸€æˆä¸‹é¢çš„å½¢å¼ï¼š</p><script type="math/tex; mode=display">M = \begin{bmatrix}\cos \theta & -\sin \theta & t_x \\\sin \theta & \cos \theta & t_y \\0 & 0 & 1\end{bmatrix}</script><h1 id="3D-Transformation"><a href="#3D-Transformation" class="headerlink" title="3D Transformation"></a>3D Transformation</h1><p>ä¸äºŒç»´çš„æƒ…å†µç±»ä¼¼ï¼Œæˆ‘ä»¬ä¹ŸæŠŠä¸‰ç»´ç©ºé—´åµŒå…¥ä¸€ä¸ªæ–°ç©ºé—´ã€‚</p><p>å¯¹ä¸‰ç»´ç©ºé—´çš„ä¸€ç‚¹ $(x,y,z)$ï¼Œä¸‰å…ƒç»„ $(xS,yS,zS,S)$ å³ä¸ºè¯¥ç‚¹çš„é½æ¬¡åæ ‡ã€‚å¦‚ $(1,2,3)$ å¯è¡¨ç¤ºä¸º $(1,2,3,1)$ æˆ– $(100,200,300,100)$. æ¢å¥è¯è¯´ï¼Œä¸‰ç»´ç©ºé—´çš„ä»»ä½•ç‚¹éƒ½èƒ½è¡¨ç¤ºä¸ºé½æ¬¡åæ ‡ $(X,Y,Z,S)$ï¼Œå…¶ä¸­ $S\neq 0$.</p><p>æˆ‘ä»¬è¿™é‡Œè®¨è®ºå³æ‰‹åæ ‡ç³»ï¼Œä¸‹é¢ç»™å‡ºæŒ‰å³æ‰‹å®šåˆ™æ—‹è½¬ $\theta$ è§’åº¦çš„çŸ©é˜µï¼š</p><script type="math/tex; mode=display">R_x(\theta) = \begin{bmatrix} 1 & 0 & 0 & 0 \\ 0 & \cos \theta & -\sin \theta & 0 \\ 0 & \sin \theta & \cos \theta & 0 \\ 0 & 0 & 0 & 1 \end{bmatrix}</script><script type="math/tex; mode=display">R_y(\theta) = \begin{bmatrix} \cos \theta & 0 & \sin \theta & 0 \\ 0 & 1 & 0 & 0 \\ -\sin \theta & 0 & \cos \theta & 0 \\ 0 & 0 & 0 & 1 \end{bmatrix}</script><script type="math/tex; mode=display">R_z(\theta) = \begin{bmatrix} \cos \theta & -\sin \theta & 0 & 0 \\ \sin \theta & \cos \theta & 0 & 0 \\ 0 & 0 & 1 & 0 \\ 0 & 0 & 0 & 1 \end{bmatrix}</script><p>ä½ ä¼šæ³¨æ„åˆ°æ²¿ $y$ è½´æ—‹è½¬çš„çŸ©é˜µå’Œåˆ«çš„ä¸ä¸€æ ·ï¼Œä½†è¿™æ˜¯å®Œå…¨æ­£ç¡®çš„ï¼Œè®¤çœŸç®—ä¸€ç®—å°±å¥½äº†ã€‚</p><p>ï¼ˆæˆ‘æ²¡æ„Ÿè§‰è¿™é‡Œæœ‰ä»€ä¹ˆâ€œæ·±åˆ»å«ä¹‰â€ï¼Œä½†æ„Ÿè§‰å³ä½¿æœ‰ä¹Ÿåº”è¯¥ä¸ä¼šå¾ˆæœ‰ç”¨â€¦â€¦ï¼‰</p><p>ï¼ˆä¸è¿‡ä¸çŸ¥é“å¦‚æœæ¨å¹¿åˆ° $n$ ç»´æ—‹è½¬ä¼šä¸ä¼šæœ‰ç”¨ï¼‰</p><p>ï¼ˆå¯æˆ‘ä»¬ç”Ÿæ´»åœ¨ä¸‰æ¬¡å…ƒï¼ï¼‰</p><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œ<strong>æ—‹è½¬çŸ©é˜µéƒ½æ˜¯æ­£äº¤çŸ©é˜µ</strong>ï¼Œæ‰€ä»¥å®ƒçš„è½¬ç½®å°±æ˜¯å®ƒçš„é€†ã€‚</p><p>ä¸–ç•Œä¸Šè¿˜å­˜åœ¨ä¸€ä¸ªå«åš <strong>Rodrigues æ—‹è½¬å…¬å¼</strong>çš„ä¸œè¥¿ï¼Œå®ƒç»™å‡ºäº†å‘é‡ $v$ ç»•å•ä½å‘é‡ $k$ æ—‹è½¬ $\theta$ è§’åº¦å¾—åˆ°çš„ç»“æœã€‚ï¼ˆæŒ‰å³æ‰‹å®šåˆ™æ—‹è½¬ï¼‰</p><script type="math/tex; mode=display">\mathbf{v}_{\text{rot}} = \mathbf{v} \cos\theta + (\mathbf{k} \times \mathbf{v}) \sin\theta + \\\mathbf{k}(\mathbf{k} \cdot \mathbf{v})(1 - \cos\theta)</script><p><img src="/images/learning/open-course/GAMES101/Notes/note1/rodrigues.png" alt=""></p><p>å½“ç„¶ä¹Ÿå¯ä»¥æŠŠè¿™ä¸ªæ—‹è½¬çŸ©é˜µå†™å‡ºæ¥ï¼š</p><script type="math/tex; mode=display">\mathbf{R}(\mathbf{k}, \theta) = \cos(\theta)\mathbf{I} + (1 - \cos(\theta))\mathbf{k}\mathbf{k}^T + \sin(\theta)\begin{bmatrix} 0 & -k_z & k_y \\ k_z & 0 & -k_x \\ -k_y & k_x & 0 \end{bmatrix}</script><p>æœ€å³è¾¹é‚£ä¸ªçŸ©é˜µæ˜¯ $k$ çš„å‰ä¹˜çŸ©é˜µå•¦~</p><h1 id="Viewing-transformation"><a href="#Viewing-transformation" class="headerlink" title="Viewing transformation"></a>Viewing transformation</h1><p>2D å’Œ 3D transformation éƒ½æ˜¯åŸºç¡€å˜æ¢ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ç ”ç©¶æ¸¸æˆé‡Œçš„ç”»é¢æ˜¯å¦‚ä½•æ¸²æŸ“åˆ°å±å¹•ä¸Šçš„ã€‚</p><p><img src="/images/learning/open-course/GAMES101/Notes/note1/map-seq.png" alt=""></p><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªæ‘„åƒæœºã€ä¸¤ä¸ªæ–¹å—ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ˜¯æ€ä¹ˆè®¡ç®—å‡ºæ‘„åƒæœºæ‹æ‘„çš„ç”»é¢çš„å‘¢ï¼ˆå‚è€ƒå³ä¸‹è§’ï¼‰ï¼Ÿ</p><p><img src="/images/learning/open-course/GAMES101/Notes/note1/godot-camera.png" alt=""></p><p>æˆ‘ä»¬æŒ‰ç…§ä¸‹é¢çš„æµç¨‹è¿›è¡Œæ“ä½œï¼š</p><h2 id="Camera-transformation"><a href="#Camera-transformation" class="headerlink" title="Camera transformation"></a>Camera transformation</h2><p>é¦–å…ˆï¼Œæˆ‘ä»¬å˜æ¢ç©ºé—´è®©æ‘„åƒæœºä½äºåæ ‡åŸç‚¹ï¼Œä¸”é¢å‘ $z$ è½´è´Ÿæ–¹å‘ï¼Œå¤´é¡¶æœ $y$ è½´æ­£æ–¹å‘ã€‚å¯¹ä¸Šå›¾æ¥è¯´ï¼Œå°±æ˜¯æŠŠ $w$ å˜æ¢ä¸º $z$ è½´ï¼ŒæŠŠ $v$ å˜æ¢ä¸º $y$ è½´ã€‚</p><p>å¯¹åº”çš„çŸ©é˜µæ˜¯</p><script type="math/tex; mode=display">\text{M}_{\text{cam}} =\begin{bmatrix}u_x & u_y & u_z & 0 \\v_x & v_y & v_z & 0 \\w_x & w_y & w_z & 0 \\0 & 0 & 0 & 1\end{bmatrix}\times\begin{bmatrix}1 & 0 & 0 & -\text{cam}_x \\0 & 1 & 0 & -\text{cam}_y \\0 & 0 & 1 & -\text{cam}_z \\0 & 0 & 0 & 1\end{bmatrix}</script><p>è¿™é‡Œçš„å°æŠ€å·§æ˜¯ï¼Œæ—‹è½¬çŸ©é˜µçš„é€†æ˜¯å…¶è½¬ç½®ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆç®—å‡º $xyz$ è½´å˜æ¢åˆ° $uvw$ è½´çš„æ—‹è½¬çŸ©é˜µï¼Œå†å¯¹å…¶è½¬ç½®ï¼Œå°±å¾—åˆ°äº†æŠŠ $uvw$ å˜æ¢åˆ° $xyz$ çš„çŸ©é˜µã€‚</p><h2 id="Projection-transformation"><a href="#Projection-transformation" class="headerlink" title="Projection transformation"></a>Projection transformation</h2><p>ç„¶åï¼Œæˆ‘ä»¬æŠŠç›¸æœºæ‹æ‘„çš„åŒºåŸŸå˜æ¢åˆ° $[-1,1]^3$ ä¸­ï¼Œè¿™æ˜¯ä¸€ä¸ªè§„èŒƒåŒ–ï¼Œä¸ºæœªæ¥æŠŠåŒºåŸŸæ”¾åˆ°å±å¹•ä¸Šåšå‡†å¤‡ã€‚åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬è¦å…ˆç¡®å®šç›¸æœºèƒ½å¤Ÿæ‹æ‘„çš„åŒºåŸŸçš„èŒƒå›´ã€‚è¿™é‡Œæ¶‰åŠåˆ°çš„å˜é‡ä¸»è¦æœ‰ fovã€aspect ratioã€nearã€far. </p><p>ä¸‹å›¾èƒ½æ¸…æ™°åœ°è§£é‡Š fov å’Œ aspect ratioã€‚fov å³ field of viewï¼Œè¡¨ç¤ºç”¨è§’åº¦è¡¡é‡çš„å¯è§èŒƒå›´ï¼›aspect ratio åˆ™æ˜¯æ˜¾ç¤ºåŒºåŸŸçš„å®½é«˜æ¯”ã€‚</p><p><img src="/images/learning/open-course/GAMES101/Notes/note1/fov-and-aspect-ratio.png" alt=""></p><p>near å’Œ far åˆ™å®šä¹‰äº†å‰”é™¤è¾¹ç•Œï¼Œæˆ‘ä»¬åªæ¸²æŸ“æ»¡è¶³ $z \in [\text{near}, \text{far}]$ çš„ä¸œè¥¿ã€‚åŸç‚¹ã€è¿‘å¹³é¢å’ŒåŸå¹³é¢å…±åŒåˆ’åˆ†å‡ºäº†ä¸€å—æœ‰é™çš„ç©ºé—´ï¼Œè¿™å°±æ˜¯æ‘„åƒæœºæ‹æ‘„çš„åŒºåŸŸï¼ˆè§†é”¥ï¼‰ï¼Œæˆ‘ä»¬ä¼šæŠŠä»–å˜æ¢åˆ° $[-1,1]^3$ ä¸­ã€‚</p><p><img src="/images/learning/open-course/GAMES101/Notes/note1/near-far.png" alt=""></p><p>å˜æ¢åˆ†ä¸ºä¸¤æ­¥ï¼Œç¬¬ä¸€æ­¥æ˜¯æŠŠè§†é”¥å˜æ¢ä¸ºé•¿æ–¹ä½“ï¼Œç¬¬äºŒæ­¥æŠŠé•¿æ–¹ä½“å˜æ¢ä¸º $[-1,1]^3$ çš„æ­£æ–¹ä½“ã€‚</p><p>åœ¨ç¬¬ä¸€æ­¥å˜æ¢æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›æ»¡è¶³ä»¥ä¸‹ä¸¤ç‚¹ï¼š</p><ol><li>near å’Œ far å¹³é¢ä¸Šçš„ç‚¹çš„ $z$ å€¼ä¸å˜</li><li>è¿‘å¤§è¿œå°ï¼Œä¸”ç¼©æ”¾æ¯”ä¾‹ç¬¦åˆç›¸ä¼¼ä¸‰è§’å½¢çš„è§„å¾‹</li></ol><p>ç»“åˆé½æ¬¡åæ ‡ï¼Œæˆ‘ä»¬å°±èƒ½å¾—åˆ°ä»¥ä¸‹çŸ©é˜µï¼š</p><script type="math/tex; mode=display">\begin{align*}\text{M}_\text{per}&=\begin{bmatrix}\frac{2}{r-l} & 0 & 0 & -\frac{r+l}{r-l} \\0 & \frac{2}{t-b} & 0 & -\frac{t+b}{t-b} \\0 & 0 & \frac{2}{n-f} & -\frac{n+f}{n-f} \\0 & 0 & 0 & 1\end{bmatrix}\times\begin{bmatrix}n & 0 & 0 & 0 \\0 & n & 0 & 0 \\0 & 0 & n+f & -nf \\0 & 0 & 1 & 0\end{bmatrix}\\&=\begin{bmatrix}\frac{2n}{r-l} & 0 & -\frac{r+l}{r-l} & 0 \\0 & \frac{2n}{t-b} & -\frac{t+b}{t-b} & 0 \\0 & 0 & \frac{n+f}{n-f} & -\frac{2nf}{n-f} \\0 & 0 & 1 & 0\end{bmatrix}\end{align*}</script><p>ç¬¬ä¸€ä¸ªç­‰å·å³è¾¹çš„å¼å­ä¸­ï¼Œå³è¾¹çš„çŸ©é˜µæŠŠè§†é”¥å‹ç¼©ä¸ºä¸€ä¸ªé•¿æ–¹ä½“ï¼Œå·¦è¾¹çš„çŸ©é˜µæŠŠè¿™ä¸ªé•¿æ–¹ä½“å˜æ¢åˆ° $[-1,1]^3$.</p><p><img src="/images/learning/open-course/GAMES101/Notes/note1/rectangle.png" alt=""></p><p>æˆ‘ä»¬å¯ä»¥æ ¹æ® $\text{near},\text{fov},\text{aspectRatio<br>}$ æ±‚å‡º $l,t,r,b$.</p><script type="math/tex; mode=display">\begin{align*}&\text{t} = -n \times \tan\left(\frac{\text{fov}}{2}\right)\\&\text{b} = -\text{t}\\&\text{r} = \text{t} \times \text{aspectRatio}\\&\text{l} = -\text{r}\end{align*}</script><p><img src="/images/learning/open-course/GAMES101/Notes/note1/fov-ltrb.png" alt=""></p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæŠ•å½±çŸ©é˜µå†™ä¸ºï¼š</p><script type="math/tex; mode=display">\large\text{M}_\text{per} =\begin{bmatrix}-\frac{1}{\text{aspect} \times \tan(\frac{\text{fov}}{2})} & 0 & 0 & 0 \\0 & -\frac{1}{\tan(\frac{\text{fov}}{2})} & 0 & 0 \\0 & 0 & \frac{n+f}{n-f} & -\frac{2nf}{n-f} \\0 & 0 & 1 & 0\end{bmatrix}</script><h2 id="Viewport-transformation"><a href="#Viewport-transformation" class="headerlink" title="Viewport transformation"></a>Viewport transformation</h2><p>æœ€åï¼Œæˆ‘ä»¬ä¼šæŠŠ $[-1,1]^3$ çš„å†…å®¹çš„å®½é«˜æ˜ å°„ä¸ºå±å¹•å¤§å°ã€‚åœ¨è¿™ä¸ªå˜æ¢ä¸­ $z$ åæ ‡ä¸å˜ï¼Œå› æ­¤å˜æ¢çŸ©é˜µä¸ºï¼š</p><script type="math/tex; mode=display">\large\text{M}_\text{viewport}=\begin{bmatrix}\frac{width}{2} & 0 & 0 & \frac{width}{2} \\0 & \frac{height}{2} & 0 & \frac{height}{2} \\0 & 0 & 1 & 0 \\0 & 0 & 0 & 1\end{bmatrix}</script><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æ€»è€Œè¨€ä¹‹ï¼Œæˆ‘ä»¬çš„å˜æ¢çŸ©é˜µä¸º</p><script type="math/tex; mode=display">\begin{align*}&\text{M}=\text{M}_\text{viewport}\text{M}_\text{per}\text{M}_\text{cam}\end{align*}</script><p>å…¶ä¸­</p><script type="math/tex; mode=display">\begin{align*}&\text{M}_{\text{cam}} =\begin{bmatrix}u_x & u_y & u_z & 0 \\v_x & v_y & v_z & 0 \\w_x & w_y & w_z & 0 \\0 & 0 & 0 & 1\end{bmatrix}\times\begin{bmatrix}1 & 0 & 0 & -\text{cam}_x \\0 & 1 & 0 & -\text{cam}_y \\0 & 0 & 1 & -\text{cam}_z \\0 & 0 & 0 & 1\end{bmatrix}\\\large&\text{M}_\text{per} =\begin{bmatrix}-\frac{1}{\text{aspect} \times \tan(\frac{\text{fov}}{2})} & 0 & 0 & 0 \\0 & -\frac{1}{\tan(\frac{\text{fov}}{2})} & 0 & 0 \\0 & 0 & \frac{n+f}{n-f} & -\frac{2nf}{n-f} \\0 & 0 & 1 & 0\end{bmatrix}\\&\large\text{M}_\text{viewport}=\begin{bmatrix}\frac{width}{2} & 0 & 0 & \frac{width}{2} \\0 & \frac{height}{2} & 0 & \frac{height}{2} \\0 & 0 & 1 & 0 \\0 & 0 & 0 & 1\end{bmatrix}\end{align*}</script><p>è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬è®¨è®ºçš„ $n$ å’Œ $f$ è¢«å®šä¹‰ä¸ºåæ ‡å€¼ï¼Œå®ƒä»¬æ˜¯å°äº 0 çš„ã€‚ä¸€äº›åœ°æ–¹æŠŠ $n$ å’Œ $f$ å®šä¹‰ä¸ºåˆ°è¿‘/è¿œå¹³é¢çš„è·ç¦»ï¼Œè¿™æ˜¯å¤§äº 0 çš„ï¼Œè¿™ä¼šå¼•èµ·æŠ•å½±çŸ©é˜µçš„å˜åŒ–ã€‚å¦å¤–ï¼Œä¸åŒçš„åæ ‡ç³»çº¦å®šä¹Ÿä¼šå¼•èµ·çŸ©é˜µçš„å˜åŒ–ã€‚</p><p>æ¯”å¦‚åœ¨OpenGLä¸­ï¼Œ $n$ å’Œ $f$ è¢«å®šä¹‰ä¸ºåˆ°è¿‘/è¿œå¹³é¢çš„è·ç¦»ï¼Œè¿™æ˜¯å¤§äº 0 çš„ï¼Œè€Œä¸”ä»–ä»¬çš„ projection transformation æŠŠæ‹æ‘„å†…å®¹ä»å³æ‰‹åæ ‡ç³»çš„è§†å›¾ç©ºé—´æ˜ å°„åˆ°å·¦æ‰‹åæ ‡ç³»çš„æ ‡å‡†è®¾å¤‡åæ ‡ï¼ˆNDCï¼‰ç©ºé—´ã€‚ç‰¹åˆ«åœ°ï¼Œ$z$ è½´çš„ $[ -n,-f]$ è¢«æ˜ å°„åˆ° $[-1,1]$ ï¼ˆè¿™ä¼¼ä¹è¯´æ˜åœ¨ NDC ç©ºé—´ä¸­ï¼Œ$z$ å€¼è¾ƒå°çš„å†…å®¹æ¸²æŸ“æ›´é å‰ï¼Ÿï¼‰</p><p>ä»–ä»¬çš„ $\text{M}_\text{their-per}$ ä¸ºï¼š</p><script type="math/tex; mode=display">\large\text{M}_\text{their-per} =\begin{bmatrix}\frac{1}{\text{aspect} \times \tan(\frac{\text{fov}}{2})} & 0 & 0 & 0 \\0 & \frac{1}{\tan(\frac{\text{fov}}{2})} & 0 & 0 \\0 & 0 & -\frac{f+n}{f-n} & -\frac{2fn}{f-n} \\0 & 0 & -1 & 0\end{bmatrix}</script><p>Godot ä½¿ç”¨å’Œ OpenGL ä¸€æ ·çš„çŸ©é˜µï¼Œä¸‹é¢æ˜¯ä»–ä»¬è®¾ç½® $\text{M}_\text{per}$ çš„ä»£ç ã€‚è¿˜è¦æ³¨æ„çš„æ˜¯ï¼Œä»–ä»¬ä½¿ç”¨ column-major çš„æ–¹æ³•å­˜å‚¨æ•°æ®ï¼Œå³</p><script type="math/tex; mode=display">M =\begin{pmatrix}\text{columns}[0][0] & \text{columns}[1][0] \\\text{columns}[0][1] & \text{columns}[1][1]\end{pmatrix}</script><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">void</span> <span class="token class-name">Projection</span><span class="token double-colon punctuation">::</span><span class="token function">set_perspective</span><span class="token punctuation">(</span>real_t p_fovy_degrees<span class="token punctuation">,</span> real_t p_aspect<span class="token punctuation">,</span> real_t p_z_near<span class="token punctuation">,</span> real_t p_z_far<span class="token punctuation">,</span> <span class="token keyword">bool</span> p_flip_fov<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>p_flip_fov<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>p_fovy_degrees <span class="token operator">=</span> <span class="token function">get_fovy</span><span class="token punctuation">(</span>p_fovy_degrees<span class="token punctuation">,</span> <span class="token number">1.0</span> <span class="token operator">/</span> p_aspect<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>real_t sine<span class="token punctuation">,</span> cotangent<span class="token punctuation">,</span> deltaZ<span class="token punctuation">;</span>real_t radians <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token double-colon punctuation">::</span><span class="token function">deg_to_rad</span><span class="token punctuation">(</span>p_fovy_degrees <span class="token operator">/</span> <span class="token number">2.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>deltaZ <span class="token operator">=</span> p_z_far <span class="token operator">-</span> p_z_near<span class="token punctuation">;</span>sine <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token double-colon punctuation">::</span><span class="token function">sin</span><span class="token punctuation">(</span>radians<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>deltaZ <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>sine <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>p_aspect <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>cotangent <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token double-colon punctuation">::</span><span class="token function">cos</span><span class="token punctuation">(</span>radians<span class="token punctuation">)</span> <span class="token operator">/</span> sine<span class="token punctuation">;</span><span class="token function">set_identity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>columns<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> cotangent <span class="token operator">/</span> p_aspect<span class="token punctuation">;</span>columns<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> cotangent<span class="token punctuation">;</span>columns<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token punctuation">(</span>p_z_far <span class="token operator">+</span> p_z_near<span class="token punctuation">)</span> <span class="token operator">/</span> deltaZ<span class="token punctuation">;</span>columns<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>columns<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">2</span> <span class="token operator">*</span> p_z_near <span class="token operator">*</span> p_z_far <span class="token operator">/</span> deltaZ<span class="token punctuation">;</span>columns<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;2D-Transformation&quot;&gt;&lt;a href=&quot;#2D-Transformation&quot; class=&quot;headerlink&quot; title=&quot;2D Transformation&quot;&gt;&lt;/a&gt;2D Transformation&lt;/h1&gt;&lt;p&gt;åœ¨äºŒç»´ç©ºé—´ä¸­ï¼Œæˆ‘ä»¬èƒ½</summary>
      
    
    
    
    <category term="å…¬å¼€è¯¾" scheme="http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/"/>
    
    <category term="GAMES101" scheme="http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/"/>
    
    <category term="Notes" scheme="http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/Notes/"/>
    
    
  </entry>
  
  <entry>
    <title>æ€æˆ®å°–å¡”çš„æ¡†æ¶å¦‚æ­¤è‡ªæ´½ï¼Œæˆ‘ä»¬èƒ½ç¦»å¼€å®ƒå—ï¼Ÿ</title>
    <link href="http://rinevard.github.io/wiki/game-design/%E6%9D%80%E6%88%AE%E5%B0%96%E5%A1%94%E6%A1%86%E6%9E%B6/"/>
    <id>http://rinevard.github.io/wiki/game-design/%E6%9D%80%E6%88%AE%E5%B0%96%E5%A1%94%E6%A1%86%E6%9E%B6/</id>
    <published>2025-07-10T12:22:38.000Z</published>
    <updated>2025-08-20T11:13:48.877Z</updated>
    
    <content type="html"><![CDATA[<style>img{    width: 70%;}</style><p>æœ€è¿‘åœ¨è®¾è®¡å¡ç‰Œæ¸¸æˆï¼ˆä½ çŸ¥é“çš„ï¼Œæˆ‘ä¸€ç›´æ˜¯ç‰Œä½¬ï¼‰ï¼Œå‘ç°ä»¥å‰åšçš„ç¿»ç‰Œæ¸¸æˆåŸå‹çš„ç¿»ç‰Œç©æ³•æœ¬èº«éšæœºæ€§è¿‡å¼ºï¼Œä»è€Œæ‹“å±•ç©ºé—´è¿‡å°ï¼Œä½†â€œæ£‹ç›˜ä¸Šçš„éšä»äº¤äº’â€éå¸¸æœ‰è¶£ï¼Œäºæ˜¯å°±æ‰“ç®—ä»å®ƒå‡ºå‘å¼€å§‹è¿›ä¸€æ­¥è®¾è®¡ã€‚åˆæ­¥çš„æƒ³æ³•æ˜¯åšå¡ç‰Œè‚‰é¸½ã€‚ï¼ˆå“‡ï¼Œåˆä¸€ä¸ªå¡ç‰Œè‚‰é¸½ï¼‰</p><p><img src="/images/game-design/æ€æˆ®å°–å¡”æ¡†æ¶/reverse_prototype.png" alt=""></p><p>æˆ‘å¯¹è‚‰é¸½å¹¶æ²¡æœ‰ç‰¹åˆ«çš„å–œçˆ±ï¼Œå› ä¸ºæˆ‘ä¸€ç›´æƒ³ç€ï¼Œå¦‚æœæˆ‘ä»¬æ‹¿èµ°äº†ç©å®¶çš„æ—¶é—´ï¼Œèµ·ç è¦è¡¥å¿ä¸€äº›ä»€ä¹ˆï¼Œè€Œè‚‰é¸½ä¼¼ä¹å¹¶æ²¡æœ‰è¡¥å¿ä¸€äº›æˆ‘å¾ˆå–œæ¬¢çš„ä¸œè¥¿ã€‚ä¸è¿‡æ— è®ºå¦‚ä½•ï¼Œæˆ‘è¿˜æ˜¯æŒºå–œæ¬¢æ‰“ç‰Œçš„ï¼Œæ€æˆ®å°–å¡”ã€ç‚‰çŸ³ç‹—å¤´äººå†’é™©ã€é‚ªæ¶å†¥åˆ»éƒ½æ˜¯æˆ‘å¾ˆå–œæ¬¢çš„æ¸¸æˆï¼Œæ‰€ä»¥åšä¸ªå¡ç‰Œè‚‰é¸½ä¹Ÿè¿˜æŒºä¸é”™ã€‚æŒ‰æˆ‘çš„ç†è§£ï¼Œè‚‰é¸½æœ€é‡è¦çš„æ˜¯æ¯ä¸ªå°å…³å¡çš„ä½“éªŒï¼Œå› æ­¤æˆ‘å°±ç€æ‰‹å¼€å§‹åšæ¯å±€ç‰Œå±€çš„åŸå‹äº†ã€‚</p><p>ç„¶åè®©æˆ‘ä»¬å¼€å§‹æœ€æœ‰è¶£çš„è®¾è®¡ç¯èŠ‚ï¼</p><p>ç°åœ¨æˆ‘ä»¬é¢å‰æœ‰ä¸€ä¸ª3x5çš„ç‰Œæ¡Œï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥è¯¥åšä»€ä¹ˆï¼Ÿæˆ‘ä»¬å…ˆéšä¾¿æ‹¿ç‚¹æ‰‹ç‰Œå§ï¼Œå¯ä»¥æŠŠæ‰‹ç‰Œæ”¾åˆ°ç‰Œæ¡Œä¸Šæ¥å¬å”¤éšä»ï¼Œç„¶åå’Œæ•Œæ–¹éšä»æ‰“æ¶ã€‚ä½†æ‰‹ç‰Œä»å“ªé‡Œæ¥ï¼Œè´¹ç”¨æœºåˆ¶åˆæ€ä¹ˆåšå‘¢ï¼Ÿè¿™å°±å¼•å‡ºäº†æœ¬æ–‡çš„æ ¸å¿ƒå†…å®¹â€”â€”æ€æˆ®å°–å¡”çš„æ¡†æ¶å¦‚æ­¤è‡ªæ´½ï¼Œæˆ‘ä»¬èƒ½ç¦»å¼€å®ƒå—ï¼Ÿ</p><h1 id="æ€æˆ®å°–å¡”"><a href="#æ€æˆ®å°–å¡”" class="headerlink" title="æ€æˆ®å°–å¡”"></a>æ€æˆ®å°–å¡”</h1><p>æ€æˆ®å°–å¡”ä¸ºä»€ä¹ˆæ˜¯ç¥ï¼Ÿåœ¨è°ˆè®ºè¿™ä¸ªé—®é¢˜ä¹‹å‰ï¼Œæˆ‘æƒ³å…ˆè¯´è¯´å…¶ä»–å¡ç‰Œæ¸¸æˆç›¸è¾ƒäºçˆ¬å¡”ç©¶ç«Ÿå·®åœ¨äº†å“ªé‡Œï¼ˆè¯¯</p><p>æ€»ä¹‹ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹æ€æˆ®å°–å¡”è‡ªæ´½çš„è®¾è®¡å§ã€‚</p><p><img src="/images/game-design/æ€æˆ®å°–å¡”æ¡†æ¶/slayspire.jpg" alt=""></p><h2 id="å•å±€ç‰Œå±€çš„è‡ªæ´½"><a href="#å•å±€ç‰Œå±€çš„è‡ªæ´½" class="headerlink" title="å•å±€ç‰Œå±€çš„è‡ªæ´½"></a>å•å±€ç‰Œå±€çš„è‡ªæ´½</h2><p>æ€æˆ®å°–å¡”çš„æ‰‹ç‰Œä»å“ªé‡Œæ¥ï¼Œè´¹ç”¨æœºåˆ¶åˆæ˜¯æ€æ ·çš„ï¼Ÿåœ¨æ€æˆ®å°–å¡”ä¸­ï¼Œå¦‚æœä¸è€ƒè™‘ç‰¹æ®Šæ•ˆæœï¼Œæˆ‘ä»¬åœ¨å›åˆå¼€å§‹æ—¶ä¼šä¸¢å¼ƒæ‰€æœ‰æ‰‹ç‰Œå¹¶æŠ½äº”å¼ ç‰Œï¼Œå¹¶ä¸”è´¹ç”¨é‡ç½®ä¸ºä¸‰è´¹ã€‚</p><p>æˆ‘ä»¬å…ˆæ¥èŠèŠå‰è€…ã€‚å‰è€…åœ¨ç©èµ·æ¥æ—¶æ„Ÿè§‰ååˆ†è‡ªç„¶ï¼Œä½†ä»è®¾è®¡çš„è§’åº¦ï¼Œå…¶å®æ˜¯ä¸€ä¸ªå¹¶ä¸æ˜¾ç„¶çš„è®¾è®¡ã€‚æˆ‘ç®€å•è°ƒç ”äº†ä¸€ä¸‹ï¼Œå‘ç°å›åˆå¼€å§‹æ—¶åˆ·æ–°æ‰‹ç‰Œä¼¼ä¹æ˜¯DBGæ¸¸æˆçš„æ ‡é…ï¼Œå…¶å¼€å±±é¼»ç¥–æ˜¯ã€Šçš‡èˆ†äº‰éœ¸ã€‹ï¼ˆDominionï¼‰ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹çœ‹å®ƒæœ‰æ€æ ·çš„æ•ˆæœã€‚</p><p>æˆ‘è®¤ä¸ºæœ€å…³é”®çš„ä¸¤ç‚¹æ˜¯ï¼Œ<strong>å‡å°‘äº†å¡æ‰‹çš„å¯èƒ½æ€§</strong>ã€<strong>é™ä½äº†ç­–ç•¥æ€§</strong>ã€‚åˆ·æ–°æ‰‹ç‰Œæ˜¾ç„¶èƒ½å‡å°‘å¡æ‰‹ï¼Œä½†ä¸ºä»€ä¹ˆé™ä½äº†ç­–ç•¥æ€§å‘¢ï¼Œä»¥åŠè¿™æ˜¯å¥½äº‹å—ï¼Ÿ</p><p>ä¸ºä»€ä¹ˆå®ƒé™ä½äº†ç­–ç•¥æ€§ï¼Ÿå› ä¸ºæ‰‹ç‰Œçš„åˆ·æ–°å°±æ„å‘³ç€ç©å®¶å‡å°‘äº†å¯¹ä¸‹ä¸€å›åˆçš„é¢„æœŸã€‚å›åˆåˆ¶æ¸¸æˆçš„å¾ˆå¤§ä¸€éƒ¨åˆ†ç­–ç•¥æ€§æ˜¯ç”±å¯¹ä¸‹ä¸€å›åˆçš„é¢„æœŸå¼•èµ·çš„ã€‚å¯¹ç‚‰çŸ³ï¼ˆä»¥åŠå¾ˆå¤šCCGï¼‰æ¥è¯´ï¼Œæˆ‘ä¼šæ ¹æ®åœºé¢è€ƒè™‘æ¯å¼ ç‰Œä»€ä¹ˆæ—¶å€™æ‰“å‡ºæœ‰æœ€å¤§æ”¶ç›Šï¼Œç”šè‡³çŒœæµ‹å¯¹æ‰‹æ¥ä¸‹æ¥çš„è¡ŒåŠ¨å¹¶é¢„ç•™ä¸€äº›å¡ç‰Œã€‚è€Œæ€æˆ®å°–å¡”åˆ™æœç»äº†è¿™ç§é¢„æœŸï¼Œè®©ç©å®¶æ ¹æ®æ•Œäººå½“å‰å›åˆçš„æ„å›¾ï¼Œç»“åˆæ¯å›åˆå‘çš„ç‰Œæ‰“æœ€ä¼˜è§£ã€‚</p><p>æ˜¯çš„ï¼Œæœ€ä¼˜è§£ã€‚å¯¹å¾ˆå¤šå¡ç‰Œæ¸¸æˆæ¥è¯´ï¼Œæœ€ä¼˜è§£çš„è®¡ç®—é‡æ˜¯æå¤§çš„ï¼Œè€Œæ€æˆ®å°–å¡”æå¤§åœ°ç®€åŒ–äº†è¿™ä¸ªè®¡ç®—é‡ï¼Œè®©æ¯å›åˆæœ€ä¼˜è§£çš„è®¡ç®—éƒ½å¹¶ä¸å›°éš¾ï¼Œä»è€Œé™ä½äº†æ€ç»´é‡ã€‚è¿™å½“ç„¶ä¸æ˜¯åäº‹ï¼Œæˆ‘è®¤ä¸ºè¿™æ˜¯ç›¸å½“ä¼˜ç§€çš„è®¾è®¡ã€‚æ¸¸æˆå¹¶ä¸æ˜¯ä¸ºäº†éš¾å€’ç©å®¶è€Œå­˜åœ¨çš„ï¼Œæ¯”èµ·éš¾å€’ç©å®¶ï¼Œè®©ç©å®¶é€šè¿‡è‡ªå·±çš„åŠªåŠ›å…‹æœéš¾å…³æ›´é‡è¦ã€‚</p><p><img src="/images/game-design/æ€æˆ®å°–å¡”æ¡†æ¶/doc-pengpeng.jpg" alt=""></p><p>å¦‚æœæ‰‹ç‰Œåˆ·æ–°ï¼Œé‚£è´¹ç”¨è‡ªç„¶ä¹Ÿè¦åˆ·æ–°ï¼Œè¿™ä¾¿æ˜¯æ‰‹ç‰Œå’Œè´¹ç”¨çš„è‡ªæ´½äº†ã€‚è€Œç”±æ­¤ä¹Ÿèƒ½æ¨å‡ºæ€æˆ®å°–å¡”ä¸åšéšä»çš„ç†ç”±äº†ã€‚éšä»æ˜¯æŒç»­æ€§çš„ï¼Œè€Œæ³•æœ¯æ˜¯ä¸€æ¬¡æ€§çš„ã€‚å¦‚æœæ‰‹ç‰Œåœ¨åˆ·æ–°ï¼Œé‚£æ€ä¹ˆå’Œéšä»æ‰“comboå‘¢ï¼Ÿ</p><p>æ‰€ä»¥æˆ‘è®¤ä¸ºæ€ªç‰©ç«è½¦å¹¶ä¸å¦‚æ€æˆ®å°–å¡”è‡ªæ´½ã€‚æˆ‘è¿™å›åˆè´¹ç”¨ä¸è¶³ä»¥æ‰“å‡ºæ‰€æœ‰çš„æ²»ç–—ç‰Œï¼Œç„¶åå›åˆç»“æŸæ²»ç–—ç‰Œå°±å…¨è¢«æ‰”åˆ°å¼ƒç‰Œå †é‡Œäº†ï¼Œé‚£æˆ‘ç¼ºçš„comboè°ç»™æˆ‘è¡¥å•ŠğŸ˜­</p><p>å¦‚æœæ€»ç»“ä¸€ä¸‹ï¼Œæˆ‘ä¼šè¯´æ€æˆ®å°–å¡”çš„æ¯ä¸€å±€éƒ½ç»™æˆ‘å¸¦æ¥äº†ç‚‰çŸ³é‡Œå¥¥ç§˜æ³•èˆ¬çš„ä½“éªŒï¼Œä¾é æ³•æœ¯è½°ç‚¸åˆ›æ­»å¯¹é¢ï¼Œä½†æ²¡æœ‰å¾ˆå¤šçš„åŒæ—¶ä¾é å¤šå¼ å¡ç‰Œçš„comboï¼Œ<strong>å•å±€ç‰Œå±€</strong>è¿è¥ä¸å¤šã€‚</p><h2 id="æ¯å±€æ¸¸æˆçš„è‡ªæ´½"><a href="#æ¯å±€æ¸¸æˆçš„è‡ªæ´½" class="headerlink" title="æ¯å±€æ¸¸æˆçš„è‡ªæ´½"></a>æ¯å±€æ¸¸æˆçš„è‡ªæ´½</h2><p>æ¯å±€æ¸¸æˆçš„è‡ªæ´½åˆå¯ä»¥åˆ†ä¸ºæ€ç»´é‡è¦æ±‚çš„å¼ å¼›æœ‰åº¦ï¼Œä»¥åŠæ¸¸æˆæœºåˆ¶æœ¬èº«çš„è‡ªæ´½ã€‚</p><p>å…ˆè¯´å‰è€…ã€‚å•å±€ç‰Œå±€ç­–ç•¥æ€§è¾ƒä½ï¼Œä½†ä¸€æ•´å±€æ¸¸æˆä¸­è¿è¥æ˜¯ä¸€ä¸ªç­–ç•¥æ€§å¾ˆé«˜çš„æ“ä½œï¼Œä¹Ÿå› æ­¤æ—¢ä¸ä¼šç©å¾—å¤ªç´¯ï¼Œä¹Ÿä¸ä¼šå¤ªç®€å•ã€‚</p><p>å†è¯´åè€…ã€‚ä¸»è¦è¦è¯´çš„æ˜¯â€œè¡€é‡ä¿æŒâ€çš„æœºåˆ¶ã€‚å¦‚æœå•å±€ç‰Œå±€çš„åŒæ–¹å§‹ç»ˆå¼ºåº¦æ¥è¿‘ï¼ˆæ¯”å¦‚å¯¹ç§°å¼å¡ç‰Œæ¸¸æˆï¼‰ï¼Œé‚£è¡€é‡æ˜¾ç„¶ä¹Ÿæ˜¯éœ€è¦åœ¨æ¯å±€åˆ·æ–°çš„ã€‚ä¸è¿‡å¯¹éå¯¹ç§°æ¸¸æˆæ¥è¯´ï¼Œæ§åˆ¶å¼ºåº¦æ¥è¿‘å®åœ¨æœ‰ç‚¹å›°éš¾ï¼Œè¡€é‡ä¿æŒå’Œæ¯ä¸€å¤§å±‚çš„è¡€é‡å›å¤æ˜¯ä¸€ä¸ªç®€å•çš„å¹³è¡¡æ‰‹æ®µã€‚</p><p>åŸæœ¬è¿˜æƒ³è¯´è¯´æ˜“è¿›éš¾å‡ºçš„å¡ç»„ï¼Œä½†å®åœ¨æ²¡æ„Ÿè§‰å®ƒå’Œåˆ«çš„ä¸œè¥¿å¾ˆâ€œè‡ªæ´½â€ã€‚æˆ‘å¯¹æœºåˆ¶â€œè‡ªæ´½â€çš„ç†è§£æ˜¯æŠŠè¿™ä¸ªæœºåˆ¶æ¢æˆåˆ«çš„ï¼Œæ¸¸æˆå°±å¾ˆéš¾å·¥ä½œäº†ã€‚æ¯”å¦‚æŠŠæŠ½å¡æ¢æˆæ¯å›åˆæŠ½ä¸€å¼ ï¼Œé‚£è´¹ç”¨é‡ç½®å°±ä¼šå¯¼è‡´ä¸€ä¸‹å°±æŠŠç‰Œæ‰“å®Œï¼›æŠŠè¡€é‡æ¢æˆæ¯å±€é‡ç½®ï¼Œé‚£æ¸¸æˆå°±ç®€å•ä¸€å¤§æˆªäº†ã€‚</p><p>è€Œå¡ç»„çš„æ˜“è¿›éš¾å‡ºçœ‹èµ·æ¥æ˜¯ä¸€ä¸ªæ§åˆ¶å¼ºåº¦çš„è‡ªç„¶æ‰‹æ®µï¼Œç®€å•åœ°æŠŠå®ƒæ”¹ä¸ºé™åˆ¶å¡ç»„æœ€å°‘åäº”å¼ ï¼Œå…è®¸è‡ªç”±å¢åˆ ï¼Œä¼¼ä¹ä¹Ÿä¸ä¼šç ´åæ•´ä¸ªæ¸¸æˆã€‚è™½ç„¶æ²¡æœ‰åŸæ¥å¥½ï¼Œä½†è‡³å°‘ä¸æ˜¯æ¯ç­æ€§çš„ã€‚</p><p><img src="/images/game-design/æ€æˆ®å°–å¡”æ¡†æ¶/slayspire-shop.jpg" alt=""></p><p>æœ‰è¶£çš„æ˜¯ï¼Œæ€æˆ®å°–å¡”ä¼¼ä¹å¹¶æ²¡æœ‰å¾ˆå¤šæé«˜å•å¡å¼ºåº¦çš„æ‰‹æ®µï¼Œè€Œè®¸å¤šç±»ä¼¼çš„å¡ç‰Œè‚‰é¸½ä¼šåšå¤§é‡çš„å•å¡å¼ºåº¦çš„æé«˜ã€‚æ¯”å¦‚â€”â€”é‚ªæ¶å†¥åˆ»ã€‚</p><h1 id="é‚ªæ¶å†¥åˆ»"><a href="#é‚ªæ¶å†¥åˆ»" class="headerlink" title="é‚ªæ¶å†¥åˆ»"></a>é‚ªæ¶å†¥åˆ»</h1><p>æˆ‘ä»¬èŠèŠè±è¥¿æ¨¡ç»„ï¼Œè¿™æœ€æ¥è¿‘å¡ç‰Œè‚‰é¸½ã€‚</p><h2 id="å•å±€ç‰Œå±€çš„è‡ªæ´½-1"><a href="#å•å±€ç‰Œå±€çš„è‡ªæ´½-1" class="headerlink" title="å•å±€ç‰Œå±€çš„è‡ªæ´½"></a>å•å±€ç‰Œå±€çš„è‡ªæ´½</h2><p>é‚ªæ¶å†¥åˆ»æ¯å›åˆæŠ½ä¸€å¼ ç‰Œï¼ˆå¯é€‰æŠ½ç‰Œç»„çš„ç‰Œæˆ–è€…æ¾é¼ ç‰Œï¼‰ï¼Œè´¹ç”¨ä¸è‡ªç„¶å›å¤ï¼Œè€Œæ˜¯ä¾é çŒ®ç¥­éšä»è·å¾—ã€‚å®ƒçš„åŸå‹æ¥è‡ªludum dare 43è¿™åœºgamejamï¼ŒçŒ®ç¥­æœºåˆ¶åœ¨é‚£é‡Œå°±è¢«å®šä¸‹æ¥äº†ã€‚çŒ®ç¥­æœºåˆ¶ç¡®å®éå¸¸å¥½ç©ï¼Œæ‰€ä»¥æ•´ä¸ªæ¸¸æˆéƒ½æ˜¯ä»¥å®ƒä¸ºæ ¸å¿ƒå‘å±•å‡ºå»çš„ã€‚ </p><p><img src="/images/game-design/æ€æˆ®å°–å¡”æ¡†æ¶/sacrifice-jam.png" alt=""></p><p>çŒ®ç¥­æ˜¯è´¹ç”¨æœºåˆ¶ï¼Œé‚£æŠ½ç‰Œæœºåˆ¶æ˜¯æ€ä¹ˆæ ¹æ®çŒ®ç¥­è¢«ç¡®å®šçš„å‘¢ï¼ŸæŠ½ç‰Œæ— éä¸¤ç§ï¼Œä¸€ç§æ˜¯åˆ·æ–°ï¼Œä¸€ç§æ˜¯ä¿ç•™æ‰‹ç‰Œæ¯å›åˆæŠ½å¡ã€‚çŒ®ç¥­æœºåˆ¶å¯¼è‡´é«˜è´¹ç‰Œéš¾ä»¥ç«‹å³æ‰“å‡ºï¼Œæ¯•ç«Ÿå¦‚æœæŠŠé«˜è´¹ç‰Œåˆ·æ‰ï¼Œä¸‹æ¬¡æŠ½åˆ°å°±ä¸çŸ¥é“æ˜¯ä»€ä¹ˆæ—¶å€™äº†ã€‚æ‰€ä»¥æ˜¾ç„¶ä¿ç•™æ‰‹ç‰Œæ›´åˆé€‚ã€‚</p><p>æ¯”èµ·æ€æˆ®å°–å¡”ï¼Œé‚ªæ¶å†¥åˆ»çš„å•å±€ç‰Œå±€æ›´å…·â€æŒç»­æ€§â€œï¼Œæˆ‘ä»¬ä¸ä»…èƒ½è€ƒè™‘åˆ°ä¸‹ä¸€å›åˆï¼Œè¿˜èƒ½è€ƒè™‘åˆ°ä¸‹ä¸‹å›åˆã€‚éšä»ç«™åœºã€æ‰‹ç‰Œä¸åˆ·æ–°ã€çŒ®ç¥­æœºåˆ¶éƒ½æ˜¯æŒç»­æ€§çš„ä½“ç°ã€‚</p><p>ä½†è¿æ°”æˆåˆ†å®åœ¨æ˜¯å¤ªé«˜äº†ï¼è¿‡ç‰Œçš„ç¼ºä¹å¯¼è‡´æˆ‘ä»¬æåº¦ä¾èµ–äºèµ·æ‰‹ï¼Œè´¹ç”¨ä¸è‡ªç„¶å›å¤å’Œäº”ç‚¹ä¼¤å®³å·®å°±è¾“åˆå¼ºåŒ–äº†è¿™ä¸€ç‚¹ã€‚</p><p>ä¸è¿‡è¯´åˆ°åº•ï¼Œè¿™äº›é—®é¢˜éƒ½æ˜¯å› ä¸ºæ¯å›åˆåªæŠ½ä¸€å¼ ç‰Œå¯¹å¡ç»„æ„ç­‘æå‡ºäº†æé«˜çš„è¦æ±‚ã€‚å¥½ç‰Œå¯èƒ½æ²‰åº•ï¼Œæ–°ç‰Œä¹Ÿå¯èƒ½æ²‰åº•ï¼Œä¸€æ²‰åº•è¿™å±€å°±æ²¡æ³•ç©äº†ã€‚</p><p>ä½œè€…Danielç”¨å¥‡å¦™çš„æ–¹å¼è§£å†³äº†é—®é¢˜â€”â€”åœ¨åœ°å›¾ä¸Šæä¾›å¤§é‡çš„ç‰Œç»„æ”¹é€ èŠ‚ç‚¹ï¼Œå¹¶é¼“åŠ±è¶…æ¨¡å•å¡ã€‚æˆ‘ä»¬ä¼šåœ¨ä¸‹ä¸€èŠ‚è®¨è®ºè¿™ä¸€ç‚¹ã€‚</p><p>åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹é‚ªæ¶å†¥åˆ»çš„åŸå‹å§ï¼š<a href="https://dmullinsgames.itch.io/sacrifices-must-be-made">https://dmullinsgames.itch.io/sacrifices-must-be-made</a></p><h2 id="æ¯å±€æ¸¸æˆçš„è‡ªæ´½-1"><a href="#æ¯å±€æ¸¸æˆçš„è‡ªæ´½-1" class="headerlink" title="æ¯å±€æ¸¸æˆçš„è‡ªæ´½"></a>æ¯å±€æ¸¸æˆçš„è‡ªæ´½</h2><p><img src="/images/game-design/æ€æˆ®å°–å¡”æ¡†æ¶/inscription.png" alt=""></p><p>å¦‚æˆ‘ä»¬ä¹‹å‰æ‰€è¨€ï¼Œæ¯å›åˆåªæŠ½ä¸€å¼ ç‰Œå¯¹å¡ç»„æ„ç­‘æå‡ºäº†æé«˜çš„è¦æ±‚ã€‚ä¸€ä¸ªè‡ªç„¶çš„æ€è·¯æ˜¯å…è®¸ç©å®¶è‡ªç”±è°ƒæ•´å¡ç»„ï¼Œåªæ˜¯è®¾ç½®äº›è®¸é™åˆ¶ï¼Œæ¯”å¦‚æ¯å¼ ç‰Œæœ€å¤šå¸¦ä¸¤å¼ ã€è‡³å°‘äºŒåå¼ ç‰Œä»€ä¹ˆçš„ã€‚ä½†é‚ªæ¶å†¥åˆ»å¹¶ä¸æ˜¯è¿™ä¹ˆåšçš„ã€‚</p><p>åœ¨é‚ªæ¶å†¥åˆ»ä¸­ï¼Œåˆ å¡å¹¶ä¸æ˜¯å¾ˆå›°éš¾çš„äº‹ï¼Œé€ è¶…æ¨¡å•å¡ä¹Ÿéå¸¸ç®€å•ã€‚ç¥­å›ã€çœŸèŒå­¦å®¶èŠ‚ç‚¹å¯ä»¥åŒæ—¶å®ç°è¿™ä¸¤ç‚¹ï¼Œéª¨ç‹å¯ä»¥åˆ å¡ï¼Œç”»å®¶å¯ä»¥å¤åˆ¶è¶…æ¨¡å•å¡ï¼Œæ¯å±‚å¯ä»¥æ‹¿ä¸¤ä¸‰å¼ ç¨€æœ‰å¡ã€‚è¿™å°±è®©ç©å®¶èƒ½å¤Ÿè¿…é€Ÿæå‡å•å¡è´¨é‡ï¼Œé è¶…æ¨¡å•å¡å’Œå¯¹é¢æ‰“æ¶ã€‚</p><p>ä¹Ÿå› æ­¤åœ¨é‚ªæ¶å†¥åˆ»ä¸­ç»å¸¸ä¼šå‡ºç°ä¸€å›åˆç§’å¯¹é¢çš„å±€ï¼Œè¯´å®è¯æˆ‘è§‰å¾—è¿™å¹¶ä¸æ˜¯å¤ªå¥½çš„è®¾è®¡ï¼Œä¸è¿‡ç¡®å®æŒºè‡ªæ´½çš„ã€‚</p><h1 id="æˆ‘çš„æ¸¸æˆ"><a href="#æˆ‘çš„æ¸¸æˆ" class="headerlink" title="æˆ‘çš„æ¸¸æˆ"></a>æˆ‘çš„æ¸¸æˆ</h1><p>ï¼ˆå“‡ï¼Œä½ çš„æ¸¸æˆå’Œæ€æˆ®å°–å¡”ã€é‚ªæ¶å†¥åˆ»éƒ½æ˜¯ä¸€çº§æ ‡é¢˜ï¼Œé‚£ä¸€å®šå’Œä»–ä»¬ä¸€æ ·å‰å®³å§</p><p><img src="/images/game-design/æ€æˆ®å°–å¡”æ¡†æ¶/reverse_prototype.png" alt=""></p><p>ç°åœ¨æˆ‘ä»¬é¢å‰æœ‰ä¸€ä¸ª3x5çš„ç‰Œæ¡Œï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥è¯¥åšä»€ä¹ˆï¼Ÿæˆ‘ä»¬å…ˆéšä¾¿æ‹¿ç‚¹æ‰‹ç‰Œå§ï¼Œå¯ä»¥æŠŠæ‰‹ç‰Œæ”¾åˆ°ç‰Œæ¡Œä¸Šæ¥å¬å”¤éšä»ï¼Œç„¶åå’Œæ•Œæ–¹éšä»æ‰“æ¶ã€‚ä½†æ‰‹ç‰Œä»å“ªé‡Œæ¥ï¼Œè´¹ç”¨æœºåˆ¶åˆæ€ä¹ˆåšå‘¢ï¼Ÿ</p><p>éšä»æ˜¯ç«™åœºçš„æŒç»­æ€§çš„ä¸œè¥¿ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±ä¸åˆ·æ–°æ‰‹ç‰Œäº†ï¼Œè€Œæ˜¯æ¯å›åˆæŠ½ä¸€å¼ ç‰Œã€‚è´¹ç”¨åˆ·æ–°ä¹Ÿæœªå°ä¸å¯ï¼Œä¸è¿‡æˆ‘æŒºå–œæ¬¢é‚ªæ¶å†¥åˆ»çš„çŒ®ç¥­æœºåˆ¶çš„ï¼Œæ‰€ä»¥å°±ç›´æ¥æ¬è¿‡æ¥ç”¨äº†ã€‚é‚ªæ¶å†¥åˆ»å¤ªå¡æ‰‹äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¯å›åˆå†ç»™ç©å®¶å¡ä¸€å¼ æ¾é¼ ç‰Œã€‚</p><p>ä¸è¿‡è¦è¯´æ˜çš„æ˜¯ï¼Œè¿™äº›åªæ˜¯ç†è®ºæ¨å¯¼ã€‚åœ¨å®é™…åšåŸå‹çš„æ—¶å€™æˆ‘ä¹Ÿæµ‹è¯•äº†åˆ·æ–°æ‰‹ç‰Œã€åˆ·æ–°è´¹ç”¨ï¼Œå‘ç°ç¡®å®è¿˜æ˜¯æ¯å›åˆæŠ½ä¸€å¼ ç‰Œ+çŒ®ç¥­æœºåˆ¶å’Œè¿™ä¸ªéšä»äº¤äº’æœºåˆ¶çš„å¥‘åˆåº¦æœ€é«˜ã€‚ç†è®ºå’Œå®é™…ç›¸ç¬¦è¯´æ˜ç†è®ºæœ‰ä¸€å®šæŒ‡å¯¼æ„ä¹‰ï¼Œä»¥åå¯ä»¥æ¥ç€ç”¨ï¼Œç†è®ºä¸å®é™…ä¸ç¬¦è¯´æ˜ç†è®ºåœ¨èƒ¡æ‰¯ï¼Œå°±è¦è°ƒæ•´äº†ã€‚</p><p>è‡³æ­¤ï¼Œæˆ‘ä»¬å®Œæˆäº†å•å±€ç‰Œå±€çš„è®¾è®¡ã€‚ä¹‹åæˆ‘æŠŠç‰Œæ¡Œæ”¹æˆäº†4x5ï¼Œå‘ç°æ›´æœ‰ç­–ç•¥ä¹Ÿæ›´å¥½ç©äº†ï¼Œæ‰¾äººè¯•ç©äº†ä¸€ä¸‹ä¹‹åæ¿€è¿›åœ°æ”¹æˆäº†5x7ï¼Œå±…ç„¶åˆæ›´æœ‰ç­–ç•¥æ›´å¥½ç©äº†ï¼Œé‚£æš‚æ—¶å°±è¿™æ ·å§ã€‚</p><p><img src="/images/game-design/æ€æˆ®å°–å¡”æ¡†æ¶/5x7prototype.png" alt=""></p><p>è¿™é‡Œæ˜¯è¯•ç©é“¾æ¥ï¼š</p><p><a href="/games/card-chess-prototype/index.html" target="_blank" rel="noopener noreferrer">å¼€å§‹æ¸¸æˆï¼ˆå°†åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€ï¼‰</a></p><p>å–œæ¬¢çš„è¯å¯ä»¥å¡«ä¸ªé—®å·ï¼Œè°¢è°¢å–µï¼</p><p><a href="https://wj.qq.com/s2/23112055/a88d/" target="_blank" rel="noopener noreferrer">é—®å·ï¼ˆå°†åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€ï¼‰</a></p><p>é‚£ä¹ˆæ¯å±€æ¸¸æˆè¯¥æ€ä¹ˆåšå‘¢ï¼Ÿç”±äºæˆ‘ä»¬çš„æœºåˆ¶å’Œé‚ªæ¶å†¥åˆ»ç›¸ä¼¼ï¼Œæ‰€ä»¥å®ƒä¼šé‡åˆ°çš„é—®é¢˜æˆ‘ä»¬ä¹Ÿéƒ½ä¼šé‡åˆ°ã€‚æœ€å…³é”®çš„ä¸¤ç‚¹å°±æ˜¯ç‰Œè¶Šå¤šè¶Šèœå’Œå…³é”®ç‰Œæ²‰åº•ã€‚</p><p>ä¸€å¼€å§‹æˆ‘å°è¯•è§£å†³å‰è€…ï¼Œç„¶åå¶ç„¶é—´å¾—åˆ°äº†ä¸€ä¸ªæˆ‘è§‰å¾—è¿˜ä¸é”™çš„ï¼Œèƒ½åŒæ—¶è§£å†³è¿™ä¸¤ä¸ªé—®é¢˜çš„æ–¹æ¡ˆã€‚</p><p>è§£å†³é—®é¢˜æ— éä»å•å±€ç‰Œå±€å’Œæ•´å±€æ¸¸æˆè€ƒè™‘ï¼Œæˆ‘æƒ³äº†åŠå¤©æ²¡æƒ³åˆ°æ€ä¹ˆç”¨åœ¨å•å±€å†…è§£å†³é—®é¢˜ï¼Œäºæ˜¯å°±æƒ³ç ”ç©¶ä¸‹é€šè¿‡è°ƒæ•´æ•´å±€æ¸¸æˆçš„è¿è¥æ¥è§£å†³é—®é¢˜ã€‚</p><p>åœ¨ç©å¡ç‰Œè‚‰é¸½çš„æ—¶å€™ï¼Œæˆ‘ä»¬ç»å¸¸é‡åˆ°é€‰ç‰ŒåŠ å…¥ç‰Œç»„ä¸å¦‚è·³è¿‡çš„æƒ…å†µï¼Œè¿™å°±æ˜¯å…¸å‹çš„â€œç‰Œè¶Šå¤šè¶Šèœâ€ã€‚é‚£æ€ä¹ˆä¿è¯æ¯æ¬¡é€‰ç‰Œéƒ½æœ‰è¡¥å¼ºå‘¢ï¼Ÿè€ƒè™‘åˆ°æˆ‘ä»¬çš„çŒ®ç¥­æœºåˆ¶ï¼Œæˆ‘å°±æƒ³åˆ°æŠŠå¯é€‰ç‰ŒçŒ®ç¥­æˆéšæ—¶å¯ä»¥ä½¿ç”¨çš„ä¸€æ¬¡æ€§é“å…·ï¼Œè¿™æ ·æ¯æ¬¡é€‰ç‰Œéƒ½è‡³å°‘èƒ½è®©ç©å®¶å˜å¼ºä¸€ç‚¹ã€‚</p><p>é“å…·æ€ä¹ˆåšå‘¢ï¼Ÿåˆæ­¥æƒ³æ³•æ˜¯æŠŠç‰Œçš„è´¹ç”¨å‡åŠï¼Œæ³•æœ¯ç‰Œä¸å˜ï¼Œéšä»ç‰Œåœ¨ä¸‹ä¸ªå›åˆå¼€å§‹æ—¶è‡ªåŠ¨è¢«çŒ®ç¥­ã€‚</p><p>æœ‰è¶£çš„æ˜¯ï¼Œå®ƒä¹Ÿç¼“è§£äº†å…³é”®ç‰Œæ²‰åº•çš„é—®é¢˜ï¼Œæ¯•ç«Ÿä¸€æ–¹é¢é“å…·èƒ½å¸®åŠ©æˆ‘ä»¬è¿‡æ¸¡ï¼Œå¦ä¸€æ–¹é¢æˆ‘ä»¬ä¹Ÿèƒ½ç›´æ¥æŠŠå…³é”®ç‰ŒçŒ®ç¥­æˆé“å…·ï¼Œç„¶åå°±ä¸ç”¨æ‹…å¿ƒæ²‰åº•äº†ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;style&gt;
img{
    width: 70%;
}
&lt;/style&gt;

&lt;p&gt;æœ€è¿‘åœ¨è®¾è®¡å¡ç‰Œæ¸¸æˆï¼ˆä½ çŸ¥é“çš„ï¼Œæˆ‘ä¸€ç›´æ˜¯ç‰Œä½¬ï¼‰ï¼Œå‘ç°ä»¥å‰åšçš„ç¿»ç‰Œæ¸¸æˆåŸå‹çš„ç¿»ç‰Œç©æ³•æœ¬èº«éšæœºæ€§è¿‡å¼ºï¼Œä»è€Œæ‹“å±•ç©ºé—´è¿‡å°ï¼Œä½†â€œæ£‹ç›˜ä¸Šçš„éšä»äº¤äº’â€éå¸¸æœ‰è¶£ï¼Œäºæ˜¯å°±æ‰“ç®—ä»å®ƒå‡ºå‘å¼€å§‹è¿›ä¸€æ­¥è®¾è®¡ã€‚åˆæ­¥çš„æƒ³æ³•æ˜¯</summary>
      
    
    
    
    <category term="æ¸¸æˆè®¾è®¡" scheme="http://rinevard.github.io/categories/%E6%B8%B8%E6%88%8F%E8%AE%BE%E8%AE%A1/"/>
    
    
  </entry>
  
  <entry>
    <title>_æˆ‘ä¹Ÿæƒ³åšå‡ºä¼˜ç§€çš„ä½œå“</title>
    <link href="http://rinevard.github.io/wiki/others/thoughts/%E6%88%91%E4%B9%9F%E6%83%B3%E5%81%9A%E5%87%BA%E4%BC%98%E7%A7%80%E7%9A%84%E4%BD%9C%E5%93%81/"/>
    <id>http://rinevard.github.io/wiki/others/thoughts/%E6%88%91%E4%B9%9F%E6%83%B3%E5%81%9A%E5%87%BA%E4%BC%98%E7%A7%80%E7%9A%84%E4%BD%9C%E5%93%81/</id>
    <published>2025-06-16T14:03:30.000Z</published>
    <updated>2025-07-18T15:06:40.639Z</updated>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘åšäº†<a href="https://rinevard.itch.io/myriad-by-cards">ç‰Œç”Ÿä¸‡ç‰©</a>ï¼Œæ„Ÿè§‰æŒºéš¾å—çš„ã€‚ä¸€ç›´ä»¥æ¥æˆ‘éƒ½å¸Œæœ›æ¯ä¸€éƒ¨ä½œå“éƒ½åšå¾—æ¯”ä¸Šä¸€éƒ¨æ›´å¥½ï¼Œè¿™ä¸€éƒ¨çœ‹èµ·æ¥æ¯”<a href="https://rinevard.itch.io/undertetris">undertetris</a>å¥½ä¸€ç‚¹å—ï¼Ÿæˆ–è®¸å§ï¼Œä½†æˆ‘å°±æ˜¯æ„Ÿè§‰ä¸å¼€å¿ƒã€‚</p><p>æƒ³æ¥å¯èƒ½æ˜¯å› ä¸ºè¿™ä¸æ˜¯æˆ‘å–œæ¬¢çš„ä½“éªŒå§ã€‚æˆ‘æƒ³åšå‡ºèƒ½æ‰“åŠ¨ç©å®¶çš„ä½œå“ï¼Œèƒ½è®©ç©å®¶è®°ä½ä¸€è¾ˆå­ï¼Œè‡³å°‘æ˜¯ä¸€å¹´çš„ä½œå“ï¼Œè€Œä¸æ˜¯è¿™æ ·çš„è«åå…¶å¦™çš„â€œèåˆå¡ç‰Œâ€ã€‚ç©ç€è¿™ä¸ªæ¸¸æˆæ—¶ï¼Œæ¯”èµ·å¯¹ä½œå“çš„æ»¡æ„ï¼Œæ›´å¤šçš„æ˜¯çƒ¦èºã€‚ä¹Ÿå¯èƒ½æ˜¯å› ä¸ºç°åœ¨æ˜¯è€ƒè¯•å‘¨å‹åŠ›å¤§å§ï¼Œæˆ‘ä¹Ÿä¸æ¸…æ¥šã€‚</p><p>æˆ‘æƒ³å’ŒLLMä¸€èµ·åˆ›é€ ä¸€ä¸ªä¸–ç•Œå•Šï¼Œä¸€ä¸ªæ ©æ ©å¦‚ç”Ÿçš„ä¸–ç•Œã€‚æ¯ä¸ªäº‹ä»¶éƒ½è®©äººæ€è€ƒï¼Œæ¯ä¸ªè§’è‰²éƒ½ç»™äººæ·±åˆ»å°è±¡ï¼Œè€Œä¸æ˜¯ç°åœ¨çš„åè¯å †ç Œã€æ•°å€¼è†¨èƒ€ã€‚LLMä¸ä¼šå†™æ•…äº‹ä»æ¥éƒ½ä¸æ˜¯å€Ÿå£ï¼Œæˆ‘ä»¬æ˜¯ä¸æ˜¯æœ¬å¯ä»¥åšå¾—æ›´å¥½ï¼Ÿ</p><p>æˆ‘è¯¥æ€ä¹ˆåšæ‰å¥½ï¼Ÿæˆ‘è¯¥å‰å¾€ä½•æ–¹ï¼Ÿ</p><p>æˆ‘çŸ¥é“ï¼Œè®©LLMç”Ÿæˆçš„ä¸–ç•Œåƒã€Šè‹ä¸¹çš„æ¸¸æˆã€‹ä¸€æ ·æœ¬èº«å°±æ˜¯ä¸€ä»¶ä¸ç°å®çš„äº‹æƒ…ã€‚ä½†èµ·ç å®ƒè¦åƒæ˜¯ä¸€ä¸ªä¸–ç•Œå§ï¼Œæ•´ä¸ªå†’é™©æ˜¯æœ‰æ•…äº‹æ€§çš„å§ï¼Œç°åœ¨æ˜¯ä¸ªä»€ä¹ˆç©æ„ï¼Ÿï¼Ÿï¼Ÿæ›´å¯æ°”çš„æ˜¯è¿™ç©æ„è¿˜çœŸæœ‰å¯ç©æ€§ï¼Œåšäº†ä¸€ä¸ªé å¼ºåŒ–ç¨‹åºå’Œæ•°å€¼è†¨èƒ€å †ç Œèµ·æ¥çš„ä¸œè¥¿çœŸåƒæ˜¯å¯¹è‡ªå·±çš„ä¾®è¾±ï¼</p><p>è‡³å°‘ï¼Œå®ƒçš„ä½“éªŒä¸è¯¥æ˜¯æ•°å€¼è†¨èƒ€ã€‚è‡³å°‘ï¼Œè®©ç©å®¶ç©ä¸‹å»çš„åŠ¨åŠ›ä¸è¯¥æ˜¯å¼ºåŒ–ç¨‹åºã€‚å¦‚æœæˆ‘ä»¬æ‹¿èµ°äº†ç©å®¶çš„æ—¶é—´ï¼Œæˆ‘ä»¬èµ·ç åº”å½“è¡¥å¿ä¸€äº›ä»€ä¹ˆæ‰å¯¹ï¼Œè€Œä¸è¯¥å¾’ç•™æ‚”æ¨æ„Ÿã€‚</p><p>å¯èƒ½ä¹Ÿæœ‰ç‚¹åæ¿€äº†ï¼Œå¯èƒ½åªæ˜¯æˆ‘è‡ªå·±ä¸å–œæ¬¢è¿™ç§ç±»å‹è€Œå·²â€¦â€¦ç”šè‡³æˆ‘è‡ªå·±ä¹Ÿè§‰å¾—è¿˜ç®—å¯ä»¥ï¼Œè‡³å°‘ç¡®å®æœ‰è®©æˆ‘å°è±¡æ·±åˆ»çš„æ—¶åˆ»ã€‚ä½†æˆ‘è¿˜æ˜¯æ„Ÿè§‰ä¸å¼€å¿ƒï¼Œæ¯•ç«Ÿï¼Œâ€œæˆ‘ä»¬æ˜¯ä¸æ˜¯æœ¬å¯ä»¥åšå¾—æ›´å¥½ï¼Ÿâ€</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æœ€è¿‘åšäº†&lt;a href=&quot;https://rinevard.itch.io/myriad-by-cards&quot;&gt;ç‰Œç”Ÿä¸‡ç‰©&lt;/a&gt;ï¼Œæ„Ÿè§‰æŒºéš¾å—çš„ã€‚ä¸€ç›´ä»¥æ¥æˆ‘éƒ½å¸Œæœ›æ¯ä¸€éƒ¨ä½œå“éƒ½åšå¾—æ¯”ä¸Šä¸€éƒ¨æ›´å¥½ï¼Œè¿™ä¸€éƒ¨çœ‹èµ·æ¥æ¯”&lt;a href=&quot;https://rinevard.itch.io/un</summary>
      
    
    
    
    <category term="æ‚è°ˆ" scheme="http://rinevard.github.io/categories/%E6%9D%82%E8%B0%88/"/>
    
    <category term="ç¢ç¢å¿µ" scheme="http://rinevard.github.io/categories/%E6%9D%82%E8%B0%88/%E7%A2%8E%E7%A2%8E%E5%BF%B5/"/>
    
    
  </entry>
  
  <entry>
    <title>Lab2 System calls</title>
    <link href="http://rinevard.github.io/wiki/learning/open-course/MIT-6.S081/Labs/lab2-syscall/"/>
    <id>http://rinevard.github.io/wiki/learning/open-course/MIT-6.S081/Labs/lab2-syscall/</id>
    <published>2025-06-04T07:10:38.000Z</published>
    <updated>2025-08-22T03:14:43.982Z</updated>
    
    
    
    
    <category term="å…¬å¼€è¯¾" scheme="http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/"/>
    
    <category term="MIT-6.S081" scheme="http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/MIT-6-S081/"/>
    
    <category term="Labs" scheme="http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/MIT-6-S081/Labs/"/>
    
    
  </entry>
  
  <entry>
    <title>ç¬¬äºŒç« â€”â€”æ“ä½œç³»ç»Ÿæ¦‚è¿°</title>
    <link href="http://rinevard.github.io/wiki/learning/open-course/MIT-6.S081/Notes/note2-organization-overview/"/>
    <id>http://rinevard.github.io/wiki/learning/open-course/MIT-6.S081/Notes/note2-organization-overview/</id>
    <published>2025-06-04T06:26:38.000Z</published>
    <updated>2025-08-22T03:14:43.982Z</updated>
    
    
    
    
    <category term="å…¬å¼€è¯¾" scheme="http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/"/>
    
    <category term="MIT-6.S081" scheme="http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/MIT-6-S081/"/>
    
    <category term="Notes" scheme="http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/MIT-6-S081/Notes/"/>
    
    
  </entry>
  
  <entry>
    <title>ç¬¬ä¸€ç« â€”â€”ç³»ç»Ÿæ¥å£</title>
    <link href="http://rinevard.github.io/wiki/learning/open-course/MIT-6.S081/Notes/note1-sys-interface/"/>
    <id>http://rinevard.github.io/wiki/learning/open-course/MIT-6.S081/Notes/note1-sys-interface/</id>
    <published>2025-06-01T03:18:38.000Z</published>
    <updated>2025-08-22T03:14:43.992Z</updated>
    
    <content type="html"><![CDATA[<style>img{    width: 70%;}</style><h1 id="å¸¸ç”¨çš„ç³»ç»Ÿæ¥å£"><a href="#å¸¸ç”¨çš„ç³»ç»Ÿæ¥å£" class="headerlink" title="å¸¸ç”¨çš„ç³»ç»Ÿæ¥å£"></a>å¸¸ç”¨çš„ç³»ç»Ÿæ¥å£</h1><div class="table-container"><table><thead><tr><th><strong>ç³»ç»Ÿè°ƒç”¨</strong></th><th><strong>æè¿°</strong></th></tr></thead><tbody><tr><td>fork()</td><td>åˆ›å»ºè¿›ç¨‹</td></tr><tr><td>exit()</td><td>ç»“æŸå½“å‰è¿›ç¨‹</td></tr><tr><td>wait()</td><td>ç­‰å¾…å­è¿›ç¨‹ç»“æŸ</td></tr><tr><td>kill(pid)</td><td>ç»“æŸ pid æ‰€æŒ‡è¿›ç¨‹</td></tr><tr><td>getpid()</td><td>è·å¾—å½“å‰è¿›ç¨‹ pid</td></tr><tr><td>sleep(n)</td><td>ç¡çœ  n ç§’</td></tr><tr><td>exec(filename, *argv)</td><td>åŠ è½½å¹¶æ‰§è¡Œä¸€ä¸ªæ–‡ä»¶</td></tr><tr><td>sbrk(n)</td><td>ä¸ºè¿›ç¨‹å†…å­˜ç©ºé—´å¢åŠ  n å­—èŠ‚</td></tr><tr><td>open(filename, flags)</td><td>æ‰“å¼€æ–‡ä»¶ï¼Œflags æŒ‡å®šè¯»/å†™æ¨¡å¼</td></tr><tr><td>read(fd, buf, n)</td><td>ä»æ–‡ä»¶ä¸­è¯» n ä¸ªå­—èŠ‚åˆ° buf</td></tr><tr><td>write(fd, buf, n)</td><td>ä» buf ä¸­å†™ n ä¸ªå­—èŠ‚åˆ°æ–‡ä»¶</td></tr><tr><td>close(fd)</td><td>å…³é—­æ‰“å¼€çš„ fd</td></tr><tr><td>dup(fd)</td><td>å¤åˆ¶ fd</td></tr><tr><td>pipe( p)</td><td>åˆ›å»ºç®¡é“ï¼Œ å¹¶æŠŠè¯»å’Œå†™çš„ fd è¿”å›åˆ°p</td></tr><tr><td>chdir(dirname)</td><td>æ”¹å˜å½“å‰ç›®å½•</td></tr><tr><td>mkdir(dirname)</td><td>åˆ›å»ºæ–°çš„ç›®å½•</td></tr><tr><td>mknod(name, major, minor)</td><td>åˆ›å»ºè®¾å¤‡æ–‡ä»¶</td></tr><tr><td>fstat(fd)</td><td>è¿”å›æ–‡ä»¶ä¿¡æ¯</td></tr><tr><td>link(f1, f2)</td><td>ç»™ f1 åˆ›å»ºä¸€ä¸ªæ–°åå­—(f2)</td></tr><tr><td>unlink(filename)</td><td>åˆ é™¤æ–‡ä»¶</td></tr></tbody></table></div><h1 id="è¿›ç¨‹"><a href="#è¿›ç¨‹" class="headerlink" title="è¿›ç¨‹"></a>è¿›ç¨‹</h1><div class="table-container"><table><thead><tr><th><strong>ç³»ç»Ÿè°ƒç”¨</strong></th><th><strong>æè¿°</strong></th></tr></thead><tbody><tr><td>fork()</td><td>åˆ›å»ºè¿›ç¨‹</td></tr><tr><td>exit()</td><td>ç»“æŸå½“å‰è¿›ç¨‹</td></tr><tr><td>wait()</td><td>ç­‰å¾…å­è¿›ç¨‹ç»“æŸ</td></tr><tr><td>kill(pid)</td><td>ç»“æŸ pid æ‰€æŒ‡è¿›ç¨‹</td></tr><tr><td>getpid()</td><td>è·å¾—å½“å‰è¿›ç¨‹ pid</td></tr><tr><td>exec(filename, *argv)</td><td>åŠ è½½å¹¶æ‰§è¡Œä¸€ä¸ªæ–‡ä»¶</td></tr><tr><td>sbrk(n)</td><td>ä¸ºè¿›ç¨‹å†…å­˜ç©ºé—´å¢åŠ  n å­—èŠ‚</td></tr></tbody></table></div><h1 id="I-O"><a href="#I-O" class="headerlink" title="I/O"></a>I/O</h1><div class="table-container"><table><thead><tr><th><strong>ç³»ç»Ÿè°ƒç”¨</strong></th><th><strong>æè¿°</strong></th></tr></thead><tbody><tr><td>open(filename, flags)</td><td>æ‰“å¼€æ–‡ä»¶ï¼Œflags æŒ‡å®šè¯»/å†™æ¨¡å¼</td></tr><tr><td>read(fd, buf, n)</td><td>ä»æ–‡ä»¶ä¸­è¯» n ä¸ªå­—èŠ‚åˆ° buf</td></tr><tr><td>write(fd, buf, n)</td><td>ä» buf ä¸­å†™ n ä¸ªå­—èŠ‚åˆ°æ–‡ä»¶</td></tr><tr><td>close(fd)</td><td>å…³é—­æ‰“å¼€çš„ fd</td></tr><tr><td>dup(fd)</td><td>å¤åˆ¶ fd</td></tr></tbody></table></div><p>ä»£ç ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token number">512</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">cat</span><span class="token punctuation">(</span><span class="token keyword">int</span> fd<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> n<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>n <span class="token operator">=</span> <span class="token function">read</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> buf<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// å†™å…¥æ ‡å‡†è¾“å‡º</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> buf<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">!=</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">"cat: write error\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">"cat: read error\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> fd<span class="token punctuation">,</span> i<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>argc <span class="token operator">&lt;=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">cat</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> argc<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>fd <span class="token operator">=</span> <span class="token function">open</span><span class="token punctuation">(</span>argv<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> O_RDONLY<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">"cat: cannot open %s\n"</span><span class="token punctuation">,</span> argv<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token function">cat</span><span class="token punctuation">(</span>fd<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">close</span><span class="token punctuation">(</span>fd<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸å¦¨å†æ¥çœ‹çœ‹CSAPPçš„ä¸¤å¼ å›¾</p><h3 id="openä¸¤æ¬¡ï¼š"><a href="#openä¸¤æ¬¡ï¼š" class="headerlink" title="openä¸¤æ¬¡ï¼š"></a><strong>openä¸¤æ¬¡ï¼š</strong></h3><p><img src="/images/learning/open-course/MIT-6.S081/notes/note1-syscall/opentwice.png" alt=""></p><h3 id="forkï¼š"><a href="#forkï¼š" class="headerlink" title="forkï¼š"></a><strong>forkï¼š</strong></h3><p><img src="/images/learning/open-course/MIT-6.S081/notes/note1-syscall/fork.png" alt=""></p><h1 id="ç®¡é“"><a href="#ç®¡é“" class="headerlink" title="ç®¡é“"></a>ç®¡é“</h1><div class="table-container"><table><thead><tr><th><strong>ç³»ç»Ÿè°ƒç”¨</strong></th><th><strong>æè¿°</strong></th></tr></thead><tbody><tr><td>pipe( p)</td><td>åˆ›å»ºç®¡é“ï¼Œ å¹¶æŠŠè¯»å’Œå†™çš„ fd è¿”å›åˆ°pï¼Œå…¶ä¸­pæ˜¯ int p[2]</td></tr></tbody></table></div><ul><li>p[0]: è¯»ç«¯(read end)çš„æ–‡ä»¶æè¿°ç¬¦</li><li>p[1]: å†™ç«¯(write end)çš„æ–‡ä»¶æè¿°ç¬¦</li></ul><p>æ ·ä¾‹ï¼š <code>grep fork sh.c | wc -l</code> å‘½ä»¤å°†ç¬¬ä¸€ä¸ªå‘½ä»¤(grep)çš„è¾“å‡ºä½œä¸ºç¬¬äºŒä¸ªå‘½ä»¤(wc)çš„è¾“å…¥ï¼Œ<code>|</code> å°±æ˜¯ç®¡é“ç¬¦å·ã€‚</p><p>ä¸‹é¢çš„ä»£ç æ˜¯ <code>|</code> çš„å®ç°ç¤ºä¾‹ï¼Œå¤§ä½“æ€è·¯æ˜¯æŠŠ <code>|</code> å·¦è¾¹çš„æ ‡å‡†è¾“å‡ºé‡å®šå‘åˆ°pipeçš„å†™ç«¯ï¼ŒæŠŠ <code>|</code> å³è¾¹çš„æ ‡å‡†è¾“å…¥é‡å®šå‘åˆ°pipeçš„è¯»ç«¯ã€‚</p><p>æ³¨æ„è¦å…³é—­ç®¡é“çš„æ‰€æœ‰å†™å…¥ç«¯æ¥è®© <code>read</code> è¿”å›ï¼Œå› ä¸ºå½“ pipe ä¸­æ²¡æœ‰æ•°æ®æ—¶ï¼Œ<code>read</code> ä¼šé˜»å¡ç­‰å¾…æ–°æ•°æ®å†™å…¥ï¼Œæˆ–æ˜¯å†™å…¥ç«¯éƒ½å…³é—­ï¼Œå¦‚æœæœ‰æ–°æ•°æ®å†™å…¥å°±è¯»å–ï¼Œå¦‚æœæ‰€æœ‰å†™å…¥ç«¯éƒ½å…³é—­å°±è¿”å› 0ï¼ˆå¯¹åº”EOFï¼‰.</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">// å‡è®¾æˆ‘ä»¬çš„å‘½ä»¤æ˜¯ grep fork sh.c | wc -l</span><span class="token keyword">case</span> PIPE<span class="token operator">:</span>    pcmd <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">pipecmd</span> <span class="token operator">*</span><span class="token punctuation">)</span>cmd<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">pipe</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>        <span class="token function">panic</span><span class="token punctuation">(</span><span class="token string">"pipe"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">fork1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">close</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// é‡Šæ”¾æ–‡ä»¶æè¿°ç¬¦1ï¼Œä»è€Œè®©dupæŠŠæ–‡ä»¶æè¿°ç¬¦1ç»‘å®šåˆ°p[1]æŒ‡å‘çš„ä¸œè¥¿</span>        <span class="token function">dup</span><span class="token punctuation">(</span>p<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬åœ¨é‡å®šå‘æ ‡å‡†è¾“å‡ºåˆ°pipeçš„å†™ç«¯</span>        <span class="token function">close</span><span class="token punctuation">(</span>p<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">close</span><span class="token punctuation">(</span>p<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">runcmd</span><span class="token punctuation">(</span>pcmd<span class="token operator">-></span>left<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å¯¹åº” grep fork sh.c</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">fork1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">close</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// ä¸ä¸Šé¢ç±»ä¼¼ï¼Œé‡å®šå‘æ ‡å‡†è¾“å…¥åˆ°pipeçš„è¯»ç«¯</span>        <span class="token function">dup</span><span class="token punctuation">(</span>p<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">close</span><span class="token punctuation">(</span>p<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">close</span><span class="token punctuation">(</span>p<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">runcmd</span><span class="token punctuation">(</span>pcmd<span class="token operator">-></span>right<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å¯¹åº” wc -l</span>    <span class="token punctuation">&#125;</span>    <span class="token function">close</span><span class="token punctuation">(</span>p<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">close</span><span class="token punctuation">(</span>p<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">wait</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">wait</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">break</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="æ–‡ä»¶ç³»ç»Ÿ"><a href="#æ–‡ä»¶ç³»ç»Ÿ" class="headerlink" title="æ–‡ä»¶ç³»ç»Ÿ"></a>æ–‡ä»¶ç³»ç»Ÿ</h1><div class="table-container"><table><thead><tr><th><strong>ç³»ç»Ÿè°ƒç”¨</strong></th><th><strong>æè¿°</strong></th></tr></thead><tbody><tr><td>chdir(dirname)</td><td>æ”¹å˜å½“å‰ç›®å½•</td></tr><tr><td>mkdir(dirname)</td><td>åˆ›å»ºæ–°çš„ç›®å½•</td></tr><tr><td>mknod(name, major, minor)</td><td>åˆ›å»ºè®¾å¤‡æ–‡ä»¶</td></tr><tr><td>fstat(fd)</td><td>è¿”å›æ–‡ä»¶ä¿¡æ¯</td></tr><tr><td>link(f1, f2)</td><td>ç»™ f1 åˆ›å»ºä¸€ä¸ªæ–°åå­—(f2)</td></tr><tr><td>unlink(filename)</td><td>åˆ é™¤æ–‡ä»¶</td></tr></tbody></table></div><p>æˆ‘ä»¬é€šå¸¸è®¤ä¸ºæ–‡ä»¶åå°±æ˜¯æ–‡ä»¶æœ¬èº«ï¼Œä½†å®é™…ä¸Šåç§°æ˜¯ä¸€ä¸ªç¡¬é“¾æ¥(hard link)ã€‚ä¸€ä¸ªæ–‡ä»¶å¯ä»¥æœ‰å¤šä¸ªç¡¬é“¾æ¥â€”â€”ä¾‹å¦‚ï¼Œä¸€ä¸ªç›®å½•è‡³å°‘æœ‰ä¸¤ä¸ªç¡¬é“¾æ¥ï¼šç›®å½•åå’Œ <code>.</code> ï¼ˆåœ¨ç›®å½•å†…æ—¶ï¼‰ã€‚å®ƒè¿˜æœ‰æ¥è‡ªæ¯ä¸ªå­ç›®å½•çš„ä¸€ä¸ªç¡¬é“¾æ¥ï¼ˆæ¯ä¸ªå­ç›®å½•ä¸­çš„ <code>..</code> æ–‡ä»¶ï¼‰ã€‚</p><p>é‚£æ–‡ä»¶æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿä¸€ä¸ªæ–‡ä»¶å’Œä¸€ä¸ª inode ä¸€ä¸€å¯¹åº”ï¼Œinodeå­˜æ”¾ç€è¿™ä¸ªæ–‡ä»¶çš„ç›¸å…³ä¿¡æ¯</p><p>xv6ç³»ç»Ÿçš„inodeç»“æ„åŒ…æ‹¬ä¸‹é¢è¿™äº›å†…å®¹ï¼š</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">struct</span> <span class="token class-name">dinode</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">short</span> type<span class="token punctuation">;</span>              <span class="token comment">// File type</span>    <span class="token keyword">short</span> major<span class="token punctuation">;</span>             <span class="token comment">// Major device number (T_DEVICE only)</span>    <span class="token keyword">short</span> minor<span class="token punctuation">;</span>             <span class="token comment">// Minor device number (T_DEVICE only)</span>    <span class="token keyword">short</span> nlink<span class="token punctuation">;</span>             <span class="token comment">// Number of links to inode in file system</span>    uint size<span class="token punctuation">;</span>               <span class="token comment">// Size of file (bytes)</span>    uint addrs<span class="token punctuation">[</span>NDIRECT <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// Data block addresses</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥é€šè¿‡ <code>fstat</code> è·å–æ–‡ä»¶æè¿°ç¬¦æŒ‡å‘çš„æ–‡ä»¶çš„ä¿¡æ¯ã€‚dinodeæ˜¯ç£ç›˜ä¸Šå­˜å‚¨çš„è¯¦ç»†ä¿¡æ¯ï¼Œstatæ˜¯æš´éœ²ç»™ç”¨æˆ·çš„æ–‡ä»¶ä¿¡æ¯æ¥å£</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">struct</span> <span class="token class-name">stat</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> dev<span class="token punctuation">;</span>     <span class="token comment">// File system's disk device</span>    uint ino<span class="token punctuation">;</span>    <span class="token comment">// Inode number</span>    <span class="token keyword">short</span> type<span class="token punctuation">;</span>  <span class="token comment">// Type of file</span>    <span class="token keyword">short</span> nlink<span class="token punctuation">;</span> <span class="token comment">// Number of links to file</span>    uint64 size<span class="token punctuation">;</span> <span class="token comment">// Size of file in bytes</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä»…å½“æˆ‘ä»¬æŠŠæ‰€æœ‰æŒ‡å‘æŸä¸ªinodeçš„é“¾æ¥éƒ½åˆ é™¤ï¼Œè¿™ä¸ªinodeæ‰ä¼šè¢«åˆ é™¤ã€‚</p><p>åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ç”¨ <code>ln</code> åˆ›å»ºäº†ä¸¤ä¸ªè¿æ¥ file2 å’Œ file3ï¼Œå®ƒä»¬éƒ½å’Œ file1 æŒ‡å‘çš„ inode ç›¸åŒã€‚å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœç”¨ <code>echo</code> ä¿®æ”¹ file2ï¼Œé‚£ä¹ˆ file1 ä¹Ÿä¼šè¢«ä¿®æ”¹ï¼Œå› ä¸ºæˆ‘ä»¬ä¿®æ”¹çš„å®é™…ä¸Šæ˜¯ inodeï¼Œè€Œå®ƒä»¬æŒ‡å‘åŒä¸€ä¸ªinodeã€‚<code>ls -l</code> åˆ—å‡ºç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•çš„è¯¦ç»†ä¿¡æ¯ï¼Œç¬¬äºŒä¸ªå€¼æ˜¯inodeçš„linkæ•°ã€‚æˆ‘ä»¬å¯ä»¥æŠŠé“¾æ¥è§†ä½œæ–‡ä»¶çš„â€œåˆ«åâ€ã€‚</p><pre class="line-numbers language-none"><code class="language-none">$ echo &quot;What&#39;s in a name? That which we call a rose, by any other word would smell as sweet.&quot; &gt; file1.txt$ lsfile1.txt  open-course  programs$ cat file1.txtWhat&#39;s in a name? That which we call a rose, by any other word would smell as sweet.$ ln file1.txt file2.txt$ ln file1.txt file3.txt$ ls -ltotal 20-rw-r--r-- 3 rinevard rinevard   85 May 29 11:37 file1.txt-rw-r--r-- 3 rinevard rinevard   85 May 29 11:37 file2.txt-rw-r--r-- 3 rinevard rinevard   85 May 29 11:37 file3.txtdrwxr-xr-x 3 rinevard rinevard 4096 May 28 11:00 open-coursedrwxr-xr-x 2 rinevard rinevard 4096 May 28 10:19 programs$ echo &quot;-- William Shakespeare&quot; &gt;&gt; file2.txt$ cat file1.txtWhat&#39;s in a name? That which we call a rose, by any other word would smell as sweet.-- William Shakespeare<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä½ å¯èƒ½ä¼šå¥½å¥‡ç›®å½•çš„é“¾æ¥æ•°æ€ä¹ˆè®¡ç®—ï¼Œæ˜¯è¿™æ ·çš„ï¼š</p><ol><li>æ¯ä¸ªç›®å½•é»˜è®¤æœ‰2ä¸ªé“¾æ¥ï¼Œä¸€ä¸ªæ˜¯ç›®å½•è‡ªèº«çš„â€.â€ï¼Œå¦ä¸€ä¸ªæ˜¯çˆ¶ç›®å½•ä¸­æŒ‡å‘è¯¥ç›®å½•çš„é“¾æ¥</li><li>ç›®å½•ä¸­æ¯åŒ…å«ä¸€ä¸ªå­ç›®å½•ï¼Œé“¾æ¥æ•°å°±ä¼š+1ï¼Œå› ä¸ºæ¯ä¸ªå­ç›®å½•éƒ½ä¼šåˆ›å»ºâ€..â€é“¾æ¥æŒ‡å‘çˆ¶ç›®å½•</li></ol><p>åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œrootdir çš„é“¾æ¥æ•°æ˜¯ 4ï¼Œå› ä¸ºçˆ¶ç›®å½•æœ‰ä¸€ä¸ªæŒ‡å‘å®ƒçš„é“¾æ¥â€rootdirâ€ï¼Œå®ƒè‡ªå·±æœ‰ä¸€ä¸ªæŒ‡å‘è‡ªå·±çš„é“¾æ¥â€.â€ï¼Œå®ƒçš„ä¸¤ä¸ªå­ç›®å½•dir1å’Œdir2åˆ†åˆ«æœ‰æŒ‡å‘å®ƒçš„é“¾æ¥â€..â€</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">~/open-course/rootdir$ <span class="token function">ls</span>dir1  dir2  file1.md  file2.md  file3.md~/open-course/rootdir$ <span class="token function">ls</span> <span class="token punctuation">..</span>/ <span class="token parameter variable">-l</span>total <span class="token number">8</span>drwxr-xr-x <span class="token number">11</span> rinevard rinevard <span class="token number">4096</span> May <span class="token number">31</span> <span class="token number">16</span>:40 mit-6.828drwxr-xr-x  <span class="token number">4</span> rinevard rinevard <span class="token number">4096</span> Jun  <span class="token number">1</span> <span class="token number">10</span>:58 rootdir<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ–‡ä»¶è·¯å¾„æ ¼å¼ï¼šä»¥ â€œ/â€ å¼€å¤´çš„æ˜¯ä»æ ¹ç›®å½•å‡ºå‘çš„è·¯å¾„ï¼Œå¦åˆ™æ˜¯ä»å½“å‰æ–‡ä»¶å¤¹å‡ºå‘çš„è·¯å¾„</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">~/open-course$ <span class="token function">ls</span>mit-6.828~/open-course$ <span class="token function">ls</span> mit-6.828/LICENSE  Makefile  README  conf  grade-lab-util  gradelib.py  kernel  <span class="token function">mkfs</span>  user~/open-course$ <span class="token function">ls</span> /home/rinevard/open-course  programs<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>unix shellçš„è®¸å¤šå‘½ä»¤éƒ½æ˜¯ç”¨æˆ·çº§åˆ«çš„ï¼Œè€Œéå†…ç½®çš„ã€‚shellé€šè¿‡forkå­è¿›ç¨‹å¹¶è°ƒç”¨execæ¥æ‰§è¡Œå®ƒä»¬ã€‚ä½†cdæ˜¯å†…ç½®çš„ï¼Œå› ä¸ºcdæ”¹å˜äº†shellè‡ªèº«çš„å·¥ä½œç›®å½•ã€‚</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">// Read and run input commands.</span><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">getcmd</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">'c'</span> <span class="token operator">&amp;&amp;</span> buf<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">'d'</span> <span class="token operator">&amp;&amp;</span> buf<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">' '</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// Chdir must be called by the parent, not the child.</span>        buf<span class="token punctuation">[</span><span class="token function">strlen</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// chop \n</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">chdir</span><span class="token punctuation">(</span>buf <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>            <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">"cannot cd %s\n"</span><span class="token punctuation">,</span> buf <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">continue</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">fork1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>        <span class="token function">runcmd</span><span class="token punctuation">(</span><span class="token function">parsecmd</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">wait</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;style&gt;
img{
    width: 70%;
}
&lt;/style&gt;

&lt;h1 id=&quot;å¸¸ç”¨çš„ç³»ç»Ÿæ¥å£&quot;&gt;&lt;a href=&quot;#å¸¸ç”¨çš„ç³»ç»Ÿæ¥å£&quot; class=&quot;headerlink&quot; title=&quot;å¸¸ç”¨çš„ç³»ç»Ÿæ¥å£&quot;&gt;&lt;/a&gt;å¸¸ç”¨çš„ç³»ç»Ÿæ¥å£&lt;/h1&gt;&lt;div class=&quot;</summary>
      
    
    
    
    <category term="å…¬å¼€è¯¾" scheme="http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/"/>
    
    <category term="MIT-6.S081" scheme="http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/MIT-6-S081/"/>
    
    <category term="Notes" scheme="http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/MIT-6-S081/Notes/"/>
    
    
  </entry>
  
</feed>
