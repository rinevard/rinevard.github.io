{"meta":{"title":"Rinevard","subtitle":"","description":"","author":"Rinevard","url":"http://rinevard.github.io","root":"/"},"pages":[{"title":"äººè¿¹ç½•è‡³çš„è·¯","date":"2025-02-14T06:12:25.238Z","updated":"2025-02-14T06:12:25.238Z","comments":true,"path":"secret/jurora-path.html","permalink":"http://rinevard.github.io/secret/jurora-path.html","excerpt":"","text":"/* è‰ä¹¦æ•ˆæœç›¸å…³æ ·å¼ */ .center-cursive-text { font-family: 'Brush Script MT', cursive; font-size: 24px; color: darkred; text-align: center; margin: 20px 0; /* padding: 20px; */ line-height: 1.5; cursor: default; } /* éšè—è‰ä¹¦ */ .hidden-fancy-text { font-family: 'Brush Script MT', cursive; font-size: 24px; text-align: center; margin: 20px 0; /* padding: 20px; */ line-height: 1.5; color: transparent; } .hidden-fancy-text::selection { color: darkred; background: white; } /* äººè¿¹ç½•è‡³çš„è·¯ */ .secret-message { color: transparent; cursor: default; font-family: 'Brush Script MT', cursive; /* ä½¿ç”¨è‰ä¹¦å­—ä½“ */ font-size: 24px; text-align: center; margin: 20px 0; line-height: 1.5; } .secret-message:hover { color: darkred; transition: color 0.5s ease; /* ç¨å¾®å»¶é•¿è¿‡æ¸¡æ—¶é—´ */ } ä¸€ç‰‡æ ‘æ—é‡Œåˆ†å‡ºä¸¤æ¡è·¯â€”â€” è€Œæˆ‘é€‰æ‹©äº†äººè¿¹æ›´å°‘çš„ä¸€æ¡ï¼Œ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ä»æ­¤å†³å®šäº†æˆ‘ä¸€ç”Ÿçš„é“è·¯ã€‚ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"},{"title":"äººæ¥äººå¾€çš„è·¯","date":"2025-02-14T06:44:57.617Z","updated":"2025-02-14T06:44:57.617Z","comments":true,"path":"secret/many-people-path.html","permalink":"http://rinevard.github.io/secret/many-people-path.html","excerpt":"","text":"/* è‰ä¹¦æ•ˆæœç›¸å…³æ ·å¼ */ .center-cursive-text { font-family: 'Brush Script MT', cursive; font-size: 24px; color: black; text-align: center; margin: 20px 0; line-height: 1.5; cursor: default; } /* é‡å æ–‡å­—æ•ˆæœ */ .text-overlay-container { position: relative; height: 100px; margin: 20px 0; } .overlapping-text { position: absolute; width: 100%; font-family: 'Brush Script MT', cursive; font-size: 24px; text-align: center; color: black; opacity: 0.15; cursor: default; } /* ä¸ºæ¯è¡Œæ–‡å­—è®¾ç½®ä¸åŒçš„ä½ç½®å’Œé€æ˜åº¦ */ .text-1 { top: 0; opacity: 0.8; } .text-2 { top: 12px; opacity: 0.6; } .text-3 { top: 24px; opacity: 0.4; } .text-4 { top: 36px; opacity: 0.2; } .text-5 { top: 48px; opacity: 0.1; } .text-6 { top: 60px; color: transparent; } ä¸€ç‰‡æ ‘æ—é‡Œåˆ†å‡ºä¸¤æ¡è·¯â€”â€” è€Œæˆ‘é€‰æ‹©äº†äººæ¥äººå¾€çš„ä¸€æ¡ï¼Œ åªçœ‹åˆ°äº†å…­é“å°è¿¹ã€‚ è„šå° è„šå° è„šå° è„šå° è„šå° è„šå°"},{"title":"Categories","date":"2025-02-06T02:38:03.136Z","updated":"2025-02-06T02:38:03.136Z","comments":true,"path":"categories/index.html","permalink":"http://rinevard.github.io/categories/index.html","excerpt":"","text":"è¿™é‡Œä»€ä¹ˆä¹Ÿæ²¡æœ‰å“¦~æ–‡ä»¶å¤¹å·²ç»å¾ˆæ–¹ä¾¿äº†ï¼Œä¸ºä»€ä¹ˆè¿˜è¦ç”¨åˆ†ç±»å‘¢ï¼Ÿ"},{"title":"æ— ç©·çš„è¿œæ–¹ï¼Œæ— å°½çš„äººä»¬","date":"2025-03-20T13:12:59.559Z","updated":"2025-03-20T13:12:59.559Z","comments":true,"path":"links/index.html","permalink":"http://rinevard.github.io/links/index.html","excerpt":"","text":"è¿™é‡Œæ˜¯ä¸€äº›æœ‰è¶£çš„äººä»¬ï¼Œæˆ‘çš„ç”Ÿæ´»å› ä»–ä»¬è€Œå¢æ·»äº†ä¸€æŠ¹å¥‡å¹»è‰²å½©ã€‚ä½ çŸ¥é“çš„ï¼Œæˆ‘å¹¶æ²¡æœ‰å¾ˆå¤šç¤¾äº¤æŠ€èƒ½ç‚¹ï¼Œæ‰€ä»¥ä¾¿ç”¨è¿™ç§æ–¹æ³•æ¥å‘Šè¯‰æœªæ¥çš„è‡ªå·±â€”â€”æˆ‘æ›¾é‡è§è¿‡ä¸€äº›æœ‰è¶£çš„äººã€‚ åŒ—ç†å·¥å…ˆæ˜¯ä¸€äº›ç®—æ˜¯åŒè¾ˆçš„äººå§ ç¤ºä¾‹é“¾æ¥ 1 - æè¿°æ–‡å­— ç¤ºä¾‹é“¾æ¥ 2 - æè¿°æ–‡å­— ç¤ºä¾‹é“¾æ¥ 3 - æè¿°æ–‡å­— ç„¶åæ˜¯ä¸€äº›å‰è¾ˆï¼Œè™½ç„¶å¹´é¾„ä¹Ÿå·®ä¸å¤ªå¤šå°±æ˜¯äº† èŒƒæ»‡ä¸œçš„åšå®¢ - å¦‚æœæ²¡æœ‰å‰è¾ˆå¼€å‘çš„ bit101ï¼Œæˆ‘çš„åŒ—ç†ç”Ÿæ´»æƒ³å¿…ä¸ä¼šé‚£ä¹ˆæœ‰è¶£ã€‚ å‘¨å¼ˆå¸†çš„åšå®¢ - ä¸€ä¸ªæœ‰è¶£çš„å‰è¾ˆï¼Œå†™çš„åšå®¢å¯¹æˆ‘æœ‰å¯å‘ã€‚ è¿™ä¸ªé¡µé¢æ˜¯çªå‘å¥‡æƒ³åšå‡ºæ¥çš„ï¼Œå¦‚æœå®ƒè®©æˆ‘å’Œäººä»¬æœ‰äº†æ›´å¤šçš„è”ç³»ï¼Œé‚£å®åœ¨å¾ˆæœ‰è¶£ï¼æŠ±ç€å¯¹è¿™ä»½å¥‡å¹»è‰²å½©çš„æœŸå¾…ï¼Œä¾¿è§‰å¾—è¿™äº›æ–‡å­—å€¼å¾—å†™äº†ã€‚"},{"title":"About","date":"2025-07-21T02:01:28.976Z","updated":"2025-07-21T02:01:28.976Z","comments":true,"path":"about/index.html","permalink":"http://rinevard.github.io/about/index.html","excerpt":"","text":"è¿™é‡Œæ˜¯ Rinevard. å–œæ¬¢ç‹¬ç«‹æ¸¸æˆä¹‹ç±»çš„æ–°é²œäº‹ç‰©ã€‚æˆ‘åº”è¯¥ä¸»è¦ä¼šåœ¨ç«™é‡Œæ”¾ä¸€äº›æ‚è°ˆå’Œæ¸¸æˆç›¸å…³çš„æ–‡ç« ï¼Œæ¬¢è¿æ¥çœ‹ï¼ å¶å°”ä¼šå‡ºç°çš„çˆ±å¥½æ˜¯å–åï¼Œæˆ‘è¿˜ç”¨è¿‡ Lyraineã€é²¤é±¼ã€æ±ŸçŸ¥é¹¤ï¼ˆè¯»èµ·æ¥å’Œ rinevard è›®åƒçš„ï¼‰ä¹‹ç±»çš„åå­—ã€‚ å¦‚æœæƒ³å’Œæˆ‘è”ç³»ï¼Œæ¬¢è¿å‘é‚®ä»¶åˆ° rinevard@outlook.comï¼ï¼ˆä¸è¿‡ä¸ä¸€å®šä¼šçœ‹ï¼‰ æˆ‘çš„ Github è´¦å·: Rinevard. å¦å¤–ï¼Œæ¬¢è¿åˆ°æˆ‘çš„ itch ä¸»é¡µä¸Šç©æˆ‘çš„æ¸¸æˆï¼"},{"title":"æ¢ç´¢çš„å¥–åŠ±","date":"2025-02-11T02:04:52.000Z","updated":"2025-08-20T11:13:48.889Z","comments":true,"path":"secret/index.html","permalink":"http://rinevard.github.io/secret/index.html","excerpt":"","text":"/* éšè—æ–‡æœ¬ç›¸å…³æ ·å¼ */ .secret-text::selection { color: white; background: black; } .secret-text { background: transparent; cursor: default; /* é¼ æ ‡æ ·å¼ä¿æŒé»˜è®¤ */ } #output { white-space: pre; font-family: monospace; font-size: 12px; line-height: 12px; letter-spacing: unset; transform: unset; overflow-y: hidden; background: transparent; cursor: default; /* é¼ æ ‡æ ·å¼ä¿æŒé»˜è®¤ */ } /* è‰ä¹¦æ•ˆæœç›¸å…³æ ·å¼ */ .cursive-text { font-family: 'Brush Script MT', cursive; font-size: 20px; color: darkred; /* text-align: center; */ margin: 20px 0; /* padding: 20px; */ line-height: 1.5; cursor: default; } /* è‰ä¹¦æ•ˆæœç›¸å…³æ ·å¼ */ .center-cursive-text { font-family: 'Brush Script MT', cursive; font-size: 20px; color: darkred; text-align: center; margin: 20px 0; /* padding: 20px; */ line-height: 1.5; cursor: default; } /* éšè—è‰ä¹¦ */ .hidden-fancy-text { font-family: 'Brush Script MT', cursive; font-size: 22px; /* text-align: center; */ margin: 20px 0; /* padding: 20px; */ line-height: 1.5; color: transparent; cursor: default; } .hidden-fancy-text::selection { color: darkred; background: white; } /* äººè¿¹ç½•è‡³çš„è·¯ */ .paths-container { display: flex; justify-content: center; margin: 20px 0; font-family: 'Brush Script MT', cursive; font-size: 20px; } /* ä¿®æ”¹é“¾æ¥æ ·å¼ */ .paths-container a.path { padding: 15px; text-decoration: none !important; border: none; /* ç§»é™¤å¯èƒ½çš„è¾¹æ¡† */ background: none; /* ç§»é™¤å¯èƒ½çš„èƒŒæ™¯ */ } /* æœ‰äººçš„è·¯å¾„æ ·å¼ */ .paths-container a.path-visible { color: #5a3921 !important; /* ä½¿ç”¨ !important æ¥ç¡®ä¿ä¼˜å…ˆçº§ */ } /* éšè—çš„è·¯å¾„æ ·å¼ */ .paths-container a.path-hidden { color: transparent !important; /* ä½¿ç”¨ !important æ¥ç¡®ä¿ä¼˜å…ˆçº§ */ } /* æ‚¬åœæ•ˆæœ */ .paths-container a.path-hidden:hover { color: #5a3921 !important; transition: color 0.3s ease; } /* visitedçŠ¶æ€ */ .paths-container a.path-visible:visited { color: #5a3921 !important; } .paths-container a.path-hidden:visited { color: transparent !important; } .paths-container a.path-hidden:hover:visited { color: #5a3921 !important; } å¯¹ä¸èµ·éª—äº†å¤§å®¶è¿™ä¹ˆä¹…ï¼Œå…¶å®æˆ‘æ˜¯ä¸€æ¡é²¤é±¼ã€‚ ..-*=. ......:::....... .:=*****:. ..:=++*++=---------=++**+=:.. .:+********-. ...+*+:.. ..:=*+:.-***************-. ..:-*+.. .=***************: .:=+*=**: .:***************+. ..-=- +*: .:****************: ..:+ +*: .:****************- .+* ** +*: .:****************- .-** +*: .:****************: +...+ +*: .:****************. :.:=****-. .:***************- ..:-++-.. ..-++-*************=. ..:=**+=:..... .....:-+**+:....-**********=.. ...:-===++++++==-:... .-*******=. ..=***+. ..-*:. å—¯ï¼Œå®åœ¨æ˜¯å¤ªæ•·è¡äº†ï¼Œæ‰€ä»¥æˆ‘ç¨å¾®åŠ äº†ç‚¹ä¸œè¥¿ã€‚ ç¥ä½ å¥½è¿ï¼Œä¹Ÿç¥ä½ ç©å¾—å¼€å¿ƒã€‚ é»„æ˜çš„æ ‘æ—é‡Œåˆ†å‡ºä¸¤æ¡è·¯ï¼Œ æ‰€å¹¸åœ¨æ­¤æˆ‘èƒ½åŒæ—¶å»æ¶‰è¶³ äººæ¥äººå¾€çš„è·¯ äººè¿¹ç½•è‡³çš„è·¯ æˆ–è®¸å“ªå¤©è¿˜ä¼šå†æ¥çœ‹çœ‹è¿™é‡Œçš„å˜åŒ–ï¼Ÿå¯ç¨‹äº†ï¼Œå†è§å•¦ã€‚"},{"title":"Tags","date":"2025-02-06T02:37:47.887Z","updated":"2025-02-06T02:37:47.887Z","comments":true,"path":"tags/index.html","permalink":"http://rinevard.github.io/tags/index.html","excerpt":"","text":"è¿™é‡Œä»€ä¹ˆä¹Ÿæ²¡æœ‰å“¦~æ–‡ä»¶å¤¹å·²ç»å¾ˆæ–¹ä¾¿äº†ï¼Œä¸ºä»€ä¹ˆè¿˜è¦ç”¨æ ‡ç­¾å‘¢ï¼Ÿ"}],"posts":[{"title":"Lab 2.1 ç³»ç»Ÿè°ƒç”¨æµç¨‹â€”â€”ä»¥sleepä¸ºä¾‹","slug":"learning/open-course/MIT-6.S081/Labs/lab2_1-syscall_process","date":"2025-10-15T08:02:38.000Z","updated":"2025-10-15T08:09:51.505Z","comments":true,"path":"wiki/learning/open-course/MIT-6.S081/Labs/lab2_1-syscall_process/","permalink":"http://rinevard.github.io/wiki/learning/open-course/MIT-6.S081/Labs/lab2_1-syscall_process/","excerpt":"","text":"æˆ‘ä»¬çŸ¥é“åº”ç”¨ç¨‹åºåœ¨User modeä¸‹è¿è¡Œï¼Œè€Œç³»ç»Ÿå‡½æ•°çš„æ‰§è¡Œéœ€è¦Supervisor modeï¼Œé‚£åœ¨ç³»ç»Ÿè°ƒç”¨æ—¶ï¼ŒUser modeæ˜¯æ€ä¹ˆè¿›å…¥Supervisor modeçš„å‘¢ï¼Ÿæˆ‘ä»¬ä»¥sleepçš„æ‰§è¡Œä¸ºä¾‹ï¼Œçœ‹çœ‹éƒ½å‘ç”Ÿäº†ä»€ä¹ˆã€‚é¦–å…ˆæˆ‘ä»¬ç”¨ git checkout util åˆ‡æ¢åˆ° util åˆ†æ”¯ä¸Šã€‚ åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬è¦å…ˆç®€ä»‹ä¸€ä¸‹ECALLæŒ‡ä»¤å’Œstvecï¼ˆSupervisor Trap Vector Base Address Registerï¼‰å¯„å­˜å™¨ã€‚ ECALL ä¼šè§¦å‘ä¸€ä¸ªå¼‚å¸¸ï¼Œå¦‚æœæˆ‘ä»¬åœ¨ç”¨æˆ·æ€è§¦å‘è¿™ä¸ªå¼‚å¸¸ï¼Œç¨‹åºè®¡æ•°å™¨ pc å°±ä¼šæ ¹æ® stvec è¿›è¡Œè·³è½¬ï¼Œåˆ°è¾¾å¼‚å¸¸å¤„ç†å¤„ã€‚ ä»¥ä¸‹æ˜¯ risc-v æ‰‹å†Œ å¯¹ ECALL çš„è§£é‡Šï¼š When executed in U-mode, S-mode, or M-mode, it generates an environment-call-from-U-mode exception, environment-call-from-S-mode exception, or environment-call-from-M-mode exception, respectively, and performs no other operation. å¦‚æœåœ¨ U-mode æ‰§è¡Œï¼ŒECALL æŒ‡ä»¤ä¼šäº§ç”Ÿä¸€ä¸ªæ¥è‡ª U-mode çš„ç¯å¢ƒè°ƒç”¨å¼‚å¸¸ï¼›å¦‚æœåœ¨ S-mode æ‰§è¡Œï¼Œåˆ™äº§ç”Ÿæ¥è‡ª S-mode çš„ç¯å¢ƒè°ƒç”¨å¼‚å¸¸ï¼›å¦‚æœåœ¨ M-mode æ‰§è¡Œï¼Œåˆ™äº§ç”Ÿæ¥è‡ª M-mode çš„ç¯å¢ƒè°ƒç”¨å¼‚å¸¸ã€‚ ä»¥ä¸‹æ˜¯ risc-v æ‰‹å†Œå¯¹ stvec å¯„å­˜å™¨çš„ç®€ä»‹ï¼š BASEæ˜¯4å­—èŠ‚å¯¹é½çš„ï¼ˆRISC-V æ‰‹å†Œ P80ï¼‰ï¼Œæ‰€ä»¥åœ¨MODE == 0æ—¶ï¼Œæˆ‘ä»¬è·³è½¬åˆ°çš„åœ°å€æ˜¯ (stvec &gt;&gt; 2) &lt;&lt; 2ï¼Œè€Œç”±äº MODE == 0ï¼Œè¿™ä¸ªå€¼å°±æ˜¯ stvec ï¼›åœ¨MODE == 1æ—¶ï¼Œæˆ‘ä»¬è½¬åˆ°çš„åœ°å€æ˜¯ (stvec &gt;&gt; 2) &lt;&lt; 2 + 4*cause æ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥å¼€å§‹çœ‹çœ‹ç³»ç»Ÿè°ƒç”¨æ—¶ç©¶ç«Ÿå‘ç”Ÿäº†ä»€ä¹ˆï¼æˆ‘ä»¬ä¼šä»¥sleepä¸ºä¾‹ã€‚ é¦–å…ˆæˆ‘ä»¬æ‰“å¼€gdb-multiarchï¼ˆå‚è€ƒ Note 0 çš„â€ç”¨ç»ˆç«¯è°ƒè¯•â€œï¼‰ï¼Œç„¶åç”¨ set prompt \\\\001\\\\033[1;33m\\\\002(gdb) \\\\001\\\\033[0m\\\\002 æ¥é«˜äº® â€œ(gdb)â€ ä»¥æ–¹ä¾¿è§‚å¯Ÿè‡ªå·±çš„è¾“å…¥ã€‚ ç”¨ file user/_sleep åˆ‡æ¢åˆ°ç”¨æˆ·ç¬¦å·è¡¨ï¼Œæ¥ç€ç”¨cè¿è¡Œåˆ°xv6çš„shellå¯åŠ¨ã€‚ è§‚å¯Ÿå³è¾¹çš„ç»ˆç«¯å¯ä»¥çœ‹åˆ°shellå·²ç»æˆåŠŸå¯åŠ¨äº†ã€‚ ç„¶åæˆ‘ä»¬åœ¨gdbé‡ŒæŒ‰ä¸‹ctrl+cæ¥ä¸­æ–­ï¼Œå¹¶ç”¨ b main è®¾ç½®æ–­ç‚¹ï¼Œå†ä½¿ç”¨ layout split è®©gdbæ˜¾ç¤ºå‡ºæºç å’Œæ±‡ç¼–ä»£ç ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬åœ¨gdbé‡Œè¾“å…¥ c ä»¥è®©xv6ç»§ç»­æ‰§è¡Œï¼Œå¦åˆ™xv6çš„shellä¼šå¤„äºæš‚åœçŠ¶æ€ï¼Œä¸èƒ½å¤„ç†è¾“å…¥ã€‚ ç„¶ååœ¨xv6çš„shellé‡Œæ‰§è¡Œ sleep 1 ï¼Œå®ƒä¼šåœ¨æ–­ç‚¹å¤„åœä¸‹ã€‚ è§‚å¯Ÿå·¦è¾¹çš„gdbï¼Œå¯ä»¥çœ‹åˆ°å®ƒåœåœ¨äº†sleep.cçš„mainå‡½æ•°ã€‚ éšä¾¿æ‰§è¡Œä¸€ä¸‹ç›´åˆ°åˆ°è¾¾sleepè¿™è¡Œï¼Œn è¡¨ç¤ºæ‰§è¡Œä¸€è¡Œcè¯­è¨€ï¼Œsiè¡¨ç¤ºæ‰§è¡Œä¸€ä¸ªæ±‡ç¼–è¯­å¥ã€‚ æˆ‘ä»¬ç”¨siè¿›å…¥atoiï¼Œç„¶åäº¤æ›¿ç€ç”¨nå’Œsiï¼Œåœ¨å¿«åˆ°returnæ—¶ç”¨siï¼Œå°±èƒ½ç¦»å¼€atoiå›åˆ°sleep.cã€‚ è§‚å¯Ÿå·¦è¾¹çš„gdbï¼Œå’Œä¸Šå›¾ç›¸æ¯”ï¼Œè™½ç„¶cè¯­è¨€çš„ä½ç½®æ²¡æœ‰å˜åŒ–ï¼Œä½†æ±‡ç¼–ä»£ç çš„ä½ç½®æ˜¯æœ‰å˜åŒ–çš„ã€‚ ä¹‹åç”¨siï¼Œä¼šå‘ç°æˆ‘ä»¬è·³è½¬åˆ°äº† usys.Sï¼Œå®ƒæŠŠsleepçš„ç³»ç»Ÿè°ƒç”¨å·æ”¾åˆ°å¯„å­˜å™¨a7é‡Œï¼Œç„¶åå€ŸåŠ©ecallæ¥æ‰§è¡Œç³»ç»Ÿè°ƒç”¨ã€‚ è§‚å¯Ÿå·¦è¾¹çš„gdbå‘ç°æˆ‘ä»¬å·²ç»è¿›å…¥äº†usys.S å¦‚æœæˆ‘ä»¬ç›´æ¥ç”¨å‡ ä¸ªsiï¼Œä¼šå‘ç°ecallå¹¶æ²¡æœ‰åƒjalä¹‹ç±»çš„è·³è½¬è¯­å¥ä¸€æ ·å¸¦æˆ‘ä»¬åˆ°ä¸€äº›ç¥å¥‡çš„åœ°æ–¹ï¼Œè€Œæ˜¯ç›´æ¥åˆ°äº†ä¸‹ä¸€è¡Œã€‚è¿™æ˜¯å› ä¸ºecallä¸æ˜¯è·³è½¬ï¼Œè€Œæ˜¯æŠ›å‡ºäº†ä¸€ä¸ªå¼‚å¸¸ï¼Œå†…æ ¸è‡ªåŠ¨å¤„ç†äº†å¼‚å¸¸ã€‚ è¿™æ ·çœ‹æ¥ï¼Œæˆ‘ä»¬è¦æ‰¾åˆ°è¿™ä¸ªå¼‚å¸¸çš„å¼€å§‹å¤„å¹¶è®¾ç½®æ–­ç‚¹æ‰è¡Œã€‚è¿˜è®°å¾—æˆ‘ä»¬ä¹‹å‰è¯´è¿‡ecallæŠ›å‡ºå¼‚å¸¸æ—¶pcä¼šè·³è½¬åˆ°å“ªé‡Œå—ï¼Ÿç­”æ¡ˆæ˜¯å®ƒä¼šæ ¹æ®å¯„å­˜å™¨stvecçš„å€¼è¿›è¡Œè·³è½¬ã€‚è®©æˆ‘ä»¬å€ŸåŠ©p /x $stvecçœ‹çœ‹stvecçš„å€¼ã€‚ è§‚å¯Ÿå·¦è¾¹çš„gdbï¼Œå‘ç°stvecçš„å€¼æ˜¯ 0x3ffffff000ï¼Œè‡³å°‘åœ¨æˆ‘è¿™é‡Œæ˜¯è¿™æ ·ã€‚ å›é¡¾ä¸€ä¸‹stvecå¯„å­˜å™¨çš„ç»“æ„å’ŒåŠŸèƒ½ï¼Œä¼šå‘ç°æ‰§è¡Œecallåï¼Œpcä¼šè·³è½¬åˆ°BASEæ‰€åœ¨çš„åœ°å€ã€‚æˆ‘ä»¬ä¹‹å‰è¯´è¿‡ï¼ŒBASEæ˜¯4å­—èŠ‚å¯¹é½çš„ï¼ˆRISC-V æ‰‹å†Œ P80ï¼‰ï¼Œæ‰€ä»¥åœ¨MODE == 0æ—¶ï¼Œæˆ‘ä»¬è·³è½¬åˆ°çš„åœ°å€æ˜¯ (stvec &gt;&gt; 2) &lt;&lt; 2ï¼Œè€Œç”±äº MODE == 0ï¼Œè¿™ä¸ªå€¼å°±æ˜¯ stvecã€‚ æˆ‘ä»¬æ¥ä¸‹æ¥æŠŠæ–­ç‚¹è®¾ç½®åœ¨è¿™ä¸ªå€¼ï¼Œç„¶åç”¨siåˆ°è¾¾ecallè¯­å¥å¤„ è§‚å¯Ÿå·¦è¾¹çš„gdbï¼Œæˆ‘ä»¬ç°åœ¨å·²ç»åœ¨ecallè¿™é‡Œäº†ã€‚ å¦‚æœæˆ‘ä»¬çš„æ“ä½œæ­£ç¡®ï¼Œæ¥ä¸‹æ¥çš„siä¼šè§¦å‘ä¸€ä¸ªå¼‚å¸¸å¯¼è‡´æˆ‘ä»¬è·³è½¬åˆ° 0x3ffffff000 å¹¶è§¦å‘æ–­ç‚¹ï¼Œå¸Œæœ›æˆ‘ä»¬æ²¡æœ‰ç¿»è½¦~ è§‚å¯Ÿå·¦è¾¹çš„gdbï¼Œå‘ç°æˆ‘ä»¬æˆåŠŸè·³è½¬åˆ°äº†ä¸€ä¸ªæœªçŸ¥çš„åœ°æ–¹ï¼ æŒ‰æˆ‘çš„ç†è§£ï¼Œç”±äºæˆ‘ä»¬åœ¨U-modeä¸‹æ‰§è¡Œecallä»¥è§¦å‘å¼‚å¸¸ï¼Œæ‰€ä»¥æˆ‘ä»¬ç°åœ¨å·²ç»è¿›å…¥äº†S-modeã€‚ä¸è¿‡æˆ‘ç¿»äº†å¾ˆå¤šèµ„æ–™è¿˜æ˜¯æ²¡æœ‰æ‰¾åˆ°èƒ½æ˜ç¡®æ”¯æŒè¿™ä¸€ç‚¹çš„è¯æ®ï¼ˆä¹Ÿæ²¡æœ‰æ‰¾åˆ°æ˜ç¡®åå¯¹çš„è¯æ®ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä¿ç•™æˆ‘çš„è§‚ç‚¹ã€‚ æ€»ä¹‹ä¸€åˆ‡é¡ºåˆ©ï¼è®©æˆ‘ä»¬æš‚åœä¸€ä¸‹ï¼Œæƒ³æƒ³è¿™ä¸ª 0x3ffffff000 çš„åœ°å€ä»£è¡¨ä»€ä¹ˆã€‚åœ¨å†…æ ¸å¯åŠ¨æ—¶é€šè¿‡file kernel/kernel åŠ è½½å†…æ ¸ç¬¦å·è¡¨å¹¶åœ¨usertrapretè®¾ç½®æ–­ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç° 0x3ffffff000 è¿™ä¸ªåœ°å€å’Œ kernel/trap.c é‡Œçš„trampoline_uservec ç›¸ç­‰ã€‚ trampolineæ˜¯ä»€ä¹ˆï¼Ÿtrampolineæ˜¯åœ¨è¿›ç¨‹è™šæ‹Ÿå†…å­˜çš„é¡¶éƒ¨çš„ä¸€å—ç©ºé—´ï¼Œæ˜ å°„åˆ°çš„ç‰©ç†åœ°å€å­˜æ”¾ç€è·³è½¬è¿›å’Œè·³è½¬å‡ºå†…æ ¸çš„ä»£ç ã€‚çœ‹èµ·æ¥åœ¨åšç³»ç»Ÿè°ƒç”¨æ—¶ï¼Œæˆ‘ä»¬é€šè¿‡ecallè·³è½¬è¿›å†…æ ¸ã€‚è¿™æ ·ä¸€åˆ‡éƒ½è¯´å¾—é€šäº†~ è®©æˆ‘ä»¬æ‰“å¼€trampoline.Sï¼Œå¯¹æ¯”å·¦è¾¹gdbæ˜¾ç¤ºçš„ä»£ç å’Œå³è¾¹çš„trampoline.Sï¼Œä¼šå‘ç°å®ƒä»¬ç¡®å®èƒ½å¯¹ä¸Šï¼ å¥½å§ï¼Œä¹Ÿä¸æ˜¯å®Œå…¨èƒ½å¯¹ä¸Šï¼Œä½ ä¼šæ³¨æ„åˆ°å³è¾¹çš„ li a0,TRAPFRAME åœ¨å·¦è¾¹ä¼¼ä¹å¯¹åº”äº†ä¸‰æ¡è¯­å¥ï¼Œè¿™æ˜¯æ€ä¹ˆå›äº‹å‘¢ï¼Ÿå®é™…ä¸Šï¼Œli æ˜¯RISC-V æ±‡ç¼–ä¸­çš„ä¼ªæŒ‡ä»¤ï¼Œå®é™…æ‰§è¡Œæ—¶ï¼Œli ä¼šè¢«æ±‡ç¼–å™¨ç¿»è¯‘ä¸ºä¸€æ¡æˆ–å¤šæ¡çœŸæ­£çš„ RISC-V æŒ‡ä»¤ã€‚ å—¯ï¼Œè¿™æ ·å°±èƒ½å¯¹ä¸Šäº†ï¼ è¯»ä¸€è¯»trampoline.Sï¼Œæˆ‘ä»¬å‘ç°å®ƒä¼šæŠŠç”¨æˆ·è¿›ç¨‹çš„å¯„å­˜å™¨ç­‰ä¿¡æ¯ä¿å­˜åˆ°trapframeé‡Œï¼Œç„¶åè·³è½¬åˆ°å†…æ ¸çš„usertrapå‡½æ•°ã€‚ å› æ­¤æ¥ä¸‹æ¥æˆ‘ä»¬è¦ç”¨file kernel/kernelæŠŠç¬¦å·è¡¨åˆ‡æ¢åˆ°kernelï¼Œå†ç”¨si n æ¥ä¸€æ¬¡æ‰§è¡Œå¤šæ¡æ±‡ç¼–è¯­å¥ï¼Œç›´åˆ°æŒ‡ä»¤jrå¤„ï¼š æ¯”è¾ƒå·¦è¾¹å’Œå³è¾¹ï¼Œå‘ç°å®ƒä»¬çš„æ±‡ç¼–ä»£ç ç¡®å®èƒ½å¯¹ä¸Šï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬è¦å‡†å¤‡è·³è½¬äº†ã€‚ é™·é˜±ï¼Œå¯åŠ¨ï¼ å¦‚æœä½ å‘ç°ä½ çš„gdbæ²¡æœ‰é¡ºåˆ©æ˜¾ç¤ºå‡ºcè¯­è¨€ä»£ç ï¼Œå¯èƒ½æ˜¯ä½ å¿˜è®°åˆ‡æ¢ç¬¦å·è¡¨åˆ°å†…æ ¸äº†ï¼Œç”¨file kernel/kernelæ¥åˆ‡æ¢ï¼Œç„¶åè¡¥ä¸€ä¸ªsiå°±èƒ½æ˜¾ç¤ºå‡ºæ¥äº†ã€‚ ç”±äºä¸€åˆ‡æ­£å¸¸ï¼Œæˆ‘ä»¬å¯ä»¥ä¸€è·¯æŒ‰nç›´åˆ°åˆ°è¾¾syscallè¿™é‡Œã€‚ æ¯”è¾ƒå·¦è¾¹å’Œå³è¾¹çš„ä»£ç ï¼Œå®ƒä»¬æ˜¯èƒ½å¯¹åº”ä¸Šçš„ã€‚æ¥ä¸‹æ¥è®©æˆ‘ä»¬å‡†å¤‡è¿›å…¥syscall æˆ‘ä»¬ç”¨sè¿›å…¥syscallå‡½æ•°ã€‚nå’Œséƒ½ä¼šæ‰§è¡Œå½“å‰è¡Œï¼Œä¸è¿‡å¦‚æœå½“å‰è¡Œæ˜¯å‡½æ•°ï¼Œnä¸ä¼šè¿›å…¥å‡½æ•°ï¼Œè€Œsä¼šã€‚ syscallå‡½æ•°ä»trapframeä¸­å–å‡ºç³»ç»Ÿè°ƒç”¨å·ï¼Œç„¶åè°ƒç”¨å®ƒã€‚è¿˜è®°å¾—å—ï¼Œæˆ‘ä»¬è°ƒç”¨ç³»ç»Ÿå‡½æ•°æ—¶å…ˆè¿›å…¥äº†usys.Sï¼Œç„¶åæŠŠç³»ç»Ÿè°ƒç”¨å·ä¿å­˜åˆ°äº†a7ã€‚ä¹‹åç”±äºæˆ‘ä»¬è½¬å…¥äº†å†…æ ¸ï¼Œæˆ‘ä»¬åœ¨trapoline.Sé‡ŒæŠŠæ‰€æœ‰çš„ç”¨æˆ·ç©ºé—´çš„å¯„å­˜å™¨éƒ½ä¿å­˜åˆ°äº†trapframeä¸­ã€‚ æ€»ä¹‹æˆ‘ä»¬åœ¨è¿™é‡Œè°ƒç”¨äº†sys_sleepï¼Œæˆ‘ä»¬è¿›å…¥å®ƒçœ‹çœ‹ã€‚ å¯ä»¥å‘ç°å®ƒå°±æ˜¯çœŸæ­£å¹²æ´»çš„åœ°æ–¹ï¼å®ƒéå¸¸å¿ å®åœ°æ‰§è¡Œäº†sleepçš„é€»è¾‘ã€‚ æˆ‘ä»¬å¯ä»¥æ³¨æ„åˆ° n å°±æ˜¯å­˜æ”¾ç€æˆ‘ä»¬æœ€å¼€å§‹ä¼ å…¥çš„å‚æ•°çš„å˜é‡ï¼Œå†…æ ¸é€šè¿‡argintæ¥æ‰¾åˆ°æˆ‘ä»¬ä¸€å¼€å§‹ä¼ å…¥çš„å‚æ•°ã€‚argintçš„æ€è·¯å’Œæˆ‘ä»¬ä¹‹å‰æ‰¾åˆ°ç³»ç»Ÿè°ƒç”¨å·ç±»ä¼¼ï¼Œä¹Ÿæ˜¯ä»trapframeä¸­æ‰¾åˆ°å­˜æ”¾ç€ä¼ å…¥å‚æ•°çš„å¯„å­˜å™¨ã€‚ è®©æˆ‘ä»¬ç»§ç»­å¾€åï¼Œçœ‹çœ‹åœ¨æ‰§è¡Œå®Œé€»è¾‘ä»¥åå‘ç”Ÿäº†ä»€ä¹ˆå§ã€‚ å›åˆ°usertrapï¼Œæˆ‘ä»¬ä¸€è·¯å¾€ä¸‹åˆ°è¾¾usertrapretï¼Œç„¶åç”¨sè¿›å…¥å®ƒã€‚ çœ‹å‡½æ•°åä¸Šé¢çš„æ³¨é‡Šå°±èƒ½å‘ç°å®ƒä¼šå¸¦æˆ‘ä»¬å›åˆ°ç”¨æˆ·ç©ºé—´ã€‚ æˆ‘ä»¬ç”¨nä¸€è·¯è¿è¡Œåˆ°åº•ï¼Œå†çœ‹çœ‹æ³¨é‡Šï¼Œå‘ç°æ³¨é‡Šè¯´æˆ‘ä»¬ä¼šè·³è½¬åˆ°trampoline.Sã€‚ è§‚å¯Ÿå·¦è¾¹çš„gdbï¼Œp /x trampoline_userret æ²¡æœ‰æ‰“å°å€¼æ˜¯å› ä¸ºtrampoline_userretè¢«ç¼–è¯‘å™¨ä¼˜åŒ–æ‰äº†ï¼Œæˆ‘ä»¬è¦æ‰‹åŠ¨æŠŠå®ƒçš„è¡¨è¾¾å¼å†™å‡ºæ¥å†æ‰“å°ï¼Œæ€»ä¹‹æˆ‘ä»¬æ‰“å°å‡ºäº† 0x3ffffff09cã€‚ åœ¨é‚£é‡Œè®¾ä¸ªæ–­ç‚¹ï¼Œç„¶åå‡†å¤‡ç»§ç»­ã€‚ å¤šæŒ‰å‡ ä¸ªsi åˆ°è¾¾è·³è½¬è¯­å¥å¤„ï¼Œä¸å‡ºæ„å¤–çš„è¯å†ç”¨ä¸€æ¬¡si å°±ä¼šå¸¦æˆ‘ä»¬è¿›å…¥trapoline.Sçš„userretéƒ¨åˆ†äº†ã€‚ ä¸€åˆ‡çš„ä¸€åˆ‡éƒ½ç¬¦åˆé¢„æœŸï¼Œæˆ‘ä»¬æˆåŠŸè¿›å…¥äº†trampoline.Sã€‚ å¯¹æ¯”å·¦å³çš„æ±‡ç¼–ä»£ç å¯ä»¥å‘ç°å®ƒä»¬æ˜¯å¯¹åº”çš„ã€‚ä¸ä¹‹å‰ç›¸åŒï¼Œliè¢«å±•å¼€äº†ã€‚ ç„¶åæˆ‘ä»¬ä¸€è·¯æŒ‰siåˆ°è¾¾sretè¯­å¥å¤„ã€‚sretä¼šåšä»€ä¹ˆå‘¢ï¼Ÿè®©æˆ‘ä»¬çœ‹çœ‹riscvæ‰‹å†Œï¼š The SRET instruction is used to return from a trap taken into S-mode. [â€¦] When executing SRET, the privilege level is set to the value in the SPP field of the sstatus register; [â€¦] the pc is set to the value stored in the sepc register. SRET æŒ‡ä»¤ç”¨äºä»è¿›å…¥ S-mode çš„é™·é˜±ä¸­è¿”å›ã€‚[â€¦] å½“æ‰§è¡Œ SRET æ—¶ï¼Œç‰¹æƒçº§åˆ«è¢«è®¾ç½®ä¸ºsstatus å¯„å­˜å™¨ä¸­ SPP å­—æ®µçš„å€¼ï¼›[â€¦] ç¨‹åºè®¡æ•°å™¨ pc è¢«è®¾ç½®ä¸ºå­˜å‚¨åœ¨ sepc å¯„å­˜å™¨ä¸­çš„å€¼ã€‚ æˆ‘ä»¬å€ŸåŠ© p /x sepc æ‰“å°è¿™ä¸ªå¯„å­˜å™¨çš„å€¼çœ‹çœ‹~ï¼ˆè¯·å¿½è§†å·¦å›¾é‡Œæˆ‘ä¹‹å‰å†™æˆspecçš„æ‰‹è¯¯ï¼‰ 0x342æ˜¯ä»€ä¹ˆï¼Ÿå¦‚æœä½ è®°å¿†åŠ›å¾ˆå¥½çš„è¯ï¼Œä¼šå‘ç°å®ƒæ°å¥½å°±æ˜¯usys.Sé‡Œçš„reté‚£è¡Œï¼ ï¼ˆè¿™é¬¼æ‰è®°å¾—ä½å•Šå–‚ï¼‰ æ€»ä¹‹æˆ‘ä»¬çœ‹çœ‹ä¹‹å‰çš„æˆªå›¾å§ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°0x342ç¡®å®æ˜¯reté‚£è¡Œï¼Œå°±æ˜¯ä¸‹é¢çš„æˆªå›¾ä¸­é«˜äº®çš„æ±‡ç¼–ä»£ç ä¸‹é¢é‚£è¡Œã€‚ æˆ‘ä»¬ç”¨b *0x342è®¾ä¸ªæ–­ç‚¹åœ¨é‚£é‡Œï¼Œç„¶åæ‰§è¡Œsi ï¼Œæˆ‘ä»¬å›åˆ°äº†ç”¨æˆ·ç©ºé—´ï¼åŒæ—¶ï¼Œsretä¹Ÿè®©æˆ‘ä»¬å›åˆ°äº†U-modeã€‚ ç”¨file user/_sleepåˆ‡æ¢ç¬¦å·è¡¨ï¼Œå†æ‰§è¡Œsiï¼Œæˆ‘ä»¬å›æ¥äº†ã€‚ è‡³æ­¤ï¼Œæˆ‘ä»¬å°±å®Œæˆäº†ä¸€ä¸ªå®Œæ•´çš„ç³»ç»Ÿè°ƒç”¨ã€‚ æ€»ç»“ä¸€ä¸‹ï¼Œå½“æˆ‘ä»¬è¿›è¡Œç³»ç»Ÿè°ƒç”¨æ—¶ï¼Œæˆ‘ä»¬å…ˆè¿›å…¥usys.Sï¼Œç„¶åecallè§¦å‘å¼‚å¸¸å¹¶è·³è½¬åˆ°trapoline.Sçš„uservecå¤„ï¼Œä¹‹ååˆ°è¾¾trap.cçš„usertrapå‡½æ•°ï¼Œå®ƒä¼šè°ƒç”¨syscallå‡½æ•°ä»¥æ‰§è¡Œç³»ç»Ÿå‡½æ•°çš„é€»è¾‘ï¼Œæ‰§è¡Œå®Œåè¿›å…¥usertrapretå‡½æ•°ï¼Œå†è·³è½¬åˆ°trapoline.Sçš„userretå¤„ï¼Œæœ€åå›åˆ°usys.Sï¼Œå†å›åˆ°ç”¨æˆ·çš„ä»£ç é‡Œã€‚ ç¬¬ä¸€æ¬¡è·³è½¬åˆ°trapoline.Sä¸»è¦æ˜¯ä¿å­˜äº†ç”¨æˆ·çš„å„ä¸ªå¯„å­˜å™¨åˆ°trapframeï¼Œç¬¬äºŒæ¬¡è·³è½¬æ˜¯ä»trapframeä¸­æ¢å¤äº†è¿™äº›å¯„å­˜å™¨ã€‚","categories":[{"name":"å…¬å¼€è¯¾","slug":"å…¬å¼€è¯¾","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/"},{"name":"MIT-6.S081","slug":"å…¬å¼€è¯¾/MIT-6-S081","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/MIT-6-S081/"},{"name":"Labs","slug":"å…¬å¼€è¯¾/MIT-6-S081/Labs","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/MIT-6-S081/Labs/"}],"tags":[]},{"title":"Lab 2 System calls","slug":"learning/open-course/MIT-6.S081/Labs/lab2-syscall","date":"2025-10-15T07:54:38.000Z","updated":"2025-10-15T08:10:39.024Z","comments":true,"path":"wiki/learning/open-course/MIT-6.S081/Labs/lab2-syscall/","permalink":"http://rinevard.github.io/wiki/learning/open-course/MIT-6.S081/Labs/lab2-syscall/","excerpt":"","text":"åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ä»¬å›é¡¾ä¸€ä¸‹æ€ä¹ˆå¯åŠ¨è°ƒè¯•æ¨¡å¼ï¼š åœ¨ä¸€ä¸ªç»ˆç«¯é‡Œæ‰§è¡Œ make qemu-gdb ï¼Œmake qemu-gdb CPUS=1 å¯ä»¥åªä½¿ç”¨ä¸€ä¸ªæ ¸å¿ƒï¼Œæ¯”èµ·å¤šçº¿ç¨‹æ›´ä¾¿äºè°ƒè¯•ã€‚ åœ¨å¦ä¸€ä¸ªç»ˆç«¯é‡Œæ‰§è¡Œ gdb-multiarch kernel/kernel ï¼Œè¿›å…¥ gdb åæ‰§è¡Œ target remote localhost:26001ï¼Œè¿™é‡Œçš„ç«¯å£å·ä¸ä¸€å®šæ˜¯ 26001ï¼Œçœ‹ make qemu-gdb CPUS=1 çš„æ‰“å°ç»“æœå°±è¡Œã€‚ è¿™æ ·å°±è¿›å…¥è°ƒè¯•æ¨¡å¼äº†ã€‚å¦å¤–ï¼Œæˆ‘ä¹ æƒ¯ç”¨ set prompt \\001\\033[1;33m\\002(gdb) \\001\\033[0m\\002 æ¥é«˜äº® â€œ(gdb)â€ è¿™å‡ ä¸ªå­—ã€‚ Using gdblab å¼€å¤´è®©æˆ‘ä»¬ç†Ÿæ‚‰ä¸€ä¸‹ gdb çš„ä½¿ç”¨ã€‚å¯åŠ¨è°ƒè¯•æ¨¡å¼ä»¥åæŒ‰éƒ¨å°±ç­å°±èƒ½å®Œæˆï¼Œæˆ‘ä»¬è¿™é‡Œè®°å½•ä¸€ä¸‹å¸¸ç”¨çš„ä¸€äº› gdb æŒ‡ä»¤ï¼š c æˆ– continue - ç»§ç»­æ‰§è¡Œç›´åˆ°é‡åˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹ n æˆ– next - å•æ­¥æ‰§è¡Œ,ä¼šè·³è¿‡å‡½æ•°è°ƒç”¨ s æˆ– step - å•æ­¥æ‰§è¡Œ,ä¼šè¿›å…¥å‡½æ•°å†…éƒ¨ si - æ‰§è¡Œä¸€æ¡æ±‡ç¼–æŒ‡ä»¤ finish - è¿è¡Œåˆ°å½“å‰å‡½æ•°è¿”å›ä¸ºæ­¢ p &#x2F;x $mstatus - ä»¥åå…­è¿›åˆ¶æ‰“å°CPUå½“å‰æ¨¡å¼ backtraceï¼ˆç¼©å†™btï¼‰ - æ˜¾ç¤ºå‡½æ•°è°ƒç”¨æ ˆ set prompt \\\\001\\\\033[1;33m\\\\002(gdb) \\\\001\\\\033[0m\\\\002 - é«˜äº®(gdb) until - è¿è¡Œåˆ°æŒ‡å®šè¡Œå·ä¸ºæ­¢ System call tracingè¿™é“é¢˜è®©æˆ‘ä»¬å®ç°ä¸€ä¸ªç³»ç»Ÿè°ƒç”¨ï¼ŒæŒ‰ç€ hints æŒ‰éƒ¨å°±ç­å°±èƒ½åšæ‰ã€‚å”¯ä¸€è¦æ³¨æ„çš„æ˜¯åœ¨ syscall é‡Œæ‰“å° trace ç›¸å…³çš„å†…å®¹æ—¶è¦æŠŠç³»ç»Ÿè°ƒç”¨çš„è¿”å›å€¼ ret ä»åŸæœ¬çš„ uint64 è½¬æ¢ä¸º long longï¼Œå¦åˆ™å¯¹é‚£äº›å¯èƒ½è¿”å› -1 çš„ç³»ç»Ÿè°ƒç”¨ï¼Œæˆ‘ä»¬æ— æ³•æ­£ç¡®æ‰“å° -1. åœ¨ç…§ç€ hints å®ç°ä¹‹åï¼Œçœ‹çœ‹ç³»ç»Ÿè°ƒç”¨æ˜¯å¦‚ä½•è¿›è¡Œçš„ä¹Ÿæ˜¯æ›´æœ‰è¶£çš„äº‹æƒ…ã€‚æˆ‘åœ¨ Lab 2.1 ç³»ç»Ÿè°ƒç”¨æµç¨‹â€”â€”ä»¥sleepä¸ºä¾‹ ä¸­å†™å¾—è¿˜æŒºè¯¦ç»†çš„ï¼Œè¿™é‡Œä¸å¤šèµ˜è¿°ç»†èŠ‚ã€‚ ç®€è€Œè¨€ä¹‹ï¼Œå½“æˆ‘ä»¬è¿›è¡Œç³»ç»Ÿè°ƒç”¨æ—¶ï¼š è¿›å…¥ç”± usys.pl ç”Ÿæˆçš„ usys.S ecall è§¦å‘å¼‚å¸¸å¹¶è·³è½¬åˆ° trapoline.S çš„ uservec å¤„ åˆ°è¾¾ trap.c çš„ usertrap å‡½æ•°ï¼Œå®ƒä¼šè°ƒç”¨ syscall å‡½æ•°ä»¥æ‰§è¡Œç³»ç»Ÿå‡½æ•°çš„é€»è¾‘ ç³»ç»Ÿå‡½æ•°æ‰§è¡Œå®Œæˆåè¿›å…¥usertrapretå‡½æ•° è·³è½¬åˆ° trapoline.S çš„userretå¤„ æœ€åå›åˆ° usys.S å›åˆ°ç”¨æˆ·çš„ä»£ç é‡Œã€‚ è®©æˆ‘ä»¬æ ¹æ®è¿™ä¸ªæµç¨‹æ¥çœ‹çœ‹ hints çš„æ¯ä¸€æ­¥çš„åŸå› ï¼š æŠŠ $U/_trace åŠ å…¥åˆ° Makefile ä¸­æ˜¯ä¸ºäº†ç¼–è¯‘æ—¶è¯†åˆ«åˆ° traceã€‚ åœ¨ user.h é‡ŒåŠ å…¥ trace æ˜¯ä¸ºäº†è®©ç”¨æˆ·çš„ trace.c è¯†åˆ«åˆ° trace è¿™ä¸ªå‡½æ•°ã€‚ åœ¨ usys.pl é‡ŒåŠ å…¥ trace æ˜¯ä¸ºäº†è®© usys.pl åœ¨ç”Ÿæˆçš„ usys.S é‡ŒåŠ å…¥ trace ç›¸å…³çš„å†…å®¹ï¼Œå®ƒæ˜¯æˆ‘ä»¬è¿›è¡Œç³»ç»Ÿè°ƒç”¨æ—¶çš„ç¬¬ä¸€ç«™ã€‚ åœ¨ syscall.h é‡ŒåŠ å…¥ trace æ˜¯å› ä¸ºæˆ‘ä»¬é€šè¿‡å¯„å­˜å™¨é‡Œå­˜å‚¨çš„æ•´æ•°ç¡®å®šè°ƒç”¨çš„ç³»ç»Ÿå‡½æ•°ï¼Œå¾ˆå¤šåœ°æ–¹éƒ½ä½¿ç”¨äº†è¿™ä¸ªæ–‡ä»¶é‡Œå®šä¹‰çš„å¸¸é‡ã€‚ åœ¨ syscall.c å’Œ sysproc.c é‡ŒåŠ å…¥çš„å‡½æ•°åˆ™æ˜¯å®é™…çš„é€»è¾‘éƒ¨åˆ†ï¼Œç”± syscall å‡½æ•°è°ƒç”¨ã€‚ Attack xv6åœ¨ xv6 çš„ syscall åˆ†æ”¯ä¸Šæœ‰ä¸€ä¸ªæ¼æ´â€”â€”è¿›ç¨‹è¢«å›æ”¶åï¼Œå®ƒæ›¾ç»ä½¿ç”¨çš„ç‰©ç†å†…å­˜ä¸ä¼šè¢«é‡ç½®ä¸ºåƒåœ¾æ•°æ®ï¼Œè€Œæ˜¯ä¿æŒä¹‹å‰çš„çŠ¶æ€ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ‰“ç ´å†…å­˜éš”ç¦»ï¼Œè®¿é—®åˆ«çš„å·²ç»è¢«å›æ”¶çš„è¿›ç¨‹çš„å†…å­˜ã€‚ æˆ‘ä»¬çœ‹å‘ secret.cï¼Œä¼šå‘ç°å®ƒè¯·æ±‚äº† 32 ä¸ªç‰©ç†é¡µå¤§å°çš„ç‰©ç†å†…å­˜ï¼Œç„¶åæŠŠä¸€ä¸²å­—ç¬¦æ”¾åœ¨äº†æŸä¸ªç‰©ç†é¡µçš„å¼€å¤´ã€‚æ‰€ä»¥æˆ‘ä»¬åªè¦åœ¨ attck.c é‡Œä¹Ÿè¯·æ±‚ä¸€äº›ç‰©ç†é¡µï¼Œç„¶åæ‰¾åˆ°è¿™ä¸²å­—ç¬¦ä¸²å°±è¡Œã€‚ æˆ‘ä»¬å…ˆè¯·æ±‚ 32 ä¸ªç‰©ç†é¡µç„¶åä¾æ¬¡æ‰“å°å‡ºæ¯ä¸ªç‰©ç†é¡µå¼€å¤´çš„ä¸€ä¸²å­—ç¬¦ï¼Œç»“æœå¦‚ä¸‹ï¼š ç¬¬ 1 é¡µ: ï¿½ï¿½ ç¬¬ 2 é¡µ: ï¿½ ç¬¬ 3 é¡µ: ï¿½ ç¬¬ 4 é¡µ: ï¿½ï¿½ ç¬¬ 5 é¡µ: ï¿½ ç¬¬ 6 é¡µ: 0ï¿½ ç¬¬ 7 é¡µ: ï¿½ ç¬¬ 8 é¡µ: ï¿½ ç¬¬ 9 é¡µ: ï¿½ï¿½&#x2F;cea.ae ç¬¬ 10 é¡µ: @ï¿½7ï¿½Gï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½fï¿½ï¿½ï¿½13ï¿½ï¿½fvâ¦3 ç¬¬ 11 é¡µ: Pï¿½#4ï¿½ï¿½&quot;ï¿½ï¿½ï¿½ï¿½ï¿½&#96;Bdaaï¿½ï¿½qï¿½&quot;ï¿½ ï¿½ï¿½ ç¬¬ 12 é¡µ: ï¿½ï¿½ ï¿½ attackte ç¬¬ 13 é¡µ: pï¿½ ç¬¬ 14 é¡µ: &#96;ï¿½ ç¬¬ 15 é¡µ: ï¿½ï¿½ï¿½ ç¬¬ 16 é¡µ: ï¿½ï¿½7ï¿½Gï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½fï¿½ï¿½ï¿½13ï¿½ï¿½fvâ¦3 ç¬¬ 17 é¡µ: ï¿½ï¿½very very secret pw is: &#x2F;cea.ae ç¬¬ 18 é¡µ: ï¿½ï¿½ ç¬¬ 19 é¡µ: pï¿½ ç¬¬ 20 é¡µ: 0ï¿½ ç¬¬ 21 é¡µ: 0ï¿½ï¿½ ç¬¬ 22 é¡µ: @ï¿½ï¿½ ç¬¬ 23 é¡µ: Pï¿½ï¿½ ç¬¬ 24 é¡µ: ï¿½ï¿½ ç¬¬ 25 é¡µ: ï¿½ï¿½ï¿½ ç¬¬ 26 é¡µ: Pï¿½ ç¬¬ 27 é¡µ: @ï¿½ ç¬¬ 28 é¡µ: 0ï¿½ ç¬¬ 29 é¡µ: ï¿½ ï¿½&amp;ï¿½Jï¿½ï¿½ï¿½ï¿½lEï¿½&#96;*&amp;ï¿½Jï¿½ ç¬¬ 31 é¡µ: ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½?ï¿½ï¿½ï¿½ ç¬¬ 32 é¡µ: ï¿½ï¿½ï¿½ å¯ä»¥æ³¨æ„åˆ°å¤§å¤šæ•°éƒ½æ˜¯ä¹±ç ï¼Œè¿™æ˜¯å› ä¸ºå†…å­˜é‡Œæœ‰éæ–‡æœ¬çš„äºŒè¿›åˆ¶æ•°æ®ï¼Œå®ƒä»¬ä¸èƒ½è¢«å½“ä½œæ–‡æœ¬è¾“å‡ºã€‚ å½“ç„¶ï¼Œæˆ‘ä»¬ä¼šæ³¨æ„åˆ°ç¬¬ 17 é¡µæœ‰ â€œvery very secret pw is: /cea.aeâ€ï¼Œå®ƒä¸ secret.c å†™å…¥çš„å†…å®¹å”¯ä¸€çš„åŒºåˆ«æ˜¯å°‘äº† â€œmy very â€ è¿™å…«ä¸ªå­—ç¬¦ã€‚ä¸ºä»€ä¹ˆä¼šæœ‰å…«ä¸ªå­—ç¬¦çš„å·®å¼‚å‘¢ï¼Ÿ çœ‹å‘ kallc.c çš„ kfreeï¼š void kfree(void *pa) &#123; struct run *r; if (((uint64)pa % PGSIZE) != 0 || (char *)pa &lt; end || (uint64)pa >= PHYSTOP) panic(\"kfree\"); #ifndef LAB_SYSCALL // Fill with junk to catch dangling refs. memset(pa, 1, PGSIZE); #endif r = (struct run *)pa; acquire(&amp;kmem.lock); r->next = kmem.freelist; kmem.freelist = r; release(&amp;kmem.lock); &#125; ç»“åˆ struct run çš„å®šä¹‰ï¼Œå°±èƒ½çŸ¥é“ r-&gt;next = kmem.freelist è¿™å¥è¯­å¥æ˜¯æŠŠä¸€ä¸ªæŒ‡é’ˆæ”¾åœ¨äº†è¾“å…¥çš„ç‰©ç†åœ°å€çš„å‰å…«ä¸ª bytes ä¸­ã€‚è¿™æ­£æ˜¯ä¹‹å‰å…«ä¸ªå­—ç¬¦çš„å·®å¼‚çš„ç”±æ¥ã€‚ æ€»ç»“ä¸€ä¸‹ï¼Œåœ¨è¿è¡Œ secret.c çš„è¿›ç¨‹è¢«å›æ”¶åï¼Œå…¶ä¸­åŒ…å« â€œmy very very very secret pw is: /cea.aeâ€ çš„ç‰©ç†é¡µçš„å¼€å¤´å…«ä¸ª bytes è¢«æŒ‡é’ˆè¦†ç›–ï¼Œæ‰€ä»¥åªå‰©ä¸‹äº† â€œ[8 bytes æŒ‡é’ˆ]very very secret pw is: /cea.aeâ€. æ‰€ä»¥æˆ‘ä»¬å¤šè¯·æ±‚å‡ ä¸ªæ–°çš„ç‰©ç†é¡µç„¶åéå†å®ƒä»¬ï¼Œç”¨å‰ç¼€ â€œvery very secret pw is: â€ æ¥åŒ¹é…å°±è¡Œã€‚ æˆ‘ä»¬åœ¨æ–‡æœ«ä¼šæ›´å…·ä½“åœ°è®²è®²è¿›ç¨‹è¢«å›æ”¶çš„è¿‡ç¨‹ï¼Œä½†å…ˆè®©æˆ‘ä»¬æ¥çœ‹çœ‹ä»£ç ï¼š int strncmp(const char *str1, const char *str2, int n); // kalloc.c çš„ kfree å‡½æ•°é‡ŒæŠŠç‰©ç†é¡µçš„å¼€å¤´æ¢æˆäº†ä¸€ä¸ªæŒ‡é’ˆ. // æ‰€ä»¥æˆ‘ä»¬ä¸¢å¤±äº†å¼€å¤´çš„ sizeof(æŒ‡é’ˆ) ä¸ªå­—ç¬¦. const int overwrite_len = sizeof(void *); int main(int argc, char *argv[]) &#123; char *end; char *prefix = \"my very very very secret pw is: \"; int cmplen = strlen(prefix) - overwrite_len; // éå†æ–°æ’å…¥çš„32ä¸ªç‰©ç†é¡µ for (int i = 0; i &lt; 32; i++) &#123; end = sbrk(PGSIZE); if (strncmp(end + overwrite_len, prefix + overwrite_len, cmplen) == 0) &#123; write(2, end + 32, 8); exit(0); &#125; &#125; exit(1); &#125; è¿™é‡ŒæŠŠå†…å®¹å†™è¿›æ–‡ä»¶æè¿°ç¬¦ 2 æ˜¯å› ä¸º attacktest.c é‡Œå¼€äº†ä¸€ä¸ªç®¡é“ï¼Œè¿è¡Œ attack.c çš„è¿›ç¨‹çš„æ–‡ä»¶æè¿°ç¬¦ 2 è¿æ¥ç€ç®¡é“å†™ç«¯ï¼Œè¿è¡Œ attacktest.c çš„è¿›ç¨‹åˆ™åœ¨è¯»å–ç®¡é“è¯»ç«¯ã€‚ä¸‹é¢çš„ä»£ç å°±æ˜¯æŠŠ attack.c çš„æ–‡ä»¶æè¿°ç¬¦ 2 è¿æ¥åˆ°ç®¡é“å†™ç«¯çš„ä»£ç ï¼š if (pid == 0) &#123; close(fds[0]); close(2); dup(fds[1]); char *newargv[] = &#123;\"attack\", 0&#125;; exec(newargv[0], newargv); printf(\"exec %s failed\\n\", newargv[0]); exit(1); &#125; è¿›ç¨‹è¢«å›æ”¶çš„è¿‡ç¨‹ä¸€ä¸ªè¿›ç¨‹è°ƒç”¨ exit(int) åä¼šè¿›å…¥ ZOMBIE çŠ¶æ€ï¼Œä½†å¹¶ä¸ç«‹å³é‡Šæ”¾ç‰©ç†å†…å­˜ï¼Œè€Œæ˜¯ä¼šå”¤é†’å…¶çˆ¶è¿›ç¨‹ï¼š void exit(int status) &#123; // æˆ‘ä»¬åœ¨è¿™é‡Œçœç•¥äº†å¾ˆå¤šä»£ç ï¼Œæœ‰å…´è¶£å¯ä»¥è‡ªå·±çœ‹ proc.c wakeup(p->parent); p->state = ZOMBIE; &#125; çˆ¶è¿›ç¨‹è°ƒç”¨ wait(uint64) ä¼šæ‰¾åˆ° ZOMBIE å­è¿›ç¨‹å¹¶è°ƒç”¨ freeproc æ¥å›æ”¶å®ƒï¼š int wait(uint64 addr) &#123; // æˆ‘ä»¬åœ¨è¿™é‡Œçœç•¥äº†å¾ˆå¤šä»£ç ï¼Œæœ‰å…´è¶£å¯ä»¥è‡ªå·±çœ‹ proc.c struct proc *pp; struct proc *p = myproc(); for (;;) &#123; for (pp = proc; pp &lt; &amp;proc[NPROC]; pp++) &#123; if (pp->parent == p &amp;&amp; pp->state == ZOMBIE) &#123; // Found one. pid = pp->pid; freeproc(pp); return pid; &#125; // Wait for a child to exit. sleep(p, &amp;wait_lock); // DOC: wait-sleep &#125; &#125; freeproc åˆ™åˆè°ƒç”¨ proc_freepagetable æ¥å›æ”¶ç‰©ç†å†…å­˜ï¼š // Free a process's page table, and free the // physical memory it refers to. void proc_freepagetable(pagetable_t pagetable, uint64 sz) &#123; uvmunmap(pagetable, TRAMPOLINE, 1, 0); uvmunmap(pagetable, TRAPFRAME, 1, 0); uvmfree(pagetable, sz); &#125; å…¶ä¸­çš„ uvmfree(pagetable, sz) å°±åœ¨é‡Šæ”¾ç‰©ç†å†…å­˜äº†ï¼š // Free user memory pages, // then free page-table pages. void uvmfree(pagetable_t pagetable, uint64 sz) &#123; if (sz > 0) uvmunmap(pagetable, 0, PGROUNDUP(sz) / PGSIZE, 1); freewalk(pagetable); &#125; è®©æˆ‘ä»¬çœ‹å‘ uvmunmapï¼Œå®ƒè·å–æ¯ä¸€é¡µçš„ç‰©ç†åœ°å€ç„¶åè°ƒç”¨ kfreeï¼š // Remove npages of mappings starting from va. va must be // page-aligned. The mappings must exist. // Optionally free the physical memory. void uvmunmap(pagetable_t pagetable, uint64 va, uint64 npages, int do_free) &#123; uint64 a; pte_t *pte; int sz; if ((va % PGSIZE) != 0) panic(\"uvmunmap: not aligned\"); for (a = va; a &lt; va + npages * PGSIZE; a += sz) &#123; sz = PGSIZE; if ((pte = walk(pagetable, a, 0)) == 0) panic(\"uvmunmap: walk\"); if ((*pte &amp; PTE_V) == 0) &#123; printf(\"va=%ld pte=%ld\\n\", a, *pte); panic(\"uvmunmap: not mapped\"); &#125; if (PTE_FLAGS(*pte) == PTE_V) panic(\"uvmunmap: not a leaf\"); if (do_free) &#123; uint64 pa = PTE2PA(*pte); kfree((void *)pa); &#125; *pte = 0; &#125; &#125; æ›´ç»†èŠ‚çš„é‡Šæ”¾ trapframeã€é‡Šæ”¾é¡µè¡¨æˆ‘ä»¬å°±ä¸åœ¨è¿™é‡Œå¤šè¯´äº†ã€‚","categories":[{"name":"å…¬å¼€è¯¾","slug":"å…¬å¼€è¯¾","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/"},{"name":"MIT-6.S081","slug":"å…¬å¼€è¯¾/MIT-6-S081","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/MIT-6-S081/"},{"name":"Labs","slug":"å…¬å¼€è¯¾/MIT-6-S081/Labs","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/MIT-6-S081/Labs/"}],"tags":[]},{"title":"æ¢ç´¢æ—¥å¿—[1]","slug":"others/thoughts/æ¢ç´¢æ—¥å¿—1","date":"2025-10-13T12:11:11.000Z","updated":"2025-10-14T12:11:33.133Z","comments":true,"path":"wiki/others/thoughts/æ¢ç´¢æ—¥å¿—1/","permalink":"http://rinevard.github.io/wiki/others/thoughts/%E6%8E%A2%E7%B4%A2%E6%97%A5%E5%BF%971/","excerpt":"","text":"ä¸çŸ¥é“äººä»¬å¹³å¸¸æ˜¯æ€æ ·ä¸ä»–äººç›¸è¯†çš„ã€‚è®¸ä¹…ä»¥å‰æˆ‘å°±åœ¨æƒ³ï¼Œè‡ªå·±çš„ç¤¾äº¤æ–¹å¼æ˜¯å¦æœ‰ç‚¹ä¸å¤ªåƒä¸€èˆ¬äººç±»ğŸ« ğŸ« å’±æ›´åå¥½é‚£ç§â€œå¤§å®¶ä¸€èµ·åšä¸€ä»¶éƒ½æ„Ÿå…´è¶£çš„äº‹æƒ…ç„¶åæ¸æ¸å°±è®¤è¯†äº†â€çš„ç¤¾äº¤æ–¹å¼ï¼Œä½†ä¼¼ä¹è¿™ç§åšæ³•ç›¸å¯¹å°‘è§ï¼Œè€Œä¸”æˆ‘ä»¥å‰ä¹Ÿæ²¡æ€ä¹ˆå› æ­¤è®¤è¯†åˆ°æ–°æœ‹å‹ã€‚ åœ¨ä¸çŸ­çš„è´¨ç–‘æœŸåï¼Œæ¸æ¸åœ°ä¹Ÿå‘ç°è‡ªå·±ä¹Ÿæ˜¯èƒ½ç”¨è¿™ç§æ–¹æ³•äº¤åˆ°æœ‹å‹çš„ï¼Œè‡³å°‘æ˜¯èƒ½ç»“è¯†äººç±»çš„ã€‚æ¯”å¦‚è¯´è¿™æ¬¡çš„æ¢ç´¢æ—¥å¿—å°±å’Œ GMTK Jam åœ¨å°çº¢ä¹¦æ‹‰åˆ°çš„ç¾æœ¯åŒå­¦æœ‰å…³ï¼ˆèµç¾å°çº¢ä¹¦å–µ â€œæˆ‘å¯¹æ™®é€šçš„äººç±»æ²¡æœ‰å…´è¶£ã€‚ä½ ä»¬ä¹‹ä¸­å¦‚æœæœ‰ç”»ç”»äººã€éŸ³ä¹äººã€éŸ³æ•ˆäººæˆ–è€…å¼‚ä¸–ç•Œäººå°±æ¥æ‰¾æˆ‘å§ï¼â€è™½ç„¶æˆ‘ä¸æ˜¯è¿™ä¹ˆæ‹‰äººçš„ï¼ˆæ²¡äººä¼šè¿™ä¹ˆæ‹‰äººå§ï¼ï¼‰ï¼Œä½†æ€»ä¹‹å°±æ˜¯æ‹‰åˆ°äº†è¿™ä½ä¸­ä¼ çš„ç¾æœ¯åŒå­¦ä¸€èµ·æ¥gamejamï¼Œè¿™æ˜¯å…«æœˆçš„äº‹äº†ã€‚ ä»Šå¤©é¹°è§’åœ¨ä¸­ä¼ å¼€äº†ä¸ªå®£è®²ä¼šï¼Œå’±ä½œä¸ºèµ„æ·±ç²¥ç²¥äººå½“ç„¶æƒ³å»å¬å¬çœ‹ã€‚è®¿å®¢è¿›ä¸­ä¼ éœ€è¦æ‰¾æ ¡å†…åŒå­¦æˆ–è€å¸ˆé¢„çº¦ï¼Œäºæ˜¯å’±å°±æ‰¾äº†è¿™ä½ç¾æœ¯åŒå­¦ç„¶åæˆåŠŸè¿›å…¥ä¸­ä¼ äº†ã€‚ ä¸€èˆ¬æ¥è¯´æ•…äº‹åº”è¯¥è·Œå®•èµ·ä¼ï¼Œæ¯”æ–¹è¯´æˆ‘ä»¬èµ·ç è¦å†™å†™åœ¨ä¸­ä¼ é‡åˆ°çš„è¶£äº‹ï¼Œç„¶åå†™å†™æœ‰ä»€ä¹ˆç³Ÿç³•çš„åœ°æ–¹ï¼Œç„¶åå†åä¸½æ”¶åœºï¼Œä¸è¿‡äº‹æƒ…å°±æ˜¯å¾ˆå¹³å¹³æ·¡æ·¡ã€‚é¹°è§’çš„å®£è®²ä¼šå¾ˆæ™®é€šï¼Œè™½ç„¶å‘äº†ç‚¹å‘¨è¾¹ä½†æˆ‘å¹¶æ²¡æœ‰æŠ½ä¸­æœ‰è¶£çš„å¥–å“ï¼Œä¸­ä¼ çš„é¥­æ¯”åŒ—ç†çš„å¥½åƒï¼Œä½†å¥½åƒå¾—ä¸å¤šã€‚ å¯æˆ‘ç¡®å®ä»æ¥æ²¡æœ‰å»å¤–æ ¡ç©çš„ç»å†ï¼Œæ›´åˆ«è¯´è¦æ‰¾å¤–æ ¡åŒå­¦é¢„çº¦æ‰èƒ½è¿›çš„å­¦æ ¡äº†ğŸ« ğŸ« å’±èƒ½ä»ç¤¾æè¿›åŒ–æˆç°åœ¨è¿™æ ·èƒ½ä¸»åŠ¨æ‹‰äººç»„é˜Ÿè¿˜èƒ½è”ç³»åˆ«äººå·²ç»å¾ˆå¥½äº†ä¸æ˜¯å—ï¼ˆï¼‰ æ¢ç´¢ä¹Ÿä¸æ˜¯æ¬¡æ¬¡æœ‰è¶£ï¼Œå€’ä¸å¦‚è¯´æ¢ç´¢çš„ç»“æœæ™®æ™®é€šé€šæ‰æ˜¯ç†æ‰€åº”å½“çš„å§ã€‚ç°åœ¨æ˜¯æ™šä¸Šåç‚¹äº”ååˆ†ï¼Œæˆ‘åœ¨è‰¯ä¹¡å¤§å­¦åŸåŒ—çš„åœ°é“ç«™æ²¡æœ‰æ‘†æ¸¡è½¦ï¼Œè¦éª‘è½¦å›å­¦æ ¡äº†ã€‚","categories":[{"name":"æ‚è°ˆ","slug":"æ‚è°ˆ","permalink":"http://rinevard.github.io/categories/%E6%9D%82%E8%B0%88/"},{"name":"ç¢ç¢å¿µ","slug":"æ‚è°ˆ/ç¢ç¢å¿µ","permalink":"http://rinevard.github.io/categories/%E6%9D%82%E8%B0%88/%E7%A2%8E%E7%A2%8E%E5%BF%B5/"}],"tags":[]},{"title":"Assignment 7 Path Tracing","slug":"learning/open-course/GAMES101/Hw/Hw7-path-tracing","date":"2025-10-10T14:10:44.000Z","updated":"2025-10-10T15:04:14.905Z","comments":true,"path":"wiki/learning/open-course/GAMES101/Hw/Hw7-path-tracing/","permalink":"http://rinevard.github.io/wiki/learning/open-course/GAMES101/Hw/Hw7-path-tracing/","excerpt":"","text":"å¤§è‡´æµç¨‹è¿™æ¬¡çš„ä½œä¸šæŒºéš¾çš„ã€‚é¦–å…ˆæˆ‘ä»¬æ¥å¯¹ç…§å…¬å¼è§£é‡Šä¸€ä¸‹å¤§è‡´çš„ä»£ç æµç¨‹ï¼š \\begin{align*} L_o(p, \\vec{\\omega_o}) = &L_e(p, \\vec{\\omega_o}) + \\int_{\\Omega} f_r(p, \\vec{\\omega_i}, \\vec{\\omega_o}) L_i(p, \\vec{\\omega_i}) (\\vec{\\omega_i} \\cdot n) d\\omega_i \\\\ = &L_e(p, \\vec{\\omega_o}) + \\int_{\\Omega_{å…‰æºæ–¹å‘}} f_r(p, \\vec{\\omega_i}, \\vec{\\omega_o}) L_i(p, \\vec{\\omega_i}) (\\vec{\\omega_i} \\cdot n) d\\omega_i \\\\ &+ \\int_{\\Omega_{éå…‰æºæ–¹å‘}} f_r(p, \\vec{\\omega_i}, \\vec{\\omega_o}) L_i(p, \\vec{\\omega_i}) (\\vec{\\omega_i} \\cdot n) d\\omega_i \\end{align*} å¦‚æœç‚¹ $p$ æ˜¯å…‰æºï¼Œç›´æ¥è¿”å›å…¶è‡ªå‘å…‰é¡¹ $L_e$. éšæœºé‡‡æ ·ä¸€ä¸ªå…‰æºæ–¹å‘ $w_s$ï¼Œæ ¹æ®å…¬å¼è®¡ç®— $L_\\text{direct}$. éšæœºé‡‡æ ·ä¸€ä¸ªæ–¹å‘ $w_i$ï¼ŒæŒ‰è½®ç›˜èµŒå†³å®šæ˜¯å¦ç»“æŸå¼¹å°„ã€‚ å¦‚æœä¸ç»“æŸä¸” $w_i$ æ²¡æ‰“åˆ°å…‰æºï¼Œæ ¹æ®å…¬å¼è®¡ç®— $L_\\text{indirect}$. è¿”å› $L_\\text{direct}+L_\\text{indirect}$ ç„¶åæ”¾ä»£ç ï¼š Vector3f Scene::castRay(const Ray &amp;ray, int depth) const &#123; Intersection shade_point_inter = intersect(ray); if (!shade_point_inter.happened) &#123; return Vector3f(); &#125; // ----------------Contribution from emission---------------- if (shade_point_inter.m->hasEmission()) &#123; // Light source doesn't reflect light, so we return here return shade_point_inter.m->getEmission(); &#125; // ----------------Contribution from the light source---------------- Vector3f wo = -normalize(ray.direction); Vector3f normal = normalize(shade_point_inter.normal); Vector3f l_direct = Vector3f(); Intersection light_sample; float pdf_light; sampleLight(light_sample, pdf_light); // If the ray is not blocked in the middle, compute its contribution Vector3f light_normal = normalize(light_sample.normal); Vector3f shade_point = shade_point_inter.coords; Vector3f ws = normalize(light_sample.coords - shade_point); Vector3f direct_ray_origin = shade_point + ws * EPSILON; Ray ray_to_light(direct_ray_origin, ws); Intersection inter_between_light = intersect(ray_to_light); if ((!inter_between_light.happened) || inter_between_light.distance > (light_sample.coords - direct_ray_origin).norm() - EPSILON) &#123; l_direct = light_sample.emit * shade_point_inter.m->eval(ws, wo, normal) \\ * std::max(dotProduct(ws, normal), 0.0f) * std::max(dotProduct(-ws, light_normal), 0.0f) \\ / std::pow((light_sample.coords - direct_ray_origin).norm(), 2) / pdf_light; &#125; // ----------------Contribution from other reflectors---------------- Vector3f l_indirect = Vector3f(); // Russian Roulette test if (get_random_float() &lt; RussianRoulette) &#123; Vector3f wi = normalize(shade_point_inter.m->sample(wo, normal)); Vector3f indirect_ray_origin = shade_point + wi * EPSILON; Ray reflected_ray(indirect_ray_origin, wi); Intersection reflected_inter = intersect(reflected_ray); // If reflected_ray hitting a non-emitting object, compute its contribution if (reflected_inter.happened &amp;&amp; reflected_inter.m->hasEmission()) &#123; l_indirect = Vector3f(); &#125; else &#123; l_indirect = castRay(reflected_ray, depth + 1) * shade_point_inter.m->eval(wi, wo, normal) \\ * std::max(dotProduct(wi, normal), 0.0f) \\ / (shade_point_inter.m->pdf(wi, wo, normal)) / RussianRoulette; &#125; &#125; return l_direct + l_indirect; &#125; å†æ¥çœ‹çœ‹å›¾ ä»£ç ç»†èŠ‚æ¥ä¸‹æ¥æˆ‘ä»¬å†èŠèŠå…·ä½“çš„ä»£ç ç»†èŠ‚ã€‚è‡ªå‘å…‰é¡¹æ¯”è¾ƒç®€å•ï¼Œæˆ‘ä»¬ç•¥è¿‡ã€‚ $L_\\text{direct}$ç›´æ¥å…‰éƒ¨åˆ†ã€‚é¦–å…ˆè¦æ³¨æ„çš„æ˜¯ï¼Œå„ä¸ªå°„çº¿ $w_i, w_o, w_s$ éƒ½æ˜¯ä»ç€è‰²ç‚¹æŒ‡å‘å¤–çš„å•ä½æ–¹å‘å‘é‡ã€‚è¿™æ˜¯ä¸€ä¸ªå›¾å½¢å­¦é‡Œå¸¸ç”¨çš„çº¦å®šï¼Œæ‰€ä»¥ä¸è¦é—®ä¸ºä»€ä¹ˆä¸æ˜¯æŒ‡å‘å†…äº†ï¼ˆï¼‰ ç„¶ååœ¨å‘å‡ºå°„çº¿æ—¶ï¼Œæœ€å¥½åšä¸€ä¸ªå¾®å°çš„åç§»ä»¥é¿å…å‘å‡ºçš„å°„çº¿å’Œç€è‰²ç‚¹å¹³é¢ç›¸äº¤ã€‚è¿™å°±æ˜¯æˆ‘ä»¬ direct_ray_origin = shade_point + ws * EPSILON åšäº†åŠ æ³•çš„åŸå› ã€‚ Vector3f wo = -normalize(ray.direction); Vector3f normal = normalize(shade_point_inter.normal); Vector3f l_direct = Vector3f(); Intersection light_sample; float pdf_light; sampleLight(light_sample, pdf_light); // If the ray is not blocked in the middle, compute its contribution Vector3f light_normal = normalize(light_sample.normal); Vector3f shade_point = shade_point_inter.coords; Vector3f ws = normalize(light_sample.coords - shade_point); Vector3f direct_ray_origin = shade_point + ws * EPSILON; Ray ray_to_light(direct_ray_origin, ws); Intersection inter_between_light = intersect(ray_to_light); if ((!inter_between_light.happened) || inter_between_light.distance > (light_sample.coords - direct_ray_origin).norm() - EPSILON) &#123; l_direct = light_sample.emit * shade_point_inter.m->eval(ws, wo, normal) \\ * std::max(dotProduct(ws, normal), 0.0f) * std::max(dotProduct(-ws, light_normal), 0.0f) \\ / std::pow((light_sample.coords - direct_ray_origin).norm(), 2) / pdf_light; &#125; å¦å¤–ï¼Œæˆ‘ä»¬æœ‰ä»å…‰æºé‡‡æ ·è®¡ç®—ç›´æ¥å…‰çš„å…¬å¼ï¼š \\begin{align*} &\\int_{\\Omega_{å…‰æºæ–¹å‘}} f_r(p, \\vec{\\omega_i}, \\vec{\\omega_o}) L_i(p, \\vec{\\omega_i}) (\\vec{\\omega_i} \\cdot n) d\\omega_i \\\\ =&\\int_{A} f_r(p, \\vec{\\omega_i}, \\vec{\\omega_o}) L_i(p, \\vec{\\omega_i}) \\frac{\\cos\\theta\\cos\\theta_i}{\\lVert p'-p \\rVert^2} dA \\end{align*}ç”¨è’™ç‰¹å¡ç½—è¿‘ä¼¼å°±æ˜¯ä»£ç é‡Œå†™çš„ä¸œè¥¿äº†ã€‚ $L_\\text{indirect}$é—´æ¥éƒ¨åˆ†ã€‚é¦–å…ˆè¦åšä¿„ç½—æ–¯è½®ç›˜èµŒï¼Œç„¶åè¦æ£€æŸ¥æ‰“åˆ°çš„æ˜¯å¦æ˜¯å…‰æºã€‚ å¦‚æœé€šè¿‡äº†è½®ç›˜èµŒï¼Œè€Œä¸”æ‰“åˆ°çš„ä¸æ˜¯å…‰æºï¼Œå°±è¦è®¡ç®—é—´æ¥å…‰ã€‚ ä¸ç›´æ¥å…‰ä¸€æ ·ï¼Œæˆ‘ä»¬è¦åšå¾®å°åç§»ï¼Œè¿™å°±æ˜¯ indirect_ray_origin = shade_point + wi * EPSILON . ç„¶åå¥—å…¬å¼å°±è¡Œã€‚ Vector3f l_indirect = Vector3f(); // Russian Roulette test if (get_random_float() &lt; RussianRoulette) &#123; Vector3f wi = normalize(shade_point_inter.m->sample(wo, normal)); Vector3f indirect_ray_origin = shade_point + wi * EPSILON; Ray reflected_ray(indirect_ray_origin, wi); Intersection reflected_inter = intersect(reflected_ray); // If reflected_ray hitting a non-emitting object, compute its contribution if (reflected_inter.happened &amp;&amp; reflected_inter.m->hasEmission()) &#123; l_indirect = Vector3f(); &#125; else &#123; l_indirect = castRay(reflected_ray, depth + 1) * shade_point_inter.m->eval(wi, wo, normal) \\ * std::max(dotProduct(wi, normal), 0.0f) \\ / (shade_point_inter.m->pdf(wi, wo, normal)) / RussianRoulette; &#125; &#125; ç»“æœå¯¹ EPSILON æŒºæ•æ„Ÿçš„ï¼Œå¯ä»¥æŠŠ EPSILON é€‚å½“è°ƒå¤§ç‚¹ï¼Œæˆ‘ç”¨çš„æ˜¯ 0.00020 .","categories":[{"name":"å…¬å¼€è¯¾","slug":"å…¬å¼€è¯¾","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/"},{"name":"GAMES101","slug":"å…¬å¼€è¯¾/GAMES101","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/"},{"name":"Assignments","slug":"å…¬å¼€è¯¾/GAMES101/Assignments","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/Assignments/"}],"tags":[]},{"title":"Note 6 BRDF and Rendering Eequation","slug":"learning/open-course/GAMES101/Notes/Note6-BRDF-and-renderingequation","date":"2025-10-10T13:45:28.000Z","updated":"2025-10-10T14:49:51.245Z","comments":true,"path":"wiki/learning/open-course/GAMES101/Notes/Note6-BRDF-and-renderingequation/","permalink":"http://rinevard.github.io/wiki/learning/open-course/GAMES101/Notes/Note6-BRDF-and-renderingequation/","excerpt":"","text":"æˆ‘ä»¬ä¹‹å‰å·²ç»å­¦è¿‡äº† Blinn-Phong å…‰ç…§æ¨¡å‹ï¼Œä½†å®ƒåªæ˜¯ä¸€ä¸ªå¯å‘å¼æ¨¡å‹ï¼Œåœ¨ç‰©ç†ä¸Šæ˜¯ä¸æ­£ç¡®çš„ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹ç‰©ç†ä¸Šæ­£ç¡®çš„å…‰ç…§æ˜¯æ€æ ·çš„ï¼Œä»¥åŠå¦‚ä½•ç”¨è®¡ç®—æœºè¿‘ä¼¼æ±‚è§£æ¥è¿‘æ­£ç¡®çš„å…‰ç…§ã€‚ è¾å°„åº¦é‡å­¦åœ¨äº†è§£å…‰ç…§çš„ç‰©ç†æ¨¡å‹ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ä¸€äº›ç‰©ç†é‡ã€‚æœ€å…³é”®çš„ç‰©ç†é‡æœ‰å››ä¸ªï¼Œåˆ†åˆ«æ˜¯ Radiant flux/power $\\Phi$ï¼Œå•ä½ $W$. Radiant intensity $I$ï¼Œå•ä½ $\\frac{W}{\\text{sr}}$. Irradiance $E$ï¼Œå•ä½ $\\frac{W}{m^2}$. Radiance $L$ï¼Œå•ä½ $\\frac{W}{\\text{sr}\\cdot m^2}$. æ¥ä¸‹æ¥è®©æˆ‘ä»¬çœ‹çœ‹å®ƒä»¬çš„å…·ä½“å®šä¹‰ã€‚ Radiant flux/power $\\Phi$Radiant flux/power ç¬¦å· $\\Phi$ï¼Œå•ä½ $W$. å®šä¹‰ä¸º \\Phi = \\frac{dQ}{dt}Radiant intensity $I$Radiant Intensity ç¬¦å· $I$ï¼Œå•ä½ $\\frac{W}{\\text{sr}}$ï¼Œè¡¨ç¤ºæŸä¸ªå®šç‚¹æ¥æ”¶/ç©¿è¿‡/å‘å‡ºçš„ï¼Œåœ¨æŒ‡å®šæ–¹å‘ $\\vec{\\omega}$ ä¸Šçš„ï¼Œå•ä½ç«‹ä½“è§’çš„ Power. å®šä¹‰ä¸º I(\\vec{\\omega})=\\frac{d\\Phi}{d\\omega}è¿™é‡Œçš„ç¬¦å·ç•¥æ˜¾æ··ä¹±ã€‚å·¦è¾¹çš„å‚æ•° $\\vec{\\omega}$ æ˜¯ä¸€ä¸ªæ–¹å‘å‘é‡ï¼Œå³è¾¹çš„ $d\\omega$ åˆ™æ˜¯è¿™ä¸ªæ–¹å‘ä¸Šç«‹ä½“è§’çš„å¾®åˆ†ã€‚ æˆ‘ä»¬çŸ¥é“æ–¹å‘å‘é‡ $\\vec{\\omega}$ ä¹Ÿèƒ½åœ¨çƒåæ ‡ä¸‹è¢«è¡¨ç¤ºä¸º $(\\theta,\\varphi)$ã€‚å¯¹ç»™å®šçš„ $(\\theta,\\varphi)$ï¼Œæˆ‘ä»¬å¯ä»¥ç®—å‡ºå…¶åœ¨çƒé¢ä¸Šçš„é¢ç§¯å¾®åˆ†ï¼Œä¹Ÿèƒ½è¿›ä¸€æ­¥æ±‚å‡ºç«‹ä½“è§’å¾®åˆ† $d\\omega$ï¼Œå¦‚ä¸‹æ‰€ç¤º \\begin{align*} &dA=r^2 \\sin \\theta \\space d\\theta \\space d\\varphi \\\\ &d\\omega=\\frac{dA}{r^2}=\\sin \\theta \\space d\\theta \\space d\\varphi \\end{align*}ä¸‹å›¾æ˜¯å¯¹ Solid angle å’Œ Radiant Intensity ä¸¤ä¸ªæ¦‚å¿µçš„å›¾è§£ Irradiance $E$Irradiance ç¬¦å· $E$ï¼Œå•ä½ $\\frac{W}{m^2}$. è¡¨ç¤ºç‚¹ $x$ å‘¨å›´å•ä½é¢ç§¯æ¥æ”¶/ç©¿è¿‡/å‘å‡ºçš„ Powerï¼Œå®šä¹‰ä¸º E(x)=\\frac{d\\Phi}{dA}ä¸‹å›¾è®¡ç®—å¹¶å¯¹æ¯”äº†å¹³è¡Œå…‰ç©¿è¿‡ä¸¤ä¸ªä¸åŒæˆªé¢æ—¶çš„ irradianceï¼šå‚ç›´æˆªé¢ $A$ï¼Œä»¥åŠä¸å‚ç›´æ–¹å‘æˆ $\\theta$ è§’çš„å€¾æ–œæˆªé¢ $Aâ€™$ã€‚ å…¶ä¸­ $\\Phi=\\Phiâ€™$ æ˜¯å› ä¸ºèƒ½é‡å®ˆæ’ï¼Œå…‰æŸç©¿è¿‡ä»»ä½•ä¸€ä¸ªå®Œæ•´æˆªé¢çš„åŠŸç‡æ˜¯å›ºå®šçš„ã€‚ Radiance $L$Radiance $L$ çš„å•ä½æ˜¯ $\\frac{W}{\\text{sr}\\cdot \\space m^2}$ï¼Œè¡¨ç¤ºè¡¨é¢æŸç‚¹ $x$ å‘¨å›´å•ä½æŠ•å½±é¢ç§¯æ¥æ”¶/ç©¿è¿‡/å‘å‡ºçš„ï¼Œåœ¨æŒ‡å®šæ–¹å‘ $\\vec{w}$ ä¸Šçš„ï¼Œå•ä½ç«‹ä½“è§’çš„ radiant flux. å®šä¹‰ä¸º L(x,\\vec{\\omega})=\\frac{d^2\\Phi}{d\\omega ds}=\\frac{d^2\\Phi}{d\\omega ds_{0}\\cos\\theta}è¿™é‡Œçš„ $ds$ æ˜¯æŠ•å½±å‰é¢ç§¯ï¼Œ$ds_0 \\cos\\theta$ æ˜¯æŠ•å½±é¢ç§¯ã€‚ ä¸‹å›¾æ˜¯å¯¹ Irradiance å’Œ Radianceçš„å›¾è§£ BRDFå’Œæè´¨ç°åœ¨æˆ‘ä»¬å¯ä»¥çœ‹çœ‹å…‰ç…§çš„ç‰©ç†æ¨¡å‹äº†ï¼Œå…¶ä¸­æœ€å…³é”®çš„æ˜¯ BRDFï¼Œå³åŒå‘åå°„åˆ†å¸ƒå‡½æ•°ã€‚å®ƒå®šä¹‰äº†ä»æ–¹å‘ $\\vec{\\omega_i}$ å°„å…¥çš„å…‰çº¿æ‰“åˆ°æŸä¸ªè¡¨é¢ä¸Šåå°„åˆ° $\\vec{\\omega_r}$ æ–¹å‘çš„å¼ºåº¦ï¼š f_r(p,\\vec{\\omega_i}, \\vec{\\omega_r}) = \\frac{dL_r(p,\\vec{\\omega_r})}{dE_i(p,\\vec{\\omega_i})}ä½ å¯èƒ½ä¼šç–‘æƒ‘ä¸ºä»€ä¹ˆä¹‹å‰æˆ‘ä»¬è¯´ $E$ æ˜¯å…³äº $x$ çš„å‡½æ•°ï¼Œç°åœ¨å´é™¤äº†åæ ‡ $p$ å¤–è¿˜å¤šäº†ä¸€ä¸ªæ–¹å‘å‚æ•° $\\omega_i$ï¼Œè¿™æ˜¯å› ä¸º BRDF é‡Œçš„ $E$ æ˜¯å¾®åˆ†ã€‚å…·ä½“å¯ä»¥çœ‹çœ‹ä¸‹é¢è¿™ä¸ªå¼å­ï¼š E(x) = \\int_{\\Omega} L_i(x,\\vec{\\omega_i}) \\cos\\theta_i d\\omega_i \\\\ dE_i(x, \\vec{\\omega_i}) = L_i(x, \\vec{\\omega_i}) \\cos\\theta_i d\\omega_iä½ å¯èƒ½è¿˜ä¼šç–‘æƒ‘ï¼Œä¸ºä»€ä¹ˆåˆ†æ¯ç”¨ $E$ å‘¢ï¼Ÿå’Œåˆ†æ¯ä¸€æ ·ç»Ÿä¸€ç”¨ $L$ ä¸æ˜¯æ›´ä¼˜é›…å—ï¼Ÿ æ® https://www.zhihu.com/question/28476602/answer/41003204 è¿™ä¸ªç­”æ¡ˆæ‰€è¯´ï¼Œæµ‹é‡å‡ºå°„çš„ Radiance $L$ å¾ˆæ–¹ä¾¿ï¼Œä½†æµ‹é‡å…¥å°„çš„ Irradiance $L$ å¾ˆå›°éš¾ï¼Œè€Œæµ‹é‡å…¥å°„çš„ $dE$ æŒºæ–¹ä¾¿ï¼Œå› æ­¤æˆ‘ä»¬å°±ä½¿ç”¨äº† $\\frac{dL}{dE}$. æˆ‘ä»¬æŠŠä¸Šé¢çš„ $dE_i(x,\\vec{\\omega_i})$ ä»£å…¥ BRDFï¼Œå°±å¾—åˆ°äº† f_r(p,\\vec{\\omega_i}, \\vec{\\omega_r}) = \\frac{dL_r(p,\\vec{\\omega_r})}{L_i(x,\\vec{w_i})\\cos\\theta_i dw_i}ç‰©ä½“çš„æè´¨å°±ç”¨ BSDFï¼ˆåå°„çš„BRDF+æŠ˜å°„çš„BTDFï¼‰è¡¨ç¤ºã€‚æˆ‘ä»¬è¿™é‡ŒåªèŠ BRDFï¼Œå› ä¸º BTDF å’Œ BRDF æ¥è¿‘ã€‚BRDF çš„è·å–åŒ…æ‹¬ä½†ä¸é™äºè¿™ä¸¤ç§æ–¹å¼ï¼š ç°å®æµ‹é‡ã€‚æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°è®¸å¤šåŒ…å«å¤§é‡ BRDF æµ‹é‡æ•°æ®çš„æ•°æ®é›†ï¼Œæ¯”å¦‚ MERL æ•°æ®é›†ã€‚ å¾®è¡¨é¢æ¨¡å‹ã€‚ç”¨ç²—ç³™åº¦ã€é‡‘å±åº¦ç­‰å‚æ•°æ¥æ„å»ºå¯å‘å¼çš„ BRDF å‡½æ•°ã€‚ è¿˜å€¼å¾—ä¸€æçš„æ˜¯ï¼Œç”± Helmholtz Reciprocity Principleï¼Œæœ‰ f_r(p,\\vec{\\omega_i}, \\vec{\\omega_o}) = f_r(p,\\vec{\\omega_o}, \\vec{\\omega_i})ä¹Ÿå°±æ˜¯è¯´äº¤æ¢å…¥å°„å‡ºå°„æ–¹å‘ï¼ŒBRDF å‡½æ•° $f_r$ ä¸å˜ã€‚ æ¸²æŸ“æ–¹ç¨‹ç°åœ¨æˆ‘ä»¬å…ˆçœ‹çœ‹åå°„æ–¹ç¨‹ï¼Œå†çœ‹çœ‹æ¸²æŸ“æ–¹ç¨‹ã€‚ åå°„æ–¹ç¨‹æ˜¯é€šè¿‡ BRDF æ±‚å‡º $L_r$ çš„æ–¹ç¨‹ï¼Œå¯¹ BRDF çš„å…¬å¼ç§¯åˆ†ä¸€ä¸‹å°±è¡Œï¼š L_r(p, \\vec{\\omega_r}) = \\int_{\\Omega} f_r(p, \\vec{\\omega_i}, \\vec{\\omega_r}) L_i(p, \\vec{\\omega_i}) (\\vec{\\omega_i} \\cdot \\vec{n}) d\\omega_iå…¶ä¸­ $\\vec{n}$ æ˜¯ç‚¹ $p$ å¤„çš„æ³•çº¿æ–¹å‘ï¼Œ$\\vec{\\omega_i} \\cdot \\vec{n}$ æ˜¯ BRDF å®šä¹‰é‡Œçš„ $\\cos\\theta_i$. è€Œæ¸²æŸ“æ–¹ç¨‹ï¼Œä¸è€ƒè™‘æŠ˜å°„ï¼Œåªæ˜¯æ¯”åå°„æ–¹ç¨‹å¤šäº†ä¸€ä¸ªè‡ªå‘å…‰é¡¹ï¼š L_o(p, \\vec{\\omega_o}) = L_e(p, \\vec{\\omega_o}) + \\int_{\\Omega} f_r(p, \\vec{\\omega_i}, \\vec{\\omega_o}) L_i(p, \\vec{\\omega_i}) (\\vec{\\omega_i} \\cdot n) d\\omega_iä½ å¯èƒ½ä¼šå¥½å¥‡å³ä¾§çš„ $L_i(p,\\vec{\\omega_i})$ æ€ä¹ˆæ±‚å‡ºæ¥ã€‚ç”±èƒ½é‡å®ˆæ’ï¼Œæˆ‘ä»¬å¯ä»¥ä» $p$ å‡ºå‘é¡ºç€ $-\\vec{\\omega_i}$ æ‰¾åˆ°ç¬¬ä¸€ä¸ªäº¤ç‚¹ $q$ï¼Œç„¶åå°±æœ‰ L_i(p,\\vec{\\omega_i})=L_o(q,-\\vec{\\omega_i})å®é™…ç®—æ³•ç”±ä¸Šå¯çŸ¥ï¼Œæˆ‘ä»¬è¦æ±‚è§£ä¸‹é¢çš„æ–¹ç¨‹ï¼š L_o(p, \\vec{\\omega_o}) = L_e(p, \\vec{\\omega_o}) + \\int_{\\Omega} f_r(p, \\vec{\\omega_i}, \\vec{\\omega_o}) L_o(\\text{raycast}(p, -\\vec{\\omega_i}), -\\vec{\\omega_i}) (\\vec{\\omega_i} \\cdot n) d\\vec{\\omega_i}è¿™æ˜¯ä¸€ä¸ªç§¯åˆ†ï¼Œè¿˜æ˜¯ä¸€ä¸ªé€’å½’ï¼Œæˆ‘ä»¬å…ˆç”¨è’™ç‰¹å¡ç½—ç®—æ³•è¿‘ä¼¼ç§¯åˆ†ï¼Œå¾—åˆ° L_o(p, \\vec{\\omega_o}) \\approx L_e(p, \\vec{\\omega_o}) + \\frac{1}{N}\\sum_{k=1}^{N}\\frac{f_r(p, \\vec{\\omega_i}^{(k)}, \\vec{\\omega_o}) L_o(\\text{raycast}(p, -\\vec{\\omega_i}^{(k)}), -\\vec{\\omega_i}^{(k)}) (\\vec{\\omega_i} ^{(k)}\\cdot n) } {p(\\vec{\\omega_i}^{(k)})}å…¶ä¸­ $\\vec{\\omega_i}^{(k)}$ æ˜¯éšæœºé‡‡æ ·çš„æ–¹å‘å‘é‡ï¼Œ$p(\\vec{\\omega_i}^{(k)})$ æ˜¯é‡‡æ ·åˆ°å®ƒçš„æ¦‚ç‡ã€‚ æœ‰äº†è¿™ä¸ªæ±‚å’Œï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹é€’å½’äº†ï¼Œå¤§è‡´ç®—æ³•å¦‚ä¸‹ï¼š ä» $p$ å°„å‡ºæœéšæœºæ–¹å‘ $\\vec{\\omega_i}^{(k)}$ çš„å°„çº¿ï¼Œæ‰“åˆ° $q^{(k)}$. è®¡ç®— $L_o(q,-w_i^{(k)})$ï¼Œç„¶åä»£å…¥å¼å­ï¼Œæ±‚å¾— $L_o(p,\\vec{\\omega_o})$ã€‚ ç­‰ç­‰ï¼Œè¿™ä¸æ˜¯æ— é™é€’å½’å—ï¼Ÿç¡®å®å¦‚æ­¤ã€‚æ‰€ä»¥æˆ‘ä»¬ä¼šå‡è®¾å¦‚æœå°„çº¿æ‰“åˆ°äº†å…‰æºå°±åªè¿”å›è‡ªå‘å…‰é¡¹ $L_e$. ä½†è¿™ä¸è¿˜æ˜¯å¾ˆå¤æ‚å—ï¼Œå‡è®¾æˆ‘ä»¬å¯¹æ¯ä¸ªç‚¹å‘å°„ $10$ æ¡å°„çº¿ï¼Œå¼¹å°„ä»¥åå°±è¦å‘å°„ $10^2$ ä¸ªï¼Œå†å¼¹å°„å°±è¦ $10^3$ ä¸ªï¼ æ²¡é”™ï¼Œæ‰€ä»¥æˆ‘ä»¬åªå¯¹æ¯ä¸ªç‚¹å‘å‡º $1$ æ¡å°„çº¿å¹¶è®¡ç®—å…¶å¼¹å°„åçš„å®Œæ•´è·¯å¾„ï¼Œç„¶åå¯¹æ¯ä¸ªç‚¹è¿½è¸ªå¤šæ¡è·¯å¾„å¹¶å–å¹³å‡ã€‚è™½ç„¶è¿™ä¸å®Œå…¨ç¬¦åˆä¸Šé¢çš„å…¬å¼ï¼Œä½†å¾ˆæœ‰æ•ˆã€‚ è®©æˆ‘ä»¬æ¥çœ‹çœ‹æ–°çš„ç®—æ³•å§ï¼š å¦‚æœç‚¹ $p$ æ˜¯å…‰æºï¼Œç›´æ¥è¿”å›å…¶è‡ªå‘å…‰é¡¹ã€‚ éšæœºé‡‡æ ·ä¸€ä¸ªæ–¹å‘ $w_i$ï¼Œä» $p$ å‘å‡ºä¸€æ¡æœå‘ $w_i$ çš„å°„çº¿ï¼Œæ‰“åˆ°ç‚¹ $q$. è®¡ç®—ç‚¹ $q$ çš„ $L_o(q,-w_i)$ï¼Œä»£å…¥å…¬å¼ï¼Œæ±‚å¾— $L_o(p,w_o)$. å¯¹æ±‚å¾—çš„å¤šä¸ª $L_o(p,w_o)$ å–å¹³å‡ã€‚ è¿™ä¸ªç®—æ³•å½“ç„¶å¯ä»¥è¿›ä¸€æ­¥ä¼˜åŒ–ï¼Œæ¯”å¦‚è¯´ä¸Šé¢è¿˜æ˜¯æœ‰æ½œåœ¨çš„æ— é™å¼¹å°„é£é™©ï¼Œæ‰€ä»¥è¦ç”¨ä¿„ç½—æ–¯è½®ç›˜èµŒæ¥åœ¨æ¯æ¬¡å¼¹å°„æ—¶éƒ½æœ‰éšæœºæ¦‚ç‡åœæ­¢å¼¹å°„ï¼ˆè¿™è¢«ç§°ä½œRRï¼‰ï¼›åˆæ¯”å¦‚ä¸Šé¢æ‰“åˆ°å…‰æºçš„æ¦‚ç‡å¤ªä½ï¼Œæ‰€ä»¥å¯ä»¥ä»å…‰æºé‡‡æ ·å°„çº¿ï¼ˆè¿™è¢«ç§°ä½œNEEï¼‰ã€‚ä¸è¿‡è¿™äº›ä¸œè¥¿å°±ç•™åˆ°ä½œä¸š 7 çš„è§£æé‡Œå†è¯´å§ã€‚ å‚è€ƒèµ„æ–™Stanford CS348B, Spring 2022ï¼šhttps://gfxcourses.stanford.edu/cs348b/spring22 å¤šä¼¦å¤šå¤§å­¦å›¾å½¢å­¦è®²ä¹‰ï¼šhttps://www.dgp.toronto.edu/public_user/elf/2522/light.pdf Introduction to Radiometry and Photometry UE4 çš„ BRDF å®ç°ï¼šhttps://blog.selfshadow.com/publications/s2013-shading-course/karis/s2013_pbs_epic_notes_v2.pdf","categories":[{"name":"å…¬å¼€è¯¾","slug":"å…¬å¼€è¯¾","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/"},{"name":"GAMES101","slug":"å…¬å¼€è¯¾/GAMES101","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/"},{"name":"Notes","slug":"å…¬å¼€è¯¾/GAMES101/Notes","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/Notes/"}],"tags":[]},{"title":"æ¢ç´¢æ—¥å¿—[0]","slug":"others/thoughts/æ¢ç´¢æ—¥å¿—0","date":"2025-10-10T12:10:11.000Z","updated":"2025-10-14T12:11:51.068Z","comments":true,"path":"wiki/others/thoughts/æ¢ç´¢æ—¥å¿—0/","permalink":"http://rinevard.github.io/wiki/others/thoughts/%E6%8E%A2%E7%B4%A2%E6%97%A5%E5%BF%970/","excerpt":"","text":"ç¬¬äºŒæ¬¡å‚åŠ äº† Ludum Dareï¼Œç¬¬äºŒæ¬¡å‚åŠ äº† Compo èµ›é“ã€‚Compo è¦æ±‚å•äººä»é›¶å¼€å§‹åœ¨ 48 å°æ—¶å†…åšå‡ºä¸€ä¸ªèƒ½ç©çš„ä¸œè¥¿ã€‚ä¸è§‰å¾—è¿™å¾ˆé…·å—ï¼Œä½œä¸ºä¸€ä¸ªç©å®¶æˆ‘è§‰å¾—è¿™å¤ªé…·äº†ï¼Œå¾ˆç¬¦åˆæˆ‘å¯¹æå®¢çš„æƒ³è±¡ã€‚ ä¸Šä¸€æ¬¡å‚åŠ  Compo ç»“è¯†äº†ä¸€ä½å¾ˆæœ‰è¶£çš„æœ‹å‹ï¼Œæ‰€ä»¥è¿™æ¬¡åˆå‚åŠ äº† Compo è€Œä¸æ˜¯ç»„é˜Ÿçš„ Jamã€‚ä¸è¿‡è¿™æ¬¡ä¼¼ä¹è‡³å°‘åˆ°ç°åœ¨ä¸ºæ­¢è¿˜æ²¡ç»“è¯†åˆ°å¾ˆæœ‰è¶£çš„æœ‹å‹ï¼ˆï¼‰ ä»ä¸Šå­¦æœŸå°±å¼€å§‹æƒ³ï¼Œå¤§å­¦çš„æ¯å¤©éƒ½å¤ªç›¸ä¼¼ï¼Œæ—¥å¤ä¸€æ—¥ã€‚å› æ­¤æƒ³æ¯å‘¨éƒ½åšä¸€äº›æ²¡åšè¿‡çš„äº‹æƒ…ã€‚è™½ç„¶æ²¡åšæŒå¾ˆä¹…ï¼Œä½†æˆ‘æƒ³è¿™ç¡®å®æ˜¯å€¼å¾—åšçš„ã€‚æ‰€ä»¥ä»ç°åœ¨å¼€å§‹ç®€å•å†™å†™æ¢ç´¢æ—¥å¿—å§ï¼Œæ—¶ä¸æ—¶æ¢ç´¢ä¸€ä¸‹ã€‚ è¿™æ¬¡é™¤äº†è‡ªå·±å‚åŠ ä¹‹å¤–ï¼Œè¿˜å’Œå¢¨é±¼æ¸¸ç ”ç¤¾çš„åŒå­¦ä»¬ä¸€èµ·ç»„ç»‡äº†ä¸€ä¸ªæ´»åŠ¨ï¼Œå’Œç¤¾å›¢çš„å¤§å®¶ä¸€èµ·å‚åŠ äº†è¿™åœº gamejamï¼Œå’±ä»¬ç¤¾å›¢æœ€åä¸€å…±åšäº†å››ä¸ªæ¸¸æˆã€‚æˆ‘åšäº† SwarmSurge. æ€æ ·çš„ç”Ÿæ´»å€¼å¾—æˆ‘è¿‡ï¼Œæˆ‘è¯¥è¿‡æ€æ ·çš„ç”Ÿæ´»ï¼Ÿæˆ‘ç¡®å®è¿˜æ²¡æƒ³æ˜ç™½ã€‚Jam æ˜¯ç”Ÿæ´»é‡Œä¸ºæ•°ä¸å¤šçš„ä¸€æŠ¹å¥‡å¹»è‰²å½©ï¼ŒæƒŠè‰³åˆçŸ­æš‚ã€‚åœ¨æœ‰è¶£çš„æ•…äº‹ç»“æŸä¹‹åï¼Œæˆ‘ä»¬åˆè¯¥åšä»€ä¹ˆï¼Œåˆè¯¥å»å¾€ä½•æ–¹ï¼Ÿ ä¹Ÿéš¾æ€ªä¼šå–œæ¬¢å‡‰å®«æ˜¥æ—¥ã€‚è™½ç„¶å¥¹æ€§æ ¼æ¶åŠ£æƒ³ä¸€å‡ºæ˜¯ä¸€å‡ºï¼Œä½†å¥¹æ˜¯è®©ä¸–ç•Œå˜å¾—æ›´çƒ­é—¹çš„å‡‰å®«æ˜¥æ—¥å›¢å›¢é•¿ï¼é˜¿è™šæ›¾é—®è‡ªå·±ï¼šâ€œå¯¹è¿™ç§è¶…ä¹å¸¸è¯†çš„å­¦å›­ç”Ÿæ´»ï¼Œä½ å°±ä¸è§‰å¾—å¿«ä¹å—ï¼Ÿâ€ä»–çš„å›ç­”æ˜¯ï¼šâ€œå½“ç„¶å¿«ä¹äº†ï¼Œåˆ«é—®æˆ‘è¿™ç§æ˜æ‘†ç€çš„äº‹æƒ…ã€‚â€ å¯¹è¿™äº›å¥‡å¹»è‰²å½©ï¼Œæˆ‘éš¾é“ä¸æ„Ÿè§‰å¿«ä¹å—ï¼Ÿå½“ç„¶å¿«ä¹äº†ã€‚æˆ‘ä¼šä¸€ç›´æ¢ç´¢ä¸‹å»ï¼Œå³ä½¿æ¯å¤©éƒ½æ˜¯æŸä¸ªé›¨æ—¥ã€‚","categories":[{"name":"æ‚è°ˆ","slug":"æ‚è°ˆ","permalink":"http://rinevard.github.io/categories/%E6%9D%82%E8%B0%88/"},{"name":"ç¢ç¢å¿µ","slug":"æ‚è°ˆ/ç¢ç¢å¿µ","permalink":"http://rinevard.github.io/categories/%E6%9D%82%E8%B0%88/%E7%A2%8E%E7%A2%8E%E5%BF%B5/"}],"tags":[]},{"title":"Note 5 RayTracing","slug":"learning/open-course/GAMES101/Notes/Note5-RayTracing","date":"2025-09-25T13:48:28.000Z","updated":"2025-09-25T13:51:26.850Z","comments":true,"path":"wiki/learning/open-course/GAMES101/Notes/Note5-RayTracing/","permalink":"http://rinevard.github.io/wiki/learning/open-course/GAMES101/Notes/Note5-RayTracing/","excerpt":"","text":"æ¸²æŸ“å¯ä»¥åˆ†ä¸ºä¸¤ä¸ªå¤§ç±»ï¼šobject-order rendering å’Œ Image-order rendering. å‰è€…ä»¥åœºæ™¯ä¸­çš„ç‰©ä½“ï¼ˆé€šå¸¸æ˜¯å¦‚ä¸‰è§’å½¢ï¼‰ä¸ºåŸºæœ¬å•ä½è¿›è¡Œè¿­ä»£ï¼Œéå†åœºæ™¯ä¸­çš„æ¯ä¸€ä¸ªç‰©ä½“ï¼Œç„¶åç¡®å®šè¯¥ç‰©ä½“ä¼šå½±å“å±å¹•ä¸Šçš„å“ªäº›åƒç´ ï¼›åè€…ä»¥å±å¹•ä¸Šçš„åƒç´ ä¸ºåŸºæœ¬å•ä½è¿›è¡Œè¿­ä»£ï¼Œéå†è¾“å‡ºå›¾åƒä¸­çš„æ¯ä¸€ä¸ªåƒç´ ï¼Œç„¶åå¯¹äºæ¯ä¸ªåƒç´ ï¼Œå®ƒä¼šæ‰¾å‡ºåœºæ™¯ä¸­çš„å“ªä¸ªç‰©ä½“æˆ–ç‰©ä½“çš„å“ªä¸ªéƒ¨åˆ†å†³å®šäº†è¯¥åƒç´ çš„é¢œè‰²ã€‚ æˆ‘ä»¬ä¹‹å‰å­¦çš„å…‰æ …åŒ–æ˜¯å‰è€…ï¼Œè€Œæˆ‘ä»¬æ¥ä¸‹æ¥è¦ä»‹ç»çš„å…‰çº¿è¿½è¸ªå°±æ˜¯åè€…ã€‚ å…‰çº¿è¿½è¸ªåŸºæœ¬æ€æƒ³å…‰çº¿è¿½è¸ªçš„æ€æƒ³åŸºäºå…‰è·¯å¯é€†â€”â€”æ—¢ç„¶å…‰è·¯å¯é€†ï¼Œé‚£ä¹ˆæ‰“åˆ°æ‘„åƒæœºé‡Œçš„å…‰å°±å¯ä»¥çœ‹ä½œä»æ‘„åƒæœºå‘å‡ºçš„å°„çº¿ï¼Œæˆ‘ä»¬åªè¦æ‰“å‡ºå°„çº¿ç„¶åè®¡ç®—å°„çº¿æ‰“åˆ°çš„ç‚¹çš„é¢œè‰²å°±å¥½äº†ã€‚ å…¶å®åŸºæœ¬æ€è·¯çœŸçš„å°±æ˜¯è¿™ä¹ˆç®€å•ï¼å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬ä»çœ¼ç›é‡Œå‘å‡ºç»è¿‡æ¯ä¸ªåƒç´ çš„å°„çº¿ï¼Œç„¶åå°„çº¿æ‰“åˆ°ç‰©ä½“ä¸Šå°±å¾—åˆ°äº†ç‰©ä½“çš„åŸºæœ¬é¢œè‰²ã€‚è€Œå°„çº¿è¿˜ä¼šåå°„ã€æŠ˜å°„ï¼Œæˆ‘ä»¬è®¡ç®—åå°„ã€æŠ˜å°„åçš„å°„çº¿æ‰“åˆ°çš„é¢œè‰²ï¼Œå†åŠ åˆ°åŸºæœ¬é¢œè‰²ä¸Šï¼Œå°±å¾—åˆ°äº†è¿™ä¸ªåƒç´ çš„é¢œè‰²ã€‚ å…‰çº¿è¿½è¸ªä¹Ÿè‡ªç„¶åœ°ç”Ÿæˆäº†é˜´å½±â€”â€”å¦‚æœå°„çº¿æ‰“ä¸­çš„ç‚¹å’Œå…‰æºçš„è¿çº¿é—´æœ‰ç‰©ä½“é®æŒ¡ï¼Œè¿™ç‚¹å°±æ˜¯é˜´å½±ï¼Œå¦åˆ™å°±ä¸æ˜¯é˜´å½±ã€‚ ç¢°æ’æ£€æµ‹æ—¢ç„¶å¦‚æ­¤ï¼Œæˆ‘ä»¬åªè¦æ£€æµ‹å°„çº¿å’Œä¸‰è§’å½¢çš„ç¢°æ’å°±å¥½äº†ã€‚æˆ‘ä»¬å¯ä»¥ç”¨ä¸‹é¢çš„ MÃ¶ller Trumbore Algorithm æ¥åšæ£€æµ‹ï¼Œå…¶æ€è·¯æ˜¯è§£ â€œç›´çº¿ä¸Šçš„ç‚¹ = ä¸‰è§’å½¢é‡å¿ƒåæ ‡è¡¨ç¤ºâ€ è¿™ä¸ªæ–¹ç¨‹ï¼š è€ƒè™‘å°„çº¿ $\\vec{O} + t\\vec{D}$ å’Œä¸‰è§’å½¢ $P_0, P_1, P_2$ï¼Œæˆ‘ä»¬è¦è§£æ–¹ç¨‹ \\vec{O} + t\\vec{D} = (1-b_1-b_2)\\vec{P_0} + b_1\\vec{P_1} + b_2\\vec{P_2}è¿™æ˜¯ä¸€ä¸ªçº¿æ€§æ–¹ç¨‹ç»„ï¼Œè§£ä¸º \\begin{bmatrix} t \\\\ b_1 \\\\ b_2 \\end{bmatrix} = \\frac{1}{\\vec{S_1} \\cdot \\vec{E_1}} \\begin{bmatrix} \\vec{S_2} \\cdot \\vec{E_2} \\\\ \\vec{S_1} \\cdot \\vec{S} \\\\ \\vec{S_2} \\cdot \\vec{D} \\end{bmatrix}å…¶ä¸­ \\begin{aligned} \\vec{E_1} &= \\vec{P_1} - \\vec{P_0} \\\\ \\vec{E_2} &= \\vec{P_2} - \\vec{P_0} \\\\ \\vec{S} &= \\vec{O} - \\vec{P_0} \\\\ \\vec{S_1} &= \\vec{D} \\times \\vec{E_2} \\\\ \\vec{S_2} &= \\vec{S} \\times \\vec{E_1} \\end{aligned}æ€§èƒ½ä¼˜åŒ–åœ¨åšå°„çº¿å’Œä¸‰è§’å½¢çš„ç¢°æ’æ£€æµ‹æ—¶ï¼Œç®€å•åœ°éå†åœºæ™¯é‡Œçš„æ¯ä¸ªä¸‰è§’å½¢æ˜¾ç„¶å¤ªæ…¢äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨åŒ…å›´ç›’æ¥ä¼˜åŒ–ã€‚å¦‚æœä¸€ä¸ªå°„çº¿æ²¡æœ‰ç¢°åˆ°åŒ…å›´ç›’ï¼Œè‡ªç„¶å°±ä¸ä¼šç¢°åˆ°ç›’å­é‡Œçš„ç‰©ä½“ï¼›å¦‚æœç¢°åˆ°äº†ï¼Œå†å’Œç›’å­é‡Œçš„ç‰©ä½“åšç¢°æ’æ£€æµ‹ã€‚ å¸¸è§åŒ…å›´ç›’åŒ…å›´ç›’æœ‰ä¸¤ç§æ€è·¯ï¼Œä¸€ç§æ˜¯åŸºäºç©ºé—´çš„åˆ’åˆ†ï¼Œå¦ä¸€ç§æ˜¯åŸºäºç‰©ä½“çš„åˆ’åˆ†ã€‚å‰è€…çš„ä»£è¡¨åŒ…æ‹¬å››å‰æ ‘ã€å…«å‰æ ‘ï¼›åè€…çš„ä»£è¡¨æ˜¯ BVH. å››å‰æ ‘ã€å…«å‰æ ‘æŠŠç©ºé—´è¿›è¡Œå¹³åˆ†ï¼Œå½“ä¸€ä¸ªåŒºåŸŸé‡Œè¿˜å‰©è¾ƒå¤šç‰©ä½“æ—¶å°±å†åœ¨è¿™ä¸ªåŒºåŸŸé‡Œå¹³åˆ†ä¸€æ¬¡ã€‚ BVH ä¸ºæ¯ç»„ç‰©ä½“å»ºç«‹åŒ…å›´ç›’ï¼Œç„¶åå†æŠŠçˆ¶åŒ…å›´ç›’åˆ’åˆ†æˆå­åŒ…å›´ç›’ã€‚ å°„çº¿å’ŒåŒ…å›´ç›’çš„ç¢°æ’æ£€æµ‹åŒ…å›´ç›’æœ‰å…­ä¸ªé¢ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠç›¸å¯¹çš„é¢åˆ’åˆ†æˆä¸€ç»„ä»è€Œå¾—åˆ°ä¸‰ç»„é¢ã€‚è®¡ç®—å°„çº¿ $\\vec{O} + t\\vec{D}$ ä¸è¿™ä¸‰ç»„é¢çš„äº¤ç‚¹åï¼Œæˆ‘ä»¬ä¼šå¾—åˆ° $[t{x, \\text{enter}}, t{x, \\text{exit}}],[t{y, \\text{enter}}, t{y, \\text{exit}}],[t{z, \\text{enter}}, t{z, \\text{exit}}]$ï¼Œä¹‹åè®¡ç®—ä¸‹é¢çš„äº¤é›†ï¼š [t_\\text{raymin},t_\\text{raymax}]\\cap[t_{x, \\text{enter}}, t_{x, \\text{exit}}]\\cap[t_{y, \\text{enter}}, t_{y, \\text{exit}}]\\cap[t_{z, \\text{enter}}, t_{z, \\text{exit}}]å¦‚æœäº¤é›†ä¸ºç©ºåˆ™æ— äº¤ç‚¹ï¼Œå¦åˆ™æœ‰äº¤ç‚¹ã€‚ ä¸ºäº†æ–¹ä¾¿è®¡ç®—ï¼ŒåŒ…å›´ç›’ä¸€èˆ¬æ˜¯ä¸åæ ‡è½´å¹³è¡Œçš„ã€‚","categories":[{"name":"å…¬å¼€è¯¾","slug":"å…¬å¼€è¯¾","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/"},{"name":"GAMES101","slug":"å…¬å¼€è¯¾/GAMES101","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/"},{"name":"Notes","slug":"å…¬å¼€è¯¾/GAMES101/Notes","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/Notes/"}],"tags":[]},{"title":"Assignment 6 Bounding Box","slug":"learning/open-course/GAMES101/Hw/Hw6-bounding-box","date":"2025-09-24T09:46:44.000Z","updated":"2025-09-24T12:56:28.461Z","comments":true,"path":"wiki/learning/open-course/GAMES101/Hw/Hw6-bounding-box/","permalink":"http://rinevard.github.io/wiki/learning/open-course/GAMES101/Hw/Hw6-bounding-box/","excerpt":"","text":"è¿™æ¬¡çš„ä½œä¸šè¦æ±‚å®ç°ç”¨åŒ…å›´ç›’æ¥åŠ å¿«å…‰çº¿è¿½è¸ªï¼Œå†ç”¨ BVH ä¼˜åŒ–ã€‚ é¦–å…ˆæˆ‘ä»¬è¦æŠŠ hw5 é‡Œçš„ä»£ç å¤åˆ¶è¿‡æ¥ï¼Œè®©æˆ‘ä¸è§£çš„æ˜¯ä»£ç é‡Œæ˜æ˜å·²ç»æä¾›äº† rayTriangleIntersect å‡½æ•°ï¼ŒPDF é‡Œå´è¿˜è¯´â€œå°†ä½ çš„å…‰çº¿-ä¸‰è§’å½¢ç›¸äº¤å‡½æ•°ç²˜è´´åˆ°æ­¤å¤„â€ï¼Œæ˜æ˜ç›´æ¥è°ƒç”¨å®ƒå°±å¥½äº†ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š inline Intersection Triangle::getIntersection(Ray ray) &#123; Intersection inter; float u, v, t; inter.happened = rayTriangleIntersect(v0, v1, v2, ray.origin, ray.direction, t, u, v); if (inter.happened) &#123; inter.coords = ray.origin + t * ray.direction; inter.normal = normal; inter.distance = t; inter.obj = this; inter.m = m; &#125; return inter; &#125; ç„¶åæˆ‘ä¹Ÿä¸å¤ªå–œæ¬¢ä»£ç æ¡†æ¶å¯¹ IntersectP çš„å®šä¹‰ï¼Œåœ¨æˆ‘çœ‹æ¥æ—¢ç„¶å¦å¤–ä¸¤ä¸ªå‚æ•°èƒ½é€šè¿‡ ray ç®—å‡ºæ¥ï¼Œå°±å®Œå…¨æ²¡æœ‰ç†ç”±ä½œä¸ºå‚æ•°ä¼ å…¥ã€‚ äºæ˜¯æˆ‘å°±æ”¹æˆäº†è¿™ä¸ªåªä¿ç•™ ray å‚æ•°çš„æ ·å­ï¼š inline bool Bounds3::IntersectP(const Ray&amp; ray) const &#123; // invDir: ray direction(x,y,z), invDir=(1.0/x,1.0/y,1.0/z), use this because Multiply is faster that Division auto tMinVec = (pMin - ray.origin) * ray.direction_inv; auto tMaxVec = (pMax - ray.origin) * ray.direction_inv; float tMinx = std::max(&#123;std::min(tMinVec.x, tMaxVec.x), static_cast&lt;float>(ray.t_min)&#125;); float tMiny = std::max(&#123;std::min(tMinVec.y, tMaxVec.y), static_cast&lt;float>(ray.t_min)&#125;); float tMinz = std::max(&#123;std::min(tMinVec.z, tMaxVec.z), static_cast&lt;float>(ray.t_min)&#125;); float tMaxx = std::min(&#123;std::max(tMinVec.x, tMaxVec.x), static_cast&lt;float>(ray.t_max)&#125;); float tMaxy = std::min(&#123;std::max(tMinVec.y, tMaxVec.y), static_cast&lt;float>(ray.t_max)&#125;); float tMaxz = std::min(&#123;std::max(tMinVec.z, tMaxVec.z), static_cast&lt;float>(ray.t_max)&#125;); float tMin = std::max(&#123;tMinx, tMiny, tMinz&#125;); float tMax = std::min(&#123;tMaxx, tMaxy, tMaxz&#125;); return (tMin &lt;= tMax); &#125; æ€è·¯å°±æ˜¯è®¡ç®—è¿™ä¸ªäº¤é›†ï¼š [t_\\text{raymin},t_\\text{raymax}]\\cap[t_{x, \\text{enter}}, t_{x, \\text{exit}}]\\cap[t_{y, \\text{enter}}, t_{y, \\text{exit}}]\\cap[t_{z, \\text{enter}}, t_{z, \\text{exit}}]å¯¹äºæœ€åçš„ getIntersectionï¼Œå° AI è¯´å¯ä»¥åœ¨å‘ç”Ÿç›¸äº¤æ—¶æ›´æ–° ray çš„ t_maxï¼Œç„¶ååœ¨å°„çº¿å’Œç›’å­çš„äº¤ç‚¹å¤§äº t_max æ—¶ä¸å†æ£€æµ‹ç›’å­å†…éƒ¨çš„ç›¸äº¤ï¼Œè¿™å¯ä»¥ä¼˜åŒ–æ€§èƒ½ã€‚æˆ‘è®¤ä¸ºä»–è¯´å¾—éå¸¸æœ‰é“ç†ï¼Œä½†æ”¹èµ·æ¥æœ‰ç‚¹éº»çƒ¦ï¼Œå°±ä¸æ”¹äº†ã€‚ Intersection BVHAccel::getIntersection(BVHBuildNode* node, const Ray&amp; ray) const &#123; if (!node->bounds.IntersectP(ray)) &#123; return Intersection(); &#125; // leaf node checks ray's intersection with obj if (node->left == nullptr &amp;&amp; node->right == nullptr) &#123; if (node->object == nullptr) &#123; return Intersection(); &#125; return node->object->getIntersection(ray); &#125; // parent with only one child returns child's intersection else if (node->left == nullptr) &#123; return getIntersection(node->right, ray); &#125; else if (node->right == nullptr) &#123; return getIntersection(node->left, ray); &#125; // parent with two children returns the closer intersection else &#123; Intersection inter1 = getIntersection(node->left, ray); Intersection inter2 = getIntersection(node->right, ray); if (!inter1.happened &amp;&amp; !inter2.happened) &#123; return Intersection(); &#125; else if (!inter1.happened) &#123; return inter2; &#125; else if (!inter2.happened) &#123; return inter1; &#125; return (inter1.distance &lt; inter2.distance) ? inter1 : inter2; &#125; &#125; å’±è¿˜æ˜¯åœ¨æœ€åæ”¾æ”¾å›¾å›¾","categories":[{"name":"å…¬å¼€è¯¾","slug":"å…¬å¼€è¯¾","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/"},{"name":"GAMES101","slug":"å…¬å¼€è¯¾/GAMES101","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/"},{"name":"Assignments","slug":"å…¬å¼€è¯¾/GAMES101/Assignments","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/Assignments/"}],"tags":[]},{"title":"Assignment 5 Raytracing","slug":"learning/open-course/GAMES101/Hw/Hw5-raytracing","date":"2025-09-22T11:46:16.000Z","updated":"2025-09-26T04:09:50.574Z","comments":true,"path":"wiki/learning/open-course/GAMES101/Hw/Hw5-raytracing/","permalink":"http://rinevard.github.io/wiki/learning/open-course/GAMES101/Hw/Hw5-raytracing/","excerpt":"","text":"å¦‚æœåªæ˜¯å®ç°è¦æ±‚çš„è¯ï¼Œæ„Ÿè§‰è¿™ä¼šæ˜¯å¾ˆæ— èŠçš„ä¸€æ¬¡ä½œä¸šã€‚ä¸ºäº†è®©äº‹æƒ…æœ‰è¶£ä¸€ç‚¹ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ castRay å‡½æ•°çš„å®ç°å§ã€‚æˆ‘ä»¬ä¼šæŠŠä½œä¸šä»£ç æ”¾åœ¨æ–‡æœ«ã€‚ castRay å‡½æ•°çš„åˆ†æcastRay å‡½æ•°å®ç°äº†è¯¾ä¸Šè®²çš„å…‰çº¿è¿½è¸ªï¼Œå®ƒä» orig æ‰“å‡ºæœç€ dir æ–¹å‘çš„å°„çº¿ï¼Œå¹¶è¿”å›é¢œè‰²ã€‚å…¶å·¥ä½œæµç¨‹å¦‚ä¸‹ï¼š é¦–å…ˆï¼Œæ£€æŸ¥å½“å‰çš„é€’å½’æ·±åº¦depthã€‚å½“depthè¶…è¿‡åœºæ™¯è®¾å®šçš„æœ€å¤§æ·±åº¦scene.maxDepthæ—¶ï¼Œå‡½æ•°è¿”å›é»‘è‰²ã€‚è¿™å°±æ˜¯å¼€å¤´çš„ä»£ç ï¼š if (depth > scene.maxDepth) &#123; return Vector3f(0.0,0.0,0.0); &#125; ç„¶åï¼Œè®¡ç®—å°„çº¿æ˜¯å¦ä¸åœºæ™¯ä¸­çš„ä»»ä½•ç‰©ä½“ç›¸äº¤ã€‚å¦‚æœæ²¡æœ‰å‘ç”Ÿç›¸äº¤ï¼Œè¯´æ˜å°„çº¿å°„å‘äº†åœºæ™¯çš„èƒŒæ™¯ï¼Œå‡½æ•°å°†è¿”å›èƒŒæ™¯é¢œè‰²ã€‚ å¦‚æœå°„çº¿å‡»ä¸­äº†æŸä¸ªç‰©ä½“ï¼Œå‡½æ•°å°†æ ¹æ®è¯¥ç‰©ä½“çš„æè´¨ç±»å‹ï¼Œè¿›å…¥ä¸åŒçš„å¤„ç†åˆ†æ”¯è®¡ç®—é¢œè‰²ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬ä¼šåˆ†æè¿™äº›åˆ†æ”¯ã€‚ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç‰©ä½“è¢«åˆ†ä¸ºäº†ä¸‰ç§æè´¨ï¼Œåˆ†åˆ«æ˜¯æ—¢æœ‰é•œé¢åå°„åˆæœ‰æŠ˜å°„çš„ REFLECTION_AND_REFRACTIONã€åªæœ‰åå°„çš„ REFLECTIONã€åªæœ‰æ¼«åå°„çš„ DIFFUSE_AND_GLOSSYã€‚REFLECTION_AND_REFRACTION å’Œ REFLECTION éƒ¨åˆ†çš„ä»£ç æ¯”è¾ƒç›¸ä¼¼ï¼Œæˆ‘ä»¬å°±å…ˆè®¨è®º REFLECTION_AND_REFRACTION çš„ä»£ç ï¼Œå†è®¨è®º DIFFUSE_AND_GLOSSY çš„ä»£ç ã€‚ REFLECTION_AND_REFRACTIONè¿™é‡Œçš„åå°„/æŠ˜å°„æè´¨è‡ªèº«æ˜¯æ²¡æœ‰é¢œè‰²çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒä»¬åªæ˜¾ç¤ºåå°„/æŠ˜å°„åå°„çº¿æ‰“åˆ°çš„ç‚¹çš„é¢œè‰²ã€‚æ‰€ä»¥ä»£ç æ€è·¯æ¯”è¾ƒç®€å•ï¼Œå¦‚æœå°„çº¿æ‰“åˆ°äº†è¿™ç§æè´¨çš„ç‰©ä½“ä¸Šï¼Œå®ƒä¼šåå°„/æŠ˜å°„ï¼Œæˆ‘ä»¬éœ€è¦è®¡ç®—å‡ºåå°„/æŠ˜å°„åçš„å°„çº¿æ‰“åˆ°çš„é¢œè‰²ï¼Œè¿™å°±å¯¹åº”ç€ä¸‹é¢çš„ä»£ç ï¼š Vector3f reflectionColor = castRay(reflectionRayOrig, reflectionDirection, scene, depth + 1); Vector3f refractionColor = castRay(refractionRayOrig, refractionDirection, scene, depth + 1); ä»£ç é‡Œè¿˜è€ƒè™‘äº†è²æ¶…å°”æ•ˆåº”æ¥è®¡ç®—åå°„å’ŒæŠ˜å°„çš„æ¯”ä¾‹ã€‚è²æ¶…å°”æ•ˆåº”çš„å…¬å¼æœ‰ç‚¹å¤æ‚ï¼Œæˆ‘ä»¬å°±ä¸è®²è§£äº†ã€‚è¿™é‡Œçš„ kr å°±æ˜¯è²æ¶…å°”æ–¹ç¨‹ç®—å‡ºçš„åå°„ç³»æ•°ï¼Œè€Œç”±èƒ½é‡å®ˆæ’ï¼ŒæŠ˜å°„ç³»æ•°å°±æ˜¯ $1-\\text{kr}$ã€‚ hitColor å°±æ˜¯è¿™ä¸ªç‚¹çš„æœ€ç»ˆé¢œè‰²ï¼š float kr = fresnel(dir, N, payload->hit_obj->ior); hitColor = reflectionColor * kr + refractionColor * (1 - kr); æˆ‘ä»¬ä¹Ÿä¼šæ³¨æ„åˆ°ï¼Œä»£ç åœ¨å¼€å¤´å¯¹åå°„/æŠ˜å°„ç‚¹åšäº†ä¸€ä¸ªå°å°çš„åç§»ï¼Œè¿™ä¼¼ä¹æ˜¯ä¸ºäº†é¿å…åå°„/æŠ˜å°„æ—¶ç«‹å³æ‰“åˆ°è‡ªå·±ï¼ˆå’±ä¹Ÿä¸ç¡®å®šï¼Œè¿™æ˜¯çŒœæµ‹ï¼‰ Vector3f reflectionRayOrig = (dotProduct(reflectionDirection, N) &lt; 0) ? hitPoint - N * scene.epsilon : hitPoint + N * scene.epsilon; æˆ‘ä»¬éƒ½çœ‹åˆ°è²æ¶…å°”æ•ˆåº”çš„ä»£ç äº†ï¼Œä¸å¦‚å†çœ‹çœ‹çº¯åå°„/çº¯æŠ˜å°„çš„çƒæ˜¯æ€æ ·çš„ã€‚æ³¨æ„é è¿‘æˆ‘ä»¬è§‚å¯Ÿè€…çš„çƒï¼Œæˆ‘ä»¬å¯ä»¥å…ˆæŠŠ kr è®¾ä¸º 1 æ¥çœ‹çœ‹çº¯åå°„çš„ç»“æœï¼š å†æ¥çœ‹çœ‹çº¯æŠ˜å°„çš„ç»“æœï¼š ä¸æ–‡æœ«çš„å›¾æ¯”è¾ƒä¸€ä¸‹ï¼Œå°±ä¼šå‘ç°è²æ¶…å°”æ•ˆåº”ç¡®å®å°±æ˜¯åå°„å’ŒæŠ˜å°„çš„å åŠ ã€‚ DIFFUSE_AND_GLOSSYå†æ¥çœ‹çœ‹ DIFFUSE_AND_GLOSSY éƒ¨åˆ†ï¼Œè¿™é‡Œæ˜¯æ­£å¸¸çš„ Phong æ¨¡å‹ç€è‰²ã€‚å”¯ä¸€è¦æ³¨æ„çš„æ˜¯ï¼Œè¦åˆ¤æ–­å°„çº¿æ‰“åˆ°çš„ç‚¹å’Œå…‰æºä¹‹é—´æœ‰æ²¡æœ‰ç‰©ä½“é®æŒ¡ï¼Œå¦‚æœæœ‰é®æŒ¡è¿™é‡Œå°±æ˜¯é˜´å½±ã€‚ æˆ‘è®¤ä¸ºè¿™ä¸€éƒ¨åˆ†çš„ä»£ç æœ‰é—®é¢˜ï¼Œå®ƒåªè€ƒè™‘äº†æ¼«åå°„åˆ†é‡åœ¨ä¸åœ¨é˜´å½±é‡Œï¼Œè€Œæ²¡è€ƒè™‘é•œé¢åå°„åˆ†é‡ã€‚è¿™é‡Œæ˜¯åŸæœ¬çš„ä»£ç ï¼š // æ¼«åå°„ lightAmt += inShadow ? 0 : light->intensity * LdotN; // é•œé¢åå°„ Vector3f reflectionDirection = reflect(-lightDir, N); specularColor += powf(std::max(0.f, -dotProduct(reflectionDirection, dir)), payload->hit_obj->specularExponent) * light->intensity; æˆ‘æƒ³æˆ‘ä»¬åº”è¯¥åšè¿™æ ·çš„ä¿®æ”¹ï¼š if (!inShadow) &#123; // æ¼«åå°„ lightAmt += light->intensity * LdotN; // é•œé¢åå°„ Vector3f reflectionDirection = reflect(-lightDir, N); specularColor += powf(std::max(0.f, -dotProduct(reflectionDirection, dir)), payload->hit_obj->specularExponent) * light->intensity; &#125; ä½œä¸šä»£ç æ¥ä¸‹æ¥å’±å°±ç›´æ¥æ”¾ä½œä¸šä»£ç äº†ã€‚ é¦–å…ˆæ˜¯ rayTriangleIntersectï¼š bool rayTriangleIntersect(const Vector3f&amp; v0, const Vector3f&amp; v1, const Vector3f&amp; v2, const Vector3f&amp; orig, const Vector3f&amp; dir, float&amp; tNear, float&amp; u, float&amp; v) &#123; auto e1 = v1 - v0; auto e2 = v2 - v0; auto s = orig - v0; auto s1 = crossProduct(dir, e2); auto s2 = crossProduct(s, e1); auto coefficient = 1.0 / dotProduct(s1, e1); tNear = coefficient * dotProduct(s2, e2); u = coefficient * dotProduct(s1, s); v = coefficient * dotProduct(s2, dir); return (tNear >= 0) &amp;&amp; (u >= 0) &amp;&amp; (v >= 0) &amp;&amp; ((1 - u - v) >= 0); &#125; ç„¶åæ˜¯ Render çš„éƒ¨åˆ†ï¼š for (int i = 0; i &lt; scene.width; ++i) &#123; // generate primary ray direction float x; float y; // I don't understand what are the guiding comments talking about. // Anyway, the code is assuming the distance between eye and screen is one, since abs(dir.z) == 1 // With this assumption we can compute screen's width and height // Then we map x from [0, scene.width - 1] to [-screen_width / 2, screenwidth / 2] // and map y from [0, scene.height - 1] to [screen_height / 2, -screen_height / 2] float screen_height = 2 * scale; float screen_width = imageAspectRatio * screen_height; x = (screen_width / (scene.width - 1)) * (i + 0.5) - (screen_width / 2.0); y = (-screen_height / (scene.height - 1)) * (j + 0.5) + (screen_height / 2.0); Vector3f dir = normalize(Vector3f(x, y, -1)); // Don't forget to normalize this direction! framebuffer[m++] = castRay(eye_pos, dir, scene, 0); &#125; çœ‹çœ‹ç»“æœå§ï¼å¦‚æœå’Œå‰é¢çš„çº¯åå°„/çº¯æŠ˜å°„å¯¹ç…§ï¼Œä¼šå‘ç°å‰é¢çš„çƒç¡®å®å°±æ˜¯åå°„å’ŒæŠ˜å°„çš„å åŠ ï¼ˆåå°„å¾ˆæ·¡ï¼Œä¸è¿‡ä»”ç»†çœ‹ä¹Ÿæ˜¯èƒ½çœ‹å‡ºæ¥çš„ï¼ï¼‰","categories":[{"name":"å…¬å¼€è¯¾","slug":"å…¬å¼€è¯¾","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/"},{"name":"GAMES101","slug":"å…¬å¼€è¯¾/GAMES101","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/"},{"name":"Assignments","slug":"å…¬å¼€è¯¾/GAMES101/Assignments","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/Assignments/"}],"tags":[]},{"title":"Assignment 4 Geometry","slug":"learning/open-course/GAMES101/Hw/Hw4-geometry","date":"2025-09-22T11:44:16.000Z","updated":"2025-09-22T11:44:41.718Z","comments":true,"path":"wiki/learning/open-course/GAMES101/Hw/Hw4-geometry/","permalink":"http://rinevard.github.io/wiki/learning/open-course/GAMES101/Hw/Hw4-geometry/","excerpt":"","text":"è¿™æ¬¡ä½œä¸šè¿‡äºç®€å•ï¼Œæˆ‘ä»¬ç›´æ¥æ”¾ä»£ç ã€‚ cv::Point2f recursive_bezier(const std::vector&lt;cv::Point2f> &amp;control_points, float t) &#123; // TODO: Implement de Casteljau's algorithm if (control_points.size() == 2) &#123; return ((1 - t) * control_points[0] + t * control_points[1]); &#125; std::vector&lt;cv::Point2f> new_control_points = &#123;&#125;; for (int i = 0; i &lt; control_points.size() - 1; i++) &#123; new_control_points.push_back((1 - t) * control_points[i] + t * control_points[i + 1]); &#125; return recursive_bezier(new_control_points, t); &#125; void bezier(const std::vector&lt;cv::Point2f> &amp;control_points, cv::Mat &amp;window) &#123; // TODO: Iterate through all t = 0 to t = 1 with small steps, and call de Casteljau's // recursive Bezier algorithm. float step = 0.001; for (float t = 0; t &lt;= 1; t += step ) &#123; auto point = recursive_bezier(control_points, t); window.at&lt;cv::Vec3b>(point.y, point.x)[1] = 255; &#125; &#125; å¦å¤–ï¼Œç”±äºå’±ä»¥å‰åœ¨ Godot é‡Œå¯¼å…¥å­—ä½“æ—¶è§è¿‡å¤šé€šé“ç¬¦å·è·ç¦»åœºçš„è®¾ç½®ï¼Œè€Œä¸”å‘ç°å¼€å¯å¤šé€šé“ç¬¦å·è·ç¦»åœºçš„å­—ä½“æ˜¾ç¤ºæ¸…æ™°äº†ä¸€å¤§æˆªï¼Œæ‰€ä»¥æˆ‘æ‰¾äº†æ‰¾ä¸€äº›å…³äº SDF çš„èµ„æ–™ï¼Œæ„Ÿè§‰è¿™ä¸ªä¸é”™ï¼šåŠ¨æ€ SDF å­—ä½“æ¸²æŸ“æ–¹æ³• | åä¸‰","categories":[{"name":"å…¬å¼€è¯¾","slug":"å…¬å¼€è¯¾","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/"},{"name":"GAMES101","slug":"å…¬å¼€è¯¾/GAMES101","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/"},{"name":"Assignments","slug":"å…¬å¼€è¯¾/GAMES101/Assignments","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/Assignments/"}],"tags":[]},{"title":"Note 4 Geometry","slug":"learning/open-course/GAMES101/Notes/Note4-Geometry","date":"2025-09-19T12:10:28.000Z","updated":"2025-09-19T12:13:54.595Z","comments":true,"path":"wiki/learning/open-course/GAMES101/Notes/Note4-Geometry/","permalink":"http://rinevard.github.io/wiki/learning/open-course/GAMES101/Notes/Note4-Geometry/","excerpt":"","text":"è¯¾ä¸Šåªæ˜¯ç®€å•æäº†ä¸‹å‡ ä½•ä¸“é¢˜ï¼Œæˆ‘ä¹Ÿè®¤ä¸ºè¿™ä¸ªä¸“é¢˜ç›¸è¾ƒäºåˆ«çš„å‡ ä¸ªæ²¡é‚£ä¹ˆé‡è¦ï¼Œæ‰€ä»¥åªæ˜¯è®°ä¸€ä¸‹éšå¼è¡¨ç¤ºå’Œå‚æ•°è¡¨ç¤ºçš„ç›¸å…³å†…å®¹ï¼Œå†ç®€å•æä¸€å¥ç½‘æ ¼å¤„ç†ã€‚ éšå¼è¡¨ç¤ºå’Œå‚æ•°è¡¨ç¤ºå¯¹ä¸€ä¸ªå‡ ä½•å›¾å½¢ï¼Œæˆ‘ä»¬ä¸€èˆ¬æœ‰ä¸¤ç§è¡¨ç¤ºæ–¹æ³•ï¼Œä¸€ç§æ˜¯ç”¨æ™®é€šæ–¹ç¨‹ $f(x,y,z)=0$ æ¥è¡¨ç¤ºï¼Œå¦ä¸€ç§æ˜¯ç”¨å‚æ•°æ–¹ç¨‹ $g(u,v)=(x,y,z)$ æ¥è¡¨ç¤ºã€‚å‰è€…æ˜¯éšå¼è¡¨ç¤ºï¼Œå› ä¸ºä¸èƒ½æ–¹ä¾¿åœ°æ±‚å‡ºè¿™ä¸ªæ–¹ç¨‹è¡¨ç¤ºçš„æ‰€æœ‰ç‚¹ï¼›åè€…æ˜¯å‚æ•°è¡¨ç¤ºï¼Œé€šè¿‡å‚æ•° $(u,v)$ çš„å˜åŒ–å¯ä»¥è½»æ˜“æ±‚å‡ºè¿™ä¸ªæ–¹ç¨‹è¡¨ç¤ºçš„æ‰€æœ‰ç‚¹ã€‚ ä¸è¿‡éšå¼è¡¨ç¤ºä¹Ÿæœ‰ä¼˜ç‚¹ï¼Œå®ƒèƒ½å¾ˆæ–¹ä¾¿åœ°åˆ¤æ–­ä¸€ä¸ªç‚¹ $(x,y,z)$ æ˜¯å¦åœ¨æ›²çº¿ä¸Š / æ›²çº¿å†… / æ›²çº¿å¤–ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹éšå¼è¡¨ç¤ºå’Œå‚æ•°è¡¨ç¤ºçš„ä»£è¡¨åº”ç”¨ã€‚ éšå¼è¡¨ç¤ºï¼šç¬¦å·è·ç¦»åœºç¬¦å·è·ç¦»åœºï¼ˆSigned Distance Filed, SDFï¼‰æ˜¯éšå¼è¡¨ç¤ºçš„ä»£è¡¨åº”ç”¨ä¹‹ä¸€ï¼Œè‡ª 2007 å¹´ Valve çš„è®ºæ–‡ä»¥æ¥ï¼Œå®ƒä¸€ç›´è¢«ç”¨äºæ¸¸æˆå†…çš„æ–‡æœ¬æ¸²æŸ“ã€‚è™½ç„¶ç°åœ¨ç”¨çš„æ›´å¤šæ˜¯å¤šé€šé“ç¬¦å·è·ç¦»åœºï¼ˆMSDFï¼‰ï¼Œä½†æˆ‘ä»¬è¿™é‡Œåªç®€å•ä»‹ç»ä¸‹ç¬¦å·è·ç¦»åœºï¼Œå› ä¸ºåè€…æ›´åŠ å¤æ‚ã€‚ ç¬¦å·è·ç¦»åœºå°±æ˜¯å¸¦ç¬¦å·çš„è·ç¦»åœºï¼Œå¯¹ç»™å®šçš„ç‚¹ $(u,v)$ï¼Œæˆ‘ä»¬è®°å½•å®ƒåˆ°å›¾å½¢çš„æœ€è¿‘è·ç¦»â€”â€”å¦‚æœå®ƒåœ¨å›¾å½¢å†…éƒ¨ï¼ˆå›¾å½¢çš„çº¿æ¡æ˜¯æœ‰å®½åº¦çš„ï¼Œè¿™ä¸ªå†…éƒ¨æŒ‡åœ¨çº¿æ¡å†…è€Œéå‡ ä½•é—­ç¯å†…ï¼‰ï¼Œè·ç¦»ä¸ºæ­£å€¼ï¼Œå¦åˆ™ä¸ºè´Ÿå€¼ã€‚ åœ¨ V ç¤¾çš„è®ºæ–‡ä¸­ï¼Œä»–ä»¬å…ˆå¯¹çŸ¢é‡æ–‡å­—åšäº†å…‰æ …åŒ–å¾—åˆ°äº† $4096\\times 4096$ çš„å›¾åƒï¼Œç„¶ååŸºäºè¿™å¼ å›¾å¾—åˆ°äº† $64\\times 64$ çš„ç¬¦å·è·ç¦»åœºã€‚ ä¸‹å›¾å±•ç¤ºäº†åŸå›¾å’Œç¬¦å·è·ç¦»åœºã€‚å›¾åƒä¸é€æ˜åº¦æ˜¯åœ¨ $[0,1]$ é—´çš„éè´Ÿæ•°ï¼Œä¸ºäº†å¯è§†åŒ–ç¬¦å·è·ç¦»åœºï¼Œæˆ‘ä»¬æŠŠè·ç¦»ä¸ºæ­£çš„å†…éƒ¨æ˜ å°„åˆ° $(0.5, 1]$ï¼Œè·ç¦»ä¸º $0$ çš„è¾¹ç¼˜è¢«æ˜ å°„åˆ° $0.5$ï¼Œè·ç¦»ä¸ºè´Ÿçš„å¤–éƒ¨æ˜ å°„åˆ° $[0, 0.5)$. å¾—åˆ°äº†ç¬¦å·è·ç¦»åœºä¹‹åï¼Œæˆ‘ä»¬å°±èƒ½å¯¹ä»»ä½•ä¸€ä¸ªç‚¹æ’å€¼å‡ºå®ƒä¸å›¾å½¢çš„è·ç¦»ï¼Œç„¶åæ ¹æ®è¿™ä¸ªè·ç¦»å†³å®šå®ƒæ˜¯å¦æ˜¾ç¤ºå‡ºæ¥ã€‚æˆ‘ä»¬ä¹‹å‰å·²ç»æè¿‡äº†è·ç¦»åˆ°ä¸é€æ˜åº¦çš„æ˜ å°„ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•è®¾ç½®ä¸€ä¸ªé˜ˆå€¼æ¥å†³å®šæ˜¯å¦æ˜¾ç¤ºæŸä¸ªåƒç´ ï¼š baseColor.a = distAlphaMask >= 0.5; æˆ‘ä¸ªäººçš„æ€è€ƒæ˜¯ï¼Œä¸è¦å› ä¸ºæˆ‘ä»¬å¯è§†åŒ–äº†ç¬¦å·è·ç¦»åœºå°±æŠŠå®ƒå½“ä½œå›¾åƒã€‚å®ƒæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªè·ç¦»å‡½æ•° $d(u,v)$ï¼Œæˆ‘ä»¬çš„ $64\\times 64$ çš„ SDF å›¾åƒçš„æ¯ä¸ªåƒç´ è¡¨ç¤ºçš„ä¸æ˜¯â€œå¹³å‡é¢œè‰²â€ï¼Œè€Œæ˜¯â€œåƒç´ ä¸­å¿ƒç‚¹åˆ°å›¾å½¢çš„è·ç¦»â€ã€‚è¦æŠŠå®ƒçœ‹ä½œç‚¹ï¼Œè€Œéæ–¹å—ã€‚ å‚æ•°è¡¨ç¤ºï¼šè´å¡å°”æ›²çº¿å’Œæ›²é¢è´å¡å°”æ›²çº¿å’Œæ›²é¢æ˜¯å‚æ•°è¡¨ç¤ºçš„å¾ˆå¥½ä¾‹å­ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹è®¡ç®—è´å¡å°”æ›²çº¿çš„å¸¸ç”¨ç®—æ³•å’Œä¸€èˆ¬å…¬å¼ã€‚ è´å¡å°”æ›²çº¿å¸¸ç”¨çš„ç”Ÿæˆè´å¡å°”æ›²çº¿çš„ Casteljau Algorithm å¦‚ä¸‹ï¼Œæˆ‘ä»¬ä»¥å››ä¸ªç‚¹æ±‚ä¸‰é˜¶è´å¡å°”æ›²çº¿ä¸ºä¾‹ï¼š def bezier(t: float): # ç¬¬ä¸€å±‚çº¿æ€§æ’å€¼ p0_1 = (1 - t) * p0 + t * p1 p1_1 = (1 - t) * p1 + t * p2 p2_1 = (1 - t) * p2 + t * p3 # ç¬¬äºŒå±‚çº¿æ€§æ’å€¼ p0_2 = (1 - t) * p0_1 + t * p1_1 p1_2 = (1 - t) * p1_1 + t * p2_1 # ç¬¬ä¸‰å±‚ï¼ˆæœ€åä¸€å±‚ï¼‰çº¿æ€§æ’å€¼ p_final = (1 - t) * p0_2 + t * p1_2 return p_final çœ‹çœ‹è¿™ä¸ªç®—æ³•ä¹Ÿå°±çŸ¥é“è´å¡å°”æ›²çº¿æ˜¯æ€ä¹ˆæ¥çš„äº†ã€‚ ä¸‰é˜¶å…¬å¼æ˜¯ \\mathbf{B}(t) = (1-t)^3 \\mathbf{P}_0 + 3(1-t)^2 t \\mathbf{P}_1 + 3(1-t) t^2 \\mathbf{P}_2 + t^3 \\mathbf{P}_3ä¸€èˆ¬çš„ $n$ é˜¶å…¬å¼æ˜¯ \\mathbf{B}(t) = \\sum_{i=0}^{m} \\binom{m}{i} (1-t)^{m-i} t^i \\mathbf{P}_iä¸‹å›¾ä¸­ï¼Œå·¦å›¾æ˜¯ Godot é‡Œçš„ Curveï¼Œå®ƒå°±ç”¨åˆ°äº†è´å¡å°”æ›²çº¿ï¼›å³å›¾è´å¡å°”æ›²çº¿çš„ç”Ÿæˆæ–¹æ³•ï¼Œå’Œä¸Šé¢æåˆ°çš„ Casteljau Algorithm ä¸€è‡´ã€‚ å†çœ‹çœ‹å·¦å›¾ï¼Œæˆ‘ä»¬ä¼šå‘ç°å®ƒæ˜¯ç”±ä¸‰ä¸ªè´å¡å°”æ›²çº¿æ‹¼æ¥è€Œæˆçš„ï¼Œè€Œä¸”çœ‹èµ·æ¥å¾ˆå¹³æ»‘ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„â€œåˆ†æ®µè´å¡å°”æ›²çº¿â€ã€‚é«˜é˜¶è´å¡å°”æ›²çº¿ä¸å®¹æ˜“æ§åˆ¶ï¼Œæ‰€ä»¥æˆ‘ä»¬æ›´å€¾å‘äºæŠŠå‡ ä¸ªä½é˜¶è´å¡å°”æ›²çº¿æ‹¼æ¥èµ·æ¥å½¢æˆå¤æ‚æ›²çº¿ã€‚ è´å¡å°”æ›²é¢æˆ‘ä»¬åŒæ ·ç”¨ Casteljau Algorithm ç”Ÿæˆè´å¡å°”æ›²é¢ï¼š def _de_casteljau_1d(points, t): \"\"\"å¯¹ä¸€ç»´ç‚¹åºåˆ—æ‰§è¡Œ Casteljau ç®—æ³•ã€‚\"\"\" while len(points) > 1: points = [(1 - t) * p1 + t * p2 for p1, p2 in zip(points, points[1:])] return points[0] def bezier_surface(control_points, u, v): \"\"\"è®¡ç®—è´å¡å°”æ›²é¢ä¸Šçš„ä¸€ç‚¹ã€‚\"\"\" intermediate_points = [_de_casteljau_1d(row, u) for row in control_points] final_point = _de_casteljau_1d(intermediate_points, v) return final_point å¦‚ä¸‹å›¾ä¸­çš„å³å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬æœ¬è´¨ä¸Šæ˜¯å…ˆæ²¿ç€ä¸€ä¸ªè½´å‘ç”Ÿæˆä¸€ç»„è´å¡å°”æ›²çº¿ï¼Œå†åœ¨æ›²çº¿ä¸Šå–å€¼ç”Ÿæˆä¸€ç»„æ–°çš„æ§åˆ¶ç‚¹ï¼Œç„¶åç”¨è¿™ç»„æ–°æ§åˆ¶ç‚¹å®šä¹‰ä¸€æ¡æ–°çš„æ›²çº¿ï¼Œæœ€ååœ¨æ–°çš„æ›²çº¿ä¸Šå–å€¼å¾—åˆ°æ›²é¢ä¸Šçš„æœ€ç»ˆç‚¹ã€‚ ç½‘æ ¼å¤„ç†ç”Ÿæˆä¸‰è§’å½¢ç½‘æ ¼åï¼Œæˆ‘ä»¬ç»å¸¸è¿˜å¸Œæœ›åšä¸€äº›å¤„ç†ï¼Œæ¯”å¦‚ç»†åˆ†æ¥è®©æ¨¡å‹æ›´å…‰æ»‘ï¼›å‡å°‘ä¸‰è§’å½¢æ•°é‡æ¥ç®€åŒ–ç½‘æ ¼ã€‚ä¸‹é¢ç®€å•æä¸€ä¸‹ç½‘æ ¼ç»†åˆ†å’Œç½‘æ ¼ç®€åŒ–çš„å¸¸ç”¨ç®—æ³•ã€‚ ç½‘æ ¼ç»†åˆ†ç½‘æ ¼ç»†åˆ†ç®—æ³•çš„ç»å¯¹ä¸»æµæ˜¯ Catmull-Clark ç»†åˆ†ï¼ŒBlender çš„è¡¨é¢ç»†åˆ†ä¿®æ”¹å™¨çš„é»˜è®¤ç®—æ³•å°±æ˜¯è¿™ä¸ªã€‚å®ƒå¯ä»¥ç»†åˆ†ä»»æ„å½¢çŠ¶çš„å¤šè¾¹å½¢ï¼Œä½†åœ¨ç»†åˆ†å››è¾¹å½¢æ—¶æ•ˆæœæœ€å¥½ã€‚ è¯¾ä¸Šè¿˜æåˆ°äº†ç”¨äºç»†åˆ†ä¸‰è§’å½¢çš„ Loop ç»†åˆ†ï¼Œä¸è¿‡ä¸¤ä¸ªç»†åˆ†éƒ½åªæ˜¯ç®€å•æäº†ææ¦‚å¿µï¼Œæˆ‘ä»¬è¿™é‡Œä¸å¤šè®°ç¬”è®°ã€‚ ç½‘æ ¼ç®€åŒ–ç½‘æ ¼ç®€åŒ–çš„åŸºæœ¬æ€è·¯æ˜¯æ¯æ¬¡æŠŠä¸€æ¡è¾¹åç¼©æˆä¸€ä¸ªç‚¹ã€‚æˆ‘ä»¬ç”¨äºŒæ¬¡è¯¯å·®è¡¡é‡æ¯æ¡è¾¹åç¼©åå¼•å…¥çš„è¯¯å·®ï¼Œç„¶åé€‰æ‹©æœ€å°çš„è¾¹æ¥åç¼©ï¼Œä¹‹åé‡æ–°è®¡ç®—äºŒæ¬¡è¯¯å·®ï¼ˆå› ä¸ºåç¼©åå½¢çŠ¶ä¼šæ”¹å˜ï¼‰ï¼Œç„¶åå†æ¬¡é€‰æ‹©æœ€å°çš„è¾¹ï¼Œå¦‚æ­¤é‡å¤ã€‚è¿™æ˜¯ä¸ªè´ªå©ªç®—æ³•ï¼Œä½†èƒ½æ‹¿åˆ°ä¸é”™çš„ç»“æœã€‚ å…·ä½“å…¬å¼æˆ‘ä»¬ä¹Ÿä¸å†™ï¼Œå› ä¸ºè¯¾ä¸Šæ²¡è¯¦ç»†è®²ï¼Œæˆ‘ä¹Ÿä¸æ„Ÿå…´è¶£ï¼Œç”¨åˆ°çš„æ—¶å€™å»æŸ¥æŸ¥å°±å¥½äº†ã€‚","categories":[{"name":"å…¬å¼€è¯¾","slug":"å…¬å¼€è¯¾","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/"},{"name":"GAMES101","slug":"å…¬å¼€è¯¾/GAMES101","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/"},{"name":"Notes","slug":"å…¬å¼€è¯¾/GAMES101/Notes","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/Notes/"}],"tags":[]},{"title":"Note 3 Shading","slug":"learning/open-course/GAMES101/Notes/Note3-Shading","date":"2025-09-17T04:10:28.000Z","updated":"2025-09-17T04:03:13.842Z","comments":true,"path":"wiki/learning/open-course/GAMES101/Notes/Note3-Shading/","permalink":"http://rinevard.github.io/wiki/learning/open-course/GAMES101/Notes/Note3-Shading/","excerpt":"","text":"×™Ö°×”Ö´×™ ××•Ö¹×¨èµ·åˆï¼Œè®¡ç®—æœºçš„ä¸–ç•Œå°šæœªæ¸²æŸ“ï¼Œæ˜¾ç¤ºå™¨ä¸­ç©ºè™šæ··æ²Œï¼Œæ¸Šé¢é»‘æš—ã€‚ å”¯æœ‰é¡¶ç‚¹ä¸å¤šè¾¹å½¢æ‚¬äºè™šç©ºï¼Œä¸è§å…¶å½¢ï¼Œä¸è¾¨å…¶è‰²ã€‚ é‚£å£°éŸ³è¯´ï¼šâ€œè¦æœ‰å…‰ã€‚â€ å°±æœ‰äº†å…‰ã€‚ å…‰æ˜¯å¥½çš„ï¼Œäºæ˜¯é‚£å£°éŸ³å°†å…‰ä¸æš—åˆ†å¼€äº†ã€‚å…‰æ‰€ç…§ä¹‹å¤„ï¼Œç‰©ä½“çš„æ­£é¢å¾—ä»¥æ˜¾ç°ï¼›å…‰æ‰€ä¸è‡³çš„èƒŒé¢ï¼Œåˆ™å½’äºé˜´å½±ã€‚ä»æ­¤ï¼Œä¸‰ç»´çš„ä¸–ç•Œæœ‰äº†æ˜æš—ä¸å±‚æ¬¡ã€‚ è¿™å…‰å¹¶éä¸€ä½“ã€‚ é‚£æ™®ç…§ä¸‡ç‰©ï¼Œå‡åŒ€æ•£å¼€ï¼Œä½¿ç‰©ä½“æ˜¾å…¶æœ¬è‰²çš„ï¼Œç§°ä¹‹ä¸ºæ¼«åå°„ã€‚ é‚£æ±‡äºä¸€ç‚¹ï¼Œé”åˆ©å¤ºç›®ï¼Œä½¿å…‰æ»‘ä¹‹ç‰©å°½æ˜¾å…¶è€€çš„ï¼Œç§°ä¹‹ä¸ºé•œé¢åå°„ã€‚ é‚£å¼¥æ¼«äºç¯å¢ƒï¼Œå……ç›ˆäºé˜´å½±ï¼Œä½¿é»‘æš—ä¸è‡³å®Œå…¨åå™¬ä¸€åˆ‡çš„ï¼Œç§°ä¹‹ä¸ºç¯å¢ƒå…‰ã€‚ æœ‰æ¼«åå°„ï¼Œæœ‰é•œé¢åå°„ï¼Œæœ‰ç¯å¢ƒå…‰ï¼Œå…±åŒæ„æˆäº†è¿™è™šæ‹Ÿä¸–ç•Œçš„ç¬¬ä¸€ä¸ªç™½æ˜¼ã€‚ æ¼«åå°„ï¼ˆDiffuse Reflectionï¼‰åœ¨æ¼«åå°„ä¸­ï¼Œå…‰å‘å››é¢å…«æ–¹æ•£å»ï¼Œæ‰€ä»¥ç‰©ä½“æ¼«åå°„å‡ºçš„å…‰ä¸æ‘„åƒæœºä½ç½®æ— å…³ï¼Œè€Œä»…ä¸ä»¥ä¸‹å‡ é¡¹æœ‰å…³ï¼š å…‰å¼º $c_l$. ç‰©ä½“æè´¨ $c_r$. ä¸åŒç‰©ä½“å¯¹å…‰çš„åå°„ç‡æ˜¯ä¸åŒçš„ï¼Œå³ä½¿æ˜¯åŒä¸€ä¸ªç‰©ä½“ä¹Ÿå¯¹ä¸åŒé¢œè‰²çš„å…‰æœ‰ä¸åŒåå°„ç‡ã€‚ ç‰©ä½“è¡¨é¢æ³•çº¿ $\\mathbf{n}$. å…‰æºæ–¹å‘ $\\mathbf{l}$. æœ€ç»ˆç»“æœå¯ä»¥å†™æˆ L_d = c_r c_l \\max (0, \\mathbf{n} \\cdot \\mathbf{l})ç”±äºå…‰å¼ºä¸€èˆ¬éšè·ç¦»è¡°å‡ï¼Œæ‰€ä»¥ $c_l$ ä¸€èˆ¬åæ¯”äºè·ç¦»çš„å¹³æ–¹ $r^2$. é•œé¢åå°„ï¼ˆSpecular Reflectionï¼‰é•œé¢åå°„ä¸­ï¼Œå…‰ä¸»è¦å‘ä¸€ä¸ªæ–¹å‘åå°„ï¼Œæ‰€ä»¥é•œé¢åå°„çš„å…‰ä¸æ‘„åƒæœºä½ç½®æœ‰å…³ã€‚ L_s = c_pc_l\\max(0, \\mathbf n \\cdot \\mathbf h)^på…¶ä¸­ $c_p$ æ˜¯è‡ªå®šä¹‰çš„ RGB å€¼ï¼Œå…è®¸æˆ‘ä»¬æ§åˆ¶é«˜å…‰é¢œè‰²ï¼ŒæŒ‡æ•° $p$ æ˜¯ä¸ºäº†ä¿è¯æˆ‘ä»¬åªåœ¨å°èŒƒå›´å†…çœ‹åˆ°é«˜å…‰ï¼Œ$p$ è¶Šå¤§è¿™ä¸ªé«˜å…‰å¯è§èŒƒå›´è¶Šå°ï¼Œè€Œ $\\mathbf h$ çš„å®šä¹‰å¦‚ä¸‹ï¼š \\mathbf h = (\\mathbf e + \\mathbf l).\\text{normalized()}è¿˜æœ‰ä¸€ç§å†™æ³•æŠŠ $\\mathbf n \\cdot \\mathbf h$ æ¢æˆäº† $\\mathbf r \\cdot \\mathbf e$ï¼Œç®€å•è®¡ç®—å¯ä»¥å‘ç° $\\mathbfn$ å’Œ $\\mathbf h$ çš„å¤¹è§’æ˜¯ $\\mathbf r$ å’Œ $\\mathbf e$ çš„å¤¹è§’çš„ä¸€åŠï¼Œæ‰€ä»¥è¿™ä¸¤ä¸ªå†™æ³•åœ¨æ€è·¯ä¸Šæ˜¯ä¸€æ ·çš„ï¼Œéƒ½åœ¨è€ƒè™‘åå°„å…‰æ–¹å‘å’Œæ‘„åƒæœºæ–¹å‘çš„å¤¹è§’ï¼Œä¸è¿‡åœ¨æ•°å€¼ä¸Šä¼šç•¥æœ‰å·®åˆ«ã€‚æœ¬æ–‡é‡‡ç”¨ $\\mathbf n \\cdot \\mathbf h$ çš„å†™æ³•ã€‚ ç¯å¢ƒå…‰ï¼ˆAmbient Lightingï¼‰å¦‚æœåªè€ƒè™‘æ¼«åå°„å’Œé•œé¢åå°„ï¼Œæˆ‘ä»¬ä¼šå‘ç°æ²¡æœ‰é¢æœå…‰æºçš„ç‰©ä½“å®Œå…¨æ˜¯é»‘è‰²çš„ï¼Œä½†ç°å®é‡Œæ˜¾ç„¶ä¸æ˜¯å¦‚æ­¤ã€‚è¿™æ˜¯å› ä¸ºåœ¨ç°å®é‡Œï¼Œå…‰ç»è¿‡å¤šæ¬¡åå°„è€Œç…§äº®äº†é‚£äº›æ²¡æœ‰é¢æœå…‰æºçš„ç‰©ä½“ã€‚æˆ‘ä»¬å¯ä»¥è¿‘ä¼¼åœ°è®¤ä¸ºæœ‰ä¸€ç§å……æ–¥ç€æ•´ä¸ªç©ºé—´çš„å…‰ï¼Œå¹¶æŠŠå®ƒå«åšç¯å¢ƒå…‰ï¼Œå…¬å¼å¦‚ä¸‹ï¼š L_a=c_r c_aå…¶ä¸­ $c_a$ æ˜¯ç¯å¢ƒå…‰çš„å¼ºåº¦ã€‚ å†¯æ°å…‰ç…§æ¨¡å‹ç»¼åˆæ¥çœ‹ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†å†¯æ°å…‰ç…§æ¨¡å‹ï¼Œå…¬å¼å¦‚ä¸‹ï¼š L=c_r(c_a+c_l\\max{(0,\\mathbf n \\cdot \\mathbf l)})+c_pc_l\\max(0, \\mathbf n \\cdot \\mathbf h)^på…¶ä¸­ $c_r$ æ˜¯ç‰©ä½“æè´¨ï¼Œè¡¨ç¤ºç‰©ä½“å¯¹å…‰çš„åå°„ç‡ï¼Œä¸€èˆ¬æ˜¯ä¸€ä¸ª Vector3f ç±»å‹çš„å€¼ï¼Œå› ä¸ºç‰©ä½“å¯¹ä¸åŒé¢œè‰²çš„å…‰æœ‰ä¸åŒåå°„ç‡ï¼› $c_a$ æ˜¯ç¯å¢ƒå…‰å¼ºï¼Œä¸€èˆ¬æ˜¯ä¸€ä¸ª Vector3f ç±»å‹çš„å€¼ï¼› $c_l$ æ˜¯å…‰å¼ºï¼Œä¸€èˆ¬ä¸ç‰©ä½“å’Œå…‰æºçš„è·ç¦»æˆåæ¯”ï¼Œä¸€èˆ¬æ˜¯ä¸€ä¸ª Vector3f ç±»å‹çš„å€¼ï¼› $c_p$ æ˜¯é«˜å…‰é¢œè‰²ï¼Œä¸€èˆ¬ä¹Ÿæ˜¯ä¸€ä¸ª Vector3f ç±»å‹çš„å€¼ã€‚ UVæ˜ å°„ä¸ºäº†æŠŠè´´å›¾è´´åˆ°æ¨¡å‹ä¸Šï¼Œéœ€è¦æœ‰ä¸€ä¸ª $(x, y, z) \\rightarrow (u, v)$ çš„å‡½æ•° $\\phi$. æˆ‘ä»¬æœŸæœ›è¿™ä¸ªå‡½æ•°æœ‰è¿™äº›æ€§è´¨ï¼š å•å°„ï¼šæˆ‘ä»¬ä¸å¸Œæœ›ä¸¤ä¸ª 3D ç‚¹æ˜ å°„åˆ°åŒä¸€ä¸ª 2D ç‚¹ä¸Š å¤§å°ä¸å˜æ€§ï¼šåœ¨ 3D æ¨¡å‹ä¸Šçš„ä¸‰è§’å½¢å¤šå¤§ï¼Œæˆ‘ä»¬å¸Œæœ› 2D çš„ä¸‰è§’å½¢ä¹Ÿå·®ä¸å¤šå¤§å° å½¢çŠ¶ä¸å˜æ€§ï¼š3D æ¨¡å‹çš„ä¸‰è§’å½¢æ˜ å°„åˆ° 2D ä¸Šåï¼Œä¸¤ä¸ªä¸‰è§’å½¢åº”å°½é‡ç›¸ä¼¼ è¿ç»­ï¼šå¦‚æœä¸¤ä¸ªç‚¹åœ¨ 3D ä¸–ç•Œæ¨¡å‹ä¸Šç›¸è¿‘ï¼Œæˆ‘ä»¬å¸Œæœ›å®ƒä»¬åœ¨ 2D ä¸Šä¹Ÿç›¸è¿‘ è´´å›¾æœ‰è®¸å¤šåº”ç”¨ï¼Œæœ€å®¹æ˜“æƒ³åˆ°çš„æ˜¯é¢œè‰²è´´å›¾ï¼Œå®ƒç›´æ¥æŠŠé¢œè‰²è´´åˆ°æ¨¡å‹ä¸Šï¼Œä¹Ÿè¢«ç§°ä½œæ¼«åå°„è´´å›¾ã€‚ æ³•çº¿è´´å›¾ã€é‡‘å±åº¦è´´å›¾ã€ç²—ç³™åº¦è´´å›¾åˆ™è¿›ä¸€æ­¥å†³å®šäº†æ¨¡å‹çš„å„ç§å±æ€§ã€‚æ¯”å¦‚æ³•çº¿è´´å›¾å®šä¹‰äº†æ¯ä¸€ç‚¹çš„æ³•çº¿ï¼Œåœ¨è®¡ç®—å…‰ç…§æ—¶ä¼šå€ŸåŠ©è¿™ä¸ªæ³•çº¿æ¥å¾—åˆ°æ›´çœŸå®çš„ç»“æœã€‚ ç€è‰²æ–¹æ³•æ¨¡å‹ç”±ä¸‰è§’å½¢åˆ’åˆ†æ¥è¡¨ç¤ºï¼Œé‚£ä¹ˆæ¯ä¸ªä¸‰è§’å½¢ç”¨æ€æ ·çš„é¢œè‰²å‘¢ï¼Ÿ å¹³é¢ç€è‰²ï¼ˆFlat Shadingï¼‰æˆ‘ä»¬é€šè¿‡å…‰ç…§è®¡ç®—é¢œè‰²ï¼Œè€Œè®¡ç®—å…‰ç…§éœ€è¦æ³•çº¿ã€‚å¹³é¢ç€è‰²ç›´æ¥æ±‚è¿™ä¸ªä¸‰è§’å½¢çš„æ³•çº¿ï¼Œç„¶åæŒ‰å…‰ç…§å…¬å¼è®¡ç®—è¿™ä¸ªä¸‰è§’å½¢çš„é¢œè‰²ã€‚è¿™ç§æ–¹æ³•å¾—åˆ°çš„æ¯ä¸ªä¸‰è§’å½¢éƒ½æ˜¯å•è‰²çš„ã€‚ é€é¡¶ç‚¹ç€è‰²ï¼ˆGouraud Shadingï¼‰é€é¡¶ç‚¹ç€è‰²åˆ™æ±‚ä¸‰è§’å½¢é¡¶ç‚¹çš„æ³•çº¿ï¼Œå¹¶ä¸ºä¸‰è§’å½¢é¡¶ç‚¹ç€è‰²ï¼Œç„¶åå¯¹å†…éƒ¨çš„æ¯ä¸ªç‚¹æ’å€¼å†…éƒ¨é¢œè‰²ã€‚ é‚£ä¹ˆé¡¶ç‚¹çš„æ³•çº¿æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿä¸€ä¸ªé¡¶ç‚¹ä¸€èˆ¬åœ¨å¤šä¸ªé¢ä¸Šï¼ŒæŠŠè¿™äº›é¢çš„æ³•çº¿åšåŠ æƒå¹³å‡å°±å¥½ï¼Œæƒå€¼å¯ä»¥æ˜¯é¢çš„é¢ç§¯ã€‚ é€åƒç´ ç€è‰²ï¼ˆPhong Shadingï¼‰é€åƒç´ ç€è‰²åŒæ ·æ±‚ä¸‰è§’å½¢é¡¶ç‚¹çš„æ³•çº¿ï¼Œç„¶åå¯¹å†…éƒ¨çš„æ¯ä¸ªç‚¹æ’å€¼å†…éƒ¨æ³•çº¿ï¼Œä»æ³•çº¿å†æ±‚å„ä¸ªç‚¹çš„é¢œè‰²ã€‚ æ’å€¼æ˜¯é€šè¿‡é‡å¿ƒåæ ‡æ¥æ’å€¼ã€‚å¯¹ä¸‰è§’å½¢ $ABC$ å†…çš„æŸä¸€ç‚¹ $P$ï¼Œå®ƒå¯ä»¥è¡¨ç¤ºä¸º P=\\frac{S_{APB}C+S_{BPC}A+S_{CPA}B}{S_{ABC}}è¿™é‡Œçš„ $S$ æ˜¯é¢ç§¯ï¼Œè¿™é‡Œçš„å½¢å¦‚ $S{APB}/S{ABC}$ çš„å¼å­å°±æ˜¯å„ä¸ªç‚¹çš„æƒå€¼ã€‚ åœ¨æ’å€¼æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨ä¸–ç•Œç©ºé—´ / æ‘„åƒæœºç©ºé—´åšæ’å€¼ï¼Œå³åœ¨ viewing transformation å‰è¿›è¡Œæ’å€¼ï¼Œè€Œä¸æ˜¯ viewing transformation åã€‚ ä½†æˆ‘ä»¬ä¸€èˆ¬åœ¨å…‰æ …åŒ–æ—¶æ‰è¿›è¡Œæ’å€¼ï¼Œè¿™æ—¶å·²ç»æŠŠç‰©ä½“å˜æ¢åˆ°äº† NDC ç©ºé—´ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜è¦è¿›è¡Œé€è§†çŸ«æ­£ã€‚å…¬å¼å¦‚ä¸‹ï¼Œå…·ä½“æ¨å¯¼å¯ä»¥å‚è€ƒ Homework 3 çš„ç¬”è®°ã€‚ \\begin{align*} &\\alpha = \\frac{\\alpha' / w_0}{\\alpha' / w_0 + \\beta' / w_1 + \\gamma' / w_2} \\\\ &\\beta= \\frac{\\beta' / w_1}{\\alpha' / w_0 + \\beta' / w_1 + \\gamma' / w_2} \\\\ &\\gamma= \\frac{\\gamma' / w_2}{\\alpha' / w_0 + \\beta' / w_1 + \\gamma' / w_2} \\end{align*}å…¶ä¸­ $\\alphaâ€™,\\betaâ€™,\\gammaâ€™$ æ˜¯å±å¹•ç©ºé—´çš„é‡å¿ƒåæ ‡ï¼Œ$\\alpha,\\beta,\\gamma$ æ˜¯ä¸–ç•Œç©ºé—´çš„é‡å¿ƒåæ ‡ã€‚æˆ‘ä»¬ç”¨ä¸–ç•Œç©ºé—´çš„é‡å¿ƒåæ ‡ä½œä¸ºæƒé‡æ¥æ’å€¼ã€‚ æ¸²æŸ“ç®¡çº¿æ¸²æŸ“æµç¨‹åŸºæœ¬å¦‚ä¸‹ï¼š Inputï¼šè¾“å…¥ 3D ä¸–ç•Œçš„é¡¶ç‚¹ Vertex Processingï¼šç”¨å„ç§å˜æ¢çŸ©é˜µæŠŠé¡¶ç‚¹å˜æ¢åˆ°å±å¹•ç©ºé—´ Triangle Processingï¼šæ ¹æ®ä¼ å…¥çš„é¡¶ç‚¹è¿æ¥æ–¹å¼åœ¨å±å¹•ç©ºé—´è¿æ¥ä¸‰è§’å½¢ Rasterizationï¼šæŠŠä¸‰è§’å½¢è½¬åŒ–æˆç‰‡å…ƒ / åƒç´  Fragement Processingï¼šåº”ç”¨è´´å›¾ã€å…‰ç…§ç­‰ Framebuffer Operationsï¼šæ·±åº¦æµ‹è¯•ç­‰ çº¹ç†æ”¾å¤§å’Œçº¹ç†ç¼©å°åœ¨åšçº¹ç†æ˜ å°„æ—¶ï¼Œè´´å›¾å¤ªå°å’Œè´´å›¾å¤ªå¤§éƒ½ä¼šæœ‰é—®é¢˜ã€‚ çº¹ç†æ”¾å¤§è´´å›¾å¤ªå°æ—¶è¦åšçº¹ç†æ”¾å¤§ï¼Œå¯¹é‡‡æ ·ç‚¹åšåŒçº¿æ€§æ’å€¼å³å¯ã€‚ çº¹ç†ç¼©å°è´´å›¾å¤ªå¤§æ—¶ç›´è§‰ä¸Šæ¯”è´´å›¾å¤ªå°æ›´å¥½å¤„ç†ï¼Œä½†æ°æ°ç›¸åã€‚è¿˜è®°å¾—é¢‘è°±å—ï¼Œè´´å›¾å¤ªå¤§ä»£è¡¨é«˜é¢‘æœ‰æ›´å¤šä¿¡æ¯ï¼Œæˆ‘ä»¬ä¼šå› é‡‡æ ·é¢‘ç‡ä¸è¶³è€Œæ— æ³•æ­£ç¡®åæ˜ é«˜é¢‘ä¿¡æ¯ï¼Œå¯¼è‡´ç»“æœå‡ºç°é”¯é½¿ã€æ‘©å°”çº¹ç­‰èµ°æ ·é—®é¢˜ã€‚ æœ€å¸¸ç”¨çš„ç¼“è§£æ–¹æ³•æ˜¯ Mipmappingã€‚åŸºæœ¬æ€è·¯æ˜¯ï¼Œæˆ‘ä»¬åˆ†æå±å¹•ä¸Šæ¯ä¸ªåƒç´ åœ¨è´´å›¾ä¸Šè¦†ç›–çš„åƒç´ æ•°é‡ï¼Œå¯¹é‚£äº›è¦†ç›–è¾ƒå¤šçš„ï¼Œå°±è®©ä»–ä»¬å»è¢«ç¼©å°çš„è´´å›¾ä¸Šé‡‡æ ·ï¼Œè¿™æ ·å°±èƒ½ç¼“è§£æ¬ é‡‡æ ·é—®é¢˜ã€‚ é¦–å…ˆæˆ‘ä»¬è¦åˆ›å»ºâ€œç¼©å°çš„è´´å›¾â€ï¼ŒMipmapé“¾åŒ…å«ä¸€ç³»åˆ—çº¹ç† $D_0, D_1, D_2, \\ldots, D_N$ï¼Œå…¶ä¸­ $D_i$ çš„åˆ†è¾¨ç‡ä¸º $\\frac{W}{2^i} \\times \\frac{H}{2^i}$ï¼Œç›´åˆ°æœ€å†…å±‚ä¸º $1 \\times 1$ åƒç´ ã€‚ ç„¶åæˆ‘ä»¬è¦åˆ†æå•ä¸ªå±å¹•åƒç´ è¦†ç›–äº†å¤šå°‘çº¹ç†åƒç´ ï¼Œå¤§è‡´æ€è·¯æ˜¯è®¡ç®—å±å¹•ç©ºé—´çš„ç›¸é‚»ç‚¹æ˜ å°„åˆ°è´´å›¾ç©ºé—´åçš„è·ç¦»ã€‚è´´å›¾ç©ºé—´é‡Œç›¸é‚»åƒç´ è·ç¦»ä¸º $1$ï¼Œæ‰€ä»¥å¦‚æœå±å¹•ç©ºé—´çš„ç›¸é‚»ç‚¹æ˜ å°„åˆ°è´´å›¾ç©ºé—´åçš„è·ç¦»ä¸º $x$ï¼Œæˆ‘ä»¬å°±è®¤ä¸ºå®ƒè¦†ç›–äº† $x$ ä¸ªåƒç´ ã€‚ è¿™ä¸ªâ€œå•ä¸ªå±å¹•åƒç´ è¦†ç›–äº†å¤šå°‘çº¹ç†åƒç´ â€çš„ä¼°ç®—è¢«è®°ä½œ $\\rho$ï¼Œå…¬å¼å¦‚ä¸‹ï¼š \\rho = \\max\\left( \\sqrt{\\left(\\frac{\\partial u}{\\partial x}\\right)^2 + \\left(\\frac{\\partial v}{\\partial x}\\right)^2}, \\sqrt{\\left(\\frac{\\partial u}{\\partial y}\\right)^2 + \\left(\\frac{\\partial v}{\\partial y}\\right)^2} \\right)å– $\\max$ æ˜¯ä¸ºäº†å°½å¯èƒ½å–å±‚çº§æ›´ä½çš„ Mipmapã€‚ä¸€ä¸ªå±å¹•åƒç´ è¦†ç›–çš„çº¹ç†åƒç´ è¶Šå¤šï¼Œå®ƒå¯¹åº”çš„ Mipmap å±‚çº§å°±è¶Šå°ã€‚æ€»ä¹‹ï¼Œæˆ‘ä»¬å®å¯æ¨¡ç³Šï¼Œä¹Ÿä¸è¦æ¬ é‡‡æ ·ã€‚ æœ€åç”¨ $\\lambda = \\log_2{\\rho}$ å°±èƒ½ç®—å‡ºè¿™ä¸ªå±å¹•åƒç´ å¯¹åº”çš„çº¹ç†å±‚çº§ã€‚æ¯”å¦‚å½“ $\\lambda = 0$ æ—¶ï¼Œè¡¨ç¤ºä¸€ä¸ªå±å¹•åƒç´ æ°å¥½å¯¹åº”ä¸€ä¸ªçº¹ç†åƒç´ ï¼Œåº”ä½¿ç”¨åŸå§‹çº¹ç† $D_0$. è®¡ç®—å‡ºå±‚çº§ $\\lambda$ åè¿˜è¦åšé‡‡æ ·ã€‚æ˜¾ç„¶ $\\lambda$ å¤§å¤šæ•°æ—¶å€™éƒ½ä¸æ˜¯æ•´æ•°ï¼Œæ‰€ä»¥æœ‰ä¸¤ç§å¸¸è§çš„é‡‡æ ·æ–¹æ³•ï¼š æœ€è¿‘é‚»Mipmapæ»¤æ³¢ï¼ˆNearest Mipmap Filteringï¼‰ é€‰æ‹©æœ€æ¥è¿‘ $\\lambda$ çš„æ•´æ•°å±‚çº§ $d = \\text{round}(\\lambda)$ åšé‡‡æ ·ï¼Œåœ¨è¿™ä¸€å±‚å¯ä»¥æ˜¯æœ€è¿‘é‚»æˆ–åŒçº¿æ€§æ»¤æ³¢ã€‚ ä¸‰çº¿æ€§æ»¤æ³¢ï¼ˆTrilinear Filteringï¼‰ ç¡®å®š $\\lambda$ ä¸¤ä¾§çš„ä¸¤ä¸ªæ•´æ•°å±‚çº§ï¼š$d_1 = \\lfloor\\lambda\\rfloor$ å’Œ $d_2 = \\lceil\\lambda\\rceil = d_1 + 1$ï¼Œåœ¨è¿™ä¸¤å±‚åˆ†åˆ«åšåŒçº¿æ€§æ»¤æ³¢é‡‡æ ·å¾—åˆ°é¢œè‰² $C_1$ å’Œ $C_2$ï¼Œç„¶åå¾—åˆ°æœ€ç»ˆé¢œè‰² C = (1 - f) \\cdot C_1 + f \\cdot C_2 å…¶ä¸­ $f = \\lambda - \\lfloor\\lambda\\rfloor$ ä¸º $\\lambda$ çš„å°æ•°éƒ¨åˆ†ã€‚ å…¶ä»–å°çŸ¥è¯†è™ä¹¦æåˆ°çš„planar projectionã€spherical coordinatesã€cylindrical coordinatesã€cubemapsæœ¬è´¨ä¸Šéƒ½æ˜¯æŠŠ3dè¡¨é¢æŠ•å½±åˆ°ä¸€ä¸ªç†æƒ³çš„ç®€å•å‡ ä½•ä½“ä¸Šï¼Œç„¶åæŠŠç®€å•å‡ ä½•ä½“å±•å¼€æˆå¹³é¢ã€‚","categories":[{"name":"å…¬å¼€è¯¾","slug":"å…¬å¼€è¯¾","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/"},{"name":"GAMES101","slug":"å…¬å¼€è¯¾/GAMES101","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/"},{"name":"Notes","slug":"å…¬å¼€è¯¾/GAMES101/Notes","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/Notes/"}],"tags":[]},{"title":"Assignment 3 Pipeline and Shading","slug":"learning/open-course/GAMES101/Hw/Hw3-pipeline-and-shading","date":"2025-09-13T11:45:16.000Z","updated":"2025-09-13T12:04:25.374Z","comments":true,"path":"wiki/learning/open-course/GAMES101/Hw/Hw3-pipeline-and-shading/","permalink":"http://rinevard.github.io/wiki/learning/open-course/GAMES101/Hw/Hw3-pipeline-and-shading/","excerpt":"","text":"æœ¬æ¬¡ä½œä¸šå¯¹ bump_fragment_shaderã€displacement_fragment_shader çš„è¦æ±‚éå¸¸ä¸ä¸¥è°¨ï¼Œè‡³å°‘åŒ…æ‹¬è¿™äº›é—®é¢˜ï¼š è¿™ä¸¤ä¸ª shdaer éœ€è¦çš„è´´å›¾æ˜¯å‡¹å‡¸è´´å›¾ï¼Œå‡¹å‡¸è´´å›¾æœ¬åº”è¯¥æ˜¯ç°åº¦å›¾ï¼Œè¿™é‡Œä½¿ç”¨ RGB è´´å›¾ã€‚ åœ¨è®¡ç®—åˆ‡çº¿ç©ºé—´åˆ°ä¸–ç•Œç©ºé—´çš„å˜æ¢çŸ©é˜µ TBN æ—¶ä½¿ç”¨äº†é”™è¯¯çš„å…¬å¼ã€‚æ­£ç¡®çš„å…¬å¼éœ€è¦çŸ¥é“ä¸‰è§’å½¢çš„ä¸‰ä¸ªé¡¶ç‚¹åŠå…¶ UV åæ ‡ã€‚ displacement æ–¹æ³•æ²¡æœ‰åœ¨å…‰æ …åŒ–å‰åç§»é¡¶ç‚¹ä½ç½®ï¼Œè€Œåªè°ƒæ•´äº†æ˜¾ç¤ºé¢œè‰²ã€‚ æˆ‘ä»¬å…ˆä»‹ç»ä¸€ä¸‹ TBN çš„æ­£ç¡®è®¡ç®—æ–¹å¼å’Œä» bump texture ç®—å‡ºæ¢¯åº¦çš„æ–¹æ³•ï¼Œå†ä¾æ¬¡ä»‹ç»ä¸€ä¸‹å„ä¸ªä½œä¸šçš„åšæ³•ã€‚ TBNçš„æ­£ç¡®è®¡ç®—æ–¹å¼æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ä»€ä¹ˆæ˜¯ TBN ä»¥åŠä¸ºä»€ä¹ˆéœ€è¦ TBN. ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬å…ˆè€ƒè™‘æ³•çº¿è´´å›¾ã€‚ä¸‹æ–‡æŠŠä¸–ç•Œç©ºé—´é‡ŒæŒ‰æ³•çº¿è´´å›¾ä¿®æ­£åçš„æ³•çº¿ç§°ä½œâ€œä¿®æ­£æ³•çº¿â€ï¼ŒæŠŠä¸–ç•Œç©ºé—´é‡Œä¿®æ­£å‰çš„æ³•çº¿ç§°ä½œâ€œå‡ ä½•æ³•çº¿â€ï¼Œè¿™é‡Œé»˜è®¤å®ƒä»¬éƒ½æ˜¯å½’ä¸€åŒ–çš„ã€‚ è€ƒè™‘ä¸–ç•Œç©ºé—´çš„æŸä¸€ç‚¹ $Q$ï¼Œå‡è®¾å®ƒåœ¨æ³•çº¿è´´å›¾ä¸­å¯¹åº”çš„ä¸€ç‚¹ä¸º $Qâ€™$ï¼Œæˆ‘ä»¬çŸ¥é“ç‚¹ $Qâ€™$ å¯¹åº”çš„æ³•çº¿è¢«ç”¨äºè®¡ç®—ä¸–ç•Œç©ºé—´ç‚¹ $Q$ çš„ä¿®æ­£æ³•çº¿ã€‚ä½†ç­‰ç­‰ï¼Œç›´æ¥æŠŠ RGB å€¼å¤åˆ¶è¿‡å»çœ‹èµ·æ¥æ˜¯é”™è¯¯çš„ï¼Œå› ä¸ºéšç€ç‰©ä½“è½¬åŠ¨ï¼Œç‚¹ $Q$ å¯¹åº”çš„æ³•çº¿ä¹Ÿåº”å½“è½¬åŠ¨ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªçŸ©é˜µæ¥å®ç°è¿™ç§ä»æ³•çº¿è´´å›¾ä¸Šçš„æ³•çº¿åˆ°ä¸–ç•Œç©ºé—´çš„ä¿®æ­£æ³•çº¿çš„å˜æ¢ã€‚ è´´å›¾æ˜¯äºŒç»´çš„ï¼Œå› æ­¤æˆ‘ä»¬å†é¢å¤–å®šä¹‰ä¸€ä¸ªå‚ç›´çº¸é¢å‘å¤–çš„è½´ $n$ï¼Œå®ƒè¡¨ç¤ºæ³•çº¿çš„â€œé»˜è®¤æ–¹å‘â€ï¼Œè¿™å°±å¾—åˆ°äº†ä¸‰ç»´çš„åˆ‡çº¿ç©ºé—´ã€‚å¦‚æœç‚¹ $Qâ€™$ å¯¹åº”çš„æ³•çº¿æ˜¯ $(0,0,1)$ï¼Œé‚£ä¹ˆä¸–ç•Œç©ºé—´çš„ç‚¹ $Q$ çš„ä¿®æ­£æ³•çº¿å°±æ˜¯åŸæœ¬çš„å‡ ä½•æ³•çº¿ã€‚ æ¥ä¸‹æ¥å°±è¦è€ƒè™‘å¦‚ä½•æ‰¾åˆ°è¿™ä¸ªä»åˆ‡çº¿ç©ºé—´åˆ°ä¸–ç•Œç©ºé—´çš„æ—‹è½¬çŸ©é˜µäº†ã€‚ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬å…ˆè€ƒè™‘å•ä¸ªä¸‰è§’å½¢çš„æ—‹è½¬ã€‚ä¹‹åæˆ‘ä»¬ä¼šå¯¹æ¯ä¸ªç‚¹æ±‚å‡ºå®ƒè‡ªå·±çš„æ—‹è½¬çŸ©é˜µã€‚æ²¡é”™ï¼Œæ¯ä¸ªç‚¹çš„æ—‹è½¬çŸ©é˜µä¸åŒï¼Œè¿™æ˜¯å› ä¸ºæ¯ä¸ªç‚¹å¯¹åº”çš„çŸ©é˜µä¼šæŠŠ $(0,0,1)$ æ˜ å°„åˆ°è¯¥ç‚¹çš„å‡ ä½•æ³•çº¿ï¼Œè€Œæ¯ä¸ªç‚¹çš„å‡ ä½•æ³•çº¿ä¸€èˆ¬ä¸åŒã€‚ å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬å¸Œæœ›æŠŠæ³•çº¿è´´å›¾ä¸Šçš„ $P_0â€™P_1â€™P_2â€™$ æ—‹è½¬ä¸ºä¸–ç•Œç©ºé—´çš„ $P_0P_1P_2$ï¼Œè®¾è¿™é‡Œçš„æ—‹è½¬çŸ©é˜µä¸º $M$ï¼Œä¸–ç•Œç©ºé—´çš„ $P_0P_1P_2$ çš„å‡ ä½•æ³•çº¿ä¸º $\\mathbf{n}$ï¼Œåˆ™æœ‰ \\begin{align*} &M[0,0,1]^T=\\mathbf n \\end{align*} ä½†å…‰é è¿™ä¸€ä¸ªæ–¹ç¨‹å½“ç„¶è§£ä¸å‡º $M$ï¼Œæ‰€ä»¥æˆ‘ä»¬å†è€ƒè™‘ä¸¤ä¸ªé¢å¤–çš„æ–¹ç¨‹ï¼š \\begin{align*} &M (P_1'-P_0')=k(P_1-P_0) \\\\ &M (P_2'-P_0')=k(P_2-P_0) \\end{align*}ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¸Œæœ›è¿™ä¸ªçŸ©é˜µæŠŠåˆ‡çº¿ç©ºé—´ä¸‰è§’å½¢çš„è¾¹å‘é‡æ—‹è½¬åˆ°ä¸–ç•Œç©ºé—´çš„è¾¹å‘é‡ä¸Šï¼Œè¿™çœ‹èµ·æ¥æ˜¯ä¸€ä¸ªåˆç†çš„è¦æ±‚ã€‚è¿™é‡Œçš„ $k$ æ˜¯è¾¹çš„é•¿åº¦çš„ç¼©æ”¾æ¯”ä¾‹ï¼Œä¸¥æ ¼æ¥è¯´æ¯æ¡è¾¹çš„ç¼©æ”¾æ¯”ä¾‹ä¸ä¸€å®šç›¸ç­‰ï¼Œä½†åªè¦ UV æ˜ å°„å‰åçš„ä¸‰è§’å½¢å¤§ä½“æ˜¯ç›¸ä¼¼ä¸‰è§’å½¢ï¼Œæˆ‘ä»¬å°±å¯ä»¥è®¤ä¸ºç¼©æ”¾æ¯”ä¾‹éƒ½ä¸º $k$. ä¸‹é¢æˆ‘ä»¬æ¥è§£æ–¹ç¨‹ã€‚é¦–å…ˆæˆ‘ä»¬è®¾ \\begin{align*} &M=\\begin{pmatrix} T & B & N \\end{pmatrix} \\\\ &P_1'-P_0'= [\\Delta u_1,\\Delta v_1,0]^T \\\\ &P_2'-P_0'= [\\Delta u_2,\\Delta v_2,0]^T \\end{align*}ä¸‹é¢ä¸¤ä¸ªå¼å­åˆ©ç”¨äº† $P_kâ€™$ çš„ç¬¬ä¸‰ä¸ªåˆ†é‡ä¸º $0$ çš„æ€§è´¨ã€‚ ç»“åˆç¬¬ä¸€ä¸ªæ–¹ç¨‹å°±èƒ½å¾—åˆ° $N=\\mathbf n$ï¼Œè¿™é‡Œçš„ $\\mathbf n$ è¡¨ç¤ºä¸–ç•Œç©ºé—´çš„ $P_0P_1P_2$ çš„å‡ ä½•æ³•çº¿ã€‚å†ç»“åˆå¦å¤–ä¸¤ä¸ªæ–¹ç¨‹å°±èƒ½å¾—åˆ° \\begin{align*} &\\Delta u_1 T+\\Delta v_1 B=k(P_1-P_0) \\\\ &\\Delta u_2 T+\\Delta v_2 B=k(P_2-P_0) \\end{align*}ä¹‹åæˆ‘ä»¬å¯ä»¥è§£å‡º $T,B,N$ çš„å€¼ \\begin{align*} &T=k\\frac{\\Delta v_2(P_1-P_0)-\\Delta v_1(P_2-P_0)}{\\Delta u_1 \\Delta v_2-\\Delta u_2 \\Delta v_1} \\\\ &B=k\\frac{\\Delta u_2(P_1-P_0)-\\Delta u_1(P_2-P_0)}{\\Delta u_2 \\Delta v_1-\\Delta u_1 \\Delta v_2} \\\\ &N=\\mathbf n \\end{align*}è¿™ä¸ªå…¬å¼æ˜¯ä¸èƒ½ç”¨çš„ï¼Œå› ä¸ºé‡Œé¢æœ‰æœªçŸ¥æ•° $k$. æ¥ä¸‹æ¥æˆ‘ä»¬è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ æˆ‘ä»¬æœŸæœ› TBN çŸ©é˜µæ˜¯ä¸€ä¸ªæ—‹è½¬çŸ©é˜µï¼Œè€Œæ—‹è½¬çŸ©é˜µæ˜¯æ­£äº¤çŸ©é˜µï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼šå¯¹ TBN åšæ–½å¯†ç‰¹æ­£äº¤åŒ–å’Œå½’ä¸€åŒ–ã€‚åªè¦ $P_0P_1P_2$ å’Œ $P_0â€™P_1â€™P_2â€™$ å¤§ä½“æ˜¯ç›¸ä¼¼ä¸‰è§’å½¢ï¼Œé‚£ä¹ˆå®ƒä»¬æœ¬æ¥å°±å·®ä¸å¤šæ­£äº¤ï¼ˆå›é¡¾æˆ‘ä»¬å¯¹ TBN çš„å®šä¹‰ï¼Œä¼šå‘ç°ç›¸ä¼¼è¯´æ˜ TBN åªå¯¹ $P_0â€™P_1â€™P_2â€™$ åšäº†æ—‹è½¬å’Œç¼©æ”¾ï¼Œè¿™è¡¨æ˜ TBN æ­£äº¤ï¼‰ï¼Œæ‰€ä»¥è¿™ç§æ­£äº¤åŒ–ä¸ä¼šæŠŠ TBN å˜åŒ–å¤ªå¤šã€‚è€Œç”±äºæˆ‘ä»¬ä¼šå¯¹ TBN åšå•ä½åŒ–ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ”¾å¿ƒåœ°ä»¤ $k=1$ æ¥ç”¨ä¸‹é¢çš„å…¬å¼æ±‚å‡º TBNï¼š \\begin{align*} &T=\\frac{\\Delta v_2(P_1-P_0)-\\Delta v_1(P_2-P_0)}{\\Delta u_1 \\Delta v_2-\\Delta u_2 \\Delta v_1} \\\\ &B=\\frac{\\Delta u_2(P_1-P_0)-\\Delta u_1(P_2-P_0)}{\\Delta u_2 \\Delta v_1-\\Delta u_1 \\Delta v_2} \\\\ &N=\\mathbf{n} \\end{align*}æœ€åï¼Œæˆ‘ä»¬å¸Œæœ› N åœ¨æ­£äº¤åŒ–å‰åä¸å˜ï¼Œæ‰€ä»¥åœ¨æ­£äº¤åŒ–åæˆ‘ä»¬æœ‰ \\begin{align*} &T'=T-(N\\cdot T)N \\\\ &B'=B-(N\\cdot B)N-(T'\\cdot B)T'/T'^2 \\\\ &N'=\\mathbf n \\end{align*}å†åšä¸ªå•ä½åŒ–å°±èƒ½å¾—åˆ°é¡¶ç‚¹çš„ TBN çŸ©é˜µäº†ã€‚è¿˜è®°å¾— TBN çŸ©é˜µæ˜¯åšä»€ä¹ˆçš„å—ï¼Œæˆ‘ä»¬ç”¨å®ƒæ¥å®ç°ä»åˆ‡çº¿ç©ºé—´åˆ°ä¸–ç•Œç©ºé—´çš„å˜æ¢ã€‚æ‰€ä»¥å¯¹ç‚¹ $Q$ï¼Œå‡è®¾å…¶æ³•çº¿è´´å›¾å¯¹åº”çš„æ³•çº¿ä¸º $\\mathbf nâ€™$ï¼Œé‚£ä¹ˆä¿®æ­£åçš„æ³•çº¿å°±æ˜¯ $M_{\\text{TBN}}\\mathbf nâ€™$. å¾ˆå¥½ï¼Œæˆ‘ä»¬ç°åœ¨èƒ½æŠŠå•ä¸ªä¸‰è§’å½¢åšå˜æ¢äº†ï¼Œä½†åœ¨çœŸæ­£çš„æ¨¡å‹ä¸­ï¼Œæ¯ä¸ªç‚¹çš„å‡ ä½•æ³•çº¿æ–¹å‘ä¸€èˆ¬éƒ½ä¸åŒï¼Œè¿™å°±æ„å‘³ç€å®ƒä»¬ä¸€èˆ¬éƒ½æœ‰ä¸åŒçš„ TBN çŸ©é˜µã€‚ä¸è®¡ç®—é¡¶ç‚¹æ³•çº¿ç±»ä¼¼ï¼Œæˆ‘ä»¬ä¼šæ‰¾åˆ°æ¯ä¸ªé¡¶ç‚¹ç›¸é‚»çš„æ‰€æœ‰ä¸‰è§’å½¢ï¼Œå¹¶å¯¹å®ƒä»¬çš„ $T$ å’Œ $B$ åšåŠ æƒå¹³å‡æ¥å¾—åˆ°è¿™ä¸ªé¡¶ç‚¹çš„ $T$ å’Œ $B$. åœ¨å®è·µä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬åªè®¡ç®—å‡ºæ¯ä¸ªé¡¶ç‚¹çš„ $T$ï¼Œç„¶ååœ¨éœ€è¦ $B$ æ—¶é€šè¿‡å‰ä¹˜ $N\\times T$ æ¥è®¡ç®—ã€‚å¯¹é‚£äº›éé¡¶ç‚¹çš„ç‚¹ï¼Œæˆ‘ä»¬ç”¨é‡å¿ƒåæ ‡æ’å€¼æ¥ç®—å‡ºå…¶ $N$ å’Œ $T$ï¼Œç„¶åä¹Ÿåšæ­£äº¤åŒ–å’Œå•ä½åŒ–æ¥ä¿è¯ TBN çŸ©é˜µçš„æ­£äº¤æ€§ã€‚ æœ€åæˆ‘ä»¬å†ç®€å•åˆ†æä¸€ä¸‹æ€ä¹ˆæ ¹æ®å‡¹å‡¸è´´å›¾åšæ³•çº¿ä¿®æ­£ã€‚åœ¨ä¿®æ­£æ³•çº¿æ—¶ï¼Œå‡¹å‡¸è´´å›¾ä¸æ³•çº¿è´´å›¾çš„å”¯ä¸€åŒºåˆ«å°±æ˜¯æ²¡æœ‰ç›´æ¥ç»™å‡ºæ³•çº¿ã€‚å›é¡¾ä¸€ä¸‹åˆ‡çº¿ç©ºé—´çš„å®šä¹‰ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç»™å‡¹å‡¸è´´å›¾åŒæ ·è®¾ç½®æ²¿çº¸é¢å‘å¤–çš„ $n$ è½´ï¼Œç„¶åæŠŠå‡¹å‡¸è´´å›¾æƒ³è±¡æˆä¸€ä¸ªæŒ‰ç°åº¦å€¼èµ·ä¼çš„æ›²é¢ï¼Œè¿™ä¸ªæ›²é¢çš„æ³•çº¿å°±å’Œæ³•çº¿è´´å›¾æä¾›çš„æ³•çº¿ç›¸å¯¹åº”ã€‚ å…·ä½“æ¥è¯´ï¼Œç‚¹ $(u,v)$ å¤„çš„æ³•çº¿å¯ä»¥ç”¨ $(h(u)-h(u+1,v),h(v)-h(u,v+1),1)$ æ¥è¿‘ä¼¼ï¼Œå…¶ä¸­ $h(u,v)$ è¡¨ç¤ºå‡¹å‡¸è´´å›¾åœ¨ç‚¹ $(u,v)$ å¤„çš„ç°åº¦å€¼ï¼Œ$h(u+1,v)$ è¡¨ç¤º $(u,v)$ å³è¾¹ä¸€æ ¼çš„ç°åº¦å€¼ã€‚ æœ‰æ—¶ç”±äºæˆ‘ä»¬æŠŠè´´å›¾åšäº†å½’ä¸€åŒ–ï¼Œæˆ‘ä»¬ä¼šæ”¹ç”¨ $h(u+1/\\text{width},v)$ï¼Œä½†è®°ä½å®ƒè¡¨ç¤ºç›¸é‚»æ ¼å­çš„ç°åº¦å€¼å°±è¡Œã€‚ æœ€åæŠŠè¿™ä¸ªæ³•çº¿å’Œ TBN çŸ©é˜µç›¸ä¹˜å³å¯å¾—åˆ°ä¿®æ­£æ³•çº¿ã€‚ å‚è€ƒ Computing Tangent Space Basis Vectors for an Arbitrary Mesh - Eric Lengyel ä½œä¸šä»£ç rasterize_triangleæ³¨æ„è¿™é‡Œçš„æ’å€¼ç®—æ³•è¦å¯¹æ‰€æœ‰çš„å±æ€§éƒ½åšé€è§†çŸ«æ­£ï¼Œæˆ‘ä»¬ç®€å•æ¨å¯¼ä¸€ä¸‹é€è§†çŸ«æ­£çš„å…¬å¼ï¼š å‡è®¾æˆ‘ä»¬åœ¨å¯¹ç‚¹ $Q$ çš„æŸä¸ªå±æ€§è¿›è¡Œæ’å€¼ï¼Œåœ¨ä¸–ç•Œç©ºé—´ä¸­ï¼Œå®ƒæ‰€åœ¨çš„ä¸‰è§’å½¢ä¸º $P_0P_1P_2$. æŠ•å½±å˜æ¢åï¼Œå®ƒä»¬åˆ†åˆ«å˜æˆäº† $Qâ€™$ å’Œ $P_0â€™P_1â€™P_2â€™$. ç”¨é‡å¿ƒåæ ‡åˆ†åˆ«è¡¨ç¤º $Q$ å’Œ $Qâ€™$ï¼Œä¼šå¾—åˆ° \\begin{align*} &Q=\\alpha P_0+\\beta P_1+\\gamma P_2 \\\\ &Q'=\\alpha' P_0'+\\beta' P_1'+\\gamma' P_2' \\end{align*}è¿™é‡Œçš„ $Q,Qâ€™,P_k,P_kâ€™$ éƒ½æ˜¯å½¢å¦‚ $[x,y,z,1]^T$ çš„å‘é‡ã€‚ åœ¨æ’å€¼å±æ€§æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›ç”¨ $\\alpha, \\beta,\\gamma$ æ¥æ’å€¼ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ $\\alphaâ€™, \\betaâ€™,\\gammaâ€™$ æ’å€¼ï¼Œå› ä¸ºæˆ‘ä»¬å½“ç„¶ä¸å¸Œæœ›å±æ€§ä¼šå› é€è§†ä½ç½®ä¸åŒè€Œä¸åŒã€‚è¿™å°±éœ€è¦æˆ‘ä»¬æ ¹æ® $\\alphaâ€™, \\betaâ€™,\\gammaâ€™$ ç®—å‡º $\\alpha, \\beta,\\gamma$. ä¸å¦¨è®¾æŠ•å½±å˜æ¢çŸ©é˜µä¸º $M$ï¼Œåˆ™æœ‰ \\begin{align*} &MQ=\\alpha MP_0+\\beta MP_1+\\gamma MP_2 \\end{align*}è¿™é‡Œçš„ $MP_k$ æ˜¯å½¢å¦‚ $[x_k,y_k,z_k,w_k]^T$ çš„ç”¨é½æ¬¡åæ ‡è¡¨ç¤ºçš„å‘é‡ï¼Œå®ƒä¸å½¢å¦‚ $[x,y,z,1]^T$ çš„ $P_kâ€™$ è™½ç„¶åœ¨æ•°å­¦ä¸Šè¡¨ç¤ºåŒä¸€ä¸ªç‚¹ï¼Œä½†åœ¨æ•°å€¼ä¸Šä¸åŒã€‚ï¼ˆè¿˜è®°å¾—å—ï¼Œé½æ¬¡åæ ‡ä¸‹çš„ $[x,y,z,1]$ å’Œ $[ax,ay,az,a]$ è¡¨ç¤ºåŒä¸€ä¸ªç‚¹ï¼‰ å› æ­¤æˆ‘ä»¬å¸Œæœ›å¯¹å‘é‡çš„ç³»æ•°åšä¸€äº›è°ƒæ•´ï¼Œæ¥è®©å„ä¸ªå‘é‡å˜æˆ $[x,y,z,1]^T$ çš„å½¢å¼ï¼Œä»è€Œæ‰¾å‡º $\\alphaâ€™, \\betaâ€™,\\gammaâ€™$ å’Œ $\\alpha, \\beta,\\gamma$ çš„å…³ç³»ã€‚ ç®€å•å˜æ¢ä¸€ä¸‹ï¼Œæˆ‘ä»¬èƒ½æŠŠä¸Šé¢çš„å¼å­å†™æˆ \\begin{align*} &MQ=\\alpha w_0\\frac{MP_0}{w_0}+\\beta w_1\\frac{MP_1}{w_1}+\\gamma w_2\\frac{MP_2}{w_2} \\end{align*}ç°åœ¨å³è¾¹çš„å„ä¸ªå‘é‡ $\\frac{MP_k}{w_k}$ éƒ½å·²ç»æ˜¯ $[x,y,z,1]^T$ çš„å½¢å¼äº†ï¼Œæˆ‘ä»¬ç»™å®ƒä»¬çš„ç³»æ•°åšä¸ªå½’ä¸€åŒ–å°±èƒ½è®©å·¦è¾¹çš„å‘é‡ä¹Ÿå˜æˆ $[x,y,z,1]^T$ çš„å½¢å¼ï¼š \\frac{MQ}{\\alpha w_0 + \\beta w_1 + \\gamma w_2} = \\frac{1}{\\alpha w_0 + \\beta w_1 + \\gamma w_2} \\bigg( \\alpha w_0\\frac{MP_0}{w_0}+\\beta w_1\\frac{MP_1}{w_1}+\\gamma w_2\\frac{MP_2}{w_2} \\bigg)ç”±æ­¤æˆ‘ä»¬å°±æœ‰ \\begin{align*} &\\frac{\\alpha w_0}{\\alpha w_0 + \\beta w_1 + \\gamma w_2}=\\alpha' \\\\ &\\frac{\\beta w_1}{\\alpha w_0 + \\beta w_1 + \\gamma w_2}=\\beta' \\\\ &\\frac{\\gamma w_2}{\\alpha w_0 + \\beta w_1 + \\gamma w_2}=\\gamma' \\end{align*}è§£ä¸Šé¢çš„æ–¹ç¨‹çš„å°æŠ€å·§æ˜¯å€ŸåŠ©é™¤æ³•å’Œé‡å¿ƒåæ ‡å’Œä¸º $1$ çš„æ€§è´¨å¾—åˆ°ä¸‹é¢çš„ç­‰ä»·çš„æ–¹ç¨‹ç»„ \\begin{align*} &\\frac{\\alpha'}{\\beta'}=\\frac{\\alpha w_0}{\\beta w_1} \\\\ &\\frac{\\alpha'}{\\gamma'}=\\frac{\\alpha w_0}{\\gamma w_2} \\\\ &\\alpha + \\beta + \\gamma = 1 \\end{align*}ç„¶åå°±èƒ½æ±‚å‡º \\begin{align*} &\\alpha = \\frac{\\alpha' / w_0}{\\alpha' / w_0 + \\beta' / w_1 + \\gamma' / w_2} \\\\ &\\beta= \\frac{\\beta' / w_1}{\\alpha' / w_0 + \\beta' / w_1 + \\gamma' / w_2} \\\\ &\\gamma= \\frac{\\gamma' / w_2}{\\alpha' / w_0 + \\beta' / w_1 + \\gamma' / w_2} \\end{align*}ç”±æ­¤ï¼Œæˆ‘ä»¬å°±ä»å±å¹•ç©ºé—´çš„é‡å¿ƒåæ ‡ $\\alphaâ€™,\\betaâ€™,\\gammaâ€™$ ç®—å‡ºäº†ä¸–ç•Œç©ºé—´çš„é‡å¿ƒåæ ‡ $\\alpha,\\beta,\\gamma$ï¼Œä¹‹åå°±èƒ½ç”¨ä¸–ç•Œç©ºé—´çš„é‡å¿ƒåæ ‡æ¥æ­£ç¡®æ’å€¼äº†ã€‚ //Screen space rasterization void rst::rasterizer::rasterize_triangle(const Triangle&amp; t, const std::array&lt;Eigen::Vector3f, 3>&amp; view_pos) &#123; auto v = t.toVector4(); // Find bounding box float left = v[0].x(); float right = v[0].x(); float bottom = v[0].y(); float top = v[0].y(); for (auto&amp; vec: v) &#123; left = std::min(left, vec.x()); right = std::max(right, vec.x()); bottom = std::min(bottom, vec.y()); top = std::max(top, vec.y()); &#125; // Update pixels in bounding box for (int x = static_cast&lt;int>(left); x &lt;= static_cast&lt;int>(right) + 1; x++) &#123; for (int y = static_cast&lt;int>(bottom); y &lt;= static_cast&lt;int>(top) + 1; y++) &#123; auto[alpha, beta, gamma] = computeBarycentric2D(x, y, t.v); // If (x, y) is not inside triangle, continue if (alpha &lt; 0 || beta &lt; 0 || gamma &lt; 0) &#123; continue; &#125; // Interpolate z value, color, normal, texcoords, shadingcoords, viewpos float alpha_corrected = alpha / v[0].w(); float beta_corrected = beta / v[1].w(); float gamma_corrected = gamma / v[2].w(); float w_reciprocal = alpha_corrected + beta_corrected + gamma_corrected; auto z_interpolated = interpolate(alpha_corrected, beta_corrected, gamma_corrected, v[0].z(), v[1].z(), v[2].z(), w_reciprocal); auto color_interpolated = interpolate(alpha_corrected, beta_corrected, gamma_corrected, t.color[0], t.color[1], t.color[2], w_reciprocal); auto normal_interpolated = interpolate(alpha_corrected, beta_corrected, gamma_corrected, t.normal[0], t.normal[1], t.normal[2], w_reciprocal); auto texcoordes_interpolated = interpolate(alpha_corrected, beta_corrected, gamma_corrected, t.tex_coords[0], t.tex_coords[1], t.tex_coords[2], w_reciprocal); auto viewpos_interpolated = interpolate(alpha_corrected, beta_corrected, gamma_corrected, view_pos[0], view_pos[1], view_pos[2], w_reciprocal); // A lower z-value means it is displayed in front if (z_interpolated &lt; depth_buf[y * width + x]) &#123; depth_buf[y * width + x] = z_interpolated; fragment_shader_payload payload( color_interpolated, normal_interpolated, texcoordes_interpolated, texture ? &amp;*texture : nullptr ); payload.view_pos = viewpos_interpolated; auto pixel_color = fragment_shader(payload); set_pixel(Vector2i(x, y), pixel_color); &#125; &#125; &#125; &#125; phong å’Œ texturephong çš„ä»£ç æŒ‰ç€ phong æ¨¡å‹å®ç°å³å¯ã€‚texture çš„ä»£ç å‡ ä¹æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ã€‚ æˆ‘å”¯ä¸€å¥½å¥‡çš„åœ°æ–¹æ˜¯ä¸ºä»€ä¹ˆæœ«å°¾ä¹˜äº† 255.0fï¼Œéš¾é“å…‰ç…§æ¨¡å‹çš„å„ä¸ªæ•°å€¼å–å€¼éƒ½åœ¨ $(0,1)$ ä¹‹é—´ï¼Ÿä½†çœ‹å…‰å¼ºä¼¼ä¹åˆä¸æ˜¯è¿™æ ·ã€‚ Eigen::Vector3f phong_fragment_shader(const fragment_shader_payload&amp; payload) &#123; Eigen::Vector3f ka = Eigen::Vector3f(0.005, 0.005, 0.005); Eigen::Vector3f kd = payload.color; Eigen::Vector3f ks = Eigen::Vector3f(0.7937, 0.7937, 0.7937); auto l1 = light&#123;&#123;20, 20, 20&#125;, &#123;500, 500, 500&#125;&#125;; auto l2 = light&#123;&#123;-20, 20, 0&#125;, &#123;500, 500, 500&#125;&#125;; std::vector&lt;light> lights = &#123;l1, l2&#125;; Eigen::Vector3f amb_light_intensity&#123;10, 10, 10&#125;; Eigen::Vector3f eye_pos&#123;0, 0, 10&#125;; float p = 150; Eigen::Vector3f color = payload.color; Eigen::Vector3f point = payload.view_pos; Eigen::Vector3f normal = payload.normal; Eigen::Vector3f result_color = &#123;0, 0, 0&#125;; Eigen::Vector3f ambient = ka.cwiseProduct(amb_light_intensity); result_color += ambient; for (auto&amp; light : lights) &#123; // TODO: For each light source in the code, calculate what the *ambient*, *diffuse*, and *specular* // components are. Then, accumulate that result on the *result_color* object. Eigen::Vector3f vec_to_light = light.position - point; Eigen::Vector3f diffuse = kd.cwiseProduct(light.intensity / vec_to_light.squaredNorm()) * MAX(0, normal.normalized().dot(vec_to_light.normalized())); Eigen::Vector3f vec_to_eye = eye_pos - point; Eigen::Vector3f h = vec_to_light.normalized() + vec_to_eye.normalized(); Eigen::Vector3f specular = ks.cwiseProduct(light.intensity / vec_to_light.squaredNorm()) * pow(MAX(0, normal.normalized().dot(h.normalized())), p); // The ambient component is only added once before the for loop result_color += (diffuse + specular); &#125; return result_color * 255.f; &#125; Eigen::Vector3f texture_fragment_shader(const fragment_shader_payload&amp; payload) &#123; Eigen::Vector3f texture_color = &#123;0, 0, 0&#125;; if (payload.texture) &#123; // TODO: Get the texture value at the texture coordinates of the current fragment texture_color = payload.texture->getColor(payload.tex_coords.x(), payload.tex_coords.y()); &#125; Eigen::Vector3f ka = Eigen::Vector3f(0.005, 0.005, 0.005); Eigen::Vector3f kd = texture_color / 255.f; Eigen::Vector3f ks = Eigen::Vector3f(0.7937, 0.7937, 0.7937); auto l1 = light&#123;&#123;20, 20, 20&#125;, &#123;500, 500, 500&#125;&#125;; auto l2 = light&#123;&#123;-20, 20, 0&#125;, &#123;500, 500, 500&#125;&#125;; std::vector&lt;light> lights = &#123;l1, l2&#125;; Eigen::Vector3f amb_light_intensity&#123;10, 10, 10&#125;; Eigen::Vector3f eye_pos&#123;0, 0, 10&#125;; float p = 150; Eigen::Vector3f color = texture_color; Eigen::Vector3f point = payload.view_pos; Eigen::Vector3f normal = payload.normal; Eigen::Vector3f result_color = &#123;0, 0, 0&#125;; Eigen::Vector3f ambient = ka.cwiseProduct(amb_light_intensity); result_color += ambient; for (auto&amp; light : lights) &#123; // TODO: For each light source in the code, calculate what the *ambient*, *diffuse*, and *specular* // components are. Then, accumulate that result on the *result_color* object. Eigen::Vector3f vec_to_light = light.position - point; Eigen::Vector3f diffuse = kd.cwiseProduct(light.intensity / vec_to_light.squaredNorm()) * MAX(0.0f, normal.normalized().dot(vec_to_light.normalized())); Eigen::Vector3f vec_to_eye = eye_pos - point; Eigen::Vector3f h = vec_to_light.normalized() + vec_to_eye.normalized(); Eigen::Vector3f specular = ks.cwiseProduct(light.intensity / vec_to_light.squaredNorm()) * pow(MAX(0.0f, normal.normalized().dot(h.normalized())), p); // The ambient component is only added once before the for loop result_color += (diffuse + specular); &#125; return result_color * 255.f; &#125; bump å’Œ displacementå¦‚å¼€å¤´æ‰€è¨€ï¼Œæœ¬æ¬¡ä½œä¸šå¯¹è¿™ä¸¤ä¸ª shader çš„è¦æ±‚éå¸¸ä¸ä¸¥è°¨ï¼Œæˆ‘ä»¬å°±ç®€å•æ”¾ä¸‹ä»£ç ï¼Œä¸å¤šè§£é‡Šäº†ã€‚åœ¨ä¸€äº›ä¸ä¸¥è°¨çš„åœ°æ–¹æˆ‘å·²ç»å†™äº†æ³¨é‡Šã€‚ Eigen::Vector3f bump_fragment_shader(const fragment_shader_payload&amp; payload) &#123; Eigen::Vector3f ka = Eigen::Vector3f(0.005, 0.005, 0.005); Eigen::Vector3f kd = payload.color; Eigen::Vector3f ks = Eigen::Vector3f(0.7937, 0.7937, 0.7937); auto l1 = light&#123;&#123;20, 20, 20&#125;, &#123;500, 500, 500&#125;&#125;; auto l2 = light&#123;&#123;-20, 20, 0&#125;, &#123;500, 500, 500&#125;&#125;; std::vector&lt;light> lights = &#123;l1, l2&#125;; Eigen::Vector3f amb_light_intensity&#123;10, 10, 10&#125;; Eigen::Vector3f eye_pos&#123;0, 0, 10&#125;; float p = 150; Eigen::Vector3f color = payload.color; Eigen::Vector3f point = payload.view_pos; Eigen::Vector3f normal = payload.normal; float kh = 0.2, kn = 0.1; // TODO: Implement bump mapping here // Let n = normal = (x, y, z) // Vector t = (x*y/sqrt(x*x+z*z),sqrt(x*x+z*z),z*y/sqrt(x*x+z*z)) // Vector b = n cross product t // Matrix TBN = [t b n] // dU = kh * kn * (h(u+1/w,v)-h(u,v)) // dV = kh * kn * (h(u,v+1/h)-h(u,v)) // Vector ln = (-dU, -dV, 1) // Normal n = normalize(TBN * ln) // Note: The formula is WRONG in theory // To calculate the TBN matrix correctly, we need the triangle's vertices and their corresponding UV coordinates // read https://learnopengl.com/Advanced-Lighting/Normal-Mapping and // https://terathon.com/blog/tangent-space.html for more details float x = normal.x(); float y = normal.y(); float z = normal.z(); float u = payload.tex_coords.x(); float v = payload.tex_coords.y(); float w = payload.texture->width; float h = payload.texture->height; Eigen::Vector3f t = Eigen::Vector3f(x*y/sqrt(x*x+z*z),sqrt(x*x+z*z),z*y/sqrt(x*x+z*z)); Eigen::Vector3f b = normal.cross(t); Eigen::Matrix3f TBN; TBN &lt;&lt; t, b, normal; // In theory the texture should be a grayscale image // However we use an ordinary RGB image here, so we take norm // read https://games-cn.org/forums/topic/frequently-asked-questionskeep-updating/ for more details float dU = kh * kn * (payload.texture->getColor(u+1.0f/w, v).norm() - payload.texture->getColor(u, v).norm()); float dV = kh * kn * (payload.texture->getColor(u, v+1.0f/h).norm() - payload.texture->getColor(u, v).norm()); Eigen::Vector3f ln = Eigen::Vector3f(-dU, -dV, 1); normal = (TBN * ln).normalized(); Eigen::Vector3f result_color = &#123;0, 0, 0&#125;; result_color = normal; return result_color * 255.f; &#125; Eigen::Vector3f displacement_fragment_shader(const fragment_shader_payload&amp; payload) &#123; Eigen::Vector3f ka = Eigen::Vector3f(0.005, 0.005, 0.005); Eigen::Vector3f kd = payload.color; Eigen::Vector3f ks = Eigen::Vector3f(0.7937, 0.7937, 0.7937); auto l1 = light&#123;&#123;20, 20, 20&#125;, &#123;500, 500, 500&#125;&#125;; auto l2 = light&#123;&#123;-20, 20, 0&#125;, &#123;500, 500, 500&#125;&#125;; std::vector&lt;light> lights = &#123;l1, l2&#125;; Eigen::Vector3f amb_light_intensity&#123;10, 10, 10&#125;; Eigen::Vector3f eye_pos&#123;0, 0, 10&#125;; float p = 150; Eigen::Vector3f color = payload.color; Eigen::Vector3f point = payload.view_pos; Eigen::Vector3f normal = payload.normal; float kh = 0.2, kn = 0.1; // TODO: Implement displacement mapping here // Let n = normal = (x, y, z) // Vector t = (x*y/sqrt(x*x+z*z),sqrt(x*x+z*z),z*y/sqrt(x*x+z*z)) // Vector b = n cross product t // Matrix TBN = [t b n] // dU = kh * kn * (h(u+1/w,v)-h(u,v)) // dV = kh * kn * (h(u,v+1/h)-h(u,v)) // Vector ln = (-dU, -dV, 1) // Position p = p + kn * n * h(u,v) // Normal n = normalize(TBN * ln) // Note: The formula is WRONG in theory // When using Displacement Mapping, the points should be offset in the camera space before rasterizing, // instead of only changing its color // read https://learnopengl.com/Advanced-Lighting/Normal-Mapping and // https://terathon.com/blog/tangent-space.html for more details float x = normal.x(); float y = normal.y(); float z = normal.z(); float u = payload.tex_coords.x(); float v = payload.tex_coords.y(); float w = payload.texture->width; float h = payload.texture->height; Eigen::Vector3f t = Eigen::Vector3f(x*y/sqrt(x*x+z*z),sqrt(x*x+z*z),z*y/sqrt(x*x+z*z)); Eigen::Vector3f b = normal.cross(t); Eigen::Matrix3f TBN; TBN &lt;&lt; t, b, normal; // In theory the texture should be a grayscale image // However we use an ordinary RGB image here, so we take norm // read https://games-cn.org/forums/topic/frequently-asked-questionskeep-updating/ for more details float dU = kh * kn * (payload.texture->getColor(u+1.0f/w, v).norm() - payload.texture->getColor(u, v).norm()); float dV = kh * kn * (payload.texture->getColor(u, v+1.0f/h).norm() - payload.texture->getColor(u, v).norm()); Eigen::Vector3f ln = Eigen::Vector3f(-dU, -dV, 1); // In theory we should bias the point using the original normal // but to match the homework answer, we bias the point using the corrected normal normal = (TBN * ln).normalized(); point += kn * normal * payload.texture->getColor(u, v).norm(); Eigen::Vector3f result_color = &#123;0, 0, 0&#125;; Eigen::Vector3f ambient = ka.cwiseProduct(amb_light_intensity); result_color += ambient; for (auto&amp; light : lights) &#123; // TODO: For each light source in the code, calculate what the *ambient*, *diffuse*, and *specular* // components are. Then, accumulate that result on the *result_color* object. Eigen::Vector3f vec_to_light = light.position - point; Eigen::Vector3f diffuse = kd.cwiseProduct(light.intensity / vec_to_light.squaredNorm()) * MAX(0.0f, normal.normalized().dot(vec_to_light.normalized())); Eigen::Vector3f vec_to_eye = eye_pos - point; Eigen::Vector3f h = vec_to_light.normalized() + vec_to_eye.normalized(); Eigen::Vector3f specular = ks.cwiseProduct(light.intensity / vec_to_light.squaredNorm()) * pow(MAX(0.0f, normal.normalized().dot(h.normalized())), p); // The ambient component is only added once before the for loop result_color += (diffuse + specular); &#125; return result_color * 255.f; &#125;","categories":[{"name":"å…¬å¼€è¯¾","slug":"å…¬å¼€è¯¾","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/"},{"name":"GAMES101","slug":"å…¬å¼€è¯¾/GAMES101","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/"},{"name":"Assignments","slug":"å…¬å¼€è¯¾/GAMES101/Assignments","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/Assignments/"}],"tags":[]},{"title":"Assignment 2 Rasterizing","slug":"learning/open-course/GAMES101/Hw/Hw2-rasterizing","date":"2025-08-26T12:15:16.000Z","updated":"2025-08-26T12:21:11.482Z","comments":true,"path":"wiki/learning/open-course/GAMES101/Hw/Hw2-rasterizing/","permalink":"http://rinevard.github.io/wiki/learning/open-course/GAMES101/Hw/Hw2-rasterizing/","excerpt":"","text":"æœ¬æ¬¡ä½œä¸šè¦æ±‚æˆ‘ä»¬å®ç° Z-buffer ã€æ …æ ¼åŒ–å’Œ SSAAï¼ˆä¹Ÿå°±æ˜¯è¶…é‡‡æ ·ï¼‰ã€‚æˆ‘ä»¬å…ˆçœ‹çœ‹å‰ä¸¤ä¸ªä¸œè¥¿ï¼Œå†çœ‹çœ‹ SSAAã€‚ Z-bufferå’Œæ …æ ¼åŒ–ä»£ç æ¡†æ¶æˆ‘ä»¬è¦è¡¥å…¨çš„ rasterize_triangle å‡½æ•°åœ¨ draw å‡½æ•°å†…è¢«è°ƒç”¨ï¼Œå¯ä»¥çœ‹åˆ° draw å‡½æ•°å·²ç»åšå¥½äº†ä¸‰è§’å½¢çš„æŠ•å½±å˜æ¢ï¼Œæˆ‘ä»¬åªè¦æŠŠ $[0, \\text{width}] \\times [0,\\text{height}] \\times [n,f]$ é‡Œçš„ä¸‰è§’å½¢æ¸²æŸ“åˆ°å±å¹•ä¸Šå°±å¥½ã€‚è¾“å…¥çš„ä¸‰è§’å½¢å¤§æ¦‚å½¢å¦‚è¿™æ ·ï¼š -------input triangle--------- 529.259 350 49.3857 1 -- 350 529.259 49.3857 1 -- 170.741 350 49.3857 1 -- ----------------------------- insideTriangle å‡½æ•°ç”¨è¯¾ä¸Šè®²çš„å‰ä¹˜æ³•åˆ¤æ–­ç‚¹æ˜¯å¦åœ¨ä¸‰è§’å½¢å†…ã€‚â€œåœ¨ä¸‰è§’å½¢å†…â€è¿™ä¸ªè¯´æ³•ä¹Ÿä¸æ˜¯ç‰¹åˆ«ä¸¥è°¨ï¼Œæ›´å‡†ç¡®åœ°è¯´åº”è¯¥æ˜¯åˆ¤æ–­ä¸‰è§’å½¢åœ¨å±å¹•ä¸Šçš„äºŒç»´æŠ•å½±æ˜¯å¦åŒ…å«è¿™ä¸ªç‚¹ã€‚ /* Return whether (x, y) is in the triangle, ignoring its z value. */ static bool insideTriangle(float x, float y, const std::array&lt;Vector4f, 3>&amp; triangle) &#123; Vector2f point1 = &#123;triangle[0].x(), triangle[0].y()&#125;; Vector2f point2 = &#123;triangle[1].x(), triangle[1].y()&#125;; Vector2f point3 = &#123;triangle[2].x(), triangle[2].y()&#125;; Vector2f checked_point = &#123;x, y&#125;; auto cross_product = [](const Vector2f&amp; v1, const Vector2f&amp; v2) &#123; return v1.x() * v2.y() - v1.y() * v2.x(); &#125;; float side1 = cross_product(point1 - checked_point, point1 - point2); float side2 = cross_product(point2 - checked_point, point2 - point3); float side3 = cross_product(point3 - checked_point, point3 - point1); return (side1 > 0 &amp;&amp; side2 > 0 &amp;&amp; side3 > 0) || (side1 &lt; 0 &amp;&amp; side2 &lt; 0 &amp;&amp; side3 &lt; 0); &#125; rasterize_triangle å‡½æ•°è¿™ä¸ªå®ç°å¥½åƒæ²¡ä»€ä¹ˆç‰¹åˆ«å€¼å¾—è¯´çš„åœ°æ–¹ï¼Œç®€ç®€å•å•é‡‡é‡‡æ ·ï¼Œç„¶åç”¨ depth_buf å®ç° z-buffer å°±å¥½ã€‚ //Screen space rasterization void rst::rasterizer::rasterize_triangle(const Triangle&amp; t) &#123; auto v = t.toVector4(); // Find bounding box float left = v[0].x(); float right = v[0].x(); float bottom = v[0].y(); float top = v[0].y(); for (auto&amp; vec: v) &#123; left = std::min(left, vec.x()); right = std::max(right, vec.x()); bottom = std::min(bottom, vec.y()); top = std::max(top, vec.y()); &#125; // Update pixels in bounding box for (int x = static_cast&lt;int>(left); x &lt;= static_cast&lt;int>(right) + 1; x++) &#123; for (int y = static_cast&lt;int>(bottom); y &lt;= static_cast&lt;int>(top) + 1; y++) &#123; if (!insideTriangle(x+0.5, y+0.5, v)) &#123; continue; &#125; // Interpolate z value auto[alpha, beta, gamma] = computeBarycentric2D(x+0.5, y+0.5, t.v); float w_reciprocal = 1.0/(alpha / v[0].w() + beta / v[1].w() + gamma / v[2].w()); float z_interpolated = alpha * v[0].z() / v[0].w() + beta * v[1].z() / v[1].w() + gamma * v[2].z() / v[2].w(); z_interpolated *= w_reciprocal; // A lower z-value means it is displayed in front if (z_interpolated &lt; depth_buf[y * width + x]) &#123; depth_buf[y * width + x] = z_interpolated; set_pixel(Vector3f(x, y, z_interpolated), t.getColor()); &#125; &#125; &#125; &#125; SSAAçš„å®ç°SSAA çš„å®ç°ç›¸è¾ƒè€Œè¨€æ›´å›°éš¾ä¸€äº›ï¼Œç”±äºæ‚ä¸ƒæ‚å…«è¦æ”¹çš„åœ°æ–¹æ¯”è¾ƒå¤šï¼Œæˆ‘å°±å…ˆè¯´ä¸‹å¤§è‡´æ€è·¯ï¼Œå†èŠèŠå’±è¸©çš„ä¸¤ä¸ªå‘ã€‚ ä¸è¿‡åœ¨æ­¤ä¹‹å‰ï¼Œå…ˆæ¥çœ‹çœ‹æˆ‘ä»¬çš„æˆæœå§ï¼ï¼ˆè¿™æ˜¯åŠ¨å›¾ å¤§è‡´æ€è·¯æˆ‘ä»¬è¦å…ˆæŠŠæ‰€æœ‰å†…å®¹æ¸²æŸ“åˆ°å¤§å°ä¸º $(\\text{width} * 2, \\text{height} * 2)$ çš„è‡ªå®šä¹‰ buffer é‡Œï¼Œå†æ ¹æ®è‡ªå®šä¹‰ buffer çš„å†…å®¹å¡«å……å±å¹•ä¸Šçš„åƒç´ ã€‚ è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬ä¸èƒ½ç›´æ¥åœ¨ rasterize_triangle é‡ŒæŠŠä¸‰è§’å½¢ç”»åˆ°å±å¹•ä¸Šï¼ˆå…·ä½“åŸå› è§â€œè¸©å‘1â€é‚£ä¸€èŠ‚ï¼‰ï¼Œè€Œæ˜¯è¦åœ¨ rasterize_triangle ä¸­æŠŠä¸‰è§’å½¢ç”»åˆ°è‡ªå®šä¹‰çš„ buffer é‡Œï¼Œå†æ–°å¢ä¸€ä¸ª resolve å‡½æ•°å¹¶æŠŠå®ƒæ”¾åˆ° draw çš„æœ€åï¼Œä»è€ŒæŠŠè‡ªå®šä¹‰ buffer é‡Œçš„å†…å®¹ç”»åˆ°å±å¹•ä¸Šï¼š void rst::rasterizer::resolve() &#123; for (int y = 0; y &lt; height; y++) &#123; for (int x = 0; x &lt; width; x++) &#123; frame_buf[y * width + x] = Vector3f::Zero(); for (int i = 0; i &lt; 4; i++) &#123; frame_buf[y * width + x] += ssaa_frame_buf[(y * width + x) * 4 + i]; &#125; frame_buf[y * width + x] /= 4.0; &#125; &#125; &#125; æ›´ç»†èŠ‚ä¸€äº›çš„è¯ï¼Œæˆ‘ä»¬éœ€è¦åšè¿™äº›å·¥ä½œï¼š åœ¨ rasterizer.hpp é‡ŒåŠ å…¥ ssaa_frame_buf å’Œ resolve çš„å®šä¹‰ã€‚ ä¿®æ”¹ rasterizer çš„åˆå§‹åŒ–å‡½æ•°å’Œ clear å‡½æ•°ï¼Œæ­£ç¡®åˆå§‹åŒ–å’Œé‡ç½® ssaa_frame_bufã€‚ ä¿®æ”¹ set_pixel å‡½æ•°ï¼Œè®©å®ƒæŠŠå†…å®¹ç”»åˆ° ssaa_frame_buf é‡Œï¼Œè€Œé frame_buf é‡Œã€‚ ä¿®æ”¹ rasterize_triangleï¼Œè®©å®ƒç”¨ä½¿ç”¨æ›´é«˜çš„é‡‡æ ·ç‡ã€‚ å®ç° resolve å‡½æ•°ã€‚ æ‚ä¸ƒæ‚å…«è¦æ”¹çš„åœ°æ–¹æ¯”è¾ƒå¤šï¼Œè¿™é‡Œå°±ä¸æ”¾æ›´å¤šä»£ç äº†ã€‚ è¸©å‘1SSAAã€filtering éƒ½å»ºç«‹åœ¨â€œæˆ‘ä»¬å¯¹ç†æƒ³å›¾åƒè¿›è¡Œæ»¤æ³¢â€çš„åŸºç¡€ä¸Šã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¦å…ˆæŠŠä¸–ç•Œé‡Œçš„å¯¹è±¡æŒ‰æ­£ç¡®çš„å‰åé¡ºåºå˜ä¸ºä¸€ä¸ªäºŒç»´å›¾åƒï¼Œç„¶åå†æ»¤æ³¢ã€‚æ‰€ä»¥ç›´æ¥åœ¨ rasterize_triangle é‡ŒæŠŠåƒç´ åˆ’åˆ†æˆå­åƒç´ ç„¶åå–å¹³å‡å¹¶ä¸èƒ½å®ç° SSAAï¼Œè€Œæ˜¯ä¼šåœ¨ä¸‰è§’å½¢é‡å çš„åœ°æ–¹æ˜¾ç¤ºå‡ºé»‘è¾¹ã€‚ è®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªå…·ä½“ä¾‹å­ã€‚è€ƒè™‘ä¸€ä¸ª 1/4 è¢«ç»¿è‰²ä¸‰è§’å½¢å æ®ã€3/4 è¢«è“è‰²ä¸‰è§’å½¢å æ®çš„åƒç´ ï¼ŒSSAA ä¼šæŠŠ 1/4 ç»¿ + 3/4 è“ ä½œä¸ºè¿™ä¸ªåƒç´ çš„é¢œè‰²ã€‚ è€Œå¦‚æœç›´æ¥åœ¨ rasterize_triangle é‡ŒæŠŠåƒç´ åˆ’åˆ†æˆå­åƒç´ ç„¶åå–å¹³å‡ï¼Œé‚£ä¹ˆæ …æ ¼åŒ–è“è‰²ä¸‰è§’å½¢æ—¶ï¼Œè¿™ä¸ªåƒç´ è¢«å½“æˆ 3/4 è“ï¼›æ …æ ¼åŒ–ç»¿è‰²ä¸‰è§’å½¢æ—¶ï¼Œè¿™ä¸ªåƒç´ è¢«å½“æˆ 1/4 ç»¿ã€‚æ— è®ºè°åœ¨å‰é¢ï¼Œæœ€ç»ˆç»“æœè¦ä¹ˆæ˜¯ 3/4 è“ï¼Œè¦ä¹ˆæ˜¯ 1/4 ç»¿ï¼Œæ€»ä¸ SSAA çš„ç»“æœ 1/4 ç»¿ + 3/4 è“ ä¸åŒã€‚ è¸©å‘2insideTriangle çš„å‚æ•° x å’Œ y çš„ç±»å‹åŸæœ¬æ˜¯ intï¼Œè€Œåœ¨ SSAA é‡Œæˆ‘ä»¬æŠŠåƒç´ åˆ’åˆ†æˆäº†å››ä¸ªå­åƒç´ ï¼Œè¿™äº›å­åƒç´ çš„åæ ‡å¤§å¤šä¸æ˜¯æ•´æ•°ã€‚å› æ­¤æˆ‘ä»¬è¦æŠŠ insideTriangle çš„ x å’Œ y çš„ç±»å‹æ”¹æˆ float. static bool insideTriangle(int x, int y, const Vector3f* _v) &#123; // TODO : Implement this function to check if the point (x, y) is inside the triangle represented by _v[0], _v[1], _v[2] &#125;","categories":[{"name":"å…¬å¼€è¯¾","slug":"å…¬å¼€è¯¾","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/"},{"name":"GAMES101","slug":"å…¬å¼€è¯¾/GAMES101","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/"},{"name":"Assignments","slug":"å…¬å¼€è¯¾/GAMES101/Assignments","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/Assignments/"}],"tags":[]},{"title":"Note 2 Rasterizing","slug":"learning/open-course/GAMES101/Notes/Note2-Rasterizing","date":"2025-08-25T08:10:28.000Z","updated":"2025-09-23T07:19:39.089Z","comments":true,"path":"wiki/learning/open-course/GAMES101/Notes/Note2-Rasterizing/","permalink":"http://rinevard.github.io/wiki/learning/open-course/GAMES101/Notes/Note2-Rasterizing/","excerpt":"","text":"åœ¨ Transformation éƒ¨åˆ†ï¼Œæˆ‘ä»¬å·²ç»å¯ä»¥æŠŠä¸€ä¸ªä¸‰ç»´ç©ºé—´é‡Œçš„ä¸‰è§’å½¢æŠ•å½±åˆ°å¹³é¢ä¸Šã€‚ä½†æ€ä¹ˆæŠŠä¸€ä¸ªçº¯è‰²ä¸‰è§’å½¢ç»˜åˆ¶åˆ°å±å¹•ä¸Šå‘¢ï¼Ÿæˆ‘ä»¬çŸ¥é“å±å¹•ç”±å¤§é‡çš„åƒç´ ç‚¹ç»„æˆï¼Œé‚£ä¹ˆæ€ä¹ˆç¡®å®šæ¯ä¸ªåƒç´ ç‚¹æ˜¯ä»€ä¹ˆé¢œè‰²å‘¢ï¼Ÿ æˆ‘ä»¬é€šè¿‡é‡‡æ ·ç»™æ¯ä¸ªåƒç´ ç‚¹æ¶‚ä¸Šé¢œè‰²ã€‚æˆ‘ä»¬å¯ä»¥æ£€æŸ¥æ¯ä¸ªåƒç´ çš„ä¸­å¿ƒç‚¹æ˜¯å¦åœ¨è¿™ä¸ªä¸‰è§’å½¢å†…éƒ¨ï¼Œå¦‚æœåœ¨åˆ™æ¶‚ä¸Šä¸‰è§’å½¢çš„é¢œè‰²ã€‚è™½ç„¶è¿™æ ·ç»˜åˆ¶çš„ä¸‰è§’å½¢ä¼šæœ‰é”¯é½¿ï¼Œæ•ˆæœä¸€èˆ¬ï¼Œä½†åŸºæœ¬æ€æƒ³å°±æ˜¯è¿™æ ·ã€‚ é‚£ä¹ˆå¦‚æœæœ‰å¤šä¸ªä¸‰è§’å½¢ï¼Œè€Œä¸”ä»–ä»¬ä¹‹é—´æœ‰é®æŒ¡å…³ç³»å‘¢ï¼Ÿè¿™å°±éœ€è¦ Z-Buffer å‡ºåœºäº†ã€‚ Z-BufferZ-Buffer çš„ç®—æ³•å¦‚ä¸‹é¢çš„ä¼ªä»£ç æ‰€ç¤ºã€‚æ€è·¯æ˜¯å¯¹æ¯ä¸ªåƒç´ æ‰€åœ¨çš„æ‰€æœ‰ä¸‰è§’å½¢ï¼Œå– z å€¼æœ€å°çš„ä¸‰è§’å½¢çš„é¢œè‰²ä½œä¸ºè¿™ä¸ªåƒç´ çš„é¢œè‰²ã€‚ foreach (Triangle triangle in triangles) &#123; foreach (Vector3 sample in triangle.GetSamples()) &#123; // z å€¼è¶Šå°æ˜¾ç¤ºè¶Šé å‰ if (sample.z &lt; zBuffer[sample.x, sample.y]) &#123; frameBuffer[sample.x, sample.y] = sample.rgb; zBuffer[sample.x, sample.y] = sample.z; &#125; &#125; &#125; è¿™ä¹Ÿæœ‰è‰¯å¥½çš„å¹¶è¡Œæ€§ï¼Œå› ä¸ºä¸‰è§’å½¢çš„éå†é¡ºåºå’Œæœ€ç»ˆç»“æœæ— å…³ï¼Œåƒç´ çš„ç»˜åˆ¶é¡ºåºä¹Ÿå’Œæœ€ç»ˆç»“æœæ— å…³ã€‚ è™ä¹¦è¿˜æåˆ°æˆ‘ä»¬ä¼šå°† $z$ å€¼æ˜ å°„åˆ° $[0, B-1]$ï¼Œç”¨æ•´æ•°å­˜å‚¨ $z$ å€¼ï¼Œä½†å…¶å®è¿™æ˜¯ç°åœ¨ä¸å†ä½¿ç”¨çš„æ–¹æ³•ï¼Œæˆ‘ä»¬ç°åœ¨é€šå¸¸ä½¿ç”¨ 24 ä½æˆ– 32 ä½çš„æµ®ç‚¹æ•°æ¥å­˜å‚¨æ·±åº¦å€¼ã€‚ï¼ˆæ€ªä¸å¾—æˆ‘æŸ¥äº†å¥½ä¹…èµ„æ–™éƒ½æ²¡æŸ¥åˆ°â€œæ•´æ•°æ˜ å°„â€çš„å…·ä½“ä»£ç ï¼ŒåŸæ¥æ—©å°±ä¸ç”¨äº†ï¼ï¼ï¼ï¼‰ èµ°æ ·ç°è±¡æˆ‘ä»¬ä¹‹å‰è¯´è¿‡ï¼Œç®€å•çš„é‡‡æ ·ä¼šå‡ºç°é”¯é½¿ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ é”¯é½¿ã€æ‘©å°”çº¹ä¹‹ç±»çš„é‡‡æ ·å›¾åƒä¸åŸå›¾ä¸ç¬¦çš„ç°è±¡è¢«ç»Ÿç§°ä¸ºèµ°æ ·ï¼ˆAliasingï¼‰ç°è±¡ï¼Œèµ°æ ·çš„å®è´¨æ˜¯åŸå›¾çš„é«˜é¢‘ä¿¡å·è¢«é”™è¯¯é‡‡æ ·ã€‚ä¸ºäº†æ˜ç¡®ä»€ä¹ˆæ˜¯â€é«˜é¢‘ä¿¡å·â€å¹¶æ‰¾åˆ°ç¼“è§£èµ°æ ·ç°è±¡çš„æ–¹æ³•ï¼Œæˆ‘ä»¬å…ˆçœ‹çœ‹ä¸€äº›æ•°å­¦çŸ¥è¯†ã€‚ æ•°å­¦çŸ¥è¯†ä¸ºäº†ä¸è®©æ–‡ç« å¤ªé•¿ï¼Œè¿™é‡Œæˆ‘ä»¬çœç•¥æ‰€æœ‰çš„è¯æ˜ã€‚ä¸è¿‡æ‰€æœ‰çš„è¯æ˜éƒ½å¹¶ä¸å›°éš¾ï¼Œæœ‰ç©ºçš„è¯å¯ä»¥è‡ªå·±è¯ä¸€ä¸‹è¯•è¯•ã€‚åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ä»¬ä¼šé—®ï¼šè¿™äº›æ•°å­¦çŸ¥è¯†æœ‰ç”¨å—ï¼Ÿ In a word, mostly no, sometimes yes, and occasionally, maybe.â€” https://www.dgp.toronto.edu/public_user/elf/2522/sampling.pdf å·ç§¯æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ä¸‰ç§å·ç§¯â€”â€”ç¦»æ•£-ç¦»æ•£å·ç§¯ã€è¿ç»­-è¿ç»­å·ç§¯ã€ç¦»æ•£-è¿ç»­å·ç§¯ã€‚ä¸‹é¢çš„ $f_{\\rightarrow t}$ è¡¨ç¤ºå°†å‡½æ•° $f$ å‘å³å¹³ç§» $t$ é•¿åº¦å¾—åˆ°çš„æ–°å‡½æ•°ï¼š ç¦»æ•£-ç¦»æ•£å·ç§¯ \\begin{align*} &(a*b)[i]= \\sum_{j}a[j]b[i-j] \\\\ &(a*b)=\\sum_{j}a[j]b_{\\rightarrow j} \\end{align*}è¿ç»­-è¿ç»­å·ç§¯ \\begin{align*} &(f*g)(x)=\\int_{-\\infty}^{\\infty} f(t)g(x-t)dt \\\\ &(f*g)=\\int_{-\\infty}^{\\infty} f(t)g_{\\rightarrow t}dt \\end{align*}ç¦»æ•£-è¿ç»­å·ç§¯ \\begin{align*} &(a*f)(x)=\\sum_{i}a[i] f(x-i) \\\\ &(a*f)=\\sum_{i}a[i]f_{\\rightarrow i} \\end{align*}æˆ‘ä»¬ä¼šæ³¨æ„åˆ°ï¼Œå·ç§¯å¯ä»¥è¡¨ç¤ºä¸ºå‡½æ•°å¹³ç§»åçš„åŠ æƒå’Œã€‚ å·ç§¯æ˜¯è¿‡ä¼šå„¿ä¼šç”¨åˆ°çš„å¦™å¦™å°å·¥å…·ã€‚ å‚…é‡Œå¶çº§æ•°å’Œå‚…é‡Œå¶å˜æ¢æˆ‘ä»¬ä¹‹å‰æåˆ°ï¼Œèµ°æ ·çš„å®è´¨æ˜¯åŸå›¾çš„é«˜é¢‘ä¿¡å·è¢«é”™è¯¯é‡‡æ ·ã€‚å›¾åƒä½œä¸ºä¸€ä¸ª $R^2\\rightarrow \\text{RGBA}$çš„å‡½æ•°ï¼Œæ€ä¹ˆä¼šæœ‰é«˜é¢‘å’Œä½é¢‘ä¹‹åˆ†å‘¢ï¼Ÿuh actuallyâ˜ï¸ğŸ¤“ æˆ‘ä»¬å¤„ç†çš„ç»å¤§å¤šæ•°å‡½æ•°éƒ½æœ‰é¢‘åŸŸï¼Œè¿™ä¸ªé¢‘åŸŸå¯ä»¥é€šè¿‡å‚…é‡Œå¶å˜æ¢å¾—åˆ°ã€‚ å…ˆå›é¡¾ä¸€ä¸‹å‚…é‡Œå¶çº§æ•°ã€‚ç†ŸçŸ¥åœ¨ $[-\\frac{T}{2},\\frac{T}{2}]$ å†…ï¼Œå‡½æ•° $f(x)$ å¯ä»¥è¡¨ç¤ºä¸º f(x)=\\sum_{n=-\\infty}^{\\infty}c_n e^{inw_0 x}å…¶ä¸­ \\begin{align*} &c_n=\\frac{1}{T}\\int_{-\\frac{T}{2}}^{\\frac{T}{2}} f(t)e^{-inw_0t}dt \\\\ &w_0=\\frac{2\\pi}{T} \\end{align*}è¿™æœ¬è´¨ä¸Šæ˜¯å‡½æ•°åœ¨é—­åŒºé—´å†…çš„æ­£äº¤åŸºå±•å¼€ï¼Œè¿™ä¸ªå±•å¼€çš„å‘¨æœŸä¸º $T$. å½“ $T \\rightarrow \\infty$ æ—¶ï¼Œä»¤ $w_n=nw_0$ï¼Œ$\\Delta w=w_n-w_{n-1}=w_0$ å†ç»“åˆç§¯åˆ†çš„å®šä¹‰ï¼Œæˆ‘ä»¬å°±èƒ½ï¼ˆä¸å¤ªä¸¥è°¨åœ°ï¼‰æ±‚å‡º f(x)=\\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty}\\bigg(\\int_{-\\infty}^{\\infty}f(t)e^{-iwt}dt \\bigg)e^{iwx}dwæˆ‘ä»¬å¯ä»¥ä»¤ $u=\\frac{w}{2\\pi}$ ä»è€Œå»æ‰ç§¯åˆ†å¤–é¢çš„é‚£ä¸ªç³»æ•° f(x)=\\int_{-\\infty}^{\\infty}\\bigg(\\int_{-\\infty}^{\\infty}f(t)e^{-2\\pi iut}dt \\bigg)e^{2\\pi iux}duè€Œ $e^{2\\pi iux}$ çš„ç³»æ•° \\hat f(u)=\\int_{-\\infty}^{\\infty}f(t)e^{-2\\pi iut}dtå°±æ˜¯ $f$ çš„å‚…é‡Œå¶å˜æ¢äº†ï¼Œå®ƒä¹Ÿè®°ä½œ $\\mathcal{F}(f)$. æŠŠ $\\hat f$ ä»£å…¥å°±å¾—åˆ°äº†é€†å‚…é‡Œå¶å˜æ¢ f(x)=\\int_{-\\infty}^{\\infty}\\hat f(u)e^{2\\pi iux}dué€†å‚…é‡Œå¶å˜æ¢æŠŠå‡½æ•°å˜æˆäº†ä¸åŒé¢‘ç‡çš„ä¸‰è§’å‡½æ•°çš„ç§¯åˆ†/æ±‚å’Œï¼Œè¿™å°±æ˜¯æˆ‘ä»¬ä¹‹å‰æ‰€è¯´çš„â€œé«˜é¢‘ä¿¡å·â€å’Œâ€œä½é¢‘ä¿¡å·â€çš„å«ä¹‰ã€‚ä¹‹åæˆ‘ä»¬ä¼šä»‹ç»é‡‡æ ·å¯¼è‡´é«˜é¢‘ä¿¡å·ä¸¢å¤±çš„åŸå› ï¼Œä¸è¿‡åœ¨æ­¤ä¹‹å‰æˆ‘ä»¬å…ˆçœ‹çœ‹å‚…é‡Œå¶å˜æ¢çš„ä¸€äº›æ€§è´¨ã€‚ å‚…é‡Œå¶å˜æ¢çš„æ€§è´¨æˆ‘ä»¬åˆ—ä¸¾å‚…é‡Œå¶å˜æ¢çš„å‡ ä¸ªå¸¸ç”¨çš„æ€§è´¨ã€‚ å¦‚æœ $f$ æ˜¯å®å‡½æ•°ï¼Œ$\\hat f$ æ˜¯å¶å‡½æ•°ã€‚ å‡½æ•°å’Œå‚…é‡Œå¶å˜æ¢çš„å¹³æ–¹ç§¯åˆ†ç›¸ç­‰ \\int (f(x))^2dx=\\int (\\hat f(u))^2du åŸå‡½æ•°æ‹‰é•¿ï¼Œå‚…é‡Œå¶å˜æ¢æ”¶ç´§ \\mathcal{F}(f(x/b))=b\\hat f(bu) ç‹„æ‹‰å…‹è„‰å†²å‡½æ•°å’Œå†²æ¿€ä¸²ç‹„æ‹‰å…‹è„‰å†²å‡½æ•°çš„å®šä¹‰å¦‚ä¸‹ï¼š \\delta(t) = \\begin{cases} \\infty, & t = 0 \\\\ 0, & t \\neq 0 \\end{cases}æˆ‘ä»¬å¯ä»¥æŠŠè¿ç»­ä¿¡å·çš„å‡åŒ€é—´éš”é‡‡æ ·è¡¨ç¤ºä¸ºå†²æ¿€ä¸² s_T(x) = \\sum_{n=-\\infty}^{\\infty}\\delta(x-nT)ä¸åŸå‡½æ•° $f$ çš„ä¹˜ç§¯ï¼Œè¿™é‡Œçš„ $T$ è¡¨ç¤ºä¸¤ä¸ªé‡‡æ ·ç‚¹ä¹‹é—´çš„é—´éš”ã€‚ $s_T$ çš„å‚…é‡Œå¶å˜æ¢ä¸º \\hat s_T(u)=\\frac{1}{T}\\sum_{n=-\\infty}^{\\infty}\\delta(u-\\frac{n}{T})å®ƒä»ç„¶æ˜¯ä¸€ç³»åˆ—ç‹„æ‹‰å…‹å‡½æ•°çš„å’Œã€‚ å·ç§¯å®šç†ä¹‹å‰è¯´è¿‡ï¼Œå°† $s_T$ å’ŒåŸå‡½æ•° $f$ ç›¸ä¹˜èƒ½è·å¾—è®¸å¤šé‡è¦çš„é‡‡æ ·æ€§è´¨ï¼Œæˆ‘ä»¬å¾ˆå¿«å°±ä¼šè®¨è®ºä»–ä»¬äº†ï¼Œåœ¨æ­¤ä¹‹å‰æˆ‘ä»¬è¿˜è¦è¡¥å……æœ€åä¸€ä¸ªçŸ¥è¯†â€”â€”å·ç§¯å®šç†ã€‚ \\begin{align*} &\\mathcal{F}(f * g) =\\hat f\\hat g \\\\ &\\mathcal{F}(fg)=\\hat f * \\hat g \\end{align*}è¿™å°±æ˜¯è¯´ï¼Œæ—¶åŸŸçš„å·ç§¯å¯¹åº”é¢‘åŸŸçš„ä¹˜ç§¯ï¼Œé¢‘åŸŸçš„ä¹˜ç§¯å¯¹åº”æ—¶åŸŸçš„å·ç§¯ã€‚ èµ°æ ·çš„åŸå› ä¸€å¼€å§‹æˆ‘ä»¬å°±è¯´è¿‡ï¼Œèµ°æ ·çš„å®è´¨æ˜¯åŸå›¾çš„é«˜é¢‘ä¿¡å·è¢«é”™è¯¯é‡‡æ ·ã€‚ç°åœ¨æˆ‘ä»¬çš„æ•°å­¦å·¥å…·å·²ç»è¶³ä»¥åˆ†æç©¶ç«Ÿä¸ºä»€ä¹ˆå‘ç”Ÿäº†é”™è¯¯é‡‡æ ·ï¼Œä»¥åŠå¦‚ä½•ç¼“è§£ä»–ä»¬äº†ã€‚ å…ˆæ¥çœ‹çœ‹ä¸ºä»€ä¹ˆæˆ‘ä»¬æ²¡æœ‰æ­£ç¡®é‡‡æ ·é«˜é¢‘ä¿¡å·ã€‚ å‡è®¾æˆ‘ä»¬å¸Œæœ›å¯¹è¿™æ ·çš„å‡½æ•°è¿›è¡Œé‡‡æ ·ï¼Œé€šè¿‡å‚…é‡Œå¶å˜æ¢æˆ‘ä»¬å¯ä»¥å¾—åˆ°å…¶é¢‘åŸŸï¼ˆå³ä¸€ï¼‰ æˆ‘ä»¬ä¹‹å‰è¯´è¿‡ï¼Œå¯ä»¥æŠŠè¿ç»­å‡½æ•°çš„å‡åŒ€é—´éš”é‡‡æ ·è¡¨ç¤ºä¸ºå†²æ¿€ä¸² $s_{T}(x)=\\sum_{n=-\\infty}^{\\infty}\\delta(x-nT)$ å’ŒåŸå‡½æ•° $f$ çš„ä¹˜ç§¯ï¼Œè€Œæˆ‘ä»¬ä¹Ÿå·²ç»çŸ¥é“å†²æ¿€ä¸²çš„å‚…é‡Œå¶å˜æ¢è¿˜æ˜¯å†²æ¿€ä¸² \\hat s_T(u)=\\frac{1}{T}\\sum_{n=-\\infty}^{\\infty}\\delta(u-\\frac{n}{T})å†ç»“åˆå·ç§¯å®šç† $\\mathcal{F}(s_Tf)=\\hat s_T * \\hat f$ï¼Œä»¥åŠâ€œå·ç§¯å°±æ˜¯å‡½æ•°å¹³ç§»åçš„åŠ æƒå’Œâ€ï¼Œæˆ‘ä»¬å°±èƒ½æ¨å‡ºï¼Œé‡‡æ ·ç»“æœçš„å‚…é‡Œå¶å˜æ¢å°±æ˜¯åŸå‡½æ•°çš„å‚…é‡Œå¶å˜æ¢çš„æ— ç©·ä¸ªå¤åˆ¶å„æŒ‰ $\\frac{n}{T}$ å¹³ç§»çš„å’Œã€‚ ç”±äºæˆ‘ä»¬çš„é‡‡æ ·é—´éš” $T$ ä¸å¤Ÿå°ï¼Œå³é‡‡æ ·ç‡ $\\frac{1}{T}$ ä¸å¤Ÿå¤§ï¼Œæ‰€ä»¥ç›¸é‚»çš„ä¸¤ä¸ªå¤åˆ¶é—´å‘ç”Ÿäº†é‡å ï¼Œå¯¼è‡´é«˜é¢‘ä¿¡å·å’Œä½é¢‘ä¿¡å·äº§ç”Ÿæ··åˆï¼Œè¿™å°±å¼•èµ·äº†èµ°æ ·ã€‚è€Œè¿™æ­£æ˜¯â€œé«˜é¢‘ä¿¡å·è¢«é”™è¯¯é‡‡æ ·â€çš„å®è´¨ã€‚ å½“æˆ‘ä»¬åœ¨å…‰æ …åŒ–æ—¶ï¼Œæˆ‘ä»¬è¿˜æŠŠåƒç´ å¡«ä¸Šäº†é¢œè‰²ï¼Œè¿™æ˜¯åœ¨â€œreconstructionâ€å³é‡å»ºå›¾åƒã€‚ä¸è¿‡ç”±äºåœ¨é‡‡æ ·æ—¶æˆ‘ä»¬å·²ç»å‘ç”Ÿäº†èµ°æ ·ï¼Œæ— è®ºæ€ä¹ˆé‡å»ºéƒ½ä¸ä¼šæœ‰ä¸€ä¸ªéå¸¸å®Œç¾çš„ç»“æœäº†ã€‚ æ»¤æ³¢å™¨å’Œèµ°æ ·çš„ç¼“è§£æ–¹æ³•ä¸ºäº†ç¼“è§£èµ°æ ·ï¼Œæˆ‘ä»¬è‡ªç„¶å°±è¦é¿å…å‘ç”Ÿé‡å ã€‚é¿å…å‘ç”Ÿé‡å çš„æ€è·¯ä¸»è¦æœ‰ä¸¤ç§ï¼š å¢åŠ é‡‡æ ·ç‡ï¼Œè¿™æ ·å°±èƒ½è®©ç›¸é‚»çš„ä¸¤ä¸ªå¤åˆ¶è·ç¦»å¢å¤§ã€‚ ç”¨æ»¤æ³¢å™¨å‡å¼±é«˜é¢‘ä¿¡å·çš„å¼ºåº¦ã€‚ å¯¹å›¾åƒçš„å…‰æ …åŒ–æ¥è¯´ï¼Œå¢åŠ åˆ†è¾¨ç‡å°±å¯¹åº”å‰è€…ï¼›åœ¨é‡‡æ ·å‰å¯¹åŸå›¾åº”ç”¨å„ç§æ»¤æ³¢å™¨å°±å¯¹åº”åè€…ã€‚ æˆ‘ä»¬å½“ç„¶ä¼šé—®ï¼Œå¢åŠ é‡‡æ ·ç‡èƒ½ç¼“è§£èµ°æ ·ï¼Œé‚£å¢åŠ åˆ°å¤šå¤§åˆé€‚å‘¢ï¼Ÿæˆ‘ä»¬å¸Œæœ›ç›¸é‚»çš„ä¸¤ä¸ªå¤åˆ¶é—´çš„è·ç¦»è¶³å¤Ÿå¤§ä»¥è‡³äºä¸å‘ç”Ÿé‡å ï¼Œè¿™å°±éœ€è¦è¾“å…¥ä¿¡å·çš„æœ€é«˜é¢‘ç‡å°äºé‡‡æ ·é¢‘ç‡çš„ä¸€åŠã€‚é‡‡æ ·é¢‘ç‡çš„ä¸€åŠä¹Ÿè¢«ç§°ä¸ºå¥ˆå¥æ–¯ç‰¹é¢‘ç‡ã€‚ç†è®ºä¸Šè¯´ï¼Œåªè¦å¥ˆå¥æ–¯ç‰¹é¢‘ç‡é«˜äºè¢«é‡‡æ ·ä¿¡å·çš„æœ€é«˜é¢‘ç‡ï¼Œæˆ‘ä»¬å°±èƒ½å®Œç¾å¤åŸåŸä¿¡å·ã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹å‡ ä¸ªå¸¸è§çš„æ»¤æ³¢å™¨ï¼Œå®ƒä»¬å¸¸è¢«ç”¨äºå’Œåˆ«çš„å‡½æ•°åšå·ç§¯ã€‚ç”±äºæˆ‘ä»¬çŸ¥é“å·ç§¯å¯ä»¥è¢«ç†è§£ä¸ºä¸€ç§â€œåŠ æƒå¹³å‡â€ï¼Œæ‰€ä»¥æˆ‘ä»¬å¸Œæœ›æ»¤æ³¢å™¨éƒ½æ˜¯å½’ä¸€åŒ–çš„ã€‚ åç§° å…¬å¼ Box filterï¼ˆç¦»æ•£ï¼‰ $a_{\\text{box},r}[i] = \\begin{cases} 1/(2r + 1) & |i| \\le r, \\\\ 0 & \\text{otherwise}. \\end{cases}$ Box filterï¼ˆè¿ç»­ï¼‰ $f_{\\text{box},r}(x) = \\begin{cases} 1/(2r) & -r \\le x < r, \\\\ 0 & \\text{otherwise}. \\end{cases}$ Tent filter $f_{\\text{tent}}(x) = \\begin{cases} 1 - |x| & |x| < 1, \\\\ 0 & \\text{otherwise}; \\end{cases}$ Gaussian filter $f_{g, \\sigma}(x) = \\frac{1}{\\sigma\\sqrt{2\\pi}}e^{-x^2/2\\sigma^2}$ åç§° å…¬å¼ B-Spline Cubic Filter $f_B(x) = \\frac{1}{6} \\begin{cases} -3(1 - |x|)^3 + 3(1 - |x|)^2 + 3(1 - |x|) + 1 & -1 \\le x \\le 1, \\\\ (2 - |x|)^3 & 1 \\le |x| \\le 2, \\\\ 0 & \\text{otherwise}. \\end{cases}$ Catmull-Rom Cubic Filter $f_C(x) = \\frac{1}{2} \\begin{cases} -3(1 - |x|)^3 + 4(1 - |x|)^2 + (1 - |x|) & -1 \\le x \\le 1, \\\\ (2 - |x|)^3 - (2 - |x|)^2 & 1 \\le |x| \\le 2, \\\\ 0 & \\text{otherwise}. \\end{cases}$ Mitchell-Netravali Cubic Filter $f_M(x) = \\frac{1}{3}f_B(x) + \\frac{2}{3}f_C(x) \\\\ = \\frac{1}{18} \\begin{cases} -21(1 - |x|)^3 + 27(1 - |x|)^2 + 9(1 - |x|) + 1 & -1 \\le x \\le 1, \\\\ 7(2 - |x|)^3 - 6(2 - |x|)^2 & 1 \\le |x| \\le 2, \\\\ 0 & \\text{otherwise}. \\end{cases}$ é™¤äº†è¿‡æ»¤é«˜é¢‘ä¿¡å·ä¹‹å¤–ï¼Œæ»¤æ³¢å™¨è¿˜åœ¨é‡å»ºå›¾åƒæ—¶å‘æŒ¥ç€é‡è¦ä½œç”¨ã€‚è¿˜è®°å¾—å—ï¼Œç¦»æ•£-è¿ç»­å·ç§¯èƒ½æŠŠä¸€ç³»åˆ—ç¦»æ•£ç‚¹å˜æˆä¸€ä¸ªè¿ç»­å‡½æ•°ã€‚åœ¨æ ¹æ®é‡‡æ ·ç‚¹é‡å»ºå›¾åƒæ—¶ï¼Œæˆ‘ä»¬åŸºæœ¬å°±æ˜¯åœ¨åšé‡‡æ ·ç‚¹å’Œæ»¤æ³¢å™¨çš„å·ç§¯ã€‚åœ¨å…‰æ …åŒ–çš„â€œæŠŠæ¯ä¸ªåƒç´ ç‚¹çš„ä¸­å¿ƒé‡‡æ ·é¢œè‰²å¡«åˆ°åƒç´ ç‚¹ä¸Šâ€è¿™ä¸€æ­¥ä¸­ï¼Œæˆ‘ä»¬å°±æ˜¯åœ¨å°†é‡‡æ ·ç‚¹å’Œ Box filter åšå·ç§¯ã€‚ æ€»è€Œè¨€ä¹‹ï¼Œä¸ºäº†ç¼“è§£èµ°æ ·ï¼Œæˆ‘ä»¬å¯ä»¥ä»¥å›¾åƒç»†èŠ‚ä¸°å¯Œåº¦ä¸ºä»£ä»·ï¼Œå…ˆç”¨ä½é€šæ»¤æ³¢å™¨æ»¤æ³¢ï¼Œå†é‡‡æ ·+é‡å»ºã€‚å½“ç„¶ï¼Œå¦‚æœæˆ‘ä»¬æœ‰æ›´é«˜åˆ†è¾¨ç‡çš„å±å¹•å°±æ›´å¥½äº†~ å…¶ä»–å°çŸ¥è¯†å¸¸è§æ»¤æ³¢å™¨çš„å‚…é‡Œå¶å˜æ¢ å·ç§¯çš„å•ä½å…ƒä»»ä½•ç¦»æ•£ä¿¡å·å’Œå•ä½è„‰å†²åºåˆ—åšå·ç§¯ï¼Œç»“æœè¿˜æ˜¯åŸæœ¬çš„ç¦»æ•£ä¿¡å· \\delta[n] = \\begin{cases} 1, & n = 0 \\\\ 0, & n \\neq 0 \\end{cases}ä»»ä½•è¿ç»­ä¿¡å·å’Œç‹„æ‹‰å…‹å‡½æ•°åšå·ç§¯ï¼Œç»“æœè¿˜æ˜¯åŸæœ¬çš„è¿ç»­ä¿¡å· \\delta(t) = \\begin{cases} \\infty, & t = 0 \\\\ 0, & t \\neq 0 \\end{cases}äºŒç»´å·ç§¯å’ŒäºŒç»´æ»¤æ³¢å™¨æˆ‘ä»¬è¿™é‡Œåªç»™å‡ºè¿ç»­-è¿ç»­çš„äºŒç»´å·ç§¯ï¼Œåˆ«çš„æƒ…å†µéƒ½å·®ä¸å¤šã€‚ \\begin{align*} &(f*g)(x,y)=\\int\\int f(x-x',y-y')g(x',y')dx'dy' \\end{align*}å¯¹æ»¤æ³¢å™¨ $f(x)$ï¼Œæˆ‘ä»¬ç®€å•åœ°å®šä¹‰ $g(x,y)=f(x)f(y)$ å°±å¾—åˆ°äº†è¿™ä¸ªæ»¤æ³¢å™¨å¯¹åº”çš„äºŒç»´æ»¤æ³¢å™¨ã€‚ä¸€ä¸ªæ¯”è¾ƒå¥½çš„æ€§è´¨æ˜¯ï¼Œå¦‚æœ $f$ æ˜¯å½’ä¸€åŒ–çš„ï¼Œé‚£ä¹ˆ $g$ ä¹Ÿæ˜¯å½’ä¸€åŒ–çš„ã€‚ ä¼½é©¬å€¼æ˜¾ç¤ºå™¨çš„æ˜¾ç¤ºäº®åº¦å…³äºè¾“å…¥ä¿¡å·ä¸æ˜¯çº¿æ€§å…³ç³»ã€‚å‡è®¾è¾“å…¥ä¿¡å·ä¸º $a\\in[0,1]$ï¼Œåˆ™æœ‰ \\text{Displayed intensity}=(\\text{Maximum intensity})a^\\gammaè¿™é‡Œçš„ $\\gamma$ ä¸€èˆ¬åœ¨ $2.2$ å·¦å³ã€‚è™½ç„¶åœ¨æœ€å¼€å§‹è¿™æ˜¯ CRT æ˜¾ç¤ºå™¨çš„ç‰©ç†ç‰¹æ€§æ‰€è‡´ï¼Œä½†æœ‰è¶£çš„æ˜¯ï¼Œäººçœ¼ä¹Ÿæ°å¥½å¯¹æš—éƒ¨å˜åŒ–æ¯”äº®éƒ¨å˜åŒ–æ›´æ•æ„Ÿï¼Œæ‰€ä»¥å®ƒç°åœ¨ä½œä¸ºä¸€ä¸ªåˆ»æ„çš„è®¾è®¡ä¿ç•™äº†ä¸‹æ¥ã€‚ ä¼½é©¬çŸ«æ­£åœ¨å½±åƒç³»ç»Ÿä¸­ä¹Ÿæœ‰æå¤§ä½œç”¨ã€‚å‡è®¾æˆ‘ä»¬åœ¨æ‹æ‘„ä¸€ä¸ªè‹¹æœçš„ç…§ç‰‡ï¼Œè‹¹æœçš„ç‰©ç†äº®åº¦æ˜¯ $0.5$ï¼Œç›¸æœºå¿ å®åœ°æŠŠå®ƒè®°å½•äº†ä¸‹æ¥ã€‚è€Œå½“æ˜¾ç¤ºå™¨æ˜¾ç¤ºæ—¶ï¼Œå°±æ˜¾ç¤ºå‡ºäº† $0.5^{2.2}\\approx 0.22$ çš„ç‰©ç†äº®åº¦ï¼Œè¿™æ˜¾ç„¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚å› æ­¤åœ¨æˆ‘ä»¬æ‹æ‘„ç…§ç‰‡ä¹‹åï¼Œç›¸æœºçš„å›¾åƒå¤„ç†å™¨å°±ä¼šè‡ªåŠ¨å¯¹ç…§ç‰‡è¿›è¡Œä¼½é©¬çŸ«æ­£ã€‚ å›¾åƒé”åŒ–Unsharp Mask æ˜¯ä¸€ä¸ªç»å…¸çš„å›¾åƒé”åŒ–ç®—æ³•ã€‚ä»¤é«˜æ–¯æ¨¡ç³Šæ ¸ä¸º $G$ï¼Œå†²æ¿€å‡½æ•°ä¸º $\\delta$ï¼Œå®ƒå…ˆæå–åŸå§‹å›¾åƒçš„é«˜é¢‘ä¿¡å· I_{detail} = I_{orig} - I_{orig} * Gå†æŠŠè¿™äº›é«˜é¢‘ä¿¡å·åŠ å…¥å›åŸå›¾ä¸­ I_{sharp} = I_{orig} + \\alpha I_{detail}ç»¼åˆèµ·æ¥å°±æ˜¯ I_{sharp} =I_{orig}*((1+\\alpha)\\delta-G)å›¾åƒç¼©æ”¾ç›´æ¥å¯¹ä¸€ä¸ªåƒç´ åŒ–çš„å›¾åƒé‡‡æ ·è™½ç„¶æ•ˆç‡å¾ˆé«˜ï¼Œä½†æ•ˆæœä¸ä½³ã€‚å…ˆç”¨è¿ç»­çš„æ»¤æ³¢å™¨é‡å»ºä¿¡å·ï¼Œå†ç”¨ä½é€šæ»¤æ³¢å™¨è¿‡æ»¤é«˜é¢‘ä¿¡å·ï¼Œå†é‡‡æ ·ä¼šå¾—åˆ°æ›´å¥½çš„ç»“æœï¼Œè¿™è¢«ç§°ä¸º resamplingï¼Œé‡é‡‡æ ·ã€‚","categories":[{"name":"å…¬å¼€è¯¾","slug":"å…¬å¼€è¯¾","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/"},{"name":"GAMES101","slug":"å…¬å¼€è¯¾/GAMES101","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/"},{"name":"Notes","slug":"å…¬å¼€è¯¾/GAMES101/Notes","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/Notes/"}],"tags":[]},{"title":"Assignment 1 Transformation","slug":"learning/open-course/GAMES101/Hw/Hw1-transformation","date":"2025-08-22T03:00:58.000Z","updated":"2025-08-22T03:14:43.978Z","comments":true,"path":"wiki/learning/open-course/GAMES101/Hw/Hw1-transformation/","permalink":"http://rinevard.github.io/wiki/learning/open-course/GAMES101/Hw/Hw1-transformation/","excerpt":"","text":"æœ¬æ¬¡ä½œä¸šè¦æ±‚æˆ‘ä»¬å®ç°æ—‹è½¬çŸ©é˜µã€æŠ•å½±çŸ©é˜µã€‚æˆ‘ä»¬å…ˆç®€å•çœ‹ä¸‹ä½œä¸šæ˜¯æ€ä¹ˆåšçš„ï¼Œå†çœ‹çœ‹ä»£ç æ¡†æ¶é‡Œçš„å‡ ä¸ªæœ‰è¶£çš„åœ°æ–¹ã€‚ ä½œä¸šå®ç°ä¸¤ä¸ªæ—‹è½¬çŸ©é˜µç»• $z$ è½´çš„æ—‹è½¬çŸ©é˜µå®ç°èµ·æ¥å¾ˆç®€å•ï¼ŒæŠŠè¯¾ä¸Šçš„å†…å®¹ç¿»è¯‘æˆä»£ç å°±å¥½ã€‚åœ¨ä½¿ç”¨ std çš„ sin å’Œ cos æ—¶è¦æ³¨æ„æŠŠè§’åº¦è½¬æ¢æˆå¼§åº¦ã€‚ Eigen::Matrix4f get_model_matrix(float rotation_angle) &#123; Eigen::Matrix4f model = Eigen::Matrix4f::Identity(); float angle_rad = rotation_angle * MY_PI / 180.0; Eigen::Matrix4f rotate; float sine = std::sin(angle_rad); float cosine = std::cos(angle_rad); rotate &lt;&lt; cosine, -sine, 0, 0, sine, cosine, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1; model = rotate * model; return model; &#125; æé«˜é¡¹é‡Œçš„æ—‹è½¬çŸ©é˜µç”¨è¯¾ä¸Šè®²çš„ Rodriguesâ€™ rotation formula å°±è¡Œï¼š /* Computes the 4x4 rotation matrix representing a rotation of rotation_angle (in degree) around a given normalized axis vector that passes through the origin, using Rodrigues' rotation formula. */ Eigen::Matrix4f get_rotation(Vector3f axis, float rotation_angle) &#123; float angle_rad = rotation_angle * MY_PI / 180.0; Eigen::Matrix3f rot_mat = std::cos(angle_rad) * Eigen::Matrix3f::Identity(); rot_mat += (1 - std::cos(angle_rad)) * axis * axis.transpose(); Eigen::Matrix3f cross_product_mat; cross_product_mat &lt;&lt; 0, -axis.z(), axis.y(), axis.z(), 0, -axis.x(), -axis.y(), axis.x(), 0; rot_mat += std::sin(angle_rad) * cross_product_mat; Eigen::Matrix4f trans_mat = Eigen::Matrix4f::Identity(); trans_mat.topLeftCorner&lt;3, 3>() = rot_mat; return trans_mat; &#125; æŠ•å½±çŸ©é˜µæŠ•å½±çŸ©é˜µå°±ç›¸å¯¹å¤æ‚ä¸€äº›äº†ï¼Œå…ˆä¸Šä»£ç  Eigen::Matrix4f get_projection_matrix(float eye_fov, float aspect_ratio, float zNear, float zFar) &#123; // Students will implement this function Eigen::Matrix4f projection = Eigen::Matrix4f::Identity(); Eigen::Matrix4f perspective; float cotangent = 1.0 / std::tan(eye_fov / 2.0); float z_delta = zFar - zNear; perspective &lt;&lt; cotangent / aspect_ratio, 0, 0, 0, 0, cotangent, 0, 0, 0, 0, -(zFar + zNear) / z_delta, -2 * zFar * zNear / z_delta, 0, 0, -1, 0; projection = perspective * projection; return projection; &#125; é¦–å…ˆæˆ‘ä»¬ä¼šå‘ç°è¾“å…¥çš„ zNear å’Œ zFar éƒ½æ˜¯æ­£æ•°ï¼Œä»–ä»¬è¡¨ç¤ºè¿‘å¹³é¢å’Œè¿œå¹³é¢åˆ°åŸç‚¹çš„è·ç¦»ï¼Œè¿™ä¸è¯¾ä¸Šè®²çš„ä¸åŒã€‚è¯¾ä¸Šè®²çš„ $n$ å’Œ $f$ è¡¨ç¤ºè¿‘å¹³é¢å’Œè¿œå¹³é¢åœ¨ $z$ è½´çš„åæ ‡ï¼Œä»–ä»¬æ˜¯è´Ÿæ•°ã€‚ ç„¶åæˆ‘ä»¬åˆ†æ rasterizer.cpp é‡Œçš„ draw å‡½æ•°ï¼Œä¸‹é¢è¿™æ®µä»£ç é‡Œï¼Œv æ˜¯ä¸‰è§’å½¢çš„ä¸‰ä¸ªé¡¶ç‚¹æ„æˆçš„æ•°ç»„ï¼Œä¸‰ä¸ªé¡¶ç‚¹éƒ½å·²ç»è¢«å˜æ¢åˆ°äº† $[-1,1]^3$ çš„æ­£æ–¹ä½“ä¸­ã€‚ æ³¨æ„ vert.z() = vert.z() * f1 + f2 è¿™è¡Œä»£ç ï¼ŒæŠŠ $-1$ ä»£å…¥å³è¾¹å¾—åˆ° $-n$ï¼Œ$1$ ä»£å…¥å³è¾¹å¾—åˆ° $-f$ï¼Œå› æ­¤æˆ‘ä»¬æœ‰ç†ç”±çŒœæµ‹ $[-n,-f]$ è¢«æ˜ å°„åˆ°äº† $[-1,1]$. float f1 = (100 - 0.1) / 2.0; float f2 = (100 + 0.1) / 2.0; // ... for (auto &amp; vert : v) &#123; vert.x() = 0.5*width*(vert.x()+1.0); vert.y() = 0.5*height*(vert.y()+1.0); vert.z() = vert.z() * f1 + f2; &#125; æ€»ç»“ä¸€ä¸‹æˆ‘ä»¬çš„å‘ç°ï¼š è¾“å…¥çš„ zNear å’Œ zFar éƒ½æ˜¯æ­£æ•°ï¼Œè¡¨ç¤ºè¿‘å¹³é¢å’Œè¿œå¹³é¢åˆ°åŸç‚¹çš„è·ç¦» $[-n,-f]$ è¢«æ˜ å°„åˆ°äº† $[-1,1]$ æœ€ç»ˆæˆ‘ä»¬èƒ½å†™å‡ºè¿™æ ·çš„æŠ•å½±çŸ©é˜µï¼š \\large \\text{M}_\\text{per} = \\begin{bmatrix} \\frac{1}{\\text{aspect} \\times \\tan(\\frac{\\text{fov}}{2})} & 0 & 0 & 0 \\\\ 0 & \\frac{1}{\\tan(\\frac{\\text{fov}}{2})} & 0 & 0 \\\\ 0 & 0 & -\\frac{f+n}{f-n} & -\\frac{2fn}{f-n} \\\\ 0 & 0 & -1 & 0 \\end{bmatrix}ç¿»è¯‘æˆä»£ç å°±å¥½ã€‚ ä»£ç æ¡†æ¶é‡Œæœ‰è¶£çš„åœ°æ–¹ind çš„ä½œç”¨é¦–å…ˆæˆ‘ä»¬çœ‹å‘ main.cpp çš„ main å‡½æ•°é‡Œçš„è¿™æ®µä»£ç  std::vector&lt;Eigen::Vector3f> pos&#123;&#123;2, 0, -2&#125;, &#123;0, 2, -2&#125;, &#123;-2, 0, -2&#125;&#125;; std::vector&lt;Eigen::Vector3i> ind&#123;&#123;0, 1, 2&#125;&#125;; pos æ˜¾ç„¶æ˜¯ä¸‰è§’å½¢çš„ä¸‰ä¸ªé¡¶ç‚¹ï¼Œä½† ind æ˜¯åšä»€ä¹ˆçš„ï¼Ÿuh actuallyğŸ¤“â˜ï¸å®ƒå®šä¹‰äº†å¦‚ä½•å°†é¡¶ç‚¹è¿æ¥èµ·æ¥ã€‚å¯¹ä¸‰è§’å½¢æ¥è¯´å®ƒå½“ç„¶æ²¡ä»€ä¹ˆç”¨ï¼Œä½†å¯¹å¤šè¾¹å½¢æ¥è¯´ï¼Œå®ƒå°±å¾ˆæœ‰ç”¨äº†ã€‚ æ¯”å¦‚è¯´ï¼Œæƒ³è±¡ä¸€ä¸‹æˆ‘ä»¬åœ¨ç”»ä¸€ä¸ªå…­è¾¹å½¢ï¼Œæˆ‘ä»¬éœ€è¦å…­ä¸ªé¡¶ç‚¹ã€‚ä½†ç”±äºåœ¨æ¸²æŸ“æ—¶æˆ‘ä»¬ä¸»è¦ç»˜åˆ¶ä¸‰è§’å½¢ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æŠŠå…­è¾¹å½¢æ‹†åˆ†æˆå¤šä¸ªä¸‰è§’å½¢ï¼Œè€Œæ‹†åˆ†å‡ºçš„æ¯ä¸ªä¸‰è§’å½¢å°±å¯¹åº”ç€ ind é‡Œçš„ä¸€ä¸ªå…ƒç´ äº†ã€‚ å¯¹å…­è¾¹å½¢æ¥è¯´ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå®šä¹‰ä¸‹é¢è¿™æ ·çš„ pos å’Œ ind std::vector&lt;Eigen::Vector3f> pos &#123; &#123;2, 0, -2&#125;, // 0: å³ &#123;1, 1.732, -2&#125;, // 1: å³ä¸Š &#123;-1, 1.732, -2&#125;, // 2: å·¦ä¸Š &#123;-2, 0, -2&#125;, // 3: å·¦ &#123;-1, -1.732, -2&#125;,// 4: å·¦ä¸‹ &#123;1, -1.732, -2&#125; // 5: å³ä¸‹ &#125;; std::vector&lt;Eigen::Vector3i> ind &#123; &#123;0, 1, 2&#125;, &#123;0, 2, 3&#125;, &#123;0, 3, 4&#125;, &#123;0, 4, 5&#125; &#125;; id çš„ä½œç”¨ç»§ç»­çœ‹å‘ main.cpp çš„ main å‡½æ•°ï¼ŒæŠŠç›®å…‰æŠ•å‘è¿™æ®µä»£ç  auto pos_id = r.load_positions(pos); auto ind_id = r.load_indices(ind); // ... r.draw(pos_id, ind_id, rst::Primitive::Triangle); åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬æŠŠ id ä¼ å…¥äº† draw å‡½æ•°æ¥ç”»å›¾ã€‚ä½†ä¸ºä»€ä¹ˆè¦ç”¨ id å‘¢ï¼Ÿç›´æ¥ &amp; ä¼ å‚ä¸è¡Œå—ï¼Ÿ ã€TODOï¼šæˆ‘ä¸çŸ¥é“ã€‚AIè¯´åœ¨æ­£å¼çš„æ¸²æŸ“ä»£ç é‡Œï¼Œæˆ‘ä»¬ä¼šåœ¨loadæ—¶åšä¸€äº›æ“ä½œè¯¸å¦‚æŠŠæ•°æ®ä¸Šä¼ åˆ°æ˜¾å­˜ï¼Œæˆ–è€…é‡æ–°ç»„ç»‡ä¸Šä¼ çš„å„ä¸ªæ•°æ®æ¥æé«˜æ•ˆç‡ï¼Œä½†å’±ä¹Ÿä¸çŸ¥é“æ˜¯ä¸æ˜¯çœŸçš„ã€‚ã€‘","categories":[{"name":"å…¬å¼€è¯¾","slug":"å…¬å¼€è¯¾","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/"},{"name":"GAMES101","slug":"å…¬å¼€è¯¾/GAMES101","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/"},{"name":"Assignments","slug":"å…¬å¼€è¯¾/GAMES101/Assignments","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/Assignments/"}],"tags":[]},{"title":"Note 1 Transformation","slug":"learning/open-course/GAMES101/Notes/Note1-transformation","date":"2025-08-19T07:10:28.000Z","updated":"2025-08-22T03:14:43.967Z","comments":true,"path":"wiki/learning/open-course/GAMES101/Notes/Note1-transformation/","permalink":"http://rinevard.github.io/wiki/learning/open-course/GAMES101/Notes/Note1-transformation/","excerpt":"","text":"2D Transformationåœ¨äºŒç»´ç©ºé—´ä¸­ï¼Œæˆ‘ä»¬èƒ½ç”¨äºŒç»´çŸ©é˜µè¡¨ç¤ºæ‰€æœ‰çš„çº¿æ€§å˜æ¢ã€‚ä½†äºŒç»´ç©ºé—´ä¸­çš„å¹³ç§»åœ¨äºŒç»´ç©ºé—´ä¸­ä¸æ˜¯çº¿æ€§å˜æ¢ï¼Œå› æ­¤æˆ‘ä»¬å¸Œæœ›æ‰¾åˆ°å¦ä¸€ä¸ªç©ºé—´ï¼Œå¹¶å°†äºŒç»´ç©ºé—´åµŒå…¥ï¼Œè®©äºŒç»´å¹³ç§»åœ¨è¿™ä¸ªç©ºé—´ä¸­å˜ä¸ºçº¿æ€§å˜æ¢ã€‚æŠŠç¬›å¡å°”åæ ‡æ‰©å±•ä¸ºé½æ¬¡åæ ‡ï¼Œå°±å¾—åˆ°äº†è¿™æ ·çš„ç©ºé—´ã€‚ å¯¹äºŒç»´ç©ºé—´çš„ä¸€ç‚¹ $(x,y)$ï¼Œä¸‰å…ƒç»„ $(xZ,yZ,Z)$ å³ä¸ºè¯¥ç‚¹çš„é½æ¬¡åæ ‡ã€‚å¦‚ $(1,2)$ å¯è¡¨ç¤ºä¸º $(1,2,1)$ æˆ– $(100,200,100)$. æ¢å¥è¯è¯´ï¼ŒäºŒç»´ç©ºé—´çš„ä»»ä½•ç‚¹éƒ½èƒ½è¡¨ç¤ºä¸ºé½æ¬¡åæ ‡ $(X,Y,Z)$ï¼Œå…¶ä¸­ $Z\\neq 0$. å¦å¤–ï¼Œå¦‚æœæˆ‘ä»¬æŠŠæ— ç©·è¿œç‚¹ä¹Ÿè€ƒè™‘è¿›æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨ $(x,y,0)$ è¡¨ç¤ºæ— ç©·è¿œç‚¹ã€‚ å½é‡Œå’•å™œè¯´ä»€ä¹ˆå‘¢ï¼Œå¿«å‘Šè¯‰æˆ‘æ€ä¹ˆç”¨çº¿æ€§å˜æ¢è¡¨ç¤ºå¹³ç§»ï¼ å¯¹äºŒç»´ç©ºé—´çš„ä¸€ç‚¹ $(x,y)$ï¼Œé¦–å…ˆå°†å®ƒè½¬åŒ–ä¸ºé½æ¬¡åæ ‡å¾—åˆ° $(x,y,1)$ï¼Œç„¶åä¸ä¸‹é¢çš„çŸ©é˜µç›¸ä¹˜ M = \\begin{bmatrix} 1 & 0 & t_x \\\\ 0 & 1 & t_y \\\\ 0 & 0 & 1 \\end{bmatrix}å°±å¾—åˆ°äº† $(x+t_x,y+t_y,1)$. ç„¶åå†è½¬æ¢å›ç¬›å¡å°”åæ ‡ï¼Œå°±å¾—åˆ°äº† $(x+t_x,y+t_y)$. è¿™æ ·ä¸€æ¥ï¼Œæ—‹è½¬ã€å¹³ç§»å°±èƒ½ç»Ÿä¸€æˆä¸‹é¢çš„å½¢å¼ï¼š M = \\begin{bmatrix} \\cos \\theta & -\\sin \\theta & t_x \\\\ \\sin \\theta & \\cos \\theta & t_y \\\\ 0 & 0 & 1 \\end{bmatrix}3D Transformationä¸äºŒç»´çš„æƒ…å†µç±»ä¼¼ï¼Œæˆ‘ä»¬ä¹ŸæŠŠä¸‰ç»´ç©ºé—´åµŒå…¥ä¸€ä¸ªæ–°ç©ºé—´ã€‚ å¯¹ä¸‰ç»´ç©ºé—´çš„ä¸€ç‚¹ $(x,y,z)$ï¼Œä¸‰å…ƒç»„ $(xS,yS,zS,S)$ å³ä¸ºè¯¥ç‚¹çš„é½æ¬¡åæ ‡ã€‚å¦‚ $(1,2,3)$ å¯è¡¨ç¤ºä¸º $(1,2,3,1)$ æˆ– $(100,200,300,100)$. æ¢å¥è¯è¯´ï¼Œä¸‰ç»´ç©ºé—´çš„ä»»ä½•ç‚¹éƒ½èƒ½è¡¨ç¤ºä¸ºé½æ¬¡åæ ‡ $(X,Y,Z,S)$ï¼Œå…¶ä¸­ $S\\neq 0$. æˆ‘ä»¬è¿™é‡Œè®¨è®ºå³æ‰‹åæ ‡ç³»ï¼Œä¸‹é¢ç»™å‡ºæŒ‰å³æ‰‹å®šåˆ™æ—‹è½¬ $\\theta$ è§’åº¦çš„çŸ©é˜µï¼š R_x(\\theta) = \\begin{bmatrix} 1 & 0 & 0 & 0 \\\\ 0 & \\cos \\theta & -\\sin \\theta & 0 \\\\ 0 & \\sin \\theta & \\cos \\theta & 0 \\\\ 0 & 0 & 0 & 1 \\end{bmatrix} R_y(\\theta) = \\begin{bmatrix} \\cos \\theta & 0 & \\sin \\theta & 0 \\\\ 0 & 1 & 0 & 0 \\\\ -\\sin \\theta & 0 & \\cos \\theta & 0 \\\\ 0 & 0 & 0 & 1 \\end{bmatrix} R_z(\\theta) = \\begin{bmatrix} \\cos \\theta & -\\sin \\theta & 0 & 0 \\\\ \\sin \\theta & \\cos \\theta & 0 & 0 \\\\ 0 & 0 & 1 & 0 \\\\ 0 & 0 & 0 & 1 \\end{bmatrix}ä½ ä¼šæ³¨æ„åˆ°æ²¿ $y$ è½´æ—‹è½¬çš„çŸ©é˜µå’Œåˆ«çš„ä¸ä¸€æ ·ï¼Œä½†è¿™æ˜¯å®Œå…¨æ­£ç¡®çš„ï¼Œè®¤çœŸç®—ä¸€ç®—å°±å¥½äº†ã€‚ ï¼ˆæˆ‘æ²¡æ„Ÿè§‰è¿™é‡Œæœ‰ä»€ä¹ˆâ€œæ·±åˆ»å«ä¹‰â€ï¼Œä½†æ„Ÿè§‰å³ä½¿æœ‰ä¹Ÿåº”è¯¥ä¸ä¼šå¾ˆæœ‰ç”¨â€¦â€¦ï¼‰ ï¼ˆä¸è¿‡ä¸çŸ¥é“å¦‚æœæ¨å¹¿åˆ° $n$ ç»´æ—‹è½¬ä¼šä¸ä¼šæœ‰ç”¨ï¼‰ ï¼ˆå¯æˆ‘ä»¬ç”Ÿæ´»åœ¨ä¸‰æ¬¡å…ƒï¼ï¼‰ å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæ—‹è½¬çŸ©é˜µéƒ½æ˜¯æ­£äº¤çŸ©é˜µï¼Œæ‰€ä»¥å®ƒçš„è½¬ç½®å°±æ˜¯å®ƒçš„é€†ã€‚ ä¸–ç•Œä¸Šè¿˜å­˜åœ¨ä¸€ä¸ªå«åš Rodrigues æ—‹è½¬å…¬å¼çš„ä¸œè¥¿ï¼Œå®ƒç»™å‡ºäº†å‘é‡ $v$ ç»•å•ä½å‘é‡ $k$ æ—‹è½¬ $\\theta$ è§’åº¦å¾—åˆ°çš„ç»“æœã€‚ï¼ˆæŒ‰å³æ‰‹å®šåˆ™æ—‹è½¬ï¼‰ \\mathbf{v}_{\\text{rot}} = \\mathbf{v} \\cos\\theta + (\\mathbf{k} \\times \\mathbf{v}) \\sin\\theta + \\\\ \\mathbf{k}(\\mathbf{k} \\cdot \\mathbf{v})(1 - \\cos\\theta) å½“ç„¶ä¹Ÿå¯ä»¥æŠŠè¿™ä¸ªæ—‹è½¬çŸ©é˜µå†™å‡ºæ¥ï¼š \\mathbf{R}(\\mathbf{k}, \\theta) = \\cos(\\theta)\\mathbf{I} + (1 - \\cos(\\theta))\\mathbf{k}\\mathbf{k}^T + \\sin(\\theta)\\begin{bmatrix} 0 & -k_z & k_y \\\\ k_z & 0 & -k_x \\\\ -k_y & k_x & 0 \\end{bmatrix}æœ€å³è¾¹é‚£ä¸ªçŸ©é˜µæ˜¯ $k$ çš„å‰ä¹˜çŸ©é˜µå•¦~ Viewing transformation2D å’Œ 3D transformation éƒ½æ˜¯åŸºç¡€å˜æ¢ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ç ”ç©¶æ¸¸æˆé‡Œçš„ç”»é¢æ˜¯å¦‚ä½•æ¸²æŸ“åˆ°å±å¹•ä¸Šçš„ã€‚ å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªæ‘„åƒæœºã€ä¸¤ä¸ªæ–¹å—ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ˜¯æ€ä¹ˆè®¡ç®—å‡ºæ‘„åƒæœºæ‹æ‘„çš„ç”»é¢çš„å‘¢ï¼ˆå‚è€ƒå³ä¸‹è§’ï¼‰ï¼Ÿ æˆ‘ä»¬æŒ‰ç…§ä¸‹é¢çš„æµç¨‹è¿›è¡Œæ“ä½œï¼š Camera transformationé¦–å…ˆï¼Œæˆ‘ä»¬å˜æ¢ç©ºé—´è®©æ‘„åƒæœºä½äºåæ ‡åŸç‚¹ï¼Œä¸”é¢å‘ $z$ è½´è´Ÿæ–¹å‘ï¼Œå¤´é¡¶æœ $y$ è½´æ­£æ–¹å‘ã€‚å¯¹ä¸Šå›¾æ¥è¯´ï¼Œå°±æ˜¯æŠŠ $w$ å˜æ¢ä¸º $z$ è½´ï¼ŒæŠŠ $v$ å˜æ¢ä¸º $y$ è½´ã€‚ å¯¹åº”çš„çŸ©é˜µæ˜¯ \\text{M}_{\\text{cam}} = \\begin{bmatrix} u_x & u_y & u_z & 0 \\\\ v_x & v_y & v_z & 0 \\\\ w_x & w_y & w_z & 0 \\\\ 0 & 0 & 0 & 1 \\end{bmatrix} \\times \\begin{bmatrix} 1 & 0 & 0 & -\\text{cam}_x \\\\ 0 & 1 & 0 & -\\text{cam}_y \\\\ 0 & 0 & 1 & -\\text{cam}_z \\\\ 0 & 0 & 0 & 1 \\end{bmatrix}è¿™é‡Œçš„å°æŠ€å·§æ˜¯ï¼Œæ—‹è½¬çŸ©é˜µçš„é€†æ˜¯å…¶è½¬ç½®ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆç®—å‡º $xyz$ è½´å˜æ¢åˆ° $uvw$ è½´çš„æ—‹è½¬çŸ©é˜µï¼Œå†å¯¹å…¶è½¬ç½®ï¼Œå°±å¾—åˆ°äº†æŠŠ $uvw$ å˜æ¢åˆ° $xyz$ çš„çŸ©é˜µã€‚ Projection transformationç„¶åï¼Œæˆ‘ä»¬æŠŠç›¸æœºæ‹æ‘„çš„åŒºåŸŸå˜æ¢åˆ° $[-1,1]^3$ ä¸­ï¼Œè¿™æ˜¯ä¸€ä¸ªè§„èŒƒåŒ–ï¼Œä¸ºæœªæ¥æŠŠåŒºåŸŸæ”¾åˆ°å±å¹•ä¸Šåšå‡†å¤‡ã€‚åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬è¦å…ˆç¡®å®šç›¸æœºèƒ½å¤Ÿæ‹æ‘„çš„åŒºåŸŸçš„èŒƒå›´ã€‚è¿™é‡Œæ¶‰åŠåˆ°çš„å˜é‡ä¸»è¦æœ‰ fovã€aspect ratioã€nearã€far. ä¸‹å›¾èƒ½æ¸…æ™°åœ°è§£é‡Š fov å’Œ aspect ratioã€‚fov å³ field of viewï¼Œè¡¨ç¤ºç”¨è§’åº¦è¡¡é‡çš„å¯è§èŒƒå›´ï¼›aspect ratio åˆ™æ˜¯æ˜¾ç¤ºåŒºåŸŸçš„å®½é«˜æ¯”ã€‚ near å’Œ far åˆ™å®šä¹‰äº†å‰”é™¤è¾¹ç•Œï¼Œæˆ‘ä»¬åªæ¸²æŸ“æ»¡è¶³ $z \\in [\\text{near}, \\text{far}]$ çš„ä¸œè¥¿ã€‚åŸç‚¹ã€è¿‘å¹³é¢å’ŒåŸå¹³é¢å…±åŒåˆ’åˆ†å‡ºäº†ä¸€å—æœ‰é™çš„ç©ºé—´ï¼Œè¿™å°±æ˜¯æ‘„åƒæœºæ‹æ‘„çš„åŒºåŸŸï¼ˆè§†é”¥ï¼‰ï¼Œæˆ‘ä»¬ä¼šæŠŠä»–å˜æ¢åˆ° $[-1,1]^3$ ä¸­ã€‚ å˜æ¢åˆ†ä¸ºä¸¤æ­¥ï¼Œç¬¬ä¸€æ­¥æ˜¯æŠŠè§†é”¥å˜æ¢ä¸ºé•¿æ–¹ä½“ï¼Œç¬¬äºŒæ­¥æŠŠé•¿æ–¹ä½“å˜æ¢ä¸º $[-1,1]^3$ çš„æ­£æ–¹ä½“ã€‚ åœ¨ç¬¬ä¸€æ­¥å˜æ¢æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›æ»¡è¶³ä»¥ä¸‹ä¸¤ç‚¹ï¼š near å’Œ far å¹³é¢ä¸Šçš„ç‚¹çš„ $z$ å€¼ä¸å˜ è¿‘å¤§è¿œå°ï¼Œä¸”ç¼©æ”¾æ¯”ä¾‹ç¬¦åˆç›¸ä¼¼ä¸‰è§’å½¢çš„è§„å¾‹ ç»“åˆé½æ¬¡åæ ‡ï¼Œæˆ‘ä»¬å°±èƒ½å¾—åˆ°ä»¥ä¸‹çŸ©é˜µï¼š \\begin{align*} \\text{M}_\\text{per} &= \\begin{bmatrix} \\frac{2}{r-l} & 0 & 0 & -\\frac{r+l}{r-l} \\\\ 0 & \\frac{2}{t-b} & 0 & -\\frac{t+b}{t-b} \\\\ 0 & 0 & \\frac{2}{n-f} & -\\frac{n+f}{n-f} \\\\ 0 & 0 & 0 & 1 \\end{bmatrix} \\times \\begin{bmatrix} n & 0 & 0 & 0 \\\\ 0 & n & 0 & 0 \\\\ 0 & 0 & n+f & -nf \\\\ 0 & 0 & 1 & 0 \\end{bmatrix} \\\\ &= \\begin{bmatrix} \\frac{2n}{r-l} & 0 & -\\frac{r+l}{r-l} & 0 \\\\ 0 & \\frac{2n}{t-b} & -\\frac{t+b}{t-b} & 0 \\\\ 0 & 0 & \\frac{n+f}{n-f} & -\\frac{2nf}{n-f} \\\\ 0 & 0 & 1 & 0 \\end{bmatrix} \\end{align*}ç¬¬ä¸€ä¸ªç­‰å·å³è¾¹çš„å¼å­ä¸­ï¼Œå³è¾¹çš„çŸ©é˜µæŠŠè§†é”¥å‹ç¼©ä¸ºä¸€ä¸ªé•¿æ–¹ä½“ï¼Œå·¦è¾¹çš„çŸ©é˜µæŠŠè¿™ä¸ªé•¿æ–¹ä½“å˜æ¢åˆ° $[-1,1]^3$. æˆ‘ä»¬å¯ä»¥æ ¹æ® $\\text{near},\\text{fov},\\text{aspectRatio}$ æ±‚å‡º $l,t,r,b$. \\begin{align*} &\\text{t} = -n \\times \\tan\\left(\\frac{\\text{fov}}{2}\\right) \\\\ &\\text{b} = -\\text{t} \\\\ &\\text{r} = \\text{t} \\times \\text{aspectRatio} \\\\ &\\text{l} = -\\text{r} \\end{align*} ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæŠ•å½±çŸ©é˜µå†™ä¸ºï¼š \\large \\text{M}_\\text{per} = \\begin{bmatrix} -\\frac{1}{\\text{aspect} \\times \\tan(\\frac{\\text{fov}}{2})} & 0 & 0 & 0 \\\\ 0 & -\\frac{1}{\\tan(\\frac{\\text{fov}}{2})} & 0 & 0 \\\\ 0 & 0 & \\frac{n+f}{n-f} & -\\frac{2nf}{n-f} \\\\ 0 & 0 & 1 & 0 \\end{bmatrix}Viewport transformationæœ€åï¼Œæˆ‘ä»¬ä¼šæŠŠ $[-1,1]^3$ çš„å†…å®¹çš„å®½é«˜æ˜ å°„ä¸ºå±å¹•å¤§å°ã€‚åœ¨è¿™ä¸ªå˜æ¢ä¸­ $z$ åæ ‡ä¸å˜ï¼Œå› æ­¤å˜æ¢çŸ©é˜µä¸ºï¼š \\large \\text{M}_\\text{viewport}= \\begin{bmatrix} \\frac{width}{2} & 0 & 0 & \\frac{width}{2} \\\\ 0 & \\frac{height}{2} & 0 & \\frac{height}{2} \\\\ 0 & 0 & 1 & 0 \\\\ 0 & 0 & 0 & 1 \\end{bmatrix}æ€»ç»“æ€»è€Œè¨€ä¹‹ï¼Œæˆ‘ä»¬çš„å˜æ¢çŸ©é˜µä¸º \\begin{align*} &\\text{M}=\\text{M}_\\text{viewport}\\text{M}_\\text{per}\\text{M}_\\text{cam} \\end{align*}å…¶ä¸­ \\begin{align*} &\\text{M}_{\\text{cam}} = \\begin{bmatrix} u_x & u_y & u_z & 0 \\\\ v_x & v_y & v_z & 0 \\\\ w_x & w_y & w_z & 0 \\\\ 0 & 0 & 0 & 1 \\end{bmatrix} \\times \\begin{bmatrix} 1 & 0 & 0 & -\\text{cam}_x \\\\ 0 & 1 & 0 & -\\text{cam}_y \\\\ 0 & 0 & 1 & -\\text{cam}_z \\\\ 0 & 0 & 0 & 1 \\end{bmatrix} \\\\ \\large &\\text{M}_\\text{per} = \\begin{bmatrix} -\\frac{1}{\\text{aspect} \\times \\tan(\\frac{\\text{fov}}{2})} & 0 & 0 & 0 \\\\ 0 & -\\frac{1}{\\tan(\\frac{\\text{fov}}{2})} & 0 & 0 \\\\ 0 & 0 & \\frac{n+f}{n-f} & -\\frac{2nf}{n-f} \\\\ 0 & 0 & 1 & 0 \\end{bmatrix} \\\\ &\\large \\text{M}_\\text{viewport}= \\begin{bmatrix} \\frac{width}{2} & 0 & 0 & \\frac{width}{2} \\\\ 0 & \\frac{height}{2} & 0 & \\frac{height}{2} \\\\ 0 & 0 & 1 & 0 \\\\ 0 & 0 & 0 & 1 \\end{bmatrix} \\end{align*}è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬è®¨è®ºçš„ $n$ å’Œ $f$ è¢«å®šä¹‰ä¸ºåæ ‡å€¼ï¼Œå®ƒä»¬æ˜¯å°äº 0 çš„ã€‚ä¸€äº›åœ°æ–¹æŠŠ $n$ å’Œ $f$ å®šä¹‰ä¸ºåˆ°è¿‘/è¿œå¹³é¢çš„è·ç¦»ï¼Œè¿™æ˜¯å¤§äº 0 çš„ï¼Œè¿™ä¼šå¼•èµ·æŠ•å½±çŸ©é˜µçš„å˜åŒ–ã€‚å¦å¤–ï¼Œä¸åŒçš„åæ ‡ç³»çº¦å®šä¹Ÿä¼šå¼•èµ·çŸ©é˜µçš„å˜åŒ–ã€‚ æ¯”å¦‚åœ¨OpenGLä¸­ï¼Œ $n$ å’Œ $f$ è¢«å®šä¹‰ä¸ºåˆ°è¿‘/è¿œå¹³é¢çš„è·ç¦»ï¼Œè¿™æ˜¯å¤§äº 0 çš„ï¼Œè€Œä¸”ä»–ä»¬çš„ projection transformation æŠŠæ‹æ‘„å†…å®¹ä»å³æ‰‹åæ ‡ç³»çš„è§†å›¾ç©ºé—´æ˜ å°„åˆ°å·¦æ‰‹åæ ‡ç³»çš„æ ‡å‡†è®¾å¤‡åæ ‡ï¼ˆNDCï¼‰ç©ºé—´ã€‚ç‰¹åˆ«åœ°ï¼Œ$z$ è½´çš„ $[ -n,-f]$ è¢«æ˜ å°„åˆ° $[-1,1]$ ï¼ˆè¿™ä¼¼ä¹è¯´æ˜åœ¨ NDC ç©ºé—´ä¸­ï¼Œ$z$ å€¼è¾ƒå°çš„å†…å®¹æ¸²æŸ“æ›´é å‰ï¼Ÿï¼‰ ä»–ä»¬çš„ $\\text{M}_\\text{their-per}$ ä¸ºï¼š \\large \\text{M}_\\text{their-per} = \\begin{bmatrix} \\frac{1}{\\text{aspect} \\times \\tan(\\frac{\\text{fov}}{2})} & 0 & 0 & 0 \\\\ 0 & \\frac{1}{\\tan(\\frac{\\text{fov}}{2})} & 0 & 0 \\\\ 0 & 0 & -\\frac{f+n}{f-n} & -\\frac{2fn}{f-n} \\\\ 0 & 0 & -1 & 0 \\end{bmatrix}Godot ä½¿ç”¨å’Œ OpenGL ä¸€æ ·çš„çŸ©é˜µï¼Œä¸‹é¢æ˜¯ä»–ä»¬è®¾ç½® $\\text{M}_\\text{per}$ çš„ä»£ç ã€‚è¿˜è¦æ³¨æ„çš„æ˜¯ï¼Œä»–ä»¬ä½¿ç”¨ column-major çš„æ–¹æ³•å­˜å‚¨æ•°æ®ï¼Œå³ M = \\begin{pmatrix} \\text{columns}[0][0] & \\text{columns}[1][0] \\\\ \\text{columns}[0][1] & \\text{columns}[1][1] \\end{pmatrix}void Projection::set_perspective(real_t p_fovy_degrees, real_t p_aspect, real_t p_z_near, real_t p_z_far, bool p_flip_fov) &#123; if (p_flip_fov) &#123; p_fovy_degrees = get_fovy(p_fovy_degrees, 1.0 / p_aspect); &#125; real_t sine, cotangent, deltaZ; real_t radians = Math::deg_to_rad(p_fovy_degrees / 2.0); deltaZ = p_z_far - p_z_near; sine = Math::sin(radians); if ((deltaZ == 0) || (sine == 0) || (p_aspect == 0)) &#123; return; &#125; cotangent = Math::cos(radians) / sine; set_identity(); columns[0][0] = cotangent / p_aspect; columns[1][1] = cotangent; columns[2][2] = -(p_z_far + p_z_near) / deltaZ; columns[2][3] = -1; columns[3][2] = -2 * p_z_near * p_z_far / deltaZ; columns[3][3] = 0; &#125;","categories":[{"name":"å…¬å¼€è¯¾","slug":"å…¬å¼€è¯¾","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/"},{"name":"GAMES101","slug":"å…¬å¼€è¯¾/GAMES101","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/"},{"name":"Notes","slug":"å…¬å¼€è¯¾/GAMES101/Notes","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/Notes/"}],"tags":[]},{"title":"æ€æˆ®å°–å¡”çš„æ¡†æ¶å¦‚æ­¤è‡ªæ´½ï¼Œæˆ‘ä»¬èƒ½ç¦»å¼€å®ƒå—ï¼Ÿ","slug":"game-design/æ€æˆ®å°–å¡”æ¡†æ¶","date":"2025-07-10T12:22:38.000Z","updated":"2025-08-20T11:13:48.877Z","comments":true,"path":"wiki/game-design/æ€æˆ®å°–å¡”æ¡†æ¶/","permalink":"http://rinevard.github.io/wiki/game-design/%E6%9D%80%E6%88%AE%E5%B0%96%E5%A1%94%E6%A1%86%E6%9E%B6/","excerpt":"","text":"img{ width: 70%; } æœ€è¿‘åœ¨è®¾è®¡å¡ç‰Œæ¸¸æˆï¼ˆä½ çŸ¥é“çš„ï¼Œæˆ‘ä¸€ç›´æ˜¯ç‰Œä½¬ï¼‰ï¼Œå‘ç°ä»¥å‰åšçš„ç¿»ç‰Œæ¸¸æˆåŸå‹çš„ç¿»ç‰Œç©æ³•æœ¬èº«éšæœºæ€§è¿‡å¼ºï¼Œä»è€Œæ‹“å±•ç©ºé—´è¿‡å°ï¼Œä½†â€œæ£‹ç›˜ä¸Šçš„éšä»äº¤äº’â€éå¸¸æœ‰è¶£ï¼Œäºæ˜¯å°±æ‰“ç®—ä»å®ƒå‡ºå‘å¼€å§‹è¿›ä¸€æ­¥è®¾è®¡ã€‚åˆæ­¥çš„æƒ³æ³•æ˜¯åšå¡ç‰Œè‚‰é¸½ã€‚ï¼ˆå“‡ï¼Œåˆä¸€ä¸ªå¡ç‰Œè‚‰é¸½ï¼‰ æˆ‘å¯¹è‚‰é¸½å¹¶æ²¡æœ‰ç‰¹åˆ«çš„å–œçˆ±ï¼Œå› ä¸ºæˆ‘ä¸€ç›´æƒ³ç€ï¼Œå¦‚æœæˆ‘ä»¬æ‹¿èµ°äº†ç©å®¶çš„æ—¶é—´ï¼Œèµ·ç è¦è¡¥å¿ä¸€äº›ä»€ä¹ˆï¼Œè€Œè‚‰é¸½ä¼¼ä¹å¹¶æ²¡æœ‰è¡¥å¿ä¸€äº›æˆ‘å¾ˆå–œæ¬¢çš„ä¸œè¥¿ã€‚ä¸è¿‡æ— è®ºå¦‚ä½•ï¼Œæˆ‘è¿˜æ˜¯æŒºå–œæ¬¢æ‰“ç‰Œçš„ï¼Œæ€æˆ®å°–å¡”ã€ç‚‰çŸ³ç‹—å¤´äººå†’é™©ã€é‚ªæ¶å†¥åˆ»éƒ½æ˜¯æˆ‘å¾ˆå–œæ¬¢çš„æ¸¸æˆï¼Œæ‰€ä»¥åšä¸ªå¡ç‰Œè‚‰é¸½ä¹Ÿè¿˜æŒºä¸é”™ã€‚æŒ‰æˆ‘çš„ç†è§£ï¼Œè‚‰é¸½æœ€é‡è¦çš„æ˜¯æ¯ä¸ªå°å…³å¡çš„ä½“éªŒï¼Œå› æ­¤æˆ‘å°±ç€æ‰‹å¼€å§‹åšæ¯å±€ç‰Œå±€çš„åŸå‹äº†ã€‚ ç„¶åè®©æˆ‘ä»¬å¼€å§‹æœ€æœ‰è¶£çš„è®¾è®¡ç¯èŠ‚ï¼ ç°åœ¨æˆ‘ä»¬é¢å‰æœ‰ä¸€ä¸ª3x5çš„ç‰Œæ¡Œï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥è¯¥åšä»€ä¹ˆï¼Ÿæˆ‘ä»¬å…ˆéšä¾¿æ‹¿ç‚¹æ‰‹ç‰Œå§ï¼Œå¯ä»¥æŠŠæ‰‹ç‰Œæ”¾åˆ°ç‰Œæ¡Œä¸Šæ¥å¬å”¤éšä»ï¼Œç„¶åå’Œæ•Œæ–¹éšä»æ‰“æ¶ã€‚ä½†æ‰‹ç‰Œä»å“ªé‡Œæ¥ï¼Œè´¹ç”¨æœºåˆ¶åˆæ€ä¹ˆåšå‘¢ï¼Ÿè¿™å°±å¼•å‡ºäº†æœ¬æ–‡çš„æ ¸å¿ƒå†…å®¹â€”â€”æ€æˆ®å°–å¡”çš„æ¡†æ¶å¦‚æ­¤è‡ªæ´½ï¼Œæˆ‘ä»¬èƒ½ç¦»å¼€å®ƒå—ï¼Ÿ æ€æˆ®å°–å¡”æ€æˆ®å°–å¡”ä¸ºä»€ä¹ˆæ˜¯ç¥ï¼Ÿåœ¨è°ˆè®ºè¿™ä¸ªé—®é¢˜ä¹‹å‰ï¼Œæˆ‘æƒ³å…ˆè¯´è¯´å…¶ä»–å¡ç‰Œæ¸¸æˆç›¸è¾ƒäºçˆ¬å¡”ç©¶ç«Ÿå·®åœ¨äº†å“ªé‡Œï¼ˆè¯¯ æ€»ä¹‹ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹æ€æˆ®å°–å¡”è‡ªæ´½çš„è®¾è®¡å§ã€‚ å•å±€ç‰Œå±€çš„è‡ªæ´½æ€æˆ®å°–å¡”çš„æ‰‹ç‰Œä»å“ªé‡Œæ¥ï¼Œè´¹ç”¨æœºåˆ¶åˆæ˜¯æ€æ ·çš„ï¼Ÿåœ¨æ€æˆ®å°–å¡”ä¸­ï¼Œå¦‚æœä¸è€ƒè™‘ç‰¹æ®Šæ•ˆæœï¼Œæˆ‘ä»¬åœ¨å›åˆå¼€å§‹æ—¶ä¼šä¸¢å¼ƒæ‰€æœ‰æ‰‹ç‰Œå¹¶æŠ½äº”å¼ ç‰Œï¼Œå¹¶ä¸”è´¹ç”¨é‡ç½®ä¸ºä¸‰è´¹ã€‚ æˆ‘ä»¬å…ˆæ¥èŠèŠå‰è€…ã€‚å‰è€…åœ¨ç©èµ·æ¥æ—¶æ„Ÿè§‰ååˆ†è‡ªç„¶ï¼Œä½†ä»è®¾è®¡çš„è§’åº¦ï¼Œå…¶å®æ˜¯ä¸€ä¸ªå¹¶ä¸æ˜¾ç„¶çš„è®¾è®¡ã€‚æˆ‘ç®€å•è°ƒç ”äº†ä¸€ä¸‹ï¼Œå‘ç°å›åˆå¼€å§‹æ—¶åˆ·æ–°æ‰‹ç‰Œä¼¼ä¹æ˜¯DBGæ¸¸æˆçš„æ ‡é…ï¼Œå…¶å¼€å±±é¼»ç¥–æ˜¯ã€Šçš‡èˆ†äº‰éœ¸ã€‹ï¼ˆDominionï¼‰ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹çœ‹å®ƒæœ‰æ€æ ·çš„æ•ˆæœã€‚ æˆ‘è®¤ä¸ºæœ€å…³é”®çš„ä¸¤ç‚¹æ˜¯ï¼Œå‡å°‘äº†å¡æ‰‹çš„å¯èƒ½æ€§ã€é™ä½äº†ç­–ç•¥æ€§ã€‚åˆ·æ–°æ‰‹ç‰Œæ˜¾ç„¶èƒ½å‡å°‘å¡æ‰‹ï¼Œä½†ä¸ºä»€ä¹ˆé™ä½äº†ç­–ç•¥æ€§å‘¢ï¼Œä»¥åŠè¿™æ˜¯å¥½äº‹å—ï¼Ÿ ä¸ºä»€ä¹ˆå®ƒé™ä½äº†ç­–ç•¥æ€§ï¼Ÿå› ä¸ºæ‰‹ç‰Œçš„åˆ·æ–°å°±æ„å‘³ç€ç©å®¶å‡å°‘äº†å¯¹ä¸‹ä¸€å›åˆçš„é¢„æœŸã€‚å›åˆåˆ¶æ¸¸æˆçš„å¾ˆå¤§ä¸€éƒ¨åˆ†ç­–ç•¥æ€§æ˜¯ç”±å¯¹ä¸‹ä¸€å›åˆçš„é¢„æœŸå¼•èµ·çš„ã€‚å¯¹ç‚‰çŸ³ï¼ˆä»¥åŠå¾ˆå¤šCCGï¼‰æ¥è¯´ï¼Œæˆ‘ä¼šæ ¹æ®åœºé¢è€ƒè™‘æ¯å¼ ç‰Œä»€ä¹ˆæ—¶å€™æ‰“å‡ºæœ‰æœ€å¤§æ”¶ç›Šï¼Œç”šè‡³çŒœæµ‹å¯¹æ‰‹æ¥ä¸‹æ¥çš„è¡ŒåŠ¨å¹¶é¢„ç•™ä¸€äº›å¡ç‰Œã€‚è€Œæ€æˆ®å°–å¡”åˆ™æœç»äº†è¿™ç§é¢„æœŸï¼Œè®©ç©å®¶æ ¹æ®æ•Œäººå½“å‰å›åˆçš„æ„å›¾ï¼Œç»“åˆæ¯å›åˆå‘çš„ç‰Œæ‰“æœ€ä¼˜è§£ã€‚ æ˜¯çš„ï¼Œæœ€ä¼˜è§£ã€‚å¯¹å¾ˆå¤šå¡ç‰Œæ¸¸æˆæ¥è¯´ï¼Œæœ€ä¼˜è§£çš„è®¡ç®—é‡æ˜¯æå¤§çš„ï¼Œè€Œæ€æˆ®å°–å¡”æå¤§åœ°ç®€åŒ–äº†è¿™ä¸ªè®¡ç®—é‡ï¼Œè®©æ¯å›åˆæœ€ä¼˜è§£çš„è®¡ç®—éƒ½å¹¶ä¸å›°éš¾ï¼Œä»è€Œé™ä½äº†æ€ç»´é‡ã€‚è¿™å½“ç„¶ä¸æ˜¯åäº‹ï¼Œæˆ‘è®¤ä¸ºè¿™æ˜¯ç›¸å½“ä¼˜ç§€çš„è®¾è®¡ã€‚æ¸¸æˆå¹¶ä¸æ˜¯ä¸ºäº†éš¾å€’ç©å®¶è€Œå­˜åœ¨çš„ï¼Œæ¯”èµ·éš¾å€’ç©å®¶ï¼Œè®©ç©å®¶é€šè¿‡è‡ªå·±çš„åŠªåŠ›å…‹æœéš¾å…³æ›´é‡è¦ã€‚ å¦‚æœæ‰‹ç‰Œåˆ·æ–°ï¼Œé‚£è´¹ç”¨è‡ªç„¶ä¹Ÿè¦åˆ·æ–°ï¼Œè¿™ä¾¿æ˜¯æ‰‹ç‰Œå’Œè´¹ç”¨çš„è‡ªæ´½äº†ã€‚è€Œç”±æ­¤ä¹Ÿèƒ½æ¨å‡ºæ€æˆ®å°–å¡”ä¸åšéšä»çš„ç†ç”±äº†ã€‚éšä»æ˜¯æŒç»­æ€§çš„ï¼Œè€Œæ³•æœ¯æ˜¯ä¸€æ¬¡æ€§çš„ã€‚å¦‚æœæ‰‹ç‰Œåœ¨åˆ·æ–°ï¼Œé‚£æ€ä¹ˆå’Œéšä»æ‰“comboå‘¢ï¼Ÿ æ‰€ä»¥æˆ‘è®¤ä¸ºæ€ªç‰©ç«è½¦å¹¶ä¸å¦‚æ€æˆ®å°–å¡”è‡ªæ´½ã€‚æˆ‘è¿™å›åˆè´¹ç”¨ä¸è¶³ä»¥æ‰“å‡ºæ‰€æœ‰çš„æ²»ç–—ç‰Œï¼Œç„¶åå›åˆç»“æŸæ²»ç–—ç‰Œå°±å…¨è¢«æ‰”åˆ°å¼ƒç‰Œå †é‡Œäº†ï¼Œé‚£æˆ‘ç¼ºçš„comboè°ç»™æˆ‘è¡¥å•ŠğŸ˜­ å¦‚æœæ€»ç»“ä¸€ä¸‹ï¼Œæˆ‘ä¼šè¯´æ€æˆ®å°–å¡”çš„æ¯ä¸€å±€éƒ½ç»™æˆ‘å¸¦æ¥äº†ç‚‰çŸ³é‡Œå¥¥ç§˜æ³•èˆ¬çš„ä½“éªŒï¼Œä¾é æ³•æœ¯è½°ç‚¸åˆ›æ­»å¯¹é¢ï¼Œä½†æ²¡æœ‰å¾ˆå¤šçš„åŒæ—¶ä¾é å¤šå¼ å¡ç‰Œçš„comboï¼Œå•å±€ç‰Œå±€è¿è¥ä¸å¤šã€‚ æ¯å±€æ¸¸æˆçš„è‡ªæ´½æ¯å±€æ¸¸æˆçš„è‡ªæ´½åˆå¯ä»¥åˆ†ä¸ºæ€ç»´é‡è¦æ±‚çš„å¼ å¼›æœ‰åº¦ï¼Œä»¥åŠæ¸¸æˆæœºåˆ¶æœ¬èº«çš„è‡ªæ´½ã€‚ å…ˆè¯´å‰è€…ã€‚å•å±€ç‰Œå±€ç­–ç•¥æ€§è¾ƒä½ï¼Œä½†ä¸€æ•´å±€æ¸¸æˆä¸­è¿è¥æ˜¯ä¸€ä¸ªç­–ç•¥æ€§å¾ˆé«˜çš„æ“ä½œï¼Œä¹Ÿå› æ­¤æ—¢ä¸ä¼šç©å¾—å¤ªç´¯ï¼Œä¹Ÿä¸ä¼šå¤ªç®€å•ã€‚ å†è¯´åè€…ã€‚ä¸»è¦è¦è¯´çš„æ˜¯â€œè¡€é‡ä¿æŒâ€çš„æœºåˆ¶ã€‚å¦‚æœå•å±€ç‰Œå±€çš„åŒæ–¹å§‹ç»ˆå¼ºåº¦æ¥è¿‘ï¼ˆæ¯”å¦‚å¯¹ç§°å¼å¡ç‰Œæ¸¸æˆï¼‰ï¼Œé‚£è¡€é‡æ˜¾ç„¶ä¹Ÿæ˜¯éœ€è¦åœ¨æ¯å±€åˆ·æ–°çš„ã€‚ä¸è¿‡å¯¹éå¯¹ç§°æ¸¸æˆæ¥è¯´ï¼Œæ§åˆ¶å¼ºåº¦æ¥è¿‘å®åœ¨æœ‰ç‚¹å›°éš¾ï¼Œè¡€é‡ä¿æŒå’Œæ¯ä¸€å¤§å±‚çš„è¡€é‡å›å¤æ˜¯ä¸€ä¸ªç®€å•çš„å¹³è¡¡æ‰‹æ®µã€‚ åŸæœ¬è¿˜æƒ³è¯´è¯´æ˜“è¿›éš¾å‡ºçš„å¡ç»„ï¼Œä½†å®åœ¨æ²¡æ„Ÿè§‰å®ƒå’Œåˆ«çš„ä¸œè¥¿å¾ˆâ€œè‡ªæ´½â€ã€‚æˆ‘å¯¹æœºåˆ¶â€œè‡ªæ´½â€çš„ç†è§£æ˜¯æŠŠè¿™ä¸ªæœºåˆ¶æ¢æˆåˆ«çš„ï¼Œæ¸¸æˆå°±å¾ˆéš¾å·¥ä½œäº†ã€‚æ¯”å¦‚æŠŠæŠ½å¡æ¢æˆæ¯å›åˆæŠ½ä¸€å¼ ï¼Œé‚£è´¹ç”¨é‡ç½®å°±ä¼šå¯¼è‡´ä¸€ä¸‹å°±æŠŠç‰Œæ‰“å®Œï¼›æŠŠè¡€é‡æ¢æˆæ¯å±€é‡ç½®ï¼Œé‚£æ¸¸æˆå°±ç®€å•ä¸€å¤§æˆªäº†ã€‚ è€Œå¡ç»„çš„æ˜“è¿›éš¾å‡ºçœ‹èµ·æ¥æ˜¯ä¸€ä¸ªæ§åˆ¶å¼ºåº¦çš„è‡ªç„¶æ‰‹æ®µï¼Œç®€å•åœ°æŠŠå®ƒæ”¹ä¸ºé™åˆ¶å¡ç»„æœ€å°‘åäº”å¼ ï¼Œå…è®¸è‡ªç”±å¢åˆ ï¼Œä¼¼ä¹ä¹Ÿä¸ä¼šç ´åæ•´ä¸ªæ¸¸æˆã€‚è™½ç„¶æ²¡æœ‰åŸæ¥å¥½ï¼Œä½†è‡³å°‘ä¸æ˜¯æ¯ç­æ€§çš„ã€‚ æœ‰è¶£çš„æ˜¯ï¼Œæ€æˆ®å°–å¡”ä¼¼ä¹å¹¶æ²¡æœ‰å¾ˆå¤šæé«˜å•å¡å¼ºåº¦çš„æ‰‹æ®µï¼Œè€Œè®¸å¤šç±»ä¼¼çš„å¡ç‰Œè‚‰é¸½ä¼šåšå¤§é‡çš„å•å¡å¼ºåº¦çš„æé«˜ã€‚æ¯”å¦‚â€”â€”é‚ªæ¶å†¥åˆ»ã€‚ é‚ªæ¶å†¥åˆ»æˆ‘ä»¬èŠèŠè±è¥¿æ¨¡ç»„ï¼Œè¿™æœ€æ¥è¿‘å¡ç‰Œè‚‰é¸½ã€‚ å•å±€ç‰Œå±€çš„è‡ªæ´½é‚ªæ¶å†¥åˆ»æ¯å›åˆæŠ½ä¸€å¼ ç‰Œï¼ˆå¯é€‰æŠ½ç‰Œç»„çš„ç‰Œæˆ–è€…æ¾é¼ ç‰Œï¼‰ï¼Œè´¹ç”¨ä¸è‡ªç„¶å›å¤ï¼Œè€Œæ˜¯ä¾é çŒ®ç¥­éšä»è·å¾—ã€‚å®ƒçš„åŸå‹æ¥è‡ªludum dare 43è¿™åœºgamejamï¼ŒçŒ®ç¥­æœºåˆ¶åœ¨é‚£é‡Œå°±è¢«å®šä¸‹æ¥äº†ã€‚çŒ®ç¥­æœºåˆ¶ç¡®å®éå¸¸å¥½ç©ï¼Œæ‰€ä»¥æ•´ä¸ªæ¸¸æˆéƒ½æ˜¯ä»¥å®ƒä¸ºæ ¸å¿ƒå‘å±•å‡ºå»çš„ã€‚ çŒ®ç¥­æ˜¯è´¹ç”¨æœºåˆ¶ï¼Œé‚£æŠ½ç‰Œæœºåˆ¶æ˜¯æ€ä¹ˆæ ¹æ®çŒ®ç¥­è¢«ç¡®å®šçš„å‘¢ï¼ŸæŠ½ç‰Œæ— éä¸¤ç§ï¼Œä¸€ç§æ˜¯åˆ·æ–°ï¼Œä¸€ç§æ˜¯ä¿ç•™æ‰‹ç‰Œæ¯å›åˆæŠ½å¡ã€‚çŒ®ç¥­æœºåˆ¶å¯¼è‡´é«˜è´¹ç‰Œéš¾ä»¥ç«‹å³æ‰“å‡ºï¼Œæ¯•ç«Ÿå¦‚æœæŠŠé«˜è´¹ç‰Œåˆ·æ‰ï¼Œä¸‹æ¬¡æŠ½åˆ°å°±ä¸çŸ¥é“æ˜¯ä»€ä¹ˆæ—¶å€™äº†ã€‚æ‰€ä»¥æ˜¾ç„¶ä¿ç•™æ‰‹ç‰Œæ›´åˆé€‚ã€‚ æ¯”èµ·æ€æˆ®å°–å¡”ï¼Œé‚ªæ¶å†¥åˆ»çš„å•å±€ç‰Œå±€æ›´å…·â€æŒç»­æ€§â€œï¼Œæˆ‘ä»¬ä¸ä»…èƒ½è€ƒè™‘åˆ°ä¸‹ä¸€å›åˆï¼Œè¿˜èƒ½è€ƒè™‘åˆ°ä¸‹ä¸‹å›åˆã€‚éšä»ç«™åœºã€æ‰‹ç‰Œä¸åˆ·æ–°ã€çŒ®ç¥­æœºåˆ¶éƒ½æ˜¯æŒç»­æ€§çš„ä½“ç°ã€‚ ä½†è¿æ°”æˆåˆ†å®åœ¨æ˜¯å¤ªé«˜äº†ï¼è¿‡ç‰Œçš„ç¼ºä¹å¯¼è‡´æˆ‘ä»¬æåº¦ä¾èµ–äºèµ·æ‰‹ï¼Œè´¹ç”¨ä¸è‡ªç„¶å›å¤å’Œäº”ç‚¹ä¼¤å®³å·®å°±è¾“åˆå¼ºåŒ–äº†è¿™ä¸€ç‚¹ã€‚ ä¸è¿‡è¯´åˆ°åº•ï¼Œè¿™äº›é—®é¢˜éƒ½æ˜¯å› ä¸ºæ¯å›åˆåªæŠ½ä¸€å¼ ç‰Œå¯¹å¡ç»„æ„ç­‘æå‡ºäº†æé«˜çš„è¦æ±‚ã€‚å¥½ç‰Œå¯èƒ½æ²‰åº•ï¼Œæ–°ç‰Œä¹Ÿå¯èƒ½æ²‰åº•ï¼Œä¸€æ²‰åº•è¿™å±€å°±æ²¡æ³•ç©äº†ã€‚ ä½œè€…Danielç”¨å¥‡å¦™çš„æ–¹å¼è§£å†³äº†é—®é¢˜â€”â€”åœ¨åœ°å›¾ä¸Šæä¾›å¤§é‡çš„ç‰Œç»„æ”¹é€ èŠ‚ç‚¹ï¼Œå¹¶é¼“åŠ±è¶…æ¨¡å•å¡ã€‚æˆ‘ä»¬ä¼šåœ¨ä¸‹ä¸€èŠ‚è®¨è®ºè¿™ä¸€ç‚¹ã€‚ åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹é‚ªæ¶å†¥åˆ»çš„åŸå‹å§ï¼šhttps://dmullinsgames.itch.io/sacrifices-must-be-made æ¯å±€æ¸¸æˆçš„è‡ªæ´½ å¦‚æˆ‘ä»¬ä¹‹å‰æ‰€è¨€ï¼Œæ¯å›åˆåªæŠ½ä¸€å¼ ç‰Œå¯¹å¡ç»„æ„ç­‘æå‡ºäº†æé«˜çš„è¦æ±‚ã€‚ä¸€ä¸ªè‡ªç„¶çš„æ€è·¯æ˜¯å…è®¸ç©å®¶è‡ªç”±è°ƒæ•´å¡ç»„ï¼Œåªæ˜¯è®¾ç½®äº›è®¸é™åˆ¶ï¼Œæ¯”å¦‚æ¯å¼ ç‰Œæœ€å¤šå¸¦ä¸¤å¼ ã€è‡³å°‘äºŒåå¼ ç‰Œä»€ä¹ˆçš„ã€‚ä½†é‚ªæ¶å†¥åˆ»å¹¶ä¸æ˜¯è¿™ä¹ˆåšçš„ã€‚ åœ¨é‚ªæ¶å†¥åˆ»ä¸­ï¼Œåˆ å¡å¹¶ä¸æ˜¯å¾ˆå›°éš¾çš„äº‹ï¼Œé€ è¶…æ¨¡å•å¡ä¹Ÿéå¸¸ç®€å•ã€‚ç¥­å›ã€çœŸèŒå­¦å®¶èŠ‚ç‚¹å¯ä»¥åŒæ—¶å®ç°è¿™ä¸¤ç‚¹ï¼Œéª¨ç‹å¯ä»¥åˆ å¡ï¼Œç”»å®¶å¯ä»¥å¤åˆ¶è¶…æ¨¡å•å¡ï¼Œæ¯å±‚å¯ä»¥æ‹¿ä¸¤ä¸‰å¼ ç¨€æœ‰å¡ã€‚è¿™å°±è®©ç©å®¶èƒ½å¤Ÿè¿…é€Ÿæå‡å•å¡è´¨é‡ï¼Œé è¶…æ¨¡å•å¡å’Œå¯¹é¢æ‰“æ¶ã€‚ ä¹Ÿå› æ­¤åœ¨é‚ªæ¶å†¥åˆ»ä¸­ç»å¸¸ä¼šå‡ºç°ä¸€å›åˆç§’å¯¹é¢çš„å±€ï¼Œè¯´å®è¯æˆ‘è§‰å¾—è¿™å¹¶ä¸æ˜¯å¤ªå¥½çš„è®¾è®¡ï¼Œä¸è¿‡ç¡®å®æŒºè‡ªæ´½çš„ã€‚ æˆ‘çš„æ¸¸æˆï¼ˆå“‡ï¼Œä½ çš„æ¸¸æˆå’Œæ€æˆ®å°–å¡”ã€é‚ªæ¶å†¥åˆ»éƒ½æ˜¯ä¸€çº§æ ‡é¢˜ï¼Œé‚£ä¸€å®šå’Œä»–ä»¬ä¸€æ ·å‰å®³å§ ç°åœ¨æˆ‘ä»¬é¢å‰æœ‰ä¸€ä¸ª3x5çš„ç‰Œæ¡Œï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥è¯¥åšä»€ä¹ˆï¼Ÿæˆ‘ä»¬å…ˆéšä¾¿æ‹¿ç‚¹æ‰‹ç‰Œå§ï¼Œå¯ä»¥æŠŠæ‰‹ç‰Œæ”¾åˆ°ç‰Œæ¡Œä¸Šæ¥å¬å”¤éšä»ï¼Œç„¶åå’Œæ•Œæ–¹éšä»æ‰“æ¶ã€‚ä½†æ‰‹ç‰Œä»å“ªé‡Œæ¥ï¼Œè´¹ç”¨æœºåˆ¶åˆæ€ä¹ˆåšå‘¢ï¼Ÿ éšä»æ˜¯ç«™åœºçš„æŒç»­æ€§çš„ä¸œè¥¿ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±ä¸åˆ·æ–°æ‰‹ç‰Œäº†ï¼Œè€Œæ˜¯æ¯å›åˆæŠ½ä¸€å¼ ç‰Œã€‚è´¹ç”¨åˆ·æ–°ä¹Ÿæœªå°ä¸å¯ï¼Œä¸è¿‡æˆ‘æŒºå–œæ¬¢é‚ªæ¶å†¥åˆ»çš„çŒ®ç¥­æœºåˆ¶çš„ï¼Œæ‰€ä»¥å°±ç›´æ¥æ¬è¿‡æ¥ç”¨äº†ã€‚é‚ªæ¶å†¥åˆ»å¤ªå¡æ‰‹äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¯å›åˆå†ç»™ç©å®¶å¡ä¸€å¼ æ¾é¼ ç‰Œã€‚ ä¸è¿‡è¦è¯´æ˜çš„æ˜¯ï¼Œè¿™äº›åªæ˜¯ç†è®ºæ¨å¯¼ã€‚åœ¨å®é™…åšåŸå‹çš„æ—¶å€™æˆ‘ä¹Ÿæµ‹è¯•äº†åˆ·æ–°æ‰‹ç‰Œã€åˆ·æ–°è´¹ç”¨ï¼Œå‘ç°ç¡®å®è¿˜æ˜¯æ¯å›åˆæŠ½ä¸€å¼ ç‰Œ+çŒ®ç¥­æœºåˆ¶å’Œè¿™ä¸ªéšä»äº¤äº’æœºåˆ¶çš„å¥‘åˆåº¦æœ€é«˜ã€‚ç†è®ºå’Œå®é™…ç›¸ç¬¦è¯´æ˜ç†è®ºæœ‰ä¸€å®šæŒ‡å¯¼æ„ä¹‰ï¼Œä»¥åå¯ä»¥æ¥ç€ç”¨ï¼Œç†è®ºä¸å®é™…ä¸ç¬¦è¯´æ˜ç†è®ºåœ¨èƒ¡æ‰¯ï¼Œå°±è¦è°ƒæ•´äº†ã€‚ è‡³æ­¤ï¼Œæˆ‘ä»¬å®Œæˆäº†å•å±€ç‰Œå±€çš„è®¾è®¡ã€‚ä¹‹åæˆ‘æŠŠç‰Œæ¡Œæ”¹æˆäº†4x5ï¼Œå‘ç°æ›´æœ‰ç­–ç•¥ä¹Ÿæ›´å¥½ç©äº†ï¼Œæ‰¾äººè¯•ç©äº†ä¸€ä¸‹ä¹‹åæ¿€è¿›åœ°æ”¹æˆäº†5x7ï¼Œå±…ç„¶åˆæ›´æœ‰ç­–ç•¥æ›´å¥½ç©äº†ï¼Œé‚£æš‚æ—¶å°±è¿™æ ·å§ã€‚ è¿™é‡Œæ˜¯è¯•ç©é“¾æ¥ï¼š å¼€å§‹æ¸¸æˆï¼ˆå°†åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€ï¼‰ å–œæ¬¢çš„è¯å¯ä»¥å¡«ä¸ªé—®å·ï¼Œè°¢è°¢å–µï¼ é—®å·ï¼ˆå°†åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€ï¼‰ é‚£ä¹ˆæ¯å±€æ¸¸æˆè¯¥æ€ä¹ˆåšå‘¢ï¼Ÿç”±äºæˆ‘ä»¬çš„æœºåˆ¶å’Œé‚ªæ¶å†¥åˆ»ç›¸ä¼¼ï¼Œæ‰€ä»¥å®ƒä¼šé‡åˆ°çš„é—®é¢˜æˆ‘ä»¬ä¹Ÿéƒ½ä¼šé‡åˆ°ã€‚æœ€å…³é”®çš„ä¸¤ç‚¹å°±æ˜¯ç‰Œè¶Šå¤šè¶Šèœå’Œå…³é”®ç‰Œæ²‰åº•ã€‚ ä¸€å¼€å§‹æˆ‘å°è¯•è§£å†³å‰è€…ï¼Œç„¶åå¶ç„¶é—´å¾—åˆ°äº†ä¸€ä¸ªæˆ‘è§‰å¾—è¿˜ä¸é”™çš„ï¼Œèƒ½åŒæ—¶è§£å†³è¿™ä¸¤ä¸ªé—®é¢˜çš„æ–¹æ¡ˆã€‚ è§£å†³é—®é¢˜æ— éä»å•å±€ç‰Œå±€å’Œæ•´å±€æ¸¸æˆè€ƒè™‘ï¼Œæˆ‘æƒ³äº†åŠå¤©æ²¡æƒ³åˆ°æ€ä¹ˆç”¨åœ¨å•å±€å†…è§£å†³é—®é¢˜ï¼Œäºæ˜¯å°±æƒ³ç ”ç©¶ä¸‹é€šè¿‡è°ƒæ•´æ•´å±€æ¸¸æˆçš„è¿è¥æ¥è§£å†³é—®é¢˜ã€‚ åœ¨ç©å¡ç‰Œè‚‰é¸½çš„æ—¶å€™ï¼Œæˆ‘ä»¬ç»å¸¸é‡åˆ°é€‰ç‰ŒåŠ å…¥ç‰Œç»„ä¸å¦‚è·³è¿‡çš„æƒ…å†µï¼Œè¿™å°±æ˜¯å…¸å‹çš„â€œç‰Œè¶Šå¤šè¶Šèœâ€ã€‚é‚£æ€ä¹ˆä¿è¯æ¯æ¬¡é€‰ç‰Œéƒ½æœ‰è¡¥å¼ºå‘¢ï¼Ÿè€ƒè™‘åˆ°æˆ‘ä»¬çš„çŒ®ç¥­æœºåˆ¶ï¼Œæˆ‘å°±æƒ³åˆ°æŠŠå¯é€‰ç‰ŒçŒ®ç¥­æˆéšæ—¶å¯ä»¥ä½¿ç”¨çš„ä¸€æ¬¡æ€§é“å…·ï¼Œè¿™æ ·æ¯æ¬¡é€‰ç‰Œéƒ½è‡³å°‘èƒ½è®©ç©å®¶å˜å¼ºä¸€ç‚¹ã€‚ é“å…·æ€ä¹ˆåšå‘¢ï¼Ÿåˆæ­¥æƒ³æ³•æ˜¯æŠŠç‰Œçš„è´¹ç”¨å‡åŠï¼Œæ³•æœ¯ç‰Œä¸å˜ï¼Œéšä»ç‰Œåœ¨ä¸‹ä¸ªå›åˆå¼€å§‹æ—¶è‡ªåŠ¨è¢«çŒ®ç¥­ã€‚ æœ‰è¶£çš„æ˜¯ï¼Œå®ƒä¹Ÿç¼“è§£äº†å…³é”®ç‰Œæ²‰åº•çš„é—®é¢˜ï¼Œæ¯•ç«Ÿä¸€æ–¹é¢é“å…·èƒ½å¸®åŠ©æˆ‘ä»¬è¿‡æ¸¡ï¼Œå¦ä¸€æ–¹é¢æˆ‘ä»¬ä¹Ÿèƒ½ç›´æ¥æŠŠå…³é”®ç‰ŒçŒ®ç¥­æˆé“å…·ï¼Œç„¶åå°±ä¸ç”¨æ‹…å¿ƒæ²‰åº•äº†ã€‚","categories":[{"name":"æ¸¸æˆè®¾è®¡","slug":"æ¸¸æˆè®¾è®¡","permalink":"http://rinevard.github.io/categories/%E6%B8%B8%E6%88%8F%E8%AE%BE%E8%AE%A1/"}],"tags":[]},{"title":"_æˆ‘ä¹Ÿæƒ³åšå‡ºä¼˜ç§€çš„ä½œå“","slug":"others/thoughts/æˆ‘ä¹Ÿæƒ³åšå‡ºä¼˜ç§€çš„ä½œå“","date":"2025-06-16T14:03:30.000Z","updated":"2025-07-18T15:06:40.639Z","comments":true,"path":"wiki/others/thoughts/æˆ‘ä¹Ÿæƒ³åšå‡ºä¼˜ç§€çš„ä½œå“/","permalink":"http://rinevard.github.io/wiki/others/thoughts/%E6%88%91%E4%B9%9F%E6%83%B3%E5%81%9A%E5%87%BA%E4%BC%98%E7%A7%80%E7%9A%84%E4%BD%9C%E5%93%81/","excerpt":"","text":"æœ€è¿‘åšäº†ç‰Œç”Ÿä¸‡ç‰©ï¼Œæ„Ÿè§‰æŒºéš¾å—çš„ã€‚ä¸€ç›´ä»¥æ¥æˆ‘éƒ½å¸Œæœ›æ¯ä¸€éƒ¨ä½œå“éƒ½åšå¾—æ¯”ä¸Šä¸€éƒ¨æ›´å¥½ï¼Œè¿™ä¸€éƒ¨çœ‹èµ·æ¥æ¯”undertetriså¥½ä¸€ç‚¹å—ï¼Ÿæˆ–è®¸å§ï¼Œä½†æˆ‘å°±æ˜¯æ„Ÿè§‰ä¸å¼€å¿ƒã€‚ æƒ³æ¥å¯èƒ½æ˜¯å› ä¸ºè¿™ä¸æ˜¯æˆ‘å–œæ¬¢çš„ä½“éªŒå§ã€‚æˆ‘æƒ³åšå‡ºèƒ½æ‰“åŠ¨ç©å®¶çš„ä½œå“ï¼Œèƒ½è®©ç©å®¶è®°ä½ä¸€è¾ˆå­ï¼Œè‡³å°‘æ˜¯ä¸€å¹´çš„ä½œå“ï¼Œè€Œä¸æ˜¯è¿™æ ·çš„è«åå…¶å¦™çš„â€œèåˆå¡ç‰Œâ€ã€‚ç©ç€è¿™ä¸ªæ¸¸æˆæ—¶ï¼Œæ¯”èµ·å¯¹ä½œå“çš„æ»¡æ„ï¼Œæ›´å¤šçš„æ˜¯çƒ¦èºã€‚ä¹Ÿå¯èƒ½æ˜¯å› ä¸ºç°åœ¨æ˜¯è€ƒè¯•å‘¨å‹åŠ›å¤§å§ï¼Œæˆ‘ä¹Ÿä¸æ¸…æ¥šã€‚ æˆ‘æƒ³å’ŒLLMä¸€èµ·åˆ›é€ ä¸€ä¸ªä¸–ç•Œå•Šï¼Œä¸€ä¸ªæ ©æ ©å¦‚ç”Ÿçš„ä¸–ç•Œã€‚æ¯ä¸ªäº‹ä»¶éƒ½è®©äººæ€è€ƒï¼Œæ¯ä¸ªè§’è‰²éƒ½ç»™äººæ·±åˆ»å°è±¡ï¼Œè€Œä¸æ˜¯ç°åœ¨çš„åè¯å †ç Œã€æ•°å€¼è†¨èƒ€ã€‚LLMä¸ä¼šå†™æ•…äº‹ä»æ¥éƒ½ä¸æ˜¯å€Ÿå£ï¼Œæˆ‘ä»¬æ˜¯ä¸æ˜¯æœ¬å¯ä»¥åšå¾—æ›´å¥½ï¼Ÿ æˆ‘è¯¥æ€ä¹ˆåšæ‰å¥½ï¼Ÿæˆ‘è¯¥å‰å¾€ä½•æ–¹ï¼Ÿ æˆ‘çŸ¥é“ï¼Œè®©LLMç”Ÿæˆçš„ä¸–ç•Œåƒã€Šè‹ä¸¹çš„æ¸¸æˆã€‹ä¸€æ ·æœ¬èº«å°±æ˜¯ä¸€ä»¶ä¸ç°å®çš„äº‹æƒ…ã€‚ä½†èµ·ç å®ƒè¦åƒæ˜¯ä¸€ä¸ªä¸–ç•Œå§ï¼Œæ•´ä¸ªå†’é™©æ˜¯æœ‰æ•…äº‹æ€§çš„å§ï¼Œç°åœ¨æ˜¯ä¸ªä»€ä¹ˆç©æ„ï¼Ÿï¼Ÿï¼Ÿæ›´å¯æ°”çš„æ˜¯è¿™ç©æ„è¿˜çœŸæœ‰å¯ç©æ€§ï¼Œåšäº†ä¸€ä¸ªé å¼ºåŒ–ç¨‹åºå’Œæ•°å€¼è†¨èƒ€å †ç Œèµ·æ¥çš„ä¸œè¥¿çœŸåƒæ˜¯å¯¹è‡ªå·±çš„ä¾®è¾±ï¼ è‡³å°‘ï¼Œå®ƒçš„ä½“éªŒä¸è¯¥æ˜¯æ•°å€¼è†¨èƒ€ã€‚è‡³å°‘ï¼Œè®©ç©å®¶ç©ä¸‹å»çš„åŠ¨åŠ›ä¸è¯¥æ˜¯å¼ºåŒ–ç¨‹åºã€‚å¦‚æœæˆ‘ä»¬æ‹¿èµ°äº†ç©å®¶çš„æ—¶é—´ï¼Œæˆ‘ä»¬èµ·ç åº”å½“è¡¥å¿ä¸€äº›ä»€ä¹ˆæ‰å¯¹ï¼Œè€Œä¸è¯¥å¾’ç•™æ‚”æ¨æ„Ÿã€‚ å¯èƒ½ä¹Ÿæœ‰ç‚¹åæ¿€äº†ï¼Œå¯èƒ½åªæ˜¯æˆ‘è‡ªå·±ä¸å–œæ¬¢è¿™ç§ç±»å‹è€Œå·²â€¦â€¦ç”šè‡³æˆ‘è‡ªå·±ä¹Ÿè§‰å¾—è¿˜ç®—å¯ä»¥ï¼Œè‡³å°‘ç¡®å®æœ‰è®©æˆ‘å°è±¡æ·±åˆ»çš„æ—¶åˆ»ã€‚ä½†æˆ‘è¿˜æ˜¯æ„Ÿè§‰ä¸å¼€å¿ƒï¼Œæ¯•ç«Ÿï¼Œâ€œæˆ‘ä»¬æ˜¯ä¸æ˜¯æœ¬å¯ä»¥åšå¾—æ›´å¥½ï¼Ÿâ€","categories":[{"name":"æ‚è°ˆ","slug":"æ‚è°ˆ","permalink":"http://rinevard.github.io/categories/%E6%9D%82%E8%B0%88/"},{"name":"ç¢ç¢å¿µ","slug":"æ‚è°ˆ/ç¢ç¢å¿µ","permalink":"http://rinevard.github.io/categories/%E6%9D%82%E8%B0%88/%E7%A2%8E%E7%A2%8E%E5%BF%B5/"}],"tags":[]},{"title":"ç¬¬ä¸€ç« â€”â€”ç³»ç»Ÿæ¥å£","slug":"learning/open-course/MIT-6.S081/Notes/note1-sys-interface","date":"2025-06-01T03:18:38.000Z","updated":"2025-08-22T03:14:43.992Z","comments":true,"path":"wiki/learning/open-course/MIT-6.S081/Notes/note1-sys-interface/","permalink":"http://rinevard.github.io/wiki/learning/open-course/MIT-6.S081/Notes/note1-sys-interface/","excerpt":"","text":"img{ width: 70%; } å¸¸ç”¨çš„ç³»ç»Ÿæ¥å£ ç³»ç»Ÿè°ƒç”¨ æè¿° fork() åˆ›å»ºè¿›ç¨‹ exit() ç»“æŸå½“å‰è¿›ç¨‹ wait() ç­‰å¾…å­è¿›ç¨‹ç»“æŸ kill(pid) ç»“æŸ pid æ‰€æŒ‡è¿›ç¨‹ getpid() è·å¾—å½“å‰è¿›ç¨‹ pid sleep(n) ç¡çœ  n ç§’ exec(filename, *argv) åŠ è½½å¹¶æ‰§è¡Œä¸€ä¸ªæ–‡ä»¶ sbrk(n) ä¸ºè¿›ç¨‹å†…å­˜ç©ºé—´å¢åŠ  n å­—èŠ‚ open(filename, flags) æ‰“å¼€æ–‡ä»¶ï¼Œflags æŒ‡å®šè¯»/å†™æ¨¡å¼ read(fd, buf, n) ä»æ–‡ä»¶ä¸­è¯» n ä¸ªå­—èŠ‚åˆ° buf write(fd, buf, n) ä» buf ä¸­å†™ n ä¸ªå­—èŠ‚åˆ°æ–‡ä»¶ close(fd) å…³é—­æ‰“å¼€çš„ fd dup(fd) å¤åˆ¶ fd pipe( p) åˆ›å»ºç®¡é“ï¼Œ å¹¶æŠŠè¯»å’Œå†™çš„ fd è¿”å›åˆ°p chdir(dirname) æ”¹å˜å½“å‰ç›®å½• mkdir(dirname) åˆ›å»ºæ–°çš„ç›®å½• mknod(name, major, minor) åˆ›å»ºè®¾å¤‡æ–‡ä»¶ fstat(fd) è¿”å›æ–‡ä»¶ä¿¡æ¯ link(f1, f2) ç»™ f1 åˆ›å»ºä¸€ä¸ªæ–°åå­—(f2) unlink(filename) åˆ é™¤æ–‡ä»¶ è¿›ç¨‹ ç³»ç»Ÿè°ƒç”¨ æè¿° fork() åˆ›å»ºè¿›ç¨‹ exit() ç»“æŸå½“å‰è¿›ç¨‹ wait() ç­‰å¾…å­è¿›ç¨‹ç»“æŸ kill(pid) ç»“æŸ pid æ‰€æŒ‡è¿›ç¨‹ getpid() è·å¾—å½“å‰è¿›ç¨‹ pid exec(filename, *argv) åŠ è½½å¹¶æ‰§è¡Œä¸€ä¸ªæ–‡ä»¶ sbrk(n) ä¸ºè¿›ç¨‹å†…å­˜ç©ºé—´å¢åŠ  n å­—èŠ‚ I/O ç³»ç»Ÿè°ƒç”¨ æè¿° open(filename, flags) æ‰“å¼€æ–‡ä»¶ï¼Œflags æŒ‡å®šè¯»/å†™æ¨¡å¼ read(fd, buf, n) ä»æ–‡ä»¶ä¸­è¯» n ä¸ªå­—èŠ‚åˆ° buf write(fd, buf, n) ä» buf ä¸­å†™ n ä¸ªå­—èŠ‚åˆ°æ–‡ä»¶ close(fd) å…³é—­æ‰“å¼€çš„ fd dup(fd) å¤åˆ¶ fd ä»£ç ç¤ºä¾‹ï¼š char buf[512]; void cat(int fd) &#123; int n; while ((n = read(fd, buf, sizeof(buf))) > 0) &#123; // å†™å…¥æ ‡å‡†è¾“å‡º if (write(1, buf, n) != n) &#123; fprintf(2, \"cat: write error\\n\"); exit(1); &#125; &#125; if (n &lt; 0) &#123; fprintf(2, \"cat: read error\\n\"); exit(1); &#125; &#125; int main(int argc, char *argv[]) &#123; int fd, i; if (argc &lt;= 1) &#123; cat(0); exit(0); &#125; for (i = 1; i &lt; argc; i++) &#123; if ((fd = open(argv[i], O_RDONLY)) &lt; 0) &#123; fprintf(2, \"cat: cannot open %s\\n\", argv[i]); exit(1); &#125; cat(fd); close(fd); &#125; exit(0); &#125; ä¸å¦¨å†æ¥çœ‹çœ‹CSAPPçš„ä¸¤å¼ å›¾ openä¸¤æ¬¡ï¼š forkï¼š ç®¡é“ ç³»ç»Ÿè°ƒç”¨ æè¿° pipe( p) åˆ›å»ºç®¡é“ï¼Œ å¹¶æŠŠè¯»å’Œå†™çš„ fd è¿”å›åˆ°pï¼Œå…¶ä¸­pæ˜¯ int p[2] p[0]: è¯»ç«¯(read end)çš„æ–‡ä»¶æè¿°ç¬¦ p[1]: å†™ç«¯(write end)çš„æ–‡ä»¶æè¿°ç¬¦ æ ·ä¾‹ï¼š grep fork sh.c | wc -l å‘½ä»¤å°†ç¬¬ä¸€ä¸ªå‘½ä»¤(grep)çš„è¾“å‡ºä½œä¸ºç¬¬äºŒä¸ªå‘½ä»¤(wc)çš„è¾“å…¥ï¼Œ| å°±æ˜¯ç®¡é“ç¬¦å·ã€‚ ä¸‹é¢çš„ä»£ç æ˜¯ | çš„å®ç°ç¤ºä¾‹ï¼Œå¤§ä½“æ€è·¯æ˜¯æŠŠ | å·¦è¾¹çš„æ ‡å‡†è¾“å‡ºé‡å®šå‘åˆ°pipeçš„å†™ç«¯ï¼ŒæŠŠ | å³è¾¹çš„æ ‡å‡†è¾“å…¥é‡å®šå‘åˆ°pipeçš„è¯»ç«¯ã€‚ æ³¨æ„è¦å…³é—­ç®¡é“çš„æ‰€æœ‰å†™å…¥ç«¯æ¥è®© read è¿”å›ï¼Œå› ä¸ºå½“ pipe ä¸­æ²¡æœ‰æ•°æ®æ—¶ï¼Œread ä¼šé˜»å¡ç­‰å¾…æ–°æ•°æ®å†™å…¥ï¼Œæˆ–æ˜¯å†™å…¥ç«¯éƒ½å…³é—­ï¼Œå¦‚æœæœ‰æ–°æ•°æ®å†™å…¥å°±è¯»å–ï¼Œå¦‚æœæ‰€æœ‰å†™å…¥ç«¯éƒ½å…³é—­å°±è¿”å› 0ï¼ˆå¯¹åº”EOFï¼‰. // å‡è®¾æˆ‘ä»¬çš„å‘½ä»¤æ˜¯ grep fork sh.c | wc -l case PIPE: pcmd = (struct pipecmd *)cmd; if (pipe(p) &lt; 0) panic(\"pipe\"); if (fork1() == 0) &#123; close(1); // é‡Šæ”¾æ–‡ä»¶æè¿°ç¬¦1ï¼Œä»è€Œè®©dupæŠŠæ–‡ä»¶æè¿°ç¬¦1ç»‘å®šåˆ°p[1]æŒ‡å‘çš„ä¸œè¥¿ dup(p[1]); //æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬åœ¨é‡å®šå‘æ ‡å‡†è¾“å‡ºåˆ°pipeçš„å†™ç«¯ close(p[0]); close(p[1]); runcmd(pcmd->left); // å¯¹åº” grep fork sh.c &#125; if (fork1() == 0) &#123; close(0); // ä¸ä¸Šé¢ç±»ä¼¼ï¼Œé‡å®šå‘æ ‡å‡†è¾“å…¥åˆ°pipeçš„è¯»ç«¯ dup(p[0]); close(p[0]); close(p[1]); runcmd(pcmd->right); // å¯¹åº” wc -l &#125; close(p[0]); close(p[1]); wait(0); wait(0); break; æ–‡ä»¶ç³»ç»Ÿ ç³»ç»Ÿè°ƒç”¨ æè¿° chdir(dirname) æ”¹å˜å½“å‰ç›®å½• mkdir(dirname) åˆ›å»ºæ–°çš„ç›®å½• mknod(name, major, minor) åˆ›å»ºè®¾å¤‡æ–‡ä»¶ fstat(fd) è¿”å›æ–‡ä»¶ä¿¡æ¯ link(f1, f2) ç»™ f1 åˆ›å»ºä¸€ä¸ªæ–°åå­—(f2) unlink(filename) åˆ é™¤æ–‡ä»¶ æˆ‘ä»¬é€šå¸¸è®¤ä¸ºæ–‡ä»¶åå°±æ˜¯æ–‡ä»¶æœ¬èº«ï¼Œä½†å®é™…ä¸Šåç§°æ˜¯ä¸€ä¸ªç¡¬é“¾æ¥(hard link)ã€‚ä¸€ä¸ªæ–‡ä»¶å¯ä»¥æœ‰å¤šä¸ªç¡¬é“¾æ¥â€”â€”ä¾‹å¦‚ï¼Œä¸€ä¸ªç›®å½•è‡³å°‘æœ‰ä¸¤ä¸ªç¡¬é“¾æ¥ï¼šç›®å½•åå’Œ . ï¼ˆåœ¨ç›®å½•å†…æ—¶ï¼‰ã€‚å®ƒè¿˜æœ‰æ¥è‡ªæ¯ä¸ªå­ç›®å½•çš„ä¸€ä¸ªç¡¬é“¾æ¥ï¼ˆæ¯ä¸ªå­ç›®å½•ä¸­çš„ .. æ–‡ä»¶ï¼‰ã€‚ é‚£æ–‡ä»¶æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿä¸€ä¸ªæ–‡ä»¶å’Œä¸€ä¸ª inode ä¸€ä¸€å¯¹åº”ï¼Œinodeå­˜æ”¾ç€è¿™ä¸ªæ–‡ä»¶çš„ç›¸å…³ä¿¡æ¯ xv6ç³»ç»Ÿçš„inodeç»“æ„åŒ…æ‹¬ä¸‹é¢è¿™äº›å†…å®¹ï¼š struct dinode &#123; short type; // File type short major; // Major device number (T_DEVICE only) short minor; // Minor device number (T_DEVICE only) short nlink; // Number of links to inode in file system uint size; // Size of file (bytes) uint addrs[NDIRECT + 1]; // Data block addresses &#125;; å¯ä»¥é€šè¿‡ fstat è·å–æ–‡ä»¶æè¿°ç¬¦æŒ‡å‘çš„æ–‡ä»¶çš„ä¿¡æ¯ã€‚dinodeæ˜¯ç£ç›˜ä¸Šå­˜å‚¨çš„è¯¦ç»†ä¿¡æ¯ï¼Œstatæ˜¯æš´éœ²ç»™ç”¨æˆ·çš„æ–‡ä»¶ä¿¡æ¯æ¥å£ struct stat &#123; int dev; // File system's disk device uint ino; // Inode number short type; // Type of file short nlink; // Number of links to file uint64 size; // Size of file in bytes &#125;; ä»…å½“æˆ‘ä»¬æŠŠæ‰€æœ‰æŒ‡å‘æŸä¸ªinodeçš„é“¾æ¥éƒ½åˆ é™¤ï¼Œè¿™ä¸ªinodeæ‰ä¼šè¢«åˆ é™¤ã€‚ åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ç”¨ ln åˆ›å»ºäº†ä¸¤ä¸ªè¿æ¥ file2 å’Œ file3ï¼Œå®ƒä»¬éƒ½å’Œ file1 æŒ‡å‘çš„ inode ç›¸åŒã€‚å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœç”¨ echo ä¿®æ”¹ file2ï¼Œé‚£ä¹ˆ file1 ä¹Ÿä¼šè¢«ä¿®æ”¹ï¼Œå› ä¸ºæˆ‘ä»¬ä¿®æ”¹çš„å®é™…ä¸Šæ˜¯ inodeï¼Œè€Œå®ƒä»¬æŒ‡å‘åŒä¸€ä¸ªinodeã€‚ls -l åˆ—å‡ºç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•çš„è¯¦ç»†ä¿¡æ¯ï¼Œç¬¬äºŒä¸ªå€¼æ˜¯inodeçš„linkæ•°ã€‚æˆ‘ä»¬å¯ä»¥æŠŠé“¾æ¥è§†ä½œæ–‡ä»¶çš„â€œåˆ«åâ€ã€‚ $ echo &quot;What&#39;s in a name? That which we call a rose, by any other word would smell as sweet.&quot; &gt; file1.txt $ ls file1.txt open-course programs $ cat file1.txt What&#39;s in a name? That which we call a rose, by any other word would smell as sweet. $ ln file1.txt file2.txt $ ln file1.txt file3.txt $ ls -l total 20 -rw-r--r-- 3 rinevard rinevard 85 May 29 11:37 file1.txt -rw-r--r-- 3 rinevard rinevard 85 May 29 11:37 file2.txt -rw-r--r-- 3 rinevard rinevard 85 May 29 11:37 file3.txt drwxr-xr-x 3 rinevard rinevard 4096 May 28 11:00 open-course drwxr-xr-x 2 rinevard rinevard 4096 May 28 10:19 programs $ echo &quot;-- William Shakespeare&quot; &gt;&gt; file2.txt $ cat file1.txt What&#39;s in a name? That which we call a rose, by any other word would smell as sweet. -- William Shakespeare ä½ å¯èƒ½ä¼šå¥½å¥‡ç›®å½•çš„é“¾æ¥æ•°æ€ä¹ˆè®¡ç®—ï¼Œæ˜¯è¿™æ ·çš„ï¼š æ¯ä¸ªç›®å½•é»˜è®¤æœ‰2ä¸ªé“¾æ¥ï¼Œä¸€ä¸ªæ˜¯ç›®å½•è‡ªèº«çš„â€.â€ï¼Œå¦ä¸€ä¸ªæ˜¯çˆ¶ç›®å½•ä¸­æŒ‡å‘è¯¥ç›®å½•çš„é“¾æ¥ ç›®å½•ä¸­æ¯åŒ…å«ä¸€ä¸ªå­ç›®å½•ï¼Œé“¾æ¥æ•°å°±ä¼š+1ï¼Œå› ä¸ºæ¯ä¸ªå­ç›®å½•éƒ½ä¼šåˆ›å»ºâ€..â€é“¾æ¥æŒ‡å‘çˆ¶ç›®å½• åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œrootdir çš„é“¾æ¥æ•°æ˜¯ 4ï¼Œå› ä¸ºçˆ¶ç›®å½•æœ‰ä¸€ä¸ªæŒ‡å‘å®ƒçš„é“¾æ¥â€rootdirâ€ï¼Œå®ƒè‡ªå·±æœ‰ä¸€ä¸ªæŒ‡å‘è‡ªå·±çš„é“¾æ¥â€.â€ï¼Œå®ƒçš„ä¸¤ä¸ªå­ç›®å½•dir1å’Œdir2åˆ†åˆ«æœ‰æŒ‡å‘å®ƒçš„é“¾æ¥â€..â€ ~/open-course/rootdir$ ls dir1 dir2 file1.md file2.md file3.md ~/open-course/rootdir$ ls ../ -l total 8 drwxr-xr-x 11 rinevard rinevard 4096 May 31 16:40 mit-6.828 drwxr-xr-x 4 rinevard rinevard 4096 Jun 1 10:58 rootdir æ–‡ä»¶è·¯å¾„æ ¼å¼ï¼šä»¥ â€œ/â€ å¼€å¤´çš„æ˜¯ä»æ ¹ç›®å½•å‡ºå‘çš„è·¯å¾„ï¼Œå¦åˆ™æ˜¯ä»å½“å‰æ–‡ä»¶å¤¹å‡ºå‘çš„è·¯å¾„ ~/open-course$ ls mit-6.828 ~/open-course$ ls mit-6.828/ LICENSE Makefile README conf grade-lab-util gradelib.py kernel mkfs user ~/open-course$ ls /home/rinevard/ open-course programs unix shellçš„è®¸å¤šå‘½ä»¤éƒ½æ˜¯ç”¨æˆ·çº§åˆ«çš„ï¼Œè€Œéå†…ç½®çš„ã€‚shellé€šè¿‡forkå­è¿›ç¨‹å¹¶è°ƒç”¨execæ¥æ‰§è¡Œå®ƒä»¬ã€‚ä½†cdæ˜¯å†…ç½®çš„ï¼Œå› ä¸ºcdæ”¹å˜äº†shellè‡ªèº«çš„å·¥ä½œç›®å½•ã€‚ // Read and run input commands. while (getcmd(buf, sizeof(buf)) >= 0) &#123; if (buf[0] == 'c' &amp;&amp; buf[1] == 'd' &amp;&amp; buf[2] == ' ') &#123; // Chdir must be called by the parent, not the child. buf[strlen(buf) - 1] = 0; // chop \\n if (chdir(buf + 3) &lt; 0) fprintf(2, \"cannot cd %s\\n\", buf + 3); continue; &#125; if (fork1() == 0) runcmd(parsecmd(buf)); wait(0); &#125;","categories":[{"name":"å…¬å¼€è¯¾","slug":"å…¬å¼€è¯¾","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/"},{"name":"MIT-6.S081","slug":"å…¬å¼€è¯¾/MIT-6-S081","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/MIT-6-S081/"},{"name":"Notes","slug":"å…¬å¼€è¯¾/MIT-6-S081/Notes","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/MIT-6-S081/Notes/"}],"tags":[]},{"title":"Lab 1 Xv6 and Unix utilities","slug":"learning/open-course/MIT-6.S081/Labs/lab1-util","date":"2025-05-31T03:18:38.000Z","updated":"2025-10-15T08:09:56.939Z","comments":true,"path":"wiki/learning/open-course/MIT-6.S081/Labs/lab1-util/","permalink":"http://rinevard.github.io/wiki/learning/open-course/MIT-6.S081/Labs/lab1-util/","excerpt":"","text":"img{ width: 80%; } åœ¨å¼€å§‹ lab ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥è§£é‡Šä¸€ä¸‹ä¸ºä»€ä¹ˆæˆ‘ä»¬å†™çš„ä»£ç èƒ½ç›´æ¥åœ¨ xv6 çš„ shell é‡Œæ‰§è¡Œã€‚æˆ‘ä»¬æ¥çœ‹çœ‹ sh.c çš„éƒ¨åˆ†ä»£ç ï¼š // Read and run input commands. while (getcmd(buf, sizeof(buf)) >= 0) &#123; if (buf[0] == 'c' &amp;&amp; buf[1] == 'd' &amp;&amp; buf[2] == ' ') &#123; // Chdir must be called by the parent, not the child. buf[strlen(buf) - 1] = 0; // chop \\n if (chdir(buf + 3) &lt; 0) fprintf(2, \"cannot cd %s\\n\", buf + 3); continue; &#125; if (fork1() == 0) runcmd(parsecmd(buf)); wait(0); &#125; ä»è¿™é‡Œæˆ‘ä»¬çœ‹å‡ºï¼Œshellé€šè¿‡forkå­è¿›ç¨‹æ¥æ‰§è¡Œå‘½ä»¤ã€‚å¦‚æœè¿›ä¸€æ­¥çœ‹çœ‹ runcmd å‡½æ•°ï¼Œå°±ä¼šå‘ç°å®ƒè°ƒç”¨äº† execï¼Œå› æ­¤ shell èƒ½æ‰§è¡Œç”¨æˆ·å†™çš„ä»£ç ã€‚ æœ‰è¶£çš„æ˜¯ï¼Œä»è¿™æ®µä»£ç é‡Œæˆ‘ä»¬ä¹Ÿèƒ½çœ‹å‡º cd æ˜¯å†…ç½®åœ¨ shell é‡Œçš„å‘½ä»¤ï¼Œè¿™æ˜¯å› ä¸º cd æ”¹å˜äº†shellè‡ªèº«çš„å·¥ä½œç›®å½•ã€‚ sleepè¿™é¢˜è®©æˆ‘ä»¬ç®€å•ç†Ÿæ‚‰ä¸‹æ¥å£ã€‚å…¶å®è¿™é‡Œç”¨ printf æ›´æ˜“è¯»ï¼Œä¸è¿‡æˆ‘å½“æ—¶åšçš„æ—¶å€™æ²¡å‘ç°æœ‰ printf #include \"kernel/types.h\" #include \"user/user.h\" #include \"kernel/fcntl.h\" int main(int argc, char *argv[]) &#123; char *errmsg = \"sleep: missing operand\\n\"; if (argc != 2) &#123; write(1, errmsg, strlen(errmsg)); exit(1); &#125; sleep(atoi(argv[1])); exit(0); &#125; pingpongè¿™é¢˜è®©æˆ‘ä»¬æ¥è§¦ä¸€ä¸‹ç®¡é“çš„ä½¿ç”¨ï¼Œéš¾è€…ä¸ä¼šï¼Œä¼šè€…ä¸éš¾ #include \"kernel/types.h\" #include \"user/user.h\" #include \"kernel/fcntl.h\" int main() &#123; char buf[512]; int p_parent_sender[2]; int p_child_sender[2]; pipe(p_parent_sender); pipe(p_child_sender); if (fork() == 0) &#123; // å­è¿›ç¨‹å…ˆè¯» read(p_parent_sender[0], buf, 2); printf(\"%d: received ping\\n\", getpid()); write(p_child_sender[1], buf, 2); close(p_parent_sender[0]); close(p_parent_sender[1]); close(p_child_sender[0]); close(p_child_sender[1]); exit(0); &#125; // çˆ¶è¿›ç¨‹å…ˆå†™ write(p_parent_sender[1], buf, 2); read(p_child_sender[0], buf, 2); printf(\"%d: received pong\\n\", getpid()); close(p_parent_sender[0]); close(p_parent_sender[1]); close(p_child_sender[0]); close(p_child_sender[1]); exit(0); &#125; primesè¿™é¢˜å¾ˆæœ‰è¶£ï¼Œæ˜¯ä¸€ä¸ªå¹¶å‘ç´ æ•°ç­›æ³•ã€‚è¿™ä¸ªç®—æ³•ç†è®ºä¸Šæ˜¯å¯ä»¥æé«˜æ•ˆç‡çš„ï¼Œæ¯•ç«Ÿåœ¨è¿è¡Œäº†ä¸€æ®µæ—¶é—´åï¼Œå„ä¸ªè¿›ç¨‹é‡Œéƒ½æœ‰ä¸€äº›æ•°ç­‰å¾…ç­›é€‰ï¼Œè¿™æ—¶å„ä¸ªè¿›ç¨‹åœ¨åŒæ—¶ç”¨è‡ªå·±çš„ç´ æ•°ç­›é€‰è¾“å…¥çš„æ•°ã€‚ ç½‘ä¸Šå¾ˆå¤šä»£ç éƒ½æ˜¯2020ç‰ˆçš„ï¼Œå½“æ—¶çš„è¦æ±‚æ˜¯æ‰¾å‡º 2-35 é—´çš„ç´ æ•°ã€‚è¿™äº›ä»£ç èƒ½è¿‡è€ç‰ˆæœ¬çš„è¦æ±‚ï¼Œä½†è¿‡ä¸äº†2024ç‰ˆè¦æ±‚çš„ 2-280ã€‚æˆ‘è®¤çœŸçœ‹äº†ä¸€ä¸¤ä»½ä»£ç ï¼Œå‘ç°å®ƒä»¬åœ¨ç”¨ fork åˆ›å»ºå­è¿›ç¨‹çš„å­è¿›ç¨‹åï¼Œå¿˜äº†å…³é—­å­å­è¿›ç¨‹çš„è¿æ¥åˆ°çˆ¶è¿›ç¨‹çš„æè¿°ç¬¦ã€‚å¯ä»¥çœ‹ä¸‹é¢ç¤ºæ„å›¾çš„ç¬¬ä¸‰ä¸ªæ¡†ï¼Œè¿™äº›ä»£ç å¿˜äº†å…³é—­ child child process çš„ fd_read. æˆ‘ç”»äº†ç¤ºæ„å›¾æ¥è§£é‡Šæˆ‘çš„ä»£ç ~ #include \"kernel/types.h\" #include \"kernel/stat.h\" #include \"user/user.h\" const int NUM = 280; int connected_fork(int *); void do_child(int); int main() &#123; int pid; int fd = -1; if ((pid = connected_fork(&amp;fd)) == 0) &#123; do_child(fd); exit(0); &#125; int n; for (n = 2; n &lt;= NUM; n++) &#123; write(fd, (void *)&amp;n, sizeof(int)); &#125; close(fd); wait(0); exit(0); &#125; /* * åˆ›å»ºå­è¿›ç¨‹. çˆ¶è¿›ç¨‹çš„ fd å’Œå­è¿›ç¨‹çš„ fd ä¼šè¢«åˆ†åˆ«è®¾ç½®ä¸ºä¸€ä¸ª pipe çš„ä¸¤ç«¯. * å¯¹çˆ¶è¿›ç¨‹, fd è¢«è®¾ç½®ä¸ºå†™ç«¯. * å¯¹å­è¿›ç¨‹, fd è¢«è®¾ç½®ä¸ºè¯»ç«¯. * * return 0 if is child else child's pid */ int connected_fork(int *fd) &#123; int p[2]; pipe(p); int pid; if ((pid = fork()) == 0) &#123; // child close(p[1]); *fd = p[0]; &#125; else &#123; // parent close(p[0]); *fd = p[1]; &#125; return pid; &#125; /* * ä» fd_read ä¸­è¯»å–æ•°å­—, æ‰“å°ç¬¬ä¸€ä¸ªæ•°, * ç­›é€‰å…¶ä»–æ•°å¹¶æ–°å»ºå­è¿›ç¨‹æŠŠè¢«ç­›é€‰åçš„æ•°å†™å…¥å­è¿›ç¨‹. åœ¨è¿è¡Œå®Œæˆåå…³é—­ fd_read. */ void do_child(int fd_read) &#123; int n = -1; int prime = -1; int fd = -1; while (read(fd_read, (void *)&amp;n, sizeof(int)) > 0) &#123; if (prime == -1) &#123; prime = n; printf(\"prime %d\\n\", prime); &#125; if ((n % prime) != 0) &#123; if (fd == -1 &amp;&amp; connected_fork(&amp;fd) == 0) &#123; // fd == -1 ç­‰ä»·äºæ²¡æœ‰å­è¿›ç¨‹ // å¦‚æœæ²¡æœ‰å­è¿›ç¨‹å°±åˆ›å»ºå­è¿›ç¨‹å¹¶è®©å®ƒå¼€å§‹å·¥ä½œ close(fd_read); do_child(fd); return; &#125; write(fd, (void *)&amp;n, sizeof(int)); &#125; &#125; close(fd_read); // fd == -1 ç­‰ä»·äºæ²¡æœ‰å­è¿›ç¨‹, è¯´æ˜å®ƒæ˜¯æœ€åä¸€ä¸ªè¿›ç¨‹ // æœ€åä¸€ä¸ªè¿›ç¨‹ä¸éœ€è¦å…³é—­æè¿°ç¬¦, ä¹Ÿä¸éœ€è¦ç­‰å¾… if (fd == -1) &#123; return; &#125; close(fd); wait(0); &#125; /* * ä¸ªäººè®¤ä¸ºå…³é—­ fd_read ä¸åº”è¯¥æ˜¯ do_child çš„å·¥ä½œ, æˆ‘è§‰å¾—\"è°åˆ›å»º, * è°å…³é—­\"ä¼šæ›´åˆé€‚. ä¹Ÿå°±æ˜¯è¯´, æˆ‘è§‰å¾—è®©è°ƒç”¨ do_child çš„å‡½æ•°å…³é—­ fd_read * æ›´åˆé€‚. * * ä½†å¦‚æœ do_child ä¸å…³é—­ fd_read, å­å­™è¿›ç¨‹å°±ä¼šä¿ç•™çˆ¶è¿›ç¨‹æœªå…³é—­çš„æè¿°ç¬¦, * ä»è€Œè€—å°½ xv6 çš„èµ„æº. */ findåœ¨ ls.c çš„åŸºç¡€ä¸Šç¨å¾®æ”¹æ”¹å°±å¥½äº†ï¼Œè¦æ³¨æ„çš„æ˜¯é€’å½’æ—¶ä¸è¦é€’å½’è¿› â€œ.â€ å’Œ â€œ..â€ ä¸¤ä¸ªæ–‡ä»¶å¤¹ æˆ‘ä»¬å®ç°çš„ find &lt;path&gt; &lt;name&gt; çš„åŠŸèƒ½å’Œ Linux é‡Œçš„ find &lt;path&gt; -name &lt;name&gt; ä¸€è‡´ #include \"kernel/types.h\" #include \"kernel/stat.h\" #include \"user/user.h\" #include \"kernel/fs.h\" #include \"kernel/fcntl.h\" void find(const char *path, const char *name); const char *basename(const char *path); int main(int argc, char *argv[]) &#123; if (argc != 3) &#123; printf(\"usage: find &lt;path> &lt;filename>\\n\"); &#125; find(argv[1], argv[2]); exit(0); &#125; /* * åœ¨ä»¥ path ä¸ºæ ¹èŠ‚ç‚¹çš„æ–‡ä»¶æ ‘ä¸‹æœç´¢åä¸º name çš„æ–‡ä»¶, * å¦‚æœæ‰¾åˆ°åˆ™æ‰“å°å…¶è·¯å¾„. */ void find(const char *path, const char *name) &#123; int fd; if ((fd = open(path, O_RDONLY)) &lt; 0) &#123; fprintf(2, \"find: cannot open %s\\n\", path); return; &#125; struct stat st; if (fstat(fd, &amp;st) &lt; 0) &#123; fprintf(2, \"find: cannot stat %s\\n\", path); close(fd); return; &#125; if (strcmp(basename(path), name) == 0) &#123; printf(\"%s\\n\", path); &#125; // åªæœ‰æ–‡ä»¶å¤¹æœ‰é€’å½’çš„å¿…è¦ if (st.type != T_DIR) &#123; close(fd); return; &#125; char buf[512], *p; struct dirent de; // ç¬¬ä¸€ä¸ª +1 å¯¹åº” '/', ç¬¬äºŒä¸ª +1 å¯¹åº”ç»“å°¾çš„ '\\0' if (strlen(path) + 1 + DIRSIZ + 1 > sizeof(buf)) &#123; printf(\"ls: path too long\\n\"); &#125; strcpy(buf, path); p = buf + strlen(buf); *p++ = '/'; while (read(fd, &amp;de, sizeof(de)) == sizeof(de)) &#123; if (de.inum == 0 || strcmp(de.name, \".\") == 0 || strcmp(de.name, \"..\") == 0) continue; memmove(p, de.name, DIRSIZ); p[DIRSIZ] = 0; if (stat(buf, &amp;st) &lt; 0) &#123; printf(\"ls: cannot stat %s\\n\", buf); continue; &#125; find(buf, name); &#125; &#125; /* * è·å–è·¯å¾„ path çš„æœ€åä¸€éƒ¨åˆ† */ const char *basename(const char *path) &#123; const char *p; for (p = path + strlen(path); p >= path &amp;&amp; *p != '/'; --p) ; ++p; return p; &#125; xargsxargs å°†æ ‡å‡†è¾“å…¥ï¼ˆstdinï¼‰æ•°æ®è½¬æ¢æˆå‘½ä»¤è¡Œå‚æ•°ï¼Œä¸€èˆ¬å’Œç®¡é“ä¸€èµ·ä½¿ç”¨ã€‚åœ¨ linux ä¸­ï¼Œxargs é»˜è®¤çš„å‘½ä»¤æ˜¯ echo. ä¸Šé¢çš„è§£é‡Šå¯èƒ½ä¸å¤ªæ¸…æ™°ï¼Œé€šè¿‡ä¸¤ä¸ªä¾‹å­å°±èƒ½çœ‹å‡ºæ¥å®ƒåœ¨åšä»€ä¹ˆäº†ï¼š ç¬¬ä¸€ä¸ªä¾‹å­æ˜¯ç›´æ¥ä½¿ç”¨ xargs $ xargs -n 1 echo Im prefix 111 Im prefix 111 222 Im prefix 222 ï¼ˆæŒ‰ ctrl+D ç»ˆæ­¢è¾“å…¥) ç¬¬äºŒä¸ªä¾‹å­æ˜¯å’Œç®¡é“è”ç”¨ $ (echo 1 ; echo 2) | xargs -n 1 echo 1 2 $ æˆ‘ä»¬å®ç°çš„ xargs &lt;command&gt; çš„åŠŸèƒ½å’Œ Linux é‡Œçš„ xargs -n 1 &lt;command&gt; ä¸€è‡´ #include \"kernel/types.h\" #include \"kernel/param.h\" #include \"user/user.h\" int main(int argc, char *argv[]) &#123; if (argc &lt; 2) &#123; fprintf(2, \"usage: xargs command\\n\"); exit(1); &#125; char *cmd = argv[1]; char *cmdargs[MAXARG]; int cmdargc = 0; // åœ¨æ›´æ”¹ cmdargc å‰, æœ€å¥½æ£€æŸ¥ cmdargc &lt; MAXARG, // ä¸è¿‡ä¸ºäº†ç®€åŒ–ä»£ç , æˆ‘ä»¬å°±ä¸æ£€æŸ¥äº† // argv[0] æ˜¯ 'xargs', argv[1] æ˜¯ command, ä¹‹åæ˜¯å‚æ•° // cmdargs åº”å½“å½¢å¦‚ [command, arg1, arg2, ..., addition_arg1, ...] cmdargc = argc - 1; for (int i = 0; i &lt; cmdargc; i++) &#123; cmdargs[i] = argv[i + 1]; &#125; char buf[512]; // è¾“å…¥è¡Œ char *p = buf; // è¾“å…¥è¡Œçš„æœ«å°¾ while (read(0, p, 1) > 0) &#123; if (p[0] == '\\n') &#123; p[0] = '\\0'; cmdargs[cmdargc] = buf; ++cmdargc; cmdargs[cmdargc] = 0; ++cmdargc; if (fork() == 0) &#123; exec(cmd, cmdargs); &#125; wait(0); // é‡ç½® p = buf; cmdargc = argc - 1; &#125; else &#123; ++p; &#125; &#125; exit(0); &#125;","categories":[{"name":"å…¬å¼€è¯¾","slug":"å…¬å¼€è¯¾","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/"},{"name":"MIT-6.S081","slug":"å…¬å¼€è¯¾/MIT-6-S081","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/MIT-6-S081/"},{"name":"Labs","slug":"å…¬å¼€è¯¾/MIT-6-S081/Labs","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/MIT-6-S081/Labs/"}],"tags":[]},{"title":"æ…¢æ…¢åœ°å†²æµª","slug":"others/thoughts/ç½‘ä¸Šå†²æµª","date":"2025-05-28T03:50:11.000Z","updated":"2025-08-19T07:08:07.564Z","comments":true,"path":"wiki/others/thoughts/ç½‘ä¸Šå†²æµª/","permalink":"http://rinevard.github.io/wiki/others/thoughts/%E7%BD%91%E4%B8%8A%E5%86%B2%E6%B5%AA/","excerpt":"","text":"åœ¨äº’è”ç½‘ä¸Šå†²æµªæ—¶ï¼Œå¶å°”ä¼šçœ‹åˆ°ä¸€äº›åšå®¢ï¼Œè‹¥æ˜¯å®ƒä»¬å¸®åˆ°äº†æˆ‘ï¼Œæˆ‘ç»å¸¸ä¹Ÿä¼šç‚¹è¿›ä¸»é¡µçœ‹çœ‹ä½œè€…éƒ½å†™äº†æ€æ ·çš„æ–‡ç« ï¼Œéƒ½æœ‰æ€æ ·çš„æ•…äº‹ã€‚ å¾ˆå¤šäººçš„ç½‘ç«™é‡Œå…¨æ˜¯æŠ€æœ¯æ–‡ç« ï¼Œæˆ‘å¯¹è¿™æ ·çš„ç½‘ç«™ç¡®å®æ²¡ä»€ä¹ˆå…´è‡´ã€‚æˆ‘æ›´å–œæ¬¢æ‚è°ˆç±»çš„æ–‡ç« ï¼Œé‚£ç§åƒæ˜¯åœ¨å¤œæ·±äººé™æ—¶ï¼Œç‹¬è‡ªä¸€äººåœ¨ç”µè„‘å‰æ…¢æ…¢å†™ä¸‹çš„æ–‡ç« ã€‚è¯»è¿™æ ·ç‹¬å¤„æ—¶å†™ä¸‹çš„æ–‡ç« ï¼Œæ€»è®©æˆ‘è§‰å¾—è‡ªå·±å’Œä½œè€…çš„çµé­‚æ›´è¿‘äº†ä¸€ç‚¹ã€‚ åœ¨äº’è”ç½‘ä¸Šéšæœºæ¼«æ¸¸ï¼Œå¯¹ç€å®Œå…¨ä¸è®¤è¯†è‡ªå·±çš„äººäº§ç”Ÿå•ç®­å¤´ï¼Œå¦‚æœè¿æ°”å¥½çš„è¯è¯´ä¸å®šä¼šæ˜¯åŒç®­å¤´ï¼ŒçœŸçš„éå¸¸æœ‰è¶£ã€‚æˆ‘å¯èƒ½è¿˜æ˜¯å–œæ¬¢æ…¢ä¸€ç‚¹çš„æ•…äº‹ï¼Œå–œæ¬¢æœ‰ç€å¾ˆé•¿å¾ˆé•¿å›å¤çš„è´´å­ï¼Œå–œæ¬¢æŠŠè‡ªå·±é‡è§çš„è¶£äº‹åˆ†äº«åˆ°ç½‘ä¸Šçš„è§†é¢‘ï¼Œå–œæ¬¢éšæ„çš„ã€çœŸè¯šçš„æ–‡ç« ã€‚å®ƒä»¬åªæ˜¯è¢«æ”¾åœ¨é‚£é‡Œï¼Œç­‰ç€åå¹´åè¢«å¦ä¸€ä¸ªäººå¶ç„¶å‘ç°ï¼Œé‚£æ˜¯ç—•è¿¹ã€‚ /* éšè—è‰ä¹¦ */ .hidden-text { font-size: 18px; text-align: center; margin: 20px 0; /* padding: 20px; */ line-height: 1.5; color: transparent; cursor: default } .hidden-fancy-text::selection { color: black; background: white; } å°±åƒè¿™é‡Œçš„ç—•è¿¹ã€‚","categories":[{"name":"æ‚è°ˆ","slug":"æ‚è°ˆ","permalink":"http://rinevard.github.io/categories/%E6%9D%82%E8%B0%88/"},{"name":"ç¢ç¢å¿µ","slug":"æ‚è°ˆ/ç¢ç¢å¿µ","permalink":"http://rinevard.github.io/categories/%E6%9D%82%E8%B0%88/%E7%A2%8E%E7%A2%8E%E5%BF%B5/"}],"tags":[]},{"title":"åœ¨å¼€å§‹ä¹‹å‰","slug":"learning/open-course/MIT-6.S081/BeforeStory","date":"2025-05-27T07:20:38.000Z","updated":"2025-08-22T03:14:43.982Z","comments":true,"path":"wiki/learning/open-course/MIT-6.S081/BeforeStory/","permalink":"http://rinevard.github.io/wiki/learning/open-course/MIT-6.S081/BeforeStory/","excerpt":"","text":"æœ€è¿‘å‘ç°äº† Arthal çš„ç¬”è®°ï¼Œæ„Ÿè§‰å†™å¾—éå¸¸ç²¾ç¾ï¼å›å¤´çœ‹çœ‹è‡ªå·±å¯¹ 15213 labs çš„ç¬”è®°ï¼Œæ„Ÿè§‰å†™å¾—ç¡®å®å¤ªç²—ç³™äº†ï¼Œå¸Œæœ›æˆ‘çš„ 6.S081 çš„ç¬”è®°ä¹Ÿèƒ½å†™å¾—è¯¦ç»†ä¸€äº›ã€‚ å’³å’³ï¼Œæˆ‘çŸ¥é“æˆ‘è¿˜æ²¡å†™ 15213 çš„ proxylabï¼Œä¸è¿‡æˆ‘æ„Ÿè§‰csappç½‘ç»œé‚£ä¸€ç« å†™å¾—æœ‰ç‚¹å«ç³Šï¼Œæ‰€ä»¥æ™šç‚¹å†åšå§ã€‚","categories":[{"name":"å…¬å¼€è¯¾","slug":"å…¬å¼€è¯¾","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/"},{"name":"MIT-6.S081","slug":"å…¬å¼€è¯¾/MIT-6-S081","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/MIT-6-S081/"}],"tags":[]},{"title":"ç¬¬ä¹ç« â€”â€”è™šæ‹Ÿå†…å­˜","slug":"learning/open-course/CMU-15-213/Notes/Chapter9-virtual-memory","date":"2025-05-13T14:10:28.000Z","updated":"2025-08-22T03:14:43.982Z","comments":true,"path":"wiki/learning/open-course/CMU-15-213/Notes/Chapter9-virtual-memory/","permalink":"http://rinevard.github.io/wiki/learning/open-course/CMU-15-213/Notes/Chapter9-virtual-memory/","excerpt":"","text":"img{ width: 80%; } é‡èµ°è™šæ‹Ÿè·¯è®©æˆ‘ä»¬å°è¯•é‡æ–°å‘æ˜ä¸€éè™šæ‹Ÿå†…å­˜ã€‚ ä½¿ç”¨è™šæ‹Ÿåœ°å€çš„åŸå› æƒ³è±¡ä¸€ä¸‹æˆ‘ä»¬åªèƒ½ç”¨ç‰©ç†åœ°å€æ¥å†™ç¨‹åºï¼Œæˆ‘ä»¬å†™å‡ºäº†ä¸‹é¢çš„ä¸œè¥¿ï¼š ; å‡è®¾ç›®æ ‡æœºå™¨æ˜¯Intel 8080ï¼Œå†…å­˜åœ°å€ä¸ºç‰©ç†åœ°å€ ORG 0x0100 ; ç¨‹åºèµ·å§‹åœ°å€ï¼Œç›´æ¥æŒ‡å®šç‰©ç†åœ°å€0x0100 MVI A, 0x05 ; å°†ç«‹å³æ•°0x05åŠ è½½åˆ°å¯„å­˜å™¨A STA 0x0200 ; å°†å¯„å­˜å™¨Açš„å€¼å­˜å‚¨åˆ°ç‰©ç†å†…å­˜åœ°å€0x0200 HLT ; åœæ­¢ç¨‹åº è¿™ä¸œè¥¿çš„å¯ç§»æ¤æ€§æ˜¾ç„¶å¾ˆå·®ï¼æ‰€ä»¥æˆ‘ä»¬å‘æ˜äº†â€œè™šæ‹Ÿåœ°å€â€ã€‚è¿™æ ·ç¨‹åºå°±èƒ½ç›´æ¥ä½¿ç”¨è™šæ‹Ÿåœ°å€ï¼Œè€Œåœ¨ç¨‹åºæ‰§è¡Œæ—¶ï¼Œè™šæ‹Ÿåœ°å€è¢«æ“ä½œç³»ç»Ÿçš„MMUï¼ˆMemory Management Unitï¼‰å®æ—¶ç¿»è¯‘æˆç‰©ç†åœ°å€ã€‚ è™šæ‹Ÿåœ°å€åˆ°ç‰©ç†åœ°å€çš„æ˜ å°„è¿™ä¹ˆçœ‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ MMU å½“ä½œä¸€ä¸ªä»è™šæ‹Ÿåœ°å€ç©ºé—´åˆ°ç‰©ç†åœ°å€ç©ºé—´çš„æ˜ å°„ï¼Œé‚£æˆ‘ä»¬è‡ªç„¶è¦ç”¨ä¸€ä¸ªæ•°æ®ç»“æ„æ¥å­˜å‚¨æ˜ å°„ã€‚ ä½†æ€ä¹ˆç»„ç»‡è¿™ä¸ªæ•°æ®ç»“æ„å‘¢ï¼Ÿç”¨ä¸€ä¸ªæ•°ç»„ï¼Œç„¶åæ¯ä¸ªè™šæ‹Ÿåœ°å€å¯¹åº”ä¸€ä¸ªç‰©ç†åœ°å€ï¼Ÿå‡è®¾æˆ‘ä»¬æœ‰ $M$ ä¸ªè™šæ‹Ÿåœ°å€ï¼Œæˆ‘ä»¬å°±å­˜ä¸€ä¸ªé•¿åº¦ä¸º $M$ çš„æ•°ç»„ï¼Ÿè¿™æ ·çš„è¯ï¼Œè¿™ä¸ªæ•°ç»„å°±å¤ªå¤§äº†ã€‚å‡è®¾æˆ‘ä»¬æœ‰ $k$ ä¸ªè¿›ç¨‹ï¼ŒæŒ‰è¿™ä¸ªæƒ³æ³•ï¼Œæˆ‘ä»¬å°±éœ€è¦è‡³å°‘ $k\\times M \\times \\text{sizeof(char *)}$ å¤§å°çš„å†…å­˜æ¥å­˜å‚¨è¿™ä¸ªæ•°æ®ç»“æ„ã€‚ æˆ‘ä»¬é€‰æ‹©æŠŠ $N$ ä¸ªè¿ç»­çš„è™šæ‹Ÿåœ°å€å½“ä½œä¸€ä¸ªè™šæ‹Ÿé¡µï¼ŒåŒæ—¶æŠŠ $N$ ä¸ªè¿ç»­çš„ç‰©ç†åœ°å€å½“ä½œä¸€ä¸ªç‰©ç†é¡µï¼Œè¿™æ ·å¯¹æ¯ä¸ªè¿›ç¨‹ï¼Œæˆ‘ä»¬å°±åªè¦åšç‰©ç†é¡µä¹‹é—´çš„æ˜ å°„ï¼Œå­˜å‚¨ $\\frac{M}{N}$ ä¸ªé¡¹å°±å¥½äº†ã€‚è€ƒè™‘åˆ°ç¨‹åºçš„å±€éƒ¨æ€§ï¼Œ æˆ‘ä»¬çš„è¿™ç§é€‰æ‹©æ˜¯åˆç†çš„ã€‚è¿™æ ·çš„ä¸€ä¸ªæ•°æ®ç»“æ„å°±å«åšä¸€ä¸ªé¡µè¡¨ã€‚ åœ¨ä¸‹å›¾çš„å•çº§é¡µè¡¨ä¸­ï¼Œæ¯ä¸€é¡¹éƒ½å¸¦æœ‰ä¸€ä¸ªæœ‰æ•ˆä½ï¼ˆç”¨äºæ ‡è®°è¿™ä¸ªè™šæ‹Ÿé¡µå¯¹åº”çš„ç‰©ç†é¡µæ˜¯å¦åœ¨ DRAM ä¸­ï¼‰å’Œå¯¹åº”ç‰©ç†é¡µçš„å¼€å¤´ç‰©ç†åœ°å€ï¼ˆå¦‚æœæ²¡æœ‰å¯¹åº”ç‰©ç†é¡µï¼Œä¸º nullï¼‰ã€‚ æŠŠè™šæ‹Ÿåœ°å€ç¿»è¯‘æˆç‰©ç†åœ°å€çš„å¤§è‡´æ€è·¯æ˜¯æ ¹æ®è™šæ‹Ÿåœ°å€æ‰¾åˆ°é¡µè¡¨ä¸­å¯¹åº”çš„é¡¹ï¼Œä»è€Œæ‰¾åˆ°å¯¹åº”çš„ç‰©ç†é¡µï¼Œç„¶åæ ¹æ®è™šæ‹Ÿåœ°å€çš„æœ€åå‡ ä½ç¡®å®šå…·ä½“çš„ç‰©ç†åœ°å€ã€‚ï¼ˆè¿˜è®°å¾—å—ï¼Œä¸€ä¸ªé¡µç”±å¾ˆå¤šåœ°å€ç»„æˆï¼‰ ä½†è¿™æ ·çš„é¡µè¡¨è¿˜æ˜¯å¾ˆå¤§å§ã€‚æˆ‘ä»¬æ€»åœ¨è¿›ç¨‹è¢«åˆ›å»ºæ—¶å°±ä¸ºä»–ä»¬åˆ†é…äº†ä¸€ä¸ªè¶…å¤§çš„é¡µè¡¨ï¼Œè€Œå®é™…ä¸Šç»å¤§å¤šæ•°ç¨‹åºéƒ½æ ¹æœ¬ç”¨ä¸åˆ°é‚£ä¹ˆå¤šè™šæ‹Ÿåœ°å€ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬èƒ½ä¸èƒ½åŠ¨æ€åœ°æ”¹å˜é¡µè¡¨çš„å¤§å°ï¼Œæ¯”å¦‚è¯´ï¼Œåœ¨ç¨‹åºè¯·æ±‚æŸä¸ªè™šæ‹Ÿåœ°å€ï¼Œä½†å®ƒä¸åœ¨é¡µè¡¨ä¸­æ—¶ï¼Œå†å»å¢å¤§é¡µè¡¨ï¼Ÿ æ‰€ä»¥æˆ‘ä»¬è¿›ä¸€æ­¥æŠŠé¡µè¡¨åˆ†æˆå¤šçº§ï¼Œåœ¨éœ€è¦çš„æ—¶å€™å†å»æ–°å¢ level è¾ƒé«˜çš„é¡µè¡¨ã€‚ åœ¨è¿™æ ·çš„å¤šçº§é¡µè¡¨ä¸­ï¼Œåªæœ‰ level æœ€é«˜çš„é¡µè¡¨å­˜å‚¨å¯¹åº”é¡µçš„å¼€å¤´ç‰©ç†åœ°å€ï¼Œè€Œå…¶ä»– level çš„é¡µè¡¨å­˜å‚¨ä¸‹ä¸€ä¸ªçº§åˆ«çš„é¡µè¡¨çš„å¼€å§‹åœ°å€ã€‚æˆ‘ä»¬ä¼šåœ¨ä¸‹ä¸€èŠ‚è¯¦ç»†è®²è§£å®ƒçš„ç¿»è¯‘è¿‡ç¨‹ã€‚ è®©æˆ‘ä»¬æ€»ç»“ä¸€ä¸‹ï¼Œæ¯ä¸ªè¿›ç¨‹æœ‰è‡ªå·±çš„é¡µè¡¨ï¼Œåœ¨åˆ‡æ¢åˆ°æŸä¸ªè¿›ç¨‹æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šæ›´æ–°å­˜å‚¨ç€é¡µè¡¨åœ°å€çš„å¯„å­˜å™¨ï¼ˆåœ¨ RISC-â…¤ ä¸­æ˜¯ satp å¯„å­˜å™¨ï¼‰ã€‚å½“è¿›ç¨‹éœ€è¦è®¿é—®æŸä¸ªè™šæ‹Ÿåœ°å€æ—¶ï¼ŒMMU ä¼šæŠŠè™šæ‹Ÿåœ°å€ç¿»è¯‘æˆç‰©ç†åœ°å€ï¼Œç„¶åè®¿é—®ç‰©ç†åœ°å€ã€‚ è¦ç‰¹åˆ«å¼ºè°ƒçš„æ˜¯ï¼Œæ¯ä¸ª level å¯ä»¥æœ‰å¤šä¸ªé¡µè¡¨ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå¤šçº§é¡µè¡¨çœ‹ä½œæ ‘çŠ¶ç»“æ„ï¼ è™šæ‹Ÿåœ°å€çš„ç¿»è¯‘æˆ‘ä»¬å·²ç»çŸ¥é“äº†è™šæ‹Ÿå†…å­˜å¤§è‡´æ˜¯æ€æ ·çš„äº†ã€‚é‚£ä¹ˆ MMU å…·ä½“æ˜¯æ€ä¹ˆæŠŠè™šæ‹Ÿåœ°å€ç¿»è¯‘æˆç‰©ç†åœ°å€çš„å‘¢ï¼Ÿæˆ‘ä»¬è¿™é‡Œè®¨è®ºå¤šçº§é¡µè¡¨ã€‚ åœ¨å¤šçº§é¡µè¡¨ä¸­ï¼Œåªæœ‰ level æœ€é«˜çš„é¡µè¡¨å­˜å‚¨å¯¹åº”é¡µçš„å¼€å¤´ç‰©ç†åœ°å€ï¼Œè€Œå…¶ä»– level çš„é¡µè¡¨å­˜å‚¨ä¸‹ä¸€ä¸ªçº§åˆ«çš„é¡µè¡¨çš„å¼€å§‹åœ°å€ã€‚ è™šæ‹Ÿåœ°å€çš„å‰å‡ ä½åœ¨ç¿»è¯‘è¿‡ç¨‹ä¸­ä¼šèµ·åˆ°â€œé¡µè¡¨ç´¢å¼•â€çš„ä½œç”¨ï¼Œå½“æˆ‘ä»¬åˆ°è¾¾äº†æŸä¸ª level çš„é¡µè¡¨ï¼Œæˆ‘ä»¬ä¼šç”¨å®ƒæ¥ç¡®å®šæˆ‘ä»¬å…·ä½“éœ€è¦è¿™ä¸ªé¡µè¡¨çš„å“ªä¸ªé¡¹ã€‚è€Œè™šæ‹Ÿåœ°å€çš„æœ€åå‡ ä½æ˜¯ä¸€ä¸ª offsetï¼Œè¿˜è®°å¾—å—ï¼Œä¸€ä¸ªè™šæ‹Ÿé¡µå’Œä¸€ä¸ªç‰©ç†é¡µå¯¹åº”ï¼Œæ‰€ä»¥åœ¨æ‰¾åˆ°äº†å¯¹åº”çš„ç‰©ç†é¡µçš„å¼€å¤´åœ°å€åï¼Œæˆ‘ä»¬è¦æ ¹æ® offset å¾—åˆ°çœŸæ­£å¯¹åº”çš„ç‰©ç†åœ°å€ã€‚ VPN æ˜¯ virtual page numberï¼ŒVPO æ˜¯ virtual page offsetï¼ŒPTE æ˜¯ page table entry æˆ‘é­”æ”¹äº†ä¸€ä¸‹ä¸Šå›¾ï¼Œå¸Œæœ›è¿™èƒ½è®©â€œæ¯ä¸ª level æœ‰å¤šä¸ªé¡µè¡¨â€è¿™ä»¶äº‹æ˜¾å¾—æ›´æ¸…æ™°ã€‚ ä¼˜åŒ–çœ‹èµ·æ¥å¤šçº§é¡µè¡¨åœ¨å­˜å‚¨æ–¹é¢ä¼˜åŒ–å¾—ä¸é”™ï¼Œä½†é€Ÿåº¦å‘¢ï¼Ÿæ—¢ç„¶æ¯ä¸ªé¡µè¡¨éƒ½æ”¾åœ¨ä¸åŒçš„åœ°å€ï¼Œé‚£å®ƒä¸æ˜¯è¦æ±‚å¤šæ¬¡è®¿é—®ä¸åŒåœ°å€å—ï¼Ÿæ­£æ˜¯å¦‚æ­¤ï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨ TLBï¼ˆTranslation Lookaside Bufferï¼‰æ¥ç¼“å­˜æœ€è¿‘ä½¿ç”¨çš„é¡µè¡¨é¡¹ï¼Œæ¥åŠ å¿«åœ°å€ç¿»è¯‘ã€‚ åŠ¨æ€å†…å­˜åˆ†é…å½“æˆ‘ä»¬è°ƒç”¨ malloc å’Œ free æ—¶ç©¶ç«Ÿå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿåœ¨åšå®Œ malloclab ä»¥åï¼Œæˆ‘ä»¬å¯¹æ­¤å·²ç»æœ‰äº†æ¯”è¾ƒæ¸…æ™°çš„ç†è§£ã€‚ mallocè°ƒç”¨ malloc æ—¶ï¼Œæˆ‘ä»¬åœ¨å¯»æ‰¾è¶³å¤Ÿå¤§çš„ç©ºé—²å†…å­˜å—æ¥æä¾›ç»™ç”¨æˆ·ï¼Œå¦‚æœä¸å¤Ÿå¤§å°±æ‰©å®¹ã€‚åœ¨â€œå¯»æ‰¾â€çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬æœ‰å¾ˆå¤šç§ç­–ç•¥å¯ä»¥é€‰ï¼Œè¿™å°±æ˜¯ placement policyï¼ŒåŒ…æ‹¬ä½†ä¸é™äº first fitã€next fitã€best fit. è€Œåœ¨æ‰¾åˆ°ç©ºé—²å—ä»¥åï¼Œæœ‰æ—¶ç©ºé—²å—å¯èƒ½æ¯”ç”¨æˆ·çš„éœ€æ±‚å¤§å¾ˆå¤šï¼Œè¿™æ—¶å°±è¦æƒ³æƒ³è¦ä¸è¦åˆ‡å‰²ç©ºé—²å—ï¼Œè¿™å°±æ˜¯ splitting policyã€‚ freeè°ƒç”¨ free æ—¶ï¼Œæˆ‘ä»¬ç®€å•åœ°æŠŠä¸€ä¸ªå·²åˆ†é…å†…å­˜å—æ ‡è®°ä¸ºç©ºé—²ã€‚ä½†ç©ºé—²ä¹‹ååˆè¦å†³å®šæ˜¯å¦æŠŠå®ƒå’Œç›¸é‚»çš„ç©ºé—²å—åˆå¹¶ï¼Œè¿™å°±æ˜¯ coalescing policyã€‚ å—çš„ç»“æ„ä¹‹å‰æåˆ°ï¼Œmalloc æ˜¯åœ¨æ‰¾ç©ºé—²å—ï¼Œä½†ä»€ä¹ˆæ˜¯â€œå—â€å‘¢ï¼Ÿå—çš„æ•°æ®ç»“æ„ä¹Ÿæœ‰å¾ˆå¤šç§å¯ä»¥é€‰ï¼Œä¸è¿‡ä¸€èˆ¬æ¥è¯´ï¼Œæ¯ä¸ªå—éƒ½è‡³å°‘ä¼šæœ‰ size å’Œ is_alloc æ ‡è®°ã€‚ ä¸¾ä¸ªä¾‹å­ï¼Œä½¿ç”¨æ˜¾å¼é“¾è¡¨ç­–ç•¥æ—¶ï¼Œæˆ‘ä»¬çš„å †å¤§æ¦‚é•¿è¿™æ ·ï¼š","categories":[{"name":"å…¬å¼€è¯¾","slug":"å…¬å¼€è¯¾","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/"},{"name":"CMU-15-213","slug":"å…¬å¼€è¯¾/CMU-15-213","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/CMU-15-213/"},{"name":"Notes","slug":"å…¬å¼€è¯¾/CMU-15-213/Notes","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/CMU-15-213/Notes/"}],"tags":[]},{"title":"Malloclabå’Œæˆ‘ä¸å¾—ä¸è¯´çš„é‚£äº›äº‹","slug":"learning/open-course/CMU-15-213/Labs/Malloclab","date":"2025-05-12T11:28:38.000Z","updated":"2025-08-22T03:14:43.978Z","comments":true,"path":"wiki/learning/open-course/CMU-15-213/Labs/Malloclab/","permalink":"http://rinevard.github.io/wiki/learning/open-course/CMU-15-213/Labs/Malloclab/","excerpt":"","text":"å†™åœ¨å‰é¢malloclab çš„éš¾åº¦å¾ˆå¤§ï¼Œæˆ‘å®ç°äº†ä¹¦ä¸Šçš„åŸºç¡€çš„éšå¼ç©ºé—²é“¾è¡¨å’Œæ˜¾å¼ç©ºé—²é“¾è¡¨ï¼Œç”¨æ—¶çº¦ 16 å°æ—¶ï¼Œå¾—åˆ†å¦‚ä¸‹ï¼š Perf index &#x3D; 47 (util) + 40 (thru) &#x3D; 87&#x2F;100 å®ç°çš„é€»è¾‘æœ¬èº«æ˜¯ç®€å•çš„ï¼Œéš¾åº¦æœ€å¤§çš„åœ°æ–¹åœ¨äºè°ƒè¯•ï¼Œæ‰€ä»¥æˆ‘å¹¶æ²¡æœ‰è¿›ä¸€æ­¥å®ç°åˆ†ç¦»çš„ç©ºé—²é“¾è¡¨ï¼Œå› ä¸ºè°ƒè¯•èµ·æ¥å®åœ¨æ˜¯å¤ªéº»çƒ¦äº†ã€‚ç®—æ˜¯ä½“éªŒäº†ä¸€ä¸‹ç³»ç»Ÿçº§ç¼–ç¨‹çš„å¤æ‚æ€§ã€‚ æœ‰è¶£çš„æ˜¯ï¼Œç”±äº fail fast çš„ç¼–ç¨‹ä¹ æƒ¯ï¼Œæˆ‘å–œæ¬¢åœ¨ä»£ç é‡Œåˆ°å¤„æ”¾ assert å’Œ print è¯­å¥ï¼Œè¿™å¸®æˆ‘èŠ‚çœäº†ä¸å°‘è°ƒè¯•æ—¶é—´ï¼Œæˆ‘ç”šè‡³ä¸€æ¬¡ gdb éƒ½æ²¡ç”¨å°±æŠŠæ‰€æœ‰çš„ bug éƒ½ä¿®å®Œäº†ã€‚ï¼ˆè¯è¯´å›æ¥æˆ‘ä¹Ÿä¸çŸ¥é“è¿™ç§ä¸œè¥¿æ€ä¹ˆç”¨ gdb è°ƒè¯•ï¼‰ æœ¬æ–‡ä¼šè°ˆè°ˆåšè¿™ä¸ª lab æ—¶å­¦åˆ°çš„ä¸€äº›ç¼–ç¨‹æŠ€å·§ï¼Œä¸ä¼šå¤ªå¤šè°ˆ lab æœ¬èº«ï¼Œå› ä¸ºç…§ç€ä¹¦ä¸Šå®ç°å‡ºæ¥å°±å¥½äº†ã€‚ å®ç¼–ç¨‹å®ç¼–ç¨‹æœ€éœ€è¦å…³æ³¨çš„åœ°æ–¹å°±æ˜¯åˆ°å¤„éƒ½è¦åŠ æ‹¬å·ã€‚è®©æˆ‘ä»¬ä»¥ä¸‹é¢è¿™è¡Œä»£ç ä¸ºä¾‹ï¼š #define GET(p) (*((unsigned int * )p)) åƒè¿™ç§å°±æ˜¯æœ‰é—®é¢˜çš„ï¼Œå› ä¸ºæ²¡ç»™ p åŠ æ‹¬å·ï¼æ¯”å¦‚è¯´ï¼ŒGET((char *)bp - WSIZE) çš„åŸæœ¬æ„å›¾æ˜¯è®© bp å‡å» WSIZEï¼Œä½†æ”¾åˆ° GET é‡Œå°±å¯¼è‡´ bp å…ˆè¢«è½¬æ¢æˆ unsigned int æŒ‡é’ˆï¼Œå†å‡å» WSIZEï¼Œä»è€Œè®© bp å‡å»äº† WSIZE * sizeof(unsigned int)ï¼ validation_checkè¿™ä¸ª lab å¯ä»¥çœ‹ä½œåœ¨åˆ›å»ºä¸€ä¸ªç¥å¥‡çš„ç±»ï¼Œæˆ‘ä»¬æ€»ä¼šå¯¹ç±»æœ‰ä¸€äº› validation è¦æ±‚ï¼ˆæ¯”å¦‚è¯´åœ¨è¿™ä¸ª lab ä¸­ï¼Œæˆ‘ä»¬è¦æ±‚å†…å­˜é‡Œä¸èƒ½æœ‰è¿ç»­çš„ç©ºé—²å—ï¼‰ï¼Œè¿™æ—¶æˆ‘ä»¬å°±å¯ä»¥å†™ä¸€ä¸ª validation_check å‡½æ•°ï¼Œå®ƒä¼šæ£€æŸ¥è¿™ä¸ªç±»æ˜¯å¦æ»¡è¶³æˆ‘ä»¬çš„ validation è¦æ±‚ã€‚ é‚£è¿™ä¸ª validation_check æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿåœ¨è°ƒè¯•çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå®ƒæ’å…¥åˆ°å„ç§åœ°æ–¹ï¼Œç„¶åçœ‹å®ƒåœ¨å“ªé‡Œ failï¼Œè¿™èƒ½å¸®åŠ©æˆ‘ä»¬æ›´å¿«å®šä½ bugã€‚ä¸€ä¸ªå°æŠ€å·§æ˜¯ç”¨äºŒåˆ†çš„æ€è·¯æ¥æ’å…¥ validation_checkã€‚ å…¶ä»–å°æŠ€å·§å†™è¿™ä¸ª lab çš„æ—¶å€™ç”¨åˆ°äº†å¾ˆå¤š 6.102 çš„çŸ¥è¯†ï¼Œæœç„¶è½¯å·¥çŸ¥è¯†è¶…æœ‰ç”¨~æ¯”å¦‚è¯´ï¼Œå†™ä¸€ä¸ªç®€ç»ƒæ¸…æ™°çš„ specification å¾ˆæœ‰å¸®åŠ©ï¼Œfail fast ç‰¹åˆ«æœ‰ç”¨ã€‚ è¿˜æ³¨æ„åˆ°äº†ä¸€ä¸ªæœ‰è¶£çš„åœ°æ–¹ï¼Œsize_t åœ¨æˆ‘çš„ç³»ç»Ÿä¸Šæ˜¯è¿™æ ·æ˜¾ç¤ºçš„ï¼š typedef unsigned long size_t æ® claude è¯´ï¼Œsize_t çš„å…·ä½“å®šä¹‰å–å†³äºç³»ç»Ÿæ¶æ„ï¼Œè¿™å¯èƒ½æ˜¯ä¸ºäº†å¯ç§»æ¤æ€§è€ƒè™‘ï¼Ÿ é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘è§‰å¾—è¿˜æœ‰ä¸€ä¸ªé‡è¦çš„ä½œç”¨ï¼Œå°±æ˜¯ç»™ç±»å‹æä¾›â€œåˆ«åâ€ã€‚æœ‰æ—¶æˆ‘ä»¬å¸Œæœ›ç±»å‹æœ‰ä¸€ä¸ªæ›´å…·æè¿°æ€§çš„åç§°ï¼Œè€Œä¸åªæ˜¯â€œintâ€ã€‚","categories":[{"name":"å…¬å¼€è¯¾","slug":"å…¬å¼€è¯¾","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/"},{"name":"CMU-15-213","slug":"å…¬å¼€è¯¾/CMU-15-213","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/CMU-15-213/"},{"name":"Labs","slug":"å…¬å¼€è¯¾/CMU-15-213/Labs","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/CMU-15-213/Labs/"}],"tags":[]},{"title":"Ludum Dareå‚åŠ æŒ‡å—","slug":"game-design/ldjamå‚èµ›æŒ‡å—","date":"2025-04-13T01:36:38.000Z","updated":"2025-07-20T09:55:53.012Z","comments":true,"path":"wiki/game-design/ldjamå‚èµ›æŒ‡å—/","permalink":"http://rinevard.github.io/wiki/game-design/ldjam%E5%8F%82%E8%B5%9B%E6%8C%87%E5%8D%97/","excerpt":"","text":"é›¶ã€åœ¨æ–‡ç« å¼€å§‹ä¹‹å‰æœ¬æ–‡åŒ…å«äº†å¯¹ Ludum Dare çš„ä»‹ç»ã€å‚ä¸æµç¨‹åŠä¸ªäººçœ‹æ³•ã€‚å†™ä½œçš„å¥‘æœºæ˜¯å‚ä¸ Ludum Dare åä½“éªŒå¾ˆå¥½ï¼Œä½†åœ¨ä¸­æ–‡äº’è”ç½‘ä¸Šæ²¡æœ‰æ‰¾åˆ°å¾ˆå…¨é¢çš„ä»‹ç»èµ„æ–™ï¼Œåªæ‰¾åˆ°äº† è§„åˆ™ä»‹ç»ã€‚åœ¨è§„åˆ™ä»‹ç»ä¹‹å¤–ï¼Œæˆ‘å¸Œæœ›èŠèŠ Ludum Dare çš„ä½“éªŒä¸ºä»€ä¹ˆå¥½ï¼ˆæ¯”èµ·æˆ‘å‚åŠ è¿‡çš„å…¶ä»– gamejamï¼‰ï¼Œå¹¶æŒ‰æ—¶é—´çº¿ä»‹ç»ä¸€ä¸‹å‚ä¸æµç¨‹ã€‚ ä¸€ã€ä»€ä¹ˆæ˜¯ Ludum Dareå®˜ç½‘å†™åˆ°ï¼Œâ€Ludum Dare is an event where you create a game from scratch in a weekend based on a theme.â€ï¼ˆå‡ºè‡ª rulesï¼‰ï¼Œå³â€œLudum Dare æ˜¯ä¸€ä¸ªå›´ç»•æŸä¸ªä¸»é¢˜åœ¨ä¸€ä¸ªå‘¨æœ«ä»é›¶å¼€å§‹åšå‡ºä¸€ä¸ªæ¸¸æˆçš„æ´»åŠ¨ã€‚â€æ›´å…·ä½“ä¸€ç‚¹ï¼ŒLudum Dare ä¸»è¦åˆ†ä¸ºä¸¤ä¸ªèµ›é“ï¼Œåˆ†åˆ«æ˜¯å•äºº 48 å°æ—¶åšä¸€ä¸ªæ¸¸æˆå’Œç»„é˜Ÿ 72 å°æ—¶åšä¸€ä¸ªæ¸¸æˆã€‚ è¿™æ—¶å€™æœ‰ç»éªŒçš„è¯»è€…å°±ä¼šé—®äº†ï¼Œè¿™ä¸å°±æ˜¯ gamejam å—ï¼Ÿæ­£æ˜¯å¦‚æ­¤ï¼Ludum Dare æ˜¯éå¸¸æ—©æœŸçš„ gamejamï¼Œå®ƒè‡ª 2002 å¹´å¼€å§‹ä¸¾åŠï¼Œæ¯å¹´ä¸¾åŠä¸¤æ¬¡ï¼Œåˆ°ä»Šå¤©å·²ç»åŠäº† 57 å±Šã€‚æ¯å±Š Ludum Dare éƒ½ä¼šå¸å¼•å…¨çƒæ•°ä»¥ä¸‡è®¡çš„å¼€å‘è€…ï¼Œå¦‚ 2021 å¹´çš„ 49 å±Šæ”¶åˆ°äº†è¿‘ 3000 æ¬¾æ¸¸æˆæäº¤ï¼Œ 2023 å¹´çš„ç¬¬ 52 å±Šæ”¶åˆ°äº† 1632 æ¬¾æ¸¸æˆæäº¤ï¼ˆæ•°æ®æ¥æºï¼‰ã€‚åœ¨è¿™å¤§é‡çš„æäº¤æ¸¸æˆä¸­ï¼Œä¹Ÿæœ‰è®¸å¤šç²¾å“ä½œå“ä»æ­¤å‘æºï¼Œæ¯”å¦‚é‚ªæ¶é“­åˆ»ï¼ˆinscryptionï¼‰çš„åŸå‹ Sacrifices Must Be Made å°±äº Ludum Dare 43 åˆ¶ä½œã€‚ äºŒã€ä¸ºä»€ä¹ˆå‚åŠ  Ludum Dareä¸­å›½æœ‰é‚£ä¹ˆå¤šæœ¬åœŸçš„ gamejamï¼Œé‚£ä¸ºä»€ä¹ˆè¦é¡¶ç€è¯­è¨€éšœç¢å‚åŠ  Ludum Dare å‘¢ï¼Ÿæˆ‘è®¤ä¸ºæœ€é‡è¦çš„ä¸¤ç‚¹æ˜¯æ¸¸æˆè´¨é‡é«˜ã€æ”¶è·åé¦ˆå¤šã€‚ å…ˆè¯´å‰è€…ï¼Œgamejam æ€»æ˜¯æœ‰ç«èµ›æ€§è´¨çš„ï¼Œåœ¨ Ludum Dare é‡Œæˆ‘ä»¬è¦å’Œå…¨ä¸–ç•Œçš„ä¼˜ç§€å¼€å‘è€…ç«äº‰ï¼Œå•æ˜¯çœ‹ç€è¿™äº›å¼€å‘è€…å›´ç»•ä¸»é¢˜çš„å¥‡æ€å¦™æƒ³å°±å·²ç»è®©äººè§‰å¾—å€¼å›ç¥¨ä»·äº†ï¼ˆå¹¶æ²¡æœ‰ç¥¨ä»·ï¼Œè¿™æ˜¯å…è´¹æ´»åŠ¨ï¼‰ï¼Œè€Œå¦‚æœå–å¾—äº†å¥½æ’ååˆ™æ›´æ˜¯ä¼šç»™äººç›¸å½“çš„æˆå°±æ„Ÿã€‚ å†è¯´åè€…ï¼Œä»‹äº Ludum Dare çš„ç®—æ³•ï¼Œæ¯ä¸ªæ¸¸æˆåŸºæœ¬éƒ½ä¼šè·å¾— 20 ä¸ªä»¥ä¸Šçš„è¯„åˆ†ï¼Œè€Œä¸”ä½ ç©çš„æ¸¸æˆè¶Šå¤šï¼ŒLudum Dare å°±ä¼šæŠŠä½ çš„æ¸¸æˆæ”¾åœ¨æ¨èæ¦œè¶Šé å‰çš„ä½ç½®ï¼Œä»è€Œå°±ä¼šæœ‰è¶Šå¤šäººç©ä½ çš„æ¸¸æˆã€‚ä»¥æˆ‘çš„ç»éªŒæ¥çœ‹ï¼Œç©çš„æ¸¸æˆæ•°é‡å’Œæ”¶è·çš„è¯„åˆ†æ•°é‡åŸºæœ¬æ¥è¿‘ï¼Œè€Œä¸”å¾ˆå¤šç©äº†æˆ‘ä»¬æ¸¸æˆçš„å¼€å‘è€…ä¼šåœ¨æ¸¸æˆä¸‹ç»™å‡ºè¯„è®ºæ¥åé¦ˆï¼Œéå¸¸åˆ©äºæˆ‘ä»¬äº†è§£è‡ªå·±æ¸¸æˆçš„ä¼˜ç§€ä¹‹å¤„ï¼ˆå¯æƒœçš„æ˜¯è¯„è®ºä¸€èˆ¬ä¸è¯´ç¼ºç‚¹ï¼Œä»¥å¤¸å¤¸å±…å¤šï¼‰ã€‚ ä¸‹é¢å†ä¸¾å‡ ä¸ª Ludum Dare çš„å…¶ä»–ä¼˜åŠ¿ï¼š è¶³ä¸å‡ºæˆ·ï¼šä¸çº¿ä¸‹ gamejam ä¸åŒï¼Œå‚åŠ  Ludum Dare æ— éœ€æŠ¥åï¼Œåªè¦æ³¨å†Œè´¦å·å¹¶åœ¨æäº¤æ—¶é—´æˆªæ­¢å‰æäº¤æ¸¸æˆå³å¯ã€‚ ç©æ¸¸æˆæ–¹ä¾¿ï¼šå¤§éƒ¨åˆ†å¼€å‘è€…éƒ½ä¼šæä¾›æ¸¸æˆçš„ web ç‰ˆæœ¬ï¼Œå³ä½¿ä¸æä¾› web ç‰ˆæœ¬ä¹Ÿå¯ä»¥ç›´æ¥åœ¨å¯¹åº”çš„æ¸¸æˆé¡µé¢ä¸‹è½½æ¸¸æˆã€‚ äº¤æµæœºä¼šï¼šæˆ‘ä»¬å¯ä»¥ç»™åˆ«çš„æ¸¸æˆæä¾›åé¦ˆï¼Œä¹Ÿå¯ä»¥åœ¨åˆ«çš„æ¸¸æˆè¯„è®ºåŒºé‡Œè¯¢é—®å¼€å‘è€…çš„è®¾è®¡æ€è·¯ï¼Œä¸€èˆ¬éƒ½ä¼šæ”¶åˆ°ç§¯æçš„å›å¤ã€‚ å’Œå¤§ç¥åˆå½±ï¼šæ¯å±Šçš„ Ludum Dare éƒ½ä¼šæœ‰ä¸€äº›å¤§ç¥æ¥å‚åŠ ï¼Œå¦‚æœæ°å·§ç¢°ä¸Šäº†è‡ªå·±æ„Ÿå…´è¶£çš„å¤§ç¥ï¼Œå°±æœ‰äº†åœ¨ä»–ä»¬çš„æ¸¸æˆè¯„è®ºåŒºå¤¸å¤¸çš„åˆå½±æœºä¼šï¼ ä¸‰ã€å‚ä¸æµç¨‹Ludum Dare çš„æµç¨‹å¤§æ¦‚æ˜¯ä¸»é¢˜æŠ•ç¥¨ã€åˆ¶ä½œã€è¯„åˆ†ä¸åé¦ˆã€ç»“æœå…¬å¸ƒã€‚ä¸ºäº†é¡ºåˆ©å‚èµ›ï¼Œé¦–å…ˆæˆ‘ä»¬è¦åœ¨ Ludum Dare ä¸Šæ³¨å†Œä¸€ä¸ªè´¦å·ã€‚æ³¨å†Œè´¦å·éœ€è¦é‚€è¯·ç ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ Google ä¸Šç”¨ ludum dare invitation code ä¹‹ç±»çš„å…³é”®è¯æˆ–è€…åœ¨ä¸¾åŠè€…çš„ä¸»é¡µä¸Šæ‰¾åˆ°é‚€è¯·ç ã€‚æˆ‘æ‰¾åˆ°çš„ç¬¬ 57 å±Šçš„é‚€è¯·ç æœ‰ Time4LD57 å’Œ BirdSiteLD57ã€‚ åœ¨æ³¨å†ŒæˆåŠŸä¹‹åï¼Œæˆ‘ä»¬è¦æƒ³æƒ³è¿™æ¬¡æ˜¯å•äººå‚èµ›è¿˜æ˜¯ç»„é˜Ÿå‚èµ›ã€‚Ludum Dare æœ‰ä¸‰æ¡èµ›é“ï¼ŒCompoã€Jam å’Œ Extra. Compo æ˜¯ç»å…¸æ¨¡å¼ï¼Œè¦æ±‚å•äºº 48 å°æ—¶å†…åšæ¸¸æˆï¼Œæ‰€æœ‰å†…å®¹åŒ…æ‹¬ç¾æœ¯ã€éŸ³æ•ˆç­‰éƒ½éœ€è¦åœ¨ 48 å°æ—¶å†…ä»é›¶å¼€å§‹åšå‡ºï¼Œè€Œä¸”å¿…é¡»å¼€æºæºä»£ç ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»»ä½•å·²ç»å†™è¿‡çš„åŸºç¡€ä»£ç å’Œä»»ä½•å·¥å…·ã€‚å¦‚æœä½ çš„æ¸¸æˆæ”¶åˆ°äº† 20 ä¸ªä»¥ä¸Šçš„è¯„åˆ†ï¼Œä¼šå¾—åˆ°æœ€ç»ˆè¯„åˆ†ã€‚ Jam ç›¸å¯¹å®½æ¾ï¼Œåªè¦æ±‚ç»„é˜Ÿ 72 å°æ—¶å†…åšæ¸¸æˆï¼Œå¯ä»¥ä½¿ç”¨ä»»ä½•å·²ç»å†™è¿‡çš„åŸºç¡€ä»£ç ï¼Œä¹Ÿå…è®¸ä½¿ç”¨éƒ¨åˆ†é¢„åˆ¶ç´ æã€‚è‹¥ç¾æœ¯æˆ–éŸ³æ•ˆéåŸåˆ›ï¼Œéœ€è¦åœ¨æäº¤æ—¶å…³é—­å¯¹åº”ç±»åˆ«çš„æ‰“åˆ†ã€‚æ¯”å¦‚å¦‚æœæˆ‘ä»¬ç”¨äº†ç¬¬ä¸‰æ–¹ç¾æœ¯ï¼Œå°±è¦åœ¨æäº¤æ—¶å…³é—­ Graphics çš„æ‰“åˆ†ã€‚å¦‚æœä½ çš„æ¸¸æˆæ”¶åˆ°äº† 20 ä¸ªä»¥ä¸Šçš„è¯„åˆ†ï¼Œä¼šå¾—åˆ°æœ€ç»ˆè¯„åˆ†ã€‚ Extra åˆ™æ˜¯è½»æ¾ç»„ï¼Œæ—¶é—´å®½è£•è‡³ 3 å‘¨ï¼Œå•äººæˆ–å›¢é˜Ÿå‡å¯ï¼Œå†…å®¹ä»¥åŸåˆ›ä¸ºä¸»ä½†å…è®¸é¢„åˆ¶ç´ æï¼Œç¾æœ¯æˆ–éŸ³æ•ˆéåŸåˆ›å¯é€€å‡ºå¯¹åº”è¯„åˆ†ç±»åˆ«ï¼Œæºä»£ç æäº¤å¯é€‰ï¼Œä½†æ— æœ€ç»ˆæ’åã€‚ èµ›é“åœ¨æäº¤æ—¶æ‰éœ€è¦ç¡®å®šï¼Œæ‰€ä»¥å¦‚æœä½ åŸæœ¬æ‰“ç®—å‚åŠ  Compoï¼Œä½†æ²¡æ¥å¾—åŠèµ¶ä¸Š Compo çš„æˆªæ­¢æäº¤æ—¶é—´ï¼Œä¹Ÿå¯ä»¥è½¬å» Jam çš„æäº¤ã€‚ æƒ³å¥½äº†èµ›é“åï¼Œå°±èƒ½è¿›å…¥ä¹‹åçš„ç¯èŠ‚äº†ã€‚ ä¸»é¢˜æŠ•ç¥¨å®˜æ–¹ä¼šæä¾›å¤§é‡çš„ä¸»é¢˜ï¼ˆç¬¬ 57 å±Šæœ‰ 1000 å¤šä¸ªï¼‰ï¼Œç»è¿‡åˆé€‰è½®ã€å¤é€‰è½®ã€å†³èµ›è½®ï¼Œæœ€ç»ˆå¾—å‡ºä¸€ä¸ªç»“æœä¸»é¢˜ã€‚æˆ‘ä»¬å½“ç„¶ä¸å¿…ç»™æ¯ä¸ªä¸»é¢˜éƒ½æŠ•ç¥¨ï¼Œæˆ‘çš„ä¸ªäººå»ºè®®æ˜¯åœ¨å†³èµ›è½®æŠ•ä¸€ä¸‹å°±è¡Œã€‚è€Œä¸”å³ä½¿ä¸æŠ•ç¥¨ä¹Ÿæ˜¯èƒ½å‚èµ›çš„ï¼å‚èµ›çš„å”¯ä¸€è¦æ±‚å°±æ˜¯åœ¨æäº¤æ—¶é—´æˆªæ­¢å‰æäº¤ä½œå“ã€‚ æ˜¯å¦å›´ç»•ä¸»é¢˜åšæ¸¸æˆä¹Ÿæ˜¯å¯é€‰çš„ï¼Œä¸»é¢˜åªæ˜¯æœ€ç»ˆè¯„åˆ†ä¸­çš„ä¸€éƒ¨åˆ†ï¼ŒLudum Dare çš„å®—æ—¨æ˜¯é¼“åŠ±å¼€å‘è€…æŠŠæ¸¸æˆåšå‡ºæ¥ã€‚ åˆ¶ä½œé˜¶æ®µè¿›å…¥åˆ¶ä½œé˜¶æ®µåï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹åšæ¸¸æˆäº†ï¼ç‚¹å‡»å³ä¸Šè§’çš„ join eventï¼Œå°±èƒ½åˆ›å»ºæ¸¸æˆè‰ç¨¿é¡µã€‚æˆ‘ä»¬ä¼šåœ¨ä¸Šä¼ é˜¶æ®µå¡«å……è¿™ä¸ªè‰ç¨¿é¡µã€‚ åˆ¶ä½œæ¸¸æˆéœ€è¦å¤§å®¶å„æ˜¾ç¥é€šï¼Œæˆ‘ç®€å•è°ˆè°ˆä¸ªäººå»ºè®®å§ã€‚ è®¾è®¡ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬è¦å¿«é€Ÿåœ°æ‰¾åˆ°å¤šä¸ªæƒ³æ³•ï¼Œç„¶åé€‰æ‹©è‡ªå·±è§‰å¾—æœ€æœ‰å‰é€”çš„æƒ³æ³•åšä¸‹å»ã€‚ç”±äºåˆ¶ä½œæ—¶é—´å¾ˆç´§ï¼Œæˆ‘ä»¬æ³¨å®šä¸èƒ½åšå¤§åšå…¨ã€‚æ¯”èµ·å¤§è€Œå…¨ï¼Œå°è€Œç¾æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚ä¸€ä¸ªåªæœ‰ä¸‰å…³çš„è®¤çœŸæ‰“ç£¨è¿‡çš„ä½œå“æ¯”ä¸€ä¸ªæœ‰åå…³çš„æ¯å…³éƒ½å¾ˆç²—ç³™çš„ä½œå“è¦å¥½å¾—å¤šã€‚ ç¨‹åºå°½ç®¡ Ludum Dare å…è®¸è®¾è®¡æ¡Œæ¸¸ä¹ƒè‡³æ›´ä¸è¢«å®šä¹‰çš„æ¸¸æˆï¼ˆæˆ‘è§è¿‡ä¸€ä¸ªç¿»æ–‡ä»¶å¤¹çš„æ¸¸æˆï¼‰ï¼Œä½†æˆ‘ä»¬è¿™é‡Œåªè®¨è®ºç”µå­æ¸¸æˆã€‚ç¨‹åºæ–¹é¢ï¼Œé€‰ç”¨è‡ªå·±æœ€ç†Ÿæ‚‰çš„å·¥å…·å³å¯ã€‚æœ‰ç†Ÿç»ƒçš„æ¸¸æˆå¼•æ“å°±é€‰æ¸¸æˆå¼•æ“ï¼Œå–œæ¬¢ä¸ç”¨å¼•æ“å¼€å‘å°±ä¸ç”¨å¼•æ“å¼€å‘ã€‚ éŸ³ä¹æˆ‘æ˜¯éŸ³ä¹èŒæ–°ï¼Œè™½ç„¶å¬è¯´è¿‡ FL studio ä¹‹ç±»çš„å·¥ä½œç«™ï¼Œä½†æˆ‘ç°åœ¨è¿˜æ²¡å­¦ä¼šã€‚æ‰€ä»¥æˆ‘è¿™é‡Œæ¨èä¸€ä¸ªç®€å•çš„éŸ³ä¹åˆ¶ä½œç½‘ç«™â€”â€”Musiclabï¼Œæˆ‘ä½¿ç”¨é‡Œé¢çš„SongMakeråšå‡ºäº†èƒ½å¬çš„ä¸œè¥¿ã€‚ éŸ³æ•ˆsfxræ˜¯å¾ˆç®€å•çš„éŸ³æ•ˆåˆ¶ä½œç½‘ç«™ï¼Œæˆ‘çœ‹ä¸æ‡‚å‚æ•°ï¼Œæ‰€ä»¥æˆ‘çš„å·¥ä½œæµæ˜¯æŠŠæˆ‘æƒ³è¦çš„æ•ˆæœå‘Šè¯‰ AIï¼ŒAI å‘Šè¯‰æˆ‘æ€ä¹ˆè°ƒå‚ï¼Œæ•ˆæœå‡ºä¹æ„æ–™åœ°è¿˜ç®—ä¸é”™ã€‚ ç¾æœ¯æˆ‘ç”¨Piskelç”»ç®€å•çš„åƒç´ ç”»ï¼Œå¶å°”ä¹Ÿç”¨Kritaæ¥ç”»åˆ«çš„ä¸œè¥¿ã€‚ æŠ›å¼€ Extra èµ›é“ä¸è°ˆï¼Œè¿™ä¸ªé˜¶æ®µæŒç»­ 48 å°æ—¶æˆ– 72 å°æ—¶ï¼Œæˆ‘æœ€åçš„å»ºè®®æ˜¯åœ¨å‚ä¸çš„åŒæ—¶ä¿æŒå……è¶³çš„ç¡çœ ï¼Œå¥½å¥½ç¡è§‰å¥½å¥½åƒé¥­å¾ˆé‡è¦ï¼ ä¸Šä¼ é˜¶æ®µåœ¨åˆ¶ä½œé˜¶æ®µç»“æŸåï¼Œä¼šç»™é¢å¤–çš„ä¸€å°æ—¶æ¥ä¸Šä¼ ã€‚å°½ç®¡å®˜ç½‘ç»™äº†é¢å¤–ä¸€å°æ—¶çš„ä¸Šä¼ æ—¶é—´ï¼Œæˆ‘è¿˜æ˜¯å»ºè®®å¤§å®¶åœ¨åˆ¶ä½œé˜¶æ®µçš„æœ«å°¾å°±å¼€å§‹ç ”ç©¶æ€ä¹ˆä¸Šä¼ æ¸¸æˆï¼Œä»¥é˜²ä¸‡ä¸€å˜›ã€‚ æˆ‘ä»¬å¯ä»¥åœ¨è¿™æ®µæ—¶é—´é‡Œå¡«å……å³ä¸Šè§’ My Game çš„è‰ç¨¿é¡µï¼ŒæŒ‰ç€é¡µé¢è¦æ±‚å¡«å†™å³å¯ã€‚ æˆ‘ä»¬å¯ä»¥æŠŠæ¸¸æˆå‹ç¼©åŒ…ä¸Šä¼ åˆ°é¡µé¢ä¸Šï¼ŒåŒæ—¶ Ludum Dare æ”¯æŒ Embed HTML5ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥æ ¹æ®Embedding Guideç›´æ¥æŠŠæ¸¸æˆçš„ç½‘é¡µç‰ˆä¸Šä¼ åˆ°å®˜ç½‘çš„æ¸¸æˆé¡µé¢ä¸Šã€‚å»ºè®®å¤§å®¶åŒæ—¶æŠŠç½‘é¡µç‰ˆä¸Šä¼ åˆ° itch ä¸Šï¼Œæ¯•ç«Ÿå®˜ç½‘çš„ç½‘é¡µç‰ˆæ¸¸æˆæ”¯æŒåšå¾—ä¸ç®—å¾ˆå®Œç¾ã€‚ è®°å¾—é€€å‡ºè‡ªå·±ä¸ç¬¦åˆ/ä¸æƒ³è¦çš„æ‰“åˆ†é€‰é¡¹ã€‚ è¯„åˆ†é˜¶æ®µè‡³æ­¤ï¼Œæ­å–œä½ åšå‡ºäº†è‡ªå·±çš„æ¸¸æˆï¼ è¯„åˆ†é˜¶æ®µæŒç»­ä¸‰å‘¨ï¼Œåœ¨è¯„åˆ†é˜¶æ®µï¼Œæˆ‘ä»¬å¯ä»¥è¯•ç©åˆ«äººçš„æ¸¸æˆå¹¶æ‰“åˆ†ï¼Œä½ æ‰“åˆ†çš„æ¸¸æˆè¶Šå¤šï¼Œæ¨èç®—æ³•ç»™ä½ çš„æ¸¸æˆçš„æ¨èä¼˜å…ˆçº§å°±è¶Šé«˜ã€‚åŒæ—¶é«˜è´¨é‡è¯„è®ºä¹Ÿèƒ½æé«˜ä½ æ¸¸æˆçš„æ¨èä¼˜å…ˆçº§ã€‚ è¯„åˆ†é˜¶æ®µå…è®¸ç»§ç»­ç¼–è¾‘é¡µé¢ï¼Œæ¯”å¦‚å¦‚æœä½ å‘ç°æ¸¸æˆé¡µé¢çš„æè¿°æœ‰é—®é¢˜ï¼Œéšæ—¶å¯ä»¥è¿›è¡Œä¿®æ”¹ã€‚ä¿®æ¸¸æˆå†…çš„ bug ä¹Ÿæ˜¯è¢«å…è®¸çš„ï¼Œä½†è¦æ±‚åœ¨ä¿® bug ä»¥åæ˜¾å¼åœ°åœ¨æ¸¸æˆé¡µé¢æ ‡å‡ºè‡ªå·±åšçš„ä¿®æ”¹ï¼ˆå†™ä¸€ä¸ªç®€è¦çš„ devlogï¼‰ï¼Œè€Œä¸”ä¸èƒ½å¢åŠ æ–°åŠŸèƒ½ã€‚ ç»“æœå…¬å¸ƒæ¸¸æˆä¼šæ ¹æ®æ‰“åˆ†æ¥æ’åã€‚æ²¡æœ‰å¥–å“ï¼Œä½ çš„æ¸¸æˆå°±æ˜¯æœ€å¥½çš„å¥–å“ï¼ å››ã€å…¶ä»–èµ„æ–™å¯ä»¥åœ¨rulesé¡µé¢æ‰¾åˆ°è¯¦ç»†çš„å‚åŠ è§„åˆ™ï¼Œå¼ºçƒˆå»ºè®®åœ¨å‚åŠ å‰é˜…è¯»ã€‚ å¯ä»¥åœ¨è¿™ç¯‡è§„åˆ™ä»‹ç»æ‰¾åˆ°ä¸­æ–‡çš„è§„åˆ™ä»‹ç»ï¼Œä½†ä¸å¦‚ä¸Šé¢é‚£ä¸ªå…¨é¢ã€‚ æœ¬æ–‡çš„ç»“æ„å‚è€ƒäº† Google ç¼–ç¨‹ä¹‹å¤(GSoC)ï¼šæµ·é‡ä¼˜è´¨é¡¹ç›®ï¼Œä¸°åšæŠ¥é…¬ï¼Œä½ ç«Ÿç„¶è¿˜ä¸çŸ¥é“ï¼Ÿ","categories":[{"name":"gamejam","slug":"gamejam","permalink":"http://rinevard.github.io/categories/gamejam/"}],"tags":[]},{"title":"ç¬¬åç« â€”â€”ç³»ç»Ÿçº§I/O","slug":"learning/open-course/CMU-15-213/Notes/Chapter10-system-io","date":"2025-04-11T02:00:00.000Z","updated":"2025-08-22T03:14:43.982Z","comments":true,"path":"wiki/learning/open-course/CMU-15-213/Notes/Chapter10-system-io/","permalink":"http://rinevard.github.io/wiki/learning/open-course/CMU-15-213/Notes/Chapter10-system-io/","excerpt":"","text":"img{ width: 75%; } æ–‡ä»¶æ‰€æœ‰çš„ I/O è®¾å¤‡éƒ½è¢«è§†ä¸ºæ–‡ä»¶ï¼Œå› æ­¤æˆ‘ä»¬èƒ½ç”¨ä¸€è‡´çš„æ–¹å¼å¤„ç†å„ç§è¾“å…¥è¾“å‡ºã€‚ æ–‡ä»¶ç±»å‹åˆ†ä¸ºä»¥ä¸‹å‡ ç±» æ™®é€šæ–‡ä»¶ï¼šåŒ…å«ç”¨æˆ·æ•°æ®ï¼Œå¯ä»¥æ˜¯æ–‡æœ¬æ–‡ä»¶ï¼ˆå¦‚.txtï¼‰æˆ–äºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆå¦‚.jpgã€.exeï¼‰ ç›®å½•ï¼šåŒ…å«ä¸€ç³»åˆ—é“¾æ¥ï¼Œæ¯ä¸ªè¿æ¥å°†ä¸€ä¸ªæ–‡ä»¶åæ˜ å°„åˆ°ä¸€ä¸ªæ–‡ä»¶ å¥—æ¥å­—ï¼ˆsocketï¼‰ï¼šè·¨ç½‘ç»œé€šä¿¡ç”¨çš„æ–‡ä»¶ è¯»å†™æ–‡ä»¶æ–‡ä»¶æè¿°ç¬¦ï¼ˆfile descriptorï¼‰æ–‡ä»¶æè¿°ç¬¦æ˜¯ä¸€ä¸ªéè´Ÿæ•´æ•°ï¼Œä»£è¡¨è¿›ç¨‹æ‰“å¼€çš„æ–‡ä»¶çš„æ ‡è¯†ç¬¦ã€‚åœ¨è¿›ç¨‹ä¸­ï¼Œæ¯å½“æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šåˆ†é…ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ç»™å®ƒã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œ0 è¡¨ç¤ºæ ‡å‡†è¾“å…¥ï¼ˆstdinï¼‰ï¼Œ1 è¡¨ç¤ºæ ‡å‡†è¾“å‡ºï¼ˆstdoutï¼‰ï¼Œ2 è¡¨ç¤ºæ ‡å‡†é”™è¯¯ï¼ˆstderrï¼‰ã€‚é€šè¿‡ç³»ç»Ÿè°ƒç”¨ï¼ˆå¦‚ openï¼‰æ‰“å¼€æ–‡ä»¶åï¼Œä¼šè¿”å›ä¸€ä¸ªæ–°çš„æ–‡ä»¶æè¿°ç¬¦ï¼ˆå¦‚ 3ã€4 ç­‰ï¼‰ï¼Œå…·ä½“å€¼å–å†³äºå½“å‰è¿›ç¨‹ä¸­å·²ä½¿ç”¨çš„æè¿°ç¬¦æƒ…å†µã€‚ ä»¥ä¸‹æ˜¯ä¸€ä¸ªä½¿ç”¨ open ç³»ç»Ÿè°ƒç”¨çš„ç¤ºä¾‹ï¼Œå±•ç¤ºå¦‚ä½•æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶å¹¶è·å–æ–‡ä»¶æè¿°ç¬¦ï¼š #include &lt;fcntl.h> #include &lt;stdio.h> #include &lt;unistd.h> int main() &#123; // æ‰“å¼€æ–‡ä»¶ \"example.txt\"ï¼Œä»¥åªè¯»æ¨¡å¼ int fd = open(\"example.txt\", O_RDONLY); if (fd == -1) &#123; perror(\"open failed\"); return 1; &#125; printf(\"æ–‡ä»¶æè¿°ç¬¦: %d\\\\n\", fd); // ä½¿ç”¨æ–‡ä»¶æè¿°ç¬¦è¿›è¡Œæ“ä½œï¼ˆå¦‚è¯»å–ï¼‰ char buffer[100]; ssize_t bytes_read = read(fd, buffer, sizeof(buffer)); if (bytes_read == -1) &#123; perror(\"read failed\"); close(fd); return 1; &#125; // å…³é—­æ–‡ä»¶æè¿°ç¬¦ close(fd); return 0; &#125; ä¸è¶³å€¼ï¼ˆshort countï¼‰â€œä¸è¶³å€¼â€æ˜¯æŒ‡åœ¨è¯»å†™æ“ä½œä¸­ï¼Œå®é™…è¯»å–æˆ–å†™å…¥çš„å­—èŠ‚æ•°å°‘äºè¯·æ±‚çš„å­—èŠ‚æ•°ã€‚åŸå› æœ‰é‡åˆ° EOFã€ä»ç»ˆç«¯è¯»æ–‡æœ¬è¡Œï¼ˆå¦‚æœè¯»ç»ˆç«¯ï¼Œread ä¸€æ¬¡åªä¼ è¾“ä¸€ä¸ªæ–‡æœ¬è¡Œï¼‰ã€è¯»å†™ç½‘ç»œå¥—æ¥å­—ã€‚ æ¯”å¦‚è°ƒç”¨ read(fd, buffer, 100)è¯·æ±‚è¯»å– 100 å­—èŠ‚ï¼Œä½†æ–‡ä»¶åªå‰© 50 å­—èŠ‚å¯ç”¨ï¼Œåˆ™è¿”å› 50ï¼ˆä¸è¶³å€¼ï¼‰ã€‚ æˆ‘ä»¬éœ€è¦æ£€æŸ¥è¿”å›å€¼ï¼Œç¡®è®¤å®é™…è¯»å†™å­—èŠ‚æ•°ï¼Œå¹¶æ ¹æ®éœ€è¦è°ƒæ•´é€»è¾‘ï¼ˆå¦‚å¾ªç¯è¯»å–å‰©ä½™æ•°æ®ï¼‰ã€‚ æè¿°ç¬¦è¡¨ã€æ–‡ä»¶è¡¨ã€v-node è¡¨æ“ä½œç³»ç»Ÿåœ¨å†…æ ¸ä¸­ç»´æŠ¤äº†ä¸‰å±‚æ•°æ®ç»“æ„æ¥ç®¡ç†æ–‡ä»¶ï¼š æè¿°ç¬¦è¡¨ï¼šæ¯ä¸ªè¿›ç¨‹ç‹¬æœ‰ï¼Œè®°å½•è¯¥è¿›ç¨‹æ‰“å¼€çš„æ‰€æœ‰æ–‡ä»¶æè¿°ç¬¦åŠå…¶å¯¹åº”çš„æ–‡ä»¶è¡¨é¡¹ã€‚ æ–‡ä»¶è¡¨ï¼šæ‰€æœ‰è¿›ç¨‹å…±äº«ï¼Œè¡¨é¡¹åŒ…æ‹¬åç§»å€¼ã€å¼•ç”¨è®¡æ•°ï¼ˆå³å½“å‰æŒ‡å‘è¯¥è¡¨çš„æè¿°ç¬¦è¡¨é¡¹æ•°ï¼‰ã€æŒ‡å‘ v-node è¡¨ä¸­å¯¹åº”é¡¹çš„æŒ‡é’ˆã€‚å…³é—­ä¸€ä¸ªæè¿°ç¬¦ä¼šå‡å°‘ç›¸åº”çš„æ–‡ä»¶è¡¨è¡¨é¡¹çš„å¼•ç”¨è®¡æ•°ï¼Œå‡åˆ°é›¶ä¼šåˆ é™¤ã€‚ v-node è¡¨ï¼ˆæˆ– inode è¡¨ï¼‰ï¼šä¸å…·ä½“æ–‡ä»¶ç³»ç»Ÿç›¸å…³ï¼Œè®°å½•æ–‡ä»¶çš„å…ƒæ•°æ®ï¼ˆå¦‚æ–‡ä»¶å¤§å°ã€æƒé™ã€å­˜å‚¨ä½ç½®ï¼‰ã€‚æ¯ä¸ªæ–‡ä»¶åœ¨ v-node è¡¨ä¸­æœ‰ä¸€ä¸ªå”¯ä¸€æ¡ç›®ã€‚ è°ƒç”¨ open æ‰“å¼€æ–‡ä»¶çš„å…·ä½“è¿‡ç¨‹å½“è°ƒç”¨ open ç³»ç»Ÿè°ƒç”¨æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šæ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š éªŒè¯å’ŒæŸ¥æ‰¾æ–‡ä»¶ï¼š å†…æ ¸æ£€æŸ¥æ–‡ä»¶è·¯å¾„ã€æƒé™ç­‰ï¼Œç¡®å®šæ–‡ä»¶æ˜¯å¦å­˜åœ¨ä¸”è¿›ç¨‹æœ‰æƒè®¿é—®ã€‚ æ‰¾åˆ°æ–‡ä»¶å¯¹åº”çš„ v-nodeï¼ˆæˆ– inodeï¼‰ï¼Œå¦‚æœæ–‡ä»¶å·²åœ¨ v-node è¡¨ä¸­ï¼Œåˆ™å¤ç”¨ï¼Œå¦åˆ™åˆ›å»ºæ–°æ¡ç›®ã€‚ åˆ†é…æ–‡ä»¶è¡¨é¡¹ï¼š å†…æ ¸åœ¨æ–‡ä»¶è¡¨ï¼ˆfile tableï¼‰ä¸­åˆ›å»ºä¸€ä¸ªæ–°è¡¨é¡¹ï¼Œè®°å½•æ–‡ä»¶çš„åç§»é‡ï¼ˆåˆå§‹ä¸º 0ï¼‰ã€è®¿é—®æ¨¡å¼ï¼ˆå¦‚åªè¯»ã€è¯»å†™ï¼‰ã€å¼•ç”¨è®¡æ•°ï¼ˆåˆå§‹ä¸º 1ï¼‰ä»¥åŠæŒ‡å‘å¯¹åº” v-node çš„æŒ‡é’ˆã€‚ æ›´æ–°æè¿°ç¬¦è¡¨ï¼š å†…æ ¸åœ¨è°ƒç”¨è¿›ç¨‹çš„æè¿°ç¬¦è¡¨ï¼ˆfile descriptor tableï¼‰ä¸­åˆ†é…ä¸€ä¸ªæœªä½¿ç”¨çš„æœ€å°æè¿°ç¬¦ç¼–å·ï¼ˆå¦‚ 3ï¼Œè‹¥ 0ã€1ã€2 å·²å ç”¨ï¼‰ã€‚ å°†è¯¥æè¿°ç¬¦æŒ‡å‘æ–°åˆ›å»ºçš„æ–‡ä»¶è¡¨é¡¹ã€‚ è¿”å›æ–‡ä»¶æè¿°ç¬¦ï¼š open è°ƒç”¨è¿”å›åˆ†é…çš„æ–‡ä»¶æè¿°ç¬¦ç»™è¿›ç¨‹ï¼Œä¾›åç»­æ“ä½œï¼ˆå¦‚ readã€writeï¼‰ä½¿ç”¨ã€‚ open ä¸¤æ¬¡ï¼š forkï¼š åŸºäºç¼“å†²åŒºçš„è¯»å†™åŸºäºç¼“å†²åŒºçš„è¯»å†™å°†æ•°æ®å…ˆå†™å…¥å†…å­˜ç¼“å†²åŒºï¼Œç­‰ç¼“å†²åŒºæ»¡æˆ–æ˜¾å¼åˆ·æ–°ï¼ˆå¦‚ fflushï¼‰æ—¶å†ä¸€æ¬¡æ€§ä¸åº•å±‚è®¾å¤‡åšæ•°æ®äº¤æ¢ï¼Œé™ä½äº† I/O å¼€é”€ã€‚ åœ¨ä½¿ç”¨è¯»å†™æ—¶ï¼Œæˆ‘ä»¬åº”å°½å¯èƒ½ä½¿ç”¨ stdio æ ‡å‡†åº“ã€‚stdioï¼ˆæ ‡å‡†è¾“å…¥è¾“å‡ºåº“ï¼‰æä¾›äº†åŸºäºç¼“å†²åŒºçš„ I/O æ“ä½œï¼ˆå¦‚ fopenã€freadã€fwriteã€printf ç­‰ï¼‰ï¼Œç›¸æ¯”ç›´æ¥ä½¿ç”¨ä½çº§ç³»ç»Ÿè°ƒç”¨ï¼ˆå¦‚ readã€writeï¼‰ï¼Œå®ƒçš„æ•ˆç‡æ›´é«˜è€Œä¸”æ›´ä¸æ˜“å‡ºé”™ã€‚","categories":[{"name":"å…¬å¼€è¯¾","slug":"å…¬å¼€è¯¾","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/"},{"name":"CMU-15-213","slug":"å…¬å¼€è¯¾/CMU-15-213","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/CMU-15-213/"},{"name":"Notes","slug":"å…¬å¼€è¯¾/CMU-15-213/Notes","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/CMU-15-213/Notes/"}],"tags":[]},{"title":"Shlabè°ƒè¯•è®°å½•å’Œä¸€é”®æµ‹è¯•è„šæœ¬","slug":"learning/open-course/CMU-15-213/Labs/Shlab","date":"2025-04-03T09:04:28.000Z","updated":"2025-08-22T03:14:43.981Z","comments":true,"path":"wiki/learning/open-course/CMU-15-213/Labs/Shlab/","permalink":"http://rinevard.github.io/wiki/learning/open-course/CMU-15-213/Labs/Shlab/","excerpt":"","text":"å†™åœ¨å‰é¢ç”¨æ—¶ 10h30min, é€šè¿‡æ‰€æœ‰æµ‹è¯•ã€‚è¿™ä¸ª lab è¿˜æ˜¯æ¯”è¾ƒç›´æ¥çš„, æŒ‰ç€ trace çš„é¡ºåºé€æ­¥å®ç°å³å¯, éš¾ç‚¹ä¸»è¦åœ¨è°ƒè¯•å’Œä¸ç†Ÿæ‚‰ç³»ç»Ÿè°ƒç”¨è¯­æ³•ä¸Šã€‚æˆ‘åœ¨å†™ä»£ç çš„è¿‡ç¨‹ä¸­é‡åˆ°äº†ä¸¤ä¸ªè°ƒäº†è›®ä¹…çš„ bug, åˆ†åˆ«åœ¨ trace13 å’Œ trace16 ä¸Š, ä¸‹é¢ç®€è¦å¤ç›˜ä¸€ä¸‹ã€‚ è°ƒè¯•trace16å…ˆè¯´ trace16 çš„ bug, è¿™ä¸ªè°ƒäº†åŠå°æ—¶ã€‚trace16 æµ‹è¯•çš„æ˜¯ shell èƒ½å¦å¤„ç†å­è¿›ç¨‹è¢«å¤–éƒ¨ä¿¡å·ä¸­æ–­æˆ–åœæ­¢çš„æƒ…å†µã€‚æˆ‘é‡åˆ°çš„é—®é¢˜æ˜¯ trace16 åœ¨ ./mystop é‚£é‡Œå¡ä½äº†, äºæ˜¯çŒœæµ‹åŸå› æ˜¯ jobs æ²¡èƒ½æ­£ç¡®æ›´æ–°å­è¿›ç¨‹çš„æš‚åœçŠ¶æ€ã€‚åé¢åŠ äº†ç‚¹è°ƒè¯•è¯­å¥å‘ç°æœç„¶å¦‚æ­¤ã€‚é‚£ä¹ˆä¿®å¤æ€è·¯å°±æ˜¯åœ¨å­è¿›ç¨‹æš‚åœåæŠŠå®ƒå¯¹åº”çš„ job çŠ¶æ€è¿›è¡Œæ›´æ–°ã€‚ä½†æ€ä¹ˆçŸ¥é“å­è¿›ç¨‹ä»€ä¹ˆæ—¶å€™æš‚åœå‘¢ï¼Ÿç­”æ¡ˆæ˜¯ sigchld_handler. æˆ‘ä¸€å¼€å§‹ä»¥ä¸º sigchld_handler åªä¼šåœ¨æŸä¸ªå­è¿›ç¨‹ç»ˆæ­¢åè¢«è°ƒç”¨, æ‰€ä»¥åªåœ¨ sigchld_handler é‡Œå†™äº†å›æ”¶å·²ç»ç»ˆæ­¢çš„å­è¿›ç¨‹çš„é€»è¾‘ã€‚åæ¥å‘ç°å­è¿›ç¨‹åªè¦çŠ¶æ€å‘ç”Ÿå˜åŒ–å°±ä¼šå‘ SIGCHLD ä¿¡å·ç»™çˆ¶è¿›ç¨‹, å­è¿›ç¨‹ç»ˆæ­¢åªæ˜¯ä¸€ç§æƒ…å†µ, æš‚åœã€æ¢å¤ä¹Ÿä¼šå‘é€è¿™ä¸ªä¿¡å·ã€‚æ‰€ä»¥è®© sigchld_handler æ£€æŸ¥å·²ç»åœæ­¢çš„å­è¿›ç¨‹, å¹¶æ›´æ–°å®ƒä»¬å¯¹åº”çš„ jobs çŠ¶æ€å°±ä¿®å¤äº†è¿™ä¸ª bug. trace13ç„¶åæ˜¯ trace13 çš„ bug, è¿™ä¸ªè°ƒäº†ä¸¤å°æ—¶åŠã€‚è¿™é‡Œçš„é—®é¢˜æ˜¯åœ¨ fg %1 å¡ä½ã€‚ç¬¬ä¸€ä¸ªçŒœæµ‹è‡ªç„¶æ˜¯è¿›ç¨‹æ²¡èƒ½è¢«æ­£ç¡®ç§»åˆ°å‰å°, ä½†åŠ äº†è°ƒè¯•è¯­å¥åå‘ç°å®ƒç¡®å®è¢«ç§»åˆ°å‰å°äº†ã€‚ä¹‹åçš„çŒœæµ‹å°±æ˜¯ waitfg çš„å®ç°æœ‰è¯¯, è¿™ä¸ªçŒœæµ‹çœ‹èµ·æ¥å¾ˆåˆç†, æ¯•ç«Ÿ handout é‡Œå†™ waitfg å¤§æ¦‚éœ€è¦ 20 è¡Œ, è€Œæˆ‘åªç”¨äº† 4 è¡Œã€‚ä½†æµ‹äº†åŠå¤©å‘ç° waitfg ä¹Ÿæ²¡é—®é¢˜ã€‚ è¿›ä¸€æ­¥åŠ å…¥å„ç§è°ƒè¯•è¯­å¥, å‘ç°åœ¨ fg %1 ä¹‹å, è¿›ç¨‹ç¡®å®è¢«é¡ºåˆ©ç§»åˆ°äº†å‰å°, jobs ä¹Ÿæ­£ç¡®æ›´æ–°äº†, waitfg åªæ˜¯å› ä¸ºå®ƒæ²¡ç»“æŸ, æ‰€ä»¥ä¸€ç›´å¾ªç¯ç€ç­‰ç€å®ƒã€‚å¥½å§, é‚£æˆ‘çŒœæ˜¯ sigchld_handler æ²¡èƒ½æ­£ç¡®å›æ”¶å®ƒã€‚æˆ‘æ£€æŸ¥äº†ä¸€ä¸‹, å‘ç°ç»ˆæ­¢çš„è¿›ç¨‹ä¹Ÿéƒ½è¢«æ­£ç¡®å›æ”¶äº†ã€‚é‚£è¿˜èƒ½æ˜¯ä»€ä¹ˆåŸå› å‘¢ï¼Ÿéš¾é“å®ƒè¢«æš‚åœäº†, ä½†æ²¡æœ‰è¢«æ­£ç¡®å¯åŠ¨, å¯¼è‡´æˆ‘ä»¬çš„ shell è¯¯ä»¥ä¸ºè¿™ä¸ªæš‚åœç€çš„è¿›ç¨‹æ˜¯å‰å°è¿›ç¨‹, ä»è€Œå¡ä½äº†ï¼Ÿè¿™å¬èµ·æ¥å°±åƒæ˜¯ä¸€ä¸ªå¹¶è¡Œå¯¼è‡´çš„é—®é¢˜, äºæ˜¯æˆ‘åˆè°ƒè¯•äº†å¥½ä¹…, æœ€åå‘ç°å®ƒç¡®å®è¢«æ­£ç¡®å¯åŠ¨äº†, è¿™ä¸ªè¿›ç¨‹åªæ˜¯å•çº¯åœ°è¿˜æ²¡æœ‰ç»ˆæ­¢è€Œå·²ã€‚ é‚£è¿™æ€ä¹ˆå¯èƒ½å‘¢ï¼Ÿå‡­ä»€ä¹ˆå®ƒåœ¨ tshref é‡Œå‡ ç§’é’Ÿå°±æ‰§è¡Œå®Œäº†, åœ¨æˆ‘çš„å®ç°é‡Œäº”åˆ†é’Ÿäº†éƒ½æ²¡æ‰§è¡Œå®Œï¼ŸåŸæ¥æ˜¯æˆ‘çš„â€œå¯åŠ¨â€å†™é”™äº†ã€‚æˆ‘ä½¿ç”¨çš„æ˜¯ kill(job-&gt;pid, SIGCONT), è¿™ä¸ªä»£ç åªæŠŠå¯åŠ¨ä¿¡å·å‘ç»™äº†è¿™ä¸€ä¸ªå­è¿›ç¨‹, è€Œä¸æ˜¯å‘ç»™å®ƒæ‰€åœ¨çš„è¿›ç¨‹ç»„, ä»è€Œè®©è¿™ä¸ªå­è¿›ç¨‹æ‰€åœ¨ç»„çš„åˆ«çš„è¿›ç¨‹æ²¡æœ‰è¢«æ­£ç¡®å¯åŠ¨ã€‚è€Œçœ‹çœ‹ mysplit.c çš„ä»£ç , ä¼šå‘ç°å®ƒç­‰å¾…å®ƒçš„å­è¿›ç¨‹æ‰§è¡Œå®Œæ‰ä¼šç»ˆæ­¢, æ‰€ä»¥æˆ‘ä»¬æŠŠä»£ç æ”¹æˆ kill(-job-&gt;pid, SIGCONT) å°±è§£å†³äº†è¿™ä¸ª bug. å°±å› ä¸ºè¿™ä¸€ä¸ªè´Ÿå·, æˆ‘è°ƒè¯•äº†ä¸¤ä¸ªåŠå°æ—¶, è€Œä¸”æˆ‘æ„Ÿè§‰æˆ‘ä¸€è·¯ä¸‹æ¥çš„å„ç§çŒœæƒ³ä¹Ÿéƒ½å¾ˆåˆç†, åªèƒ½æ„Ÿå¹ç³»ç»Ÿçº§ä»£ç çœŸéš¾è°ƒè¯•å•Šã€‚ æ„Ÿæƒ³ä¹Ÿç®—æ˜¯å­¦åˆ°äº†å‡ æ‹›å§ï¼š åœ¨è°ƒç”¨ç³»ç»Ÿå‡½æ•°æ—¶ä¸€å®šè¦æ£€æŸ¥è¿”å›å€¼, ä¸ç„¶ä¼šæŠ¥ä¸€äº›å¾ˆéš¾è°ƒè¯•çš„é”™è¯¯ åœ¨ä¿®æ”¹å…¨å±€å˜é‡æ—¶ä¸€å®šè¦ç”¨ sigprocmask æ‹¦æˆªåˆ«çš„ä¿¡å·, é¿å…å†²çª å­è¿›ç¨‹åªè¦çŠ¶æ€å‘ç”Ÿå˜åŒ–å°±ä¼šå‘ SIGCHLD ä¿¡å·ç»™çˆ¶è¿›ç¨‹, ç»ˆæ­¢ã€æš‚åœã€æ¢å¤éƒ½ä¼šå‘é€è¿™ä¸ªä¿¡å· å¯ä»¥ç”¨ waitpid æ¥æ£€æŸ¥å­è¿›ç¨‹çš„å˜åŒ–çŠ¶æ€, å®ƒä¼šå›æ”¶ç»ˆæ­¢çš„å­è¿›ç¨‹ åªåœ¨ä¿¡å·å¤„ç†ç¨‹åºä¸­è°ƒç”¨å¼‚æ­¥å®‰å…¨çš„å‡½æ•° è°ƒè¯•æ—¶å¤§èƒ†çŒœæƒ³, å°å¿ƒæ±‚è¯ ä¸€é”®æµ‹è¯•è„šæœ¬æˆ‘è®© AI å†™äº†ä¸€ä»½ä¸€é”®æµ‹è¯•è„šæœ¬, æ¯”å®˜æ–¹çš„å½¢å¦‚ make test13 çš„æµ‹è¯•æ–¹ä¾¿ä¸å°‘ã€‚è„šæœ¬çš„åŠŸèƒ½æ˜¯åœ¨ traceA åˆ° traceBï¼ˆè¦æ±‚ A &lt; Bï¼‰ä¸Šåˆ†åˆ«è¿è¡Œ tsh å’Œ tshref, å¹¶æŠŠè¾“å‡ºç»“æœæ”¾åˆ°ä¸¤ä¸ªæ–‡ä»¶ä¸­ã€‚æ¯”å¦‚è¯´, å¦‚æœæˆ‘ä»¬è¾“å…¥ ./test_traces.sh 1 5, å°±èƒ½æµ‹è¯• trace01.txt åˆ° trace05.txt, å¹¶å°†ç»“æœåˆ†åˆ«ä¿å­˜åˆ° _tshref_output.txt å’Œ _tsh_output.txtã€‚ä¹‹åç”¨å„ç§ç¼–è¾‘å™¨è‡ªå¸¦çš„æ¯”è¾ƒæ–‡ä»¶åŠŸèƒ½å°±èƒ½å¾ˆæ–¹ä¾¿çš„æ¯”è¾ƒè¾“å‡ºå¼‚åŒã€‚ ä»£ç #!/bin/bash # è„šæœ¬åç§°ï¼štest_traces.sh # æ˜¾ç¤ºç”¨æ³• usage() &#123; echo \"ç”¨æ³•: $0 lower upper\" echo \" lower: å¼€å§‹çš„ trace æ–‡ä»¶ç¼–å· (1-16)\" echo \" upper: ç»“æŸçš„ trace æ–‡ä»¶ç¼–å· (1-16)\" echo \"ç¤ºä¾‹: $0 1 5\" echo \" è¿™å°†æµ‹è¯• trace01.txt åˆ° trace05.txtï¼Œå¹¶å°†è¾“å‡ºåˆ†åˆ«ä¿å­˜åˆ° _tshref_output.txt å’Œ _tsh_output.txt\" &#125; # æ£€æŸ¥æ˜¯å¦æä¾›äº†ä¸¤ä¸ªå‚æ•° if [ \"$#\" -ne 2 ]; then echo \"é”™è¯¯: è¯·æä¾› lower å’Œ upper ä¸¤ä¸ªå‚æ•°\" usage exit 1 fi lower=$1 upper=$2 ref_output_file=\"_tshref_output.txt\" tsh_output_file=\"_tsh_output.txt\" # æ¸…ç©ºè¾“å‡ºæ–‡ä»¶ï¼ˆå¦‚æœå·²å­˜åœ¨ï¼‰ > \"$ref_output_file\" > \"$tsh_output_file\" # è·å–å½“å‰å·¥ä½œç›®å½•ï¼ˆæ¨¡ä»¿ make çš„ Entering directory æ ¼å¼ï¼‰ directory=$(pwd) # å¾ªç¯è¿è¡ŒæŒ‡å®šèŒƒå›´çš„ trace æ–‡ä»¶ for ((i=lower; i&lt;=upper; i++)); do # è¡¥é½ä¸¤ä½æ•°æ ¼å¼ï¼ˆä¾‹å¦‚ 01, 02, ..., 16ï¼‰ trace_num=$(printf \"%02d\" $i) # è¾“å‡º make æ ·å¼çš„è¿›å…¥ç›®å½•ä¿¡æ¯ï¼ˆä»…ç¬¬ä¸€æ¬¡å¾ªç¯æ—¶ï¼‰ if [ $i -eq $lower ]; then echo \"make[1]: Entering directory \\`$directory'\" >> \"$ref_output_file\" echo \"make[1]: Entering directory \\`$directory'\" >> \"$tsh_output_file\" fi # ä¸º tshref è¾“å‡ºæ·»åŠ åˆ†éš”ç¬¦å’Œå†…å®¹ echo \"===== Trace $trace_num =====\" >> \"$ref_output_file\" echo \"./sdriver.pl -t trace$trace_num.txt -s ./tshref -a \\\"-p\\\"\" >> \"$ref_output_file\" head -n 1 \"trace$trace_num.txt\" >> \"$ref_output_file\" ./sdriver.pl -t \"trace$trace_num.txt\" -s ./tshref -a \"-p\" >> \"$ref_output_file\" 2>&amp;1 echo \"\" >> \"$ref_output_file\" # æ·»åŠ ç©ºè¡Œä½œä¸ºé—´éš” # ä¸º tsh è¾“å‡ºæ·»åŠ åˆ†éš”ç¬¦å’Œå†…å®¹ echo \"===== Trace $trace_num =====\" >> \"$tsh_output_file\" echo \"./sdriver.pl -t trace$trace_num.txt -s ./tsh -a \\\"-p\\\"\" >> \"$tsh_output_file\" head -n 1 \"trace$trace_num.txt\" >> \"$tsh_output_file\" ./sdriver.pl -t \"trace$trace_num.txt\" -s ./tsh -a \"-p\" >> \"$tsh_output_file\" 2>&amp;1 echo \"\" >> \"$tsh_output_file\" # æ·»åŠ ç©ºè¡Œä½œä¸ºé—´éš” done echo \"æµ‹è¯•å®Œæˆã€‚å‚è€ƒå®ç°ç»“æœå·²ä¿å­˜åˆ° $ref_output_fileï¼Œå­¦ç”Ÿå®ç°ç»“æœå·²ä¿å­˜åˆ° $tsh_output_file\" ç”¨æ³•ç®€è¿° ä¿å­˜è„šæœ¬ï¼š å°†ä¸Šè¿°ä»£ç ä¿å­˜åˆ°ä¸€ä¸ªæ–‡ä»¶ï¼Œä¾‹å¦‚ test_traces.shã€‚ èµ‹äºˆæ‰§è¡Œæƒé™ï¼š åœ¨ç»ˆç«¯ä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œä¸ºè„šæœ¬æ·»åŠ æ‰§è¡Œæƒé™ï¼šchmod +x test_traces.sh è¿™ä¸€æ­¥æ˜¯å¿…é¡»çš„ï¼Œå› ä¸ºåœ¨ Linux/Unix ç³»ç»Ÿä¸­ï¼Œè„šæœ¬é»˜è®¤æ²¡æœ‰æ‰§è¡Œæƒé™ï¼Œéœ€è¦æ‰‹åŠ¨èµ‹äºˆã€‚ è¿è¡Œè„šæœ¬ï¼š ä½¿ç”¨ä»¥ä¸‹æ ¼å¼è¿è¡Œè„šæœ¬ï¼š./test_traces.sh lower upper lowerï¼šèµ·å§‹çš„ trace æ–‡ä»¶ç¼–å·ï¼ˆ1-16ï¼‰ã€‚ upperï¼šç»“æŸçš„ trace æ–‡ä»¶ç¼–å·ï¼ˆ1-16ï¼‰ã€‚ ç¤ºä¾‹ï¼š./test_traces.sh 1 5 è¿™å°†æµ‹è¯• trace01.txt åˆ° trace05.txtï¼Œå¹¶å°†ç»“æœåˆ†åˆ«ä¿å­˜åˆ° _tshref_output.txt å’Œ _tsh_output.txtã€‚ æ£€æŸ¥è¾“å‡ºï¼š æµ‹è¯•å®Œæˆåï¼Œæ¯”è¾ƒ _tshref_output.txtï¼ˆå‚è€ƒå®ç°ç»“æœï¼‰å’Œ _tsh_output.txtï¼ˆå­¦ç”Ÿå®ç°ç»“æœï¼‰ã€‚ ç”¨å„ç§ç¼–è¾‘å™¨è‡ªå¸¦çš„æ¯”è¾ƒæ–‡ä»¶åŠŸèƒ½å°±èƒ½å¾ˆæ–¹ä¾¿çš„æ¯”è¾ƒè¾“å‡ºå¼‚åŒã€‚ æ³¨æ„äº‹é¡¹ ç¯å¢ƒè¦æ±‚ï¼šç¡®ä¿å½“å‰ç›®å½•ä¸‹æœ‰ sdriver.plã€tshrefã€tsh ä»¥åŠå¯¹åº”çš„ traceXX.txt æ–‡ä»¶ï¼Œå¦åˆ™è„šæœ¬ä¼šæŠ¥é”™ã€‚ è¦†ç›–è¾“å‡ºï¼šæ¯æ¬¡è¿è¡Œè„šæœ¬æ—¶ï¼Œè¾“å‡ºæ–‡ä»¶ï¼ˆ_tshref_output.txt å’Œ _tsh_output.txtï¼‰ä¼šè¢«æ¸…ç©ºå¹¶é‡æ–°ç”Ÿæˆã€‚","categories":[{"name":"å…¬å¼€è¯¾","slug":"å…¬å¼€è¯¾","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/"},{"name":"CMU-15-213","slug":"å…¬å¼€è¯¾/CMU-15-213","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/CMU-15-213/"},{"name":"Labs","slug":"å…¬å¼€è¯¾/CMU-15-213/Labs","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/CMU-15-213/Labs/"}],"tags":[]},{"title":"ç¬¬å…«ç« â€”â€”å¼‚å¸¸æ§åˆ¶æµ","slug":"learning/open-course/CMU-15-213/Notes/Chapter8-exception-control-flow","date":"2025-03-31T03:26:01.000Z","updated":"2025-08-22T03:14:43.982Z","comments":true,"path":"wiki/learning/open-course/CMU-15-213/Notes/Chapter8-exception-control-flow/","permalink":"http://rinevard.github.io/wiki/learning/open-course/CMU-15-213/Notes/Chapter8-exception-control-flow/","excerpt":"","text":"img{ width: 70%; } å½“æˆ‘ä»¬åœ¨ç¨‹åºæ‰§è¡Œæ—¶æŒ‰ä¸‹ ctrl+c ï¼Œç©¶ç«Ÿå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿä¸ºè§£ç­”è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¼•å…¥å¼‚å¸¸æ§åˆ¶æµï¼ˆexceptional control flowï¼ŒECFï¼‰çš„æ¦‚å¿µã€‚å¼‚å¸¸æ§åˆ¶æµå…è®¸æˆ‘ä»¬å°†æ§åˆ¶è½¬ç§»åˆ°å…¶ä»–ç¨‹åºï¼Œä»è€Œå®ç°ä¸€äº›ç¥å¥‡çš„æ•ˆæœï¼Œæ¯”å¦‚ä¸­æ–­ç¨‹åºã€ä¸Šä¸‹æ–‡åˆ‡æ¢ã€è°ƒç”¨ç³»ç»Ÿå‡½æ•°ã€‚ å¼‚å¸¸å¼‚å¸¸æ˜¯å¼‚å¸¸æ§åˆ¶æµçš„ä¸€ç§å½¢å¼ï¼Œåˆ†ä¸ºå››ç±»ï¼š ç±»åˆ« å¼‚æ­¥/åŒæ­¥ äº§ç”ŸåŸå›  ä¾‹å­ ä¸­æ–­ï¼ˆinterruptï¼‰ å¼‚æ­¥ å¤–éƒ¨äº‹ä»¶ å¤–éƒ¨æ—¶é’Ÿï¼ˆtimer interruptï¼‰ é™·é˜±ï¼ˆtrapï¼‰ åŒæ­¥ æ‰§è¡Œå†…éƒ¨æŒ‡ä»¤ ç³»ç»Ÿè°ƒç”¨ï¼ˆsystem callsï¼‰ æ•…éšœï¼ˆfaultï¼‰ åŒæ­¥ æ‰§è¡Œå†…éƒ¨æŒ‡ä»¤ é™¤ä»¥é›¶ ç»ˆæ­¢ï¼ˆabortï¼‰ åŒæ­¥ æ‰§è¡Œå†…éƒ¨æŒ‡ä»¤ ç¡¬ä»¶é”™è¯¯ æ³¨æ„ï¼šä¸€å®šè¦æ£€æŸ¥ç³»ç»Ÿè°ƒç”¨çš„è¿”å›å€¼ï¼Œä¸ç„¶ä¼šå‡ºç°ä¸€äº›å¾ˆéš¾è°ƒè¯•çš„é”™è¯¯ï¼ å¼‚å¸¸å‘ç”Ÿåï¼Œæ§åˆ¶ä¼šè½¬ç§»ç»™å¼‚å¸¸å¤„ç†ç¨‹åºã€‚åœ¨å¤„ç†å®Œæˆåï¼Œæ ¹æ®å¼‚å¸¸çš„å…·ä½“å†…å®¹å¯èƒ½ä¼šè¿”å›åˆ°åŸç¨‹åºçš„ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼Œä¹Ÿå¯èƒ½è¿”å›åˆ°åŸç¨‹åºçš„å½“å‰æŒ‡ä»¤ï¼Œä¹Ÿå¯èƒ½ä¸è¿”å›ã€‚ï¼š è¿›ç¨‹å¹¶å‘å’Œä¸Šä¸‹æ–‡åˆ‡æ¢æˆ‘ä»¬å¯ä»¥å¹¶å‘åœ°æ‰§è¡Œå¤šä¸ªè¿›ç¨‹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ä½†æˆ‘ä»¬æ˜¯æ€ä¹ˆå®ç°è¿™ç§å¹¶å‘çš„å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚ä¸‹å›¾å±•ç°äº†å•æ ¸ CPU çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±çš„ä¸Šä¸‹æ–‡ã€‚ ä¸Šä¸‹æ–‡åˆ‡æ¢çš„åŸå› å¤šç§å¤šæ ·ï¼Œä¸¾ä¸¤ä¸ªå¸¸è§ä¾‹å­ï¼šç”¨æˆ·å¯èƒ½æ‰§è¡Œç³»ç»Ÿè°ƒç”¨è€Œç­‰å¾…æŸä¸ªäº‹ä»¶ï¼ˆæ¯”å¦‚ç”¨ waitpid ç­‰å¾…å­è¿›ç¨‹ç»ˆæ­¢ï¼‰ï¼Œè¿™æ—¶å†…æ ¸å°±å¯ä»¥è®©å½“å‰è¿›ç¨‹ä¼‘çœ å¹¶åˆ‡æ¢åˆ°å¦ä¸€ä¸ªè¿›ç¨‹ï¼›ç³»ç»Ÿæ¯éš”è‹¥å¹²æ¯«ç§’ä¹Ÿä¼šäº§ç”Ÿä¸€æ¬¡å®šæ—¶å™¨ä¸­æ–­çš„å¼‚å¸¸ï¼Œå¹¶åˆ‡æ¢åˆ°æ–°çš„è¿›ç¨‹ã€‚ è¿›ç¨‹çš„åˆ›å»ºã€ç»ˆæ­¢å’Œå›æ”¶æˆ‘ä»¬å¯ä»¥ç”¨ fork æ¥åˆ›å»ºä¸€ä¸ªå½“å‰è¿›ç¨‹çš„å¤åˆ¶â€”â€”å®ƒæ‰§è¡Œä¸€æ¬¡ï¼Œè¿”å›ä¸¤æ¬¡ï¼Œåˆ†åˆ«è¿”å›åˆ°çˆ¶è¿›ç¨‹å’Œçˆ¶è¿›ç¨‹çš„å­è¿›ç¨‹ä¸­ã€‚å¯¹çˆ¶è¿›ç¨‹ï¼Œå®ƒè¿”å›å­è¿›ç¨‹çš„ pidï¼›å¯¹å­è¿›ç¨‹ï¼Œå®ƒè¿”å› 0. å­è¿›ç¨‹åœ¨ç»ˆæ­¢åä¸ä¼šè‡ªåŠ¨è¢«æ¸…æ¥šï¼Œè€Œæ˜¯è¿›å…¥â€œåƒµæ­»è¿›ç¨‹â€çŠ¶æ€ï¼Œç›´åˆ°è¢«çˆ¶è¿›ç¨‹å›æ”¶ã€‚å¦‚æœçˆ¶è¿›ç¨‹ç»ˆæ­¢äº†ï¼Œinit è¿›ç¨‹ä¼šæˆä¸ºå®ƒçš„å­¤å„¿è¿›ç¨‹çš„å…»çˆ¶ã€‚å¾ˆæ˜æ˜¾ï¼Œè¿™é‡Œæœ‰æ½œåœ¨çš„å†…å­˜æ³„æ¼ã€‚é‚£ä¹ˆï¼Œæ€ä¹ˆå›æ”¶å­è¿›ç¨‹å‘¢ï¼Ÿ æˆ‘ä»¬å¯ä»¥ç”¨ waitpid æ¥ç­‰å¾…å­è¿›ç¨‹ç»ˆæ­¢ï¼Œåœ¨ waitpid è¿”å›åï¼Œè¿™ä¸ªç»ˆæ­¢çš„å­è¿›ç¨‹ä¼šè¢«å›æ”¶ã€‚ æˆ‘ä»¬å¯ä»¥ç”¨ execve æ¥åŠ è½½å¹¶è¿è¡Œç¨‹åºã€‚execve å‡½æ•°åœ¨å½“å‰è¿›ç¨‹çš„ä¸Šä¸‹æ–‡ä¸­åŠ è½½å¹¶è¿è¡Œä¸€ä¸ªæ–°ç¨‹åºï¼Œåªæœ‰åœ¨å‡ºç°é”™è¯¯æ—¶ï¼Œå®ƒæ‰ä¼šè¿”å›åˆ°è°ƒç”¨ç¨‹åºã€‚æ³¨æ„ï¼Œå®ƒå¹¶æ²¡æœ‰åˆ›å»ºä¸€ä¸ªæ–°è¿›ç¨‹ï¼Œè€Œæ˜¯åœ¨å½“å‰è¿›ç¨‹çš„ä¸Šä¸‹æ–‡ä¸­åŠ è½½å¹¶è¿è¡Œæ–°ç¨‹åºã€‚ æ¥çœ‹ä¸€ä¸ªç»¼åˆè¿ç”¨ä¸Šé¢çš„ä¸œè¥¿çš„ä¾‹å­å§ï¼š #include &lt;stdio.h> #include &lt;stdlib.h> #include &lt;unistd.h> #include &lt;sys/wait.h> int main() &#123; pid_t pid; pid = fork(); if (pid &lt; 0) &#123; perror(\"fork failed\"); exit(1); &#125; else if (pid == 0) &#123; // å­è¿›ç¨‹ printf(\"Child process (PID: %d) running...\\n\", getpid()); // ä½¿ç”¨ execve åŠ è½½å¹¶è¿è¡Œ \"ls\" ç¨‹åº char *argv[] = &#123;\"/bin/ls\", NULL&#125;; // å‚æ•°åˆ—è¡¨ char *envp[] = &#123;NULL&#125;; // ç¯å¢ƒå˜é‡åˆ—è¡¨ execve(\"/bin/ls\", argv, envp); // å¦‚æœ execve è¿”å›ï¼Œè¯´æ˜æ‰§è¡Œå¤±è´¥ perror(\"execve failed\"); exit(1); &#125; else &#123; // çˆ¶è¿›ç¨‹ printf(\"Parent process (PID: %d), waiting for child (PID: %d)...\\n\", getpid(), pid); // ä½¿ç”¨ waitpid ç­‰å¾…å­è¿›ç¨‹ç»ˆæ­¢å¹¶å›æ”¶ int status; waitpid(pid, &amp;status, 0); // é˜»å¡ç­‰å¾…å­è¿›ç¨‹ pid ç»“æŸ if (WIFEXITED(status)) &#123; printf(\"Child exited with status %d\\n\", WEXITSTATUS(status)); &#125; &#125; return 0; &#125; ä¿¡å·ä¿¡å·å…è®¸å†…æ ¸å¼‚æ­¥é€šçŸ¥ç›®æ ‡è¿›ç¨‹å‘ç”Ÿäº†ç‰¹å®šäº‹ä»¶ã€‚ å‘é€å’Œæ¥æ”¶ä¿¡å·å‘é€ä¿¡å·ä¿¡å·å¯ä»¥ç”±å†…æ ¸è‡ªåŠ¨ç”Ÿæˆï¼Œä¾‹å¦‚ï¼š å½“æŸä¸ªå­è¿›ç¨‹çš„çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶ï¼ˆæ¯”å¦‚ç»ˆæ­¢ã€æš‚åœã€æ¢å¤ï¼‰ï¼Œå†…æ ¸ä¼šå‘é€ä¸€ä¸ª SIGCHLD ä¿¡å·ç»™çˆ¶è¿›ç¨‹ï¼› å½“æŸä¸ªè¿›ç¨‹å°è¯•é™¤ä»¥ 0 æ—¶ï¼Œå†…æ ¸ä¼šå‘é€ä¸€ä¸ª SIGFPE ä¿¡å·ç»™è¯¥è¿›ç¨‹ã€‚æ­¤å¤–ï¼Œè¿›ç¨‹ä¹Ÿå¯ä»¥é€šè¿‡ kill å‡½æ•°æ‰‹åŠ¨è¯·æ±‚å†…æ ¸å‘å…¶ä»–è¿›ç¨‹å‘é€ä¿¡å·ã€‚ æ¥æ”¶ä¿¡å·å½“å†…æ ¸å°†ä¿¡å·ä¼ é€’ç»™ç›®æ ‡è¿›ç¨‹ï¼Œå¹¶è¿«ä½¿è¿›ç¨‹å¯¹æ­¤ä¿¡å·é‡‡å–è¡ŒåŠ¨ï¼ˆä¾‹å¦‚æ‰§è¡Œä¿¡å·å¤„ç†ç¨‹åºæˆ–é»˜è®¤è¡Œä¸ºï¼‰æ—¶ï¼Œè¿›ç¨‹å°±æ¥æ”¶äº†è¯¥ä¿¡å·ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœä¿¡å·è¢«é˜»å¡æˆ–æš‚æ—¶æœªå¤„ç†ï¼Œå®ƒä¸ä¼šè¢«è§†ä¸ºâ€œå·²æ¥æ”¶â€ï¼Œè€Œæ˜¯è¿›å…¥å¾…å¤„ç†çŠ¶æ€ã€‚ æˆ‘ä»¬èƒ½ç”¨ signal å‡½æ•°ä¿®æ”¹æ¥æ”¶ä¿¡å·åçš„è¡Œä¸ºã€‚ æœªæ¥æ”¶çš„ä¿¡å·ä¼šæ€æ ·ï¼Ÿå¦‚æœä¿¡å·å‘å‡ºåæœªè¢«ç«‹å³æ¥æ”¶ï¼Œå®ƒä¼šå˜æˆä¸€ä¸ªå¾…å¤„ç†ä¿¡å·ã€‚å†…æ ¸ä¸ºæ¯ä¸ªè¿›ç¨‹ç»´æŠ¤ä¸€ä¸ªè¡¨ç¤ºå¾…å¤„ç†ä¿¡å·çš„ä½å‘é‡ï¼ˆpending signal bit vectorï¼‰ï¼Œç”¨ä»¥è¿½è¸ªæœ‰å“ªäº›ä¿¡å·å°šæœªå¤„ç†ã€‚ç”±äºä¿¡å·ä¸æ’é˜Ÿï¼ŒåŒä¸€æ—¶åˆ»åŒä¸€ç±»å‹çš„å¾…å¤„ç†ä¿¡å·æœ€å¤šåªæœ‰ä¸€ä¸ªï¼ˆå³ä½å‘é‡ä¸­è¯¥ä½è¢«ç½®ä¸º 1ï¼‰ã€‚å¦‚æœæŸä¸ªç±»å‹å·²ç»æœ‰äº†å¾…å¤„ç†ä¿¡å·ï¼Œè¢«å‘é€è¿‡æ¥çš„åŒç±»ä¿¡å·ä¼šè¢«ç®€å•åœ°ä¸¢å¼ƒã€‚æ­¤å¤–ï¼Œå†…æ ¸è¿˜ä¸ºæ¯ä¸ªè¿›ç¨‹ç»´æŠ¤ä¸€ä¸ªè¡¨ç¤ºè¢«é˜»å¡ä¿¡å·çš„ä½å‘é‡ï¼ˆblocked signal bit vectorï¼‰ï¼Œç”¨æ¥è®°å½•å½“å‰è¢«å±è”½ã€ä¸å…è®¸ä¼ é€’çš„ä¿¡å·ã€‚ å¼‚æ­¥çš„é£é™©ä¸‹é¢çš„ä¾‹å­å¾ˆå¥½åœ°è¯´æ˜äº†å¼‚æ­¥çš„é£é™© #include \"csapp.h\" volatile sig_atomic_t pid; void sigchld_handler(int s) &#123; int olderrno = errno; pid = waitpid(-1, NULL, 0); // åœ¨å­è¿›ç¨‹ç»ˆæ­¢åæ›´æ–°pid errno = olderrno; &#125; void sigint_handler(int s) &#123; &#125; int main(int argc, char **argv) &#123; sigset_t mask, prev; Signal(SIGCHLD, sigchld_handler); // åœ¨å­è¿›ç¨‹ç»ˆæ­¢åæ›´æ–°pid Signal(SIGINT, sigint_handler); Sigemptyset(&amp;mask); Sigaddset(&amp;mask, SIGCHLD); while (1) &#123; Sigprocmask(SIG_BLOCK, &amp;mask, &amp;prev); /* Block SIGCHLD */ if (Fork() == 0) &#123; /* Child */ exit(0); &#125; /* Parent */ pid = 0; // æˆ‘ä»¬ block ä¿¡å·ï¼Œè¿™æ ·å³ä½¿å­è¿›ç¨‹åœ¨è¿™æ¡è¯­å¥å‰ç»ˆæ­¢ï¼Œpidä¹Ÿèƒ½æ­£ç¡®æ›´æ–° Sigprocmask(SIG_SETMASK, &amp;prev, NULL); /* Unblock SIGCHLD */ /* Wait for SIGCHLD to be received (wasteful) */ while (!pid) &#123; pause(); // æ½œåœ¨çš„ç«äº‰ï¼ &#125; /* Do some work after receiving SIGCHLD */ printf(\".\"); &#125; exit(0); &#125; å…ˆæ¥çœ‹çœ‹ä¸‹é¢çš„å±€éƒ¨ä»£ç ï¼š Sigprocmask(SIG_BLOCK, &amp;mask, &amp;prev); /* Block SIGCHLD */ if (Fork() == 0) &#123; /* Child */ exit(0); &#125; /* Parent */ pid = 0; // æˆ‘ä»¬ block ä¿¡å·ï¼Œè¿™æ ·å³ä½¿å­è¿›ç¨‹åœ¨è¿™æ¡è¯­å¥å‰ç»ˆæ­¢ï¼Œpidä¹Ÿèƒ½æ­£ç¡®æ›´æ–° Sigprocmask(SIG_SETMASK, &amp;prev, NULL); /* Unblock SIGCHLD */ å¦‚æœä¸ä½¿ç”¨ blockï¼Œè€Œå­è¿›ç¨‹åœ¨ pid=0 è¿™æ¡è¯­å¥å‰ç»ˆæ­¢ï¼Œé‚£ä¹ˆä¿¡å·å¤„ç†ç¨‹åºä¼šå…ˆæŠŠ pid è®¾ç½®ä¸ºå­è¿›ç¨‹ pidï¼Œç„¶å pid è¢«é‡ç½®ä¸º 0ï¼Œå¯¼è‡´æˆ‘ä»¬æ²¡èƒ½æ­£ç¡®è®°å½• pidã€‚è¿™å°±æ˜¯é˜»å¡ä¿¡å·çš„é‡è¦æ€§ã€‚ å†æ¥çœ‹çœ‹è¿™é‡Œï¼š while (!pid) &#123; pause(); // æ½œåœ¨çš„ç«äº‰ï¼ &#125; æˆ‘ä»¬çš„åŸæ„æ˜¯åœ¨æ²¡æœ‰æ¥æ”¶åˆ°ä¿¡å·æ—¶æš‚åœï¼Œä»¥é¿å…ç©ºå¾ªç¯æµªè´¹å¤„ç†å™¨èµ„æºã€‚å…·ä½“æ¥è¯´ï¼Œåœ¨æ”¶åˆ°å­è¿›ç¨‹ç»ˆæ­¢çš„ä¿¡å·å pause çŠ¶æ€ä¼šç»“æŸï¼Œç„¶åæ‰§è¡Œä¿¡å·å¤„ç†ä»£ç ï¼Œç„¶åè¿›å…¥ä¸‹ä¸€ä¸ªå¾ªç¯ã€‚ ä½†è¿™ä¸ª pause å¸¦æ¥äº†æ½œåœ¨çš„ç«äº‰ã€‚æ¯”å¦‚è¯´ï¼Œå¦‚æœåœ¨ while æµ‹è¯•åå’Œ pause å‰æ”¶åˆ°ä¿¡å·ï¼Œä¹‹ååˆæ²¡æœ‰åˆ«çš„ä¿¡å·ï¼Œpause å°±ä¼šè¿›å…¥æ°¸ä¹…ç¡çœ ã€‚è¿™å°±æ˜¯ç«äº‰çš„é£é™©ã€‚ å¯¹è¿™ä¸ªä¾‹å­ï¼Œè§£å†³åŠæ³•æ˜¯ç”¨ sigsuspend æ›¿æ¢ pauseï¼Œæˆ‘ä»¬ä¸å¤šè¯´äº†ã€‚","categories":[{"name":"å…¬å¼€è¯¾","slug":"å…¬å¼€è¯¾","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/"},{"name":"CMU-15-213","slug":"å…¬å¼€è¯¾/CMU-15-213","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/CMU-15-213/"},{"name":"Notes","slug":"å…¬å¼€è¯¾/CMU-15-213/Notes","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/CMU-15-213/Notes/"}],"tags":[]},{"title":"Cachelabç†è®ºåˆ†æ","slug":"learning/open-course/CMU-15-213/Labs/Cachelab","date":"2025-03-26T10:37:28.000Z","updated":"2025-08-22T03:14:43.981Z","comments":true,"path":"wiki/learning/open-course/CMU-15-213/Labs/Cachelab/","permalink":"http://rinevard.github.io/wiki/learning/open-course/CMU-15-213/Labs/Cachelab/","excerpt":"","text":"img{ width: 60%; } å…ˆæ”¾ä¸€ä¸ªæœ€ç»ˆç»“æœåœ¨è¿™é‡Œ Part A æ¨¡æ‹Ÿ cacheç”¨æ—¶ 3h. ä¸€å¼€å§‹å› ä¸º 16 è¿›åˆ¶è¸©äº†å‘ã€‚æˆ‘ç¬¬ä¸€ä¸ªçœ‹çš„ trace æ–‡ä»¶æ˜¯ yi.traceï¼Œæˆ‘æŠŠé‡Œé¢çš„åœ°å€å½“æˆäº†åè¿›åˆ¶ï¼Œåˆ†æäº†åŠå¤©æ€»æ„Ÿè§‰ä¸å¯¹ï¼Œåæ¥æƒŠé†’è¿™æ˜¯åå…­è¿›åˆ¶ã€‚ part A ä¸éš¾ï¼Œæ­£å¸¸æ¨¡æ‹Ÿä¸€éå°±å¥½ã€‚ç”±äº handout é‡Œè¯´ï¼Œâ€œyou should assume that memory accesses are aligned properly, such that a single memory access never crosses block boundariesâ€ï¼Œæ‰€ä»¥å¯¹æ¯è¡Œè®°å½•ï¼Œæˆ‘ä»¬åªè¦è€ƒè™‘å…¶æŒ‡ä»¤ç±»å‹å’Œåœ°å€å³å¯ï¼Œä¸å¿…è€ƒè™‘æ“ä½œå¤§å°ã€‚æˆ‘ä½¿ç”¨äº†è¿™æ ·çš„æ•°æ®ç»“æ„ï¼š typedef struct &#123; int valid; unsigned long lineTag; int lruCount; // è®°å½•ä¸Šä¸€æ¬¡è®¿é—®åˆ°ç°åœ¨çš„æ—¶é—´ &#125; CacheLine; typedef struct &#123; CacheLine *lines; &#125; CacheSet; CacheSet *sets = malloc((1 &lt;&lt; s)* sizeof(CacheSet)); åœ¨æ ¸å¿ƒå¾ªç¯é‡Œï¼Œå¯¹æŸä¸ªç»™å®šçš„ setï¼Œæˆ‘ä»¬åœ¨éå†è¿‡ç¨‹ä¸­ä»å‰å¾€åå¡«å……æ¯ä¸ª set çš„ lineï¼Œæ€è·¯å¦‚ä¸‹ï¼š å¯¹æ¯ä¸ªåœ°å€ï¼Œç”¨ä½è¿ç®—å¾—åˆ°å…¶ setIdx å’Œ tagï¼Œç„¶åæ‰¾åˆ°å¯¹åº”çš„ setï¼Œéå†é‡Œé¢çš„æ‰€æœ‰ line. å¦‚æœæ‰¾åˆ°äº†ç©º lineï¼Œç›´æ¥å¡«å……è¿›å»ï¼›å¦‚æœæ‰¾åˆ°äº†å¯¹åº”çš„ tagï¼Œå°± hit äº†ï¼›å¦‚æœæ²¡æ‰¾åˆ°å¯¹åº” tagï¼Œè¯´æ˜éœ€è¦é©±é€æŸä¸ª lineï¼Œæ‰¾åˆ° lru æœ€å¤§çš„ lineï¼ˆå³æœ€ä¹…æ²¡æœ‰è®¿é—®è¿‡çš„ lineï¼‰å¹¶æŠŠå®ƒæ¢æ‰å³å¯ã€‚ æ³¨æ„æ­£ç¡®æ›´æ–°éå†çš„ set é‡Œçš„æ¯ä¸ª line çš„ lruCount. ç”¨ä¸‹é¢çš„ä½è¿ç®—å°±èƒ½å¾—åˆ° setIdx å’Œ tagï¼š unsigned long mask = -1; mask = ~(mask &lt;&lt; s); // 000...11 (s ä¸ª 1) unsigned long setIdx = (address >> b) &amp; mask; unsigned long tag = address >> (b + s); è¿˜æœ‰ä¸€ä¸ªå° trick æ˜¯å¯ä»¥ç”¨è¿™æ ·çš„å†™æ³•æ¥ç®€åŒ–ä»£ç ï¼Œæ¯•ç«Ÿæˆ‘ä»¬å¹¶ä¸å…³å¿ƒæ“ä½œåœ¨ç±»å‹ä¸Šçš„å·®å¼‚ï¼Œåªå…³å¿ƒæ“ä½œçš„åœ°å€ï¼š switch (operation) &#123; case 'M': // M = L + S, å…¶ 'S' æ€»ä¼šå‘½ä¸­ hits++; // fall through case 'L': // fall through case 'S': // çœŸæ­£çš„å·¥ä½œ &#125; Part Bç”¨æ—¶ 7 hï¼Œæ‹¼å°½å…¨åŠ›ä¹Ÿåªèƒ½æŠŠ 64x64 æ‹¿åˆ° 1411 missï¼Œä¸Šç½‘æ‰¾äº†æ‰¾åˆ«äººçš„æ€è·¯ï¼Œæœ€åå¾—åˆ°äº† 1179 miss. æœ€åç»“æœå¦‚ä¸‹ï¼š Points Max pts MissesTrans perf 32x32 8.0 8 287Trans perf 64x64 8.0 8 1179Trans perf 61x67 10.0 10 1997 æˆ‘å‚è€ƒçš„æ–‡ç« æ˜¯è¿™ç¯‡ï¼š CSAPP - Cache Lab çš„æ›´(æœ€)ä¼˜ç§€çš„è§£æ³• - çŸ¥ä¹ï¼Œä½œè€…ç›´æ¥æ‹¿åˆ°äº† 64x64 çš„ç†è®ºæœ€ä¼˜è§£ï¼Œéå¸¸å¼ºå¤§ã€‚ä¸è¿‡æˆ‘æ²¡æœ‰åœ¨å¯¹è§’çº¿ä¸Šåšå¾®è°ƒï¼Œè€Œæ˜¯åªå‚è€ƒäº†ä½œè€…å¯¹ä¸€èˆ¬å—çš„è¯»å†™é¡ºåºã€‚ æˆ‘çš„ä¸‰ä¸ªè½¬ç½®éƒ½æ²¡æœ‰ç‰¹åˆ«è€ƒè™‘å¯¹è§’çº¿çš„æƒ…å†µã€‚ä¸€æ–¹é¢æ˜¯å› ä¸ºå«Œéº»çƒ¦ï¼Œå¦ä¸€æ–¹é¢æ˜¯å› ä¸ºæˆ‘è§‰å¾—è¿™ç§â€œä¸¤ä¸ªå†…å­˜å—ä½ç½®æ°å¥½å·® 2 çš„å¹‚æ¬¡å¯¼è‡´ç¼“å­˜æŠ–åŠ¨â€çš„äº‹æƒ…å¤ªç‰¹æ®Šï¼Œæ‰€ä»¥æ²¡é¢å¤–å¤„ç†ã€‚ åˆ†å—å¤§å°çš„ç¡®å®šé¦–å…ˆï¼Œåˆ†å—ä¼˜åŒ–æ˜¯ä¸€å®šè¦åšçš„ã€‚ä½†åˆ†æˆå¤šå¤§çš„å—å‘¢ï¼Ÿæœ€æœ´ç´ çš„æƒ³æ³•æ˜¯ï¼Œæˆ‘ä»¬å¸Œæœ›å—å°½å¯èƒ½å¤§æ¥è£…æ»¡ cacheï¼Œä½†ä¸è¦å¤ªå¤§ä»¥è‡³äº cache è£…ä¸ä¸‹ã€‚ æˆ‘ä»¬æœ‰ $2^5 = 32$ ä¸ª setsï¼Œæ¯ä¸ª set ä¸€ä¸ª lineï¼Œæ¯ä¸ª line å­˜ 8 ä¸ª intï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬æœ€å¤šèƒ½å­˜ $32 \\times 8 = 256 = 2^8$ ä¸ª int. æˆ‘ä»¬å¸Œæœ›åŒæ—¶æŠŠ A çš„å—å’Œ B çš„å—æ”¾åˆ° cache ä¸­ï¼Œä¸¤ä¸ªå—å¤§å°åº”å½“ç›¸åŒï¼Œæ‰€ä»¥æ¯ä¸ªå—å¯ä»¥æ”¾ $256/2 = 128$ ä¸ª int. 128 ä¸æ˜¯å®Œå…¨å¹³æ–¹æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ†å—æˆ 8x8. åˆç‰ˆä»£ç å›åˆ°ä¹‹å‰çš„ 8x8 åˆ†å—çš„è®¨è®ºä¸Šæ¥ã€‚æ€»ä¹‹ï¼Œæˆ‘å†™å‡ºäº†æˆ‘çš„åˆç‰ˆä»£ç ã€‚æ€è·¯å°±æ˜¯åˆ†å—ï¼Œç„¶åæŠŠ A çš„å—å­˜åˆ° tmp æ•°ç»„é‡Œï¼Œç„¶åå¤åˆ¶åˆ° B é‡Œã€‚ä¸ºä»€ä¹ˆè¦ç”¨ tmp åšä¸­è½¬å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ä¸ºäº†é¿å…ç¼“å­˜å†²çªï¼š void transpose_submit(int M, int N, int A[N][M], int B[M][N]) &#123; int blockSize = 8; int rowBlock, colBlock, i, j; // å‘ä¸Šå–æ•´, è®¡ç®—å‡ºæ€» block æ•°. // å¯èƒ½ä¼šå«æœ‰ä¸æ˜¯æ­£æ–¹å½¢çš„ block int rowBlocks = (N + blockSize - 1) / blockSize; int colBlocks = (M + blockSize - 1) / blockSize; int tmp[blockSize][blockSize]; // cachelabä¸å…è®¸å¼€æ•°ç»„ for (rowBlock = 0; rowBlock &lt; rowBlocks; rowBlock++) &#123; for (colBlock = 0; colBlock &lt; colBlocks; colBlock++) &#123; for (i = rowBlock * blockSize; i &lt; (rowBlock + 1) * blockSize &amp;&amp; i &lt; N; i++) &#123; for (j = colBlock * blockSize; j &lt; (colBlock + 1) * blockSize &amp;&amp; j &lt; M; j++) &#123; tmp[j - colBlock * blockSize][i - rowBlock * blockSize] = A[i][j]; &#125; &#125; for (j = colBlock * blockSize; j &lt; (colBlock + 1) * blockSize &amp;&amp; j &lt; M; j++) &#123; for (i = rowBlock * blockSize; i &lt; (rowBlock + 1) * blockSize &amp;&amp; i &lt; N; i++) &#123; B[j][i] = tmp[j - colBlock * blockSize][i - rowBlock * blockSize]; &#125; &#125; &#125; &#125; &#125; ç»“æœå¾ˆä¸é”™ï¼š Cache Lab summary:Points Max pts MissesTrans perf 32x32 8.0 8 261Trans perf 64x64 8.0 8 1029Trans perf 61x67 10.0 10 1725 æ­£å½“æˆ‘è§‰å¾— cachelab ä¸è¿‡å¦‚æ­¤çš„æ—¶å€™ï¼Œå¿½ç„¶å‘ç° handout é‡Œå†™äº†ä¸å…è®¸å¼€æ•°ç»„ï¼ˆå“ˆå“ˆï¼Œä½ æƒ³å¾—åˆ°çš„ cmu è€å¸ˆæƒ³ä¸åˆ°å—ï¼‰ï¼Œäºæ˜¯è¢«è¿«æ‰‹åŠ¨å±•å¼€äº† j å¾ªç¯ï¼Œä½¿ç”¨ 8 ä¸ªå˜é‡æ¥è¯»å–æ¯è¡Œçš„å€¼ã€‚è¿™å°±å¾—åˆ°äº†ä¸‹é¢çš„ç»“æœï¼š Cache Lab summary:Points Max pts MissesTrans perf 32x32 8.0 8 287Trans perf 64x64 0.0 8 4611Trans perf 61x67 10.0 10 1997 ä¹Ÿè¿˜ç®—ä¸é”™å§ï¼Œæ¯•ç«Ÿ 32x32 å’Œ 61x67 éƒ½æ»¡åˆ†äº†ã€‚å”¯ä¸€çš„é—®é¢˜æ˜¯ 64x64 çš„æ€§èƒ½å¥‡å·®æ— æ¯”ã€‚ åˆ†æ 64x64 çŸ©é˜µçš„ miss æ¬¡æ•°è¿™æ—¶å€™å°±è¦ç†è®ºåˆ†æäº†ã€‚å¯¹ 64x64 çš„çŸ©é˜µï¼ŒæŒ‰æˆ‘ä»¬ä¹‹å‰çš„åšæ³•ï¼Œæ¯ä¸ª 8x8 çš„å—å¤§çº¦å‘ç”Ÿäº†å¤šå°‘æ¬¡ miss å‘¢ï¼Ÿ ç­”æ¡ˆæ˜¯ 72 æ¬¡ã€‚A æä¾›äº† 8 æ¬¡ missï¼ŒB æä¾›äº† 64 æ¬¡ miss éªŒè¯ä¸€ä¸‹ç»“æœå¯¹ä¸å¯¹ï¼š64x64 çš„çŸ©é˜µå…±æœ‰ 64 ä¸ª 8x8 çš„å—ï¼Œ64 ä¸ªå—æ¯ä¸ªå— 72 æ¬¡ missï¼Œæ€»è®¡çº¦ $64 \\times 72=4608$ æ¬¡ missï¼Œå’Œç»“æœ 4611 æ¬¡ miss ç›¸å·®æ— å‡ ã€‚ è¿™ä¸ª miss æ˜¯æ€ä¹ˆç®—å‡ºæ¥çš„å‘¢ï¼Ÿè®©æˆ‘ä»¬çœ‹çœ‹ä¸‹å›¾ï¼š å¯¹ 64x64 çš„çŸ©é˜µæ¥è¯´ï¼ŒB[x][y] å’Œ B[x+4][y] çš„ setIdx ç›¸åŒï¼Œè¿™å°±å¯¼è‡´æˆ‘ä»¬ä¹‹å‰çš„æ–¹æ³•ä¸æ–­é©±é€æ—§ line. å®šé‡åœ°è¯´ï¼Œæ¯è¯» A çš„å—çš„ä¸€è¡Œï¼Œå¤§çº¦æ˜¯ 1 ä¸ª missï¼ŒA çš„å—å…±æœ‰ 8 è¡Œï¼Œæ‰€ä»¥ A çš„æ¯ä¸ªå—æä¾› 8 æ¬¡ missï¼›æ¯å¯¹ B çš„å—å†™å…¥ä¸€ä¸ªå€¼ï¼Œéƒ½é©±é€äº†ä¸€æ¬¡æ—§ lineï¼ˆå› ä¸º B[x+4][y] ä¼šé©±é€ B[x][y]ï¼‰ï¼Œæ‰€ä»¥ B çš„æ¯ä¸ªå—æä¾› 64 æ¬¡ miss. ä¹‹åçš„å·¥ä½œå°±æ˜¯æ‰¾åˆ°æ–¹æ³•æ¥é¿å…è¿™ç§é©±é€äº†ã€‚ å¯¹ 64x64 çŸ©é˜µçš„ç¬¬ä¸€æ¬¡ä¼˜åŒ–â€”â€”1699ä¸€å¼€å§‹æˆ‘çš„æ€è·¯æ˜¯ç›´æ¥ç”¨ 4x4 çš„å—ï¼Œè¿™ç¡®å®æœ‰ä¸å°ä¼˜åŒ–ï¼Œä½†ç¦»æ»¡åˆ†è¿˜å¾ˆè¿œã€‚è¯»è€…å¯ä»¥è¯•ç€åšä¸€ä¸ªç†è®ºåˆ†æçœ‹çœ‹ 4x4 çš„ç»“æœå¤§æ¦‚æ˜¯å¤šå°‘ missã€‚æˆ‘åˆ†æå‡ºæ¥ä¼šå¾—åˆ° 1536 ä¸ª missï¼Œå®é™…ç»“æœæ˜¯ 1699 ä¸ª missï¼Œä¹Ÿå·®ä¸å¤šå§ã€‚ å¥½å§ï¼Œè¿™ä¸ªç†è®ºåˆ†æçœ‹èµ·æ¥å€¼å¾—è¯¦ç»†è®²è§£ä¸€ä¸‹ã€‚ä¸è¿‡åœ¨å†™ä¹‹å‰ï¼Œå¸Œæœ›è¯»è€…è‡ªå·±åˆ†æä¸€ä¸‹ï¼Œçœ‹çœ‹å¾—åˆ°çš„ç»“æœæ˜¯ä¸æ˜¯ 2048ï¼Œå¹¶æƒ³æƒ³å“ªé‡Œå‡ºé”™äº†ï¼š å¦‚æœå—çš„å¤§å°æ˜¯ 4x4ï¼Œæ¯ä¸ªå—å‘ç”Ÿ 4 æ¬¡ missï¼Œæ¯ä¸ªçŸ©é˜µ 256 ä¸ªå—ï¼Œä¸€å…± 2048 æ¬¡ missï¼Œçœ‹èµ·æ¥å¾ˆåˆç†ã€‚ä½†è¿™æ˜¯ç†è®ºæœ€ä¼˜è§£ï¼Œä¸ºä»€ä¹ˆç†è®ºæœ€ä¼˜ï¼ˆ2048ï¼‰æ¯”å®é™…ç»“æœï¼ˆ1699ï¼‰è¿˜å·®å‘¢ï¼Ÿéš¾é“è¯´æ•°å­¦çš„å¤§å¦å´©å¡Œäº†ï¼Ÿ å¹¶éå¦‚æ­¤ã€‚äº‹å®ä¸Šï¼Œåœ¨æˆ‘ä»¬æŠŠæŸä¸ª 4x4 çš„å—æ”¾å…¥ cache æ—¶ï¼Œæˆ‘ä»¬ä¹ŸåŒæ—¶æŠŠå®ƒçš„å³è¾¹çš„é‚£ä¸ª 4x4 çš„å—æ”¾å…¥äº† cacheã€‚è¿™æ˜¯å› ä¸º cache çš„æ¯ä¸ª line èƒ½è£… 8 ä¸ª int. ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºæˆ‘ä»¬å®é™…ä¸Šæ˜¯åœ¨å¤„ç† 4x8 çš„å—ã€‚å¯¹æ¯ä¸ª 4x8 çš„å—ï¼ŒA æä¾›äº† 4 æ¬¡ missï¼ŒB æä¾›äº† 8 æ¬¡ missï¼Œæ€»è®¡ $64 4 + 64 8 = 1536$ æ¬¡ miss. å¯¹ 64x64 çŸ©é˜µçš„ç¬¬äºŒæ¬¡ä¼˜åŒ–â€”â€”1411åˆ†æäº†é‚£ä¹ˆå¤šï¼Œè¿˜æ˜¯æ²¡æ‹¿åˆ°æ»¡åˆ†ã€‚æˆ‘çš„åç»­æ€è·¯æ˜¯æŠŠ 8x8 çš„å—å†åˆ†æˆå››ä¸ªå°å—ï¼Œå¹¶æŒ‰ä¸‹é¢çš„é¡ºåºæ¥å†™å…¥ Bï¼š ç†è®ºåˆ†æä¸€ä¸‹ï¼ŒæŠŠ A1 å†™å…¥ B1 æ—¶ï¼ŒA miss 4 æ¬¡ï¼ŒB miss 4 æ¬¡ï¼› æŠŠ A2 å†™å…¥ B2 æ—¶ï¼ŒA miss 4 æ¬¡ï¼ŒB æ²¡æœ‰ missï¼ˆå› ä¸ºå†™å…¥ B1 æ—¶æŠŠ B2 æ”¾è¿›äº† cacheï¼‰ï¼› æŠŠ A3 å†™å…¥ B3 æ—¶ï¼ŒA æ²¡æœ‰ missï¼ŒB miss 4 æ¬¡ï¼›ï¼ˆå› ä¸ºè¯» A2 æ—¶æŠŠ A3 æ”¾å…¥äº† cacheï¼‰ï¼› æŠŠ A4 å†™å…¥ B4 æ—¶ï¼ŒA miss 4 æ¬¡ï¼ŒB æ²¡æœ‰ missï¼ˆå› ä¸ºå†™å…¥ B3 æ—¶æŠŠ B4 æ”¾è¿›äº† cacheï¼‰ æ€»è®¡ 20 æ¬¡ missï¼Œç†è®ºæœ€ä¼˜è§£ 1280ï¼Œå®é™…ç»“æœ 1411ï¼Œæˆ‘çŒœé—®é¢˜å‡ºåœ¨å¯¹è§’çº¿ä¸Šï¼Œæˆ‘ä¹Ÿæ‡’å¾—åœ¨è¿™ä¸ªåŸºç¡€ä¸Šç»§ç»­ä¼˜åŒ–äº†ã€‚ä¼˜åŒ–å¯¹è§’çº¿è¿™ç§äº‹æƒ…çœ‹èµ·æ¥å°±å¾ˆéº»çƒ¦ï¼Œè€Œä¸”æ„Ÿè§‰ç°å®é‡Œå‡ ä¹ä¸ä¼šé‡è§è¿™ç§æƒ…å†µã€‚ å¯¹ 64x64 çŸ©é˜µçš„ç¬¬äºŒæ¬¡ä¼˜åŒ–â€”â€”1179æ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œç›´æ¥çœ‹ CSAPP - Cache Lab çš„æ›´(æœ€)ä¼˜ç§€çš„è§£æ³• - çŸ¥ä¹ å’Œä»£ç å§ã€‚è¿™ç¯‡æ–‡ç« çš„ä½œè€…æ‹¿åˆ°äº† 64x64 çš„ç†è®ºæœ€ä¼˜è§£ï¼Œéå¸¸å¼ºå¤§ã€‚ä¸è¿‡æˆ‘æ²¡æœ‰åœ¨å¯¹è§’çº¿ä¸Šåšå¾®è°ƒï¼Œè€Œæ˜¯åªå‚è€ƒäº†ä½œè€…å¯¹ä¸€èˆ¬å—çš„è¯»å†™é¡ºåºã€‚ void transpose_submit_64x64(int M, int N, int A[N][M], int B[M][N]) &#123; int blockSize = 8; int rowBlock, colBlock, i, j; int rowBlocks = (N + blockSize - 1) / blockSize; int colBlocks = (M + blockSize - 1) / blockSize; int tmp0, tmp1, tmp2, tmp3, tmp4, tmp5, tmp6, tmp7; for (rowBlock = 0; rowBlock &lt; rowBlocks; rowBlock++) &#123; for (colBlock = 0; colBlock &lt; colBlocks; colBlock++) &#123; // Aä¸Š for (i = rowBlock * blockSize; i &lt; rowBlock * blockSize + blockSize / 2 &amp;&amp; i &lt; N; i++) &#123; // è¯»å–Açš„ä¸€è¡Œ tmp0 = A[i][colBlock * blockSize]; tmp1 = A[i][colBlock * blockSize + 1]; tmp2 = A[i][colBlock * blockSize + 2]; tmp3 = A[i][colBlock * blockSize + 3]; tmp4 = A[i][colBlock * blockSize + 4]; tmp5 = A[i][colBlock * blockSize + 5]; tmp6 = A[i][colBlock * blockSize + 6]; tmp7 = A[i][colBlock * blockSize + 7]; // å¡«å……Bå·¦ä¸Š B[colBlock * blockSize][i] = tmp0; B[colBlock * blockSize + 1][i] = tmp1; B[colBlock * blockSize + 2][i] = tmp2; B[colBlock * blockSize + 3][i] = tmp3; // å¡«å……Bå³ä¸Š, è¿™ä¸€éƒ¨åˆ†æœªæ¥ä¼šè¢«æ”¾åˆ°Bå·¦ä¸‹ B[colBlock * blockSize][i + blockSize / 2] = tmp4; B[colBlock * blockSize + 1][i + blockSize / 2] = tmp5; B[colBlock * blockSize + 2][i + blockSize / 2] = tmp6; B[colBlock * blockSize + 3][i + blockSize / 2] = tmp7; &#125; // Aå·¦ä¸‹, æ³¨æ„è¿™é‡ŒæŒ‰åˆ—éå† for (j = colBlock * blockSize; j &lt; colBlock * blockSize + blockSize / 2 &amp;&amp; j &lt; M; j++) &#123; // è¯»å– A çš„å·¦ä¸‹å°å—çš„ä¸€åˆ— tmp0 = A[rowBlock * blockSize + blockSize / 2][j]; tmp1 = A[rowBlock * blockSize + blockSize / 2 + 1][j]; tmp2 = A[rowBlock * blockSize + blockSize / 2 + 2][j]; tmp3 = A[rowBlock * blockSize + blockSize / 2 + 3][j]; // è¯»å– B çš„å³ä¸Šå°å—çš„ä¸€è¡Œ tmp4 = B[j][rowBlock * blockSize + blockSize / 2]; tmp5 = B[j][rowBlock * blockSize + blockSize / 2 + 1]; tmp6 = B[j][rowBlock * blockSize + blockSize / 2 + 2]; tmp7 = B[j][rowBlock * blockSize + blockSize / 2 + 3]; // æŠŠä» A å·¦ä¸‹è¯»åˆ°çš„å†…å®¹å†™åˆ° B å³ä¸Š B[j][rowBlock * blockSize + blockSize / 2] = tmp0; B[j][rowBlock * blockSize + blockSize / 2 + 1] = tmp1; B[j][rowBlock * blockSize + blockSize / 2 + 2] = tmp2; B[j][rowBlock * blockSize + blockSize / 2 + 3] = tmp3; // æŠŠ B å³ä¸Šçš„å†…å®¹å†™åˆ° B å·¦ä¸‹ B[j + blockSize / 2][rowBlock * blockSize] = tmp4; B[j + blockSize / 2][rowBlock * blockSize + 1] = tmp5; B[j + blockSize / 2][rowBlock * blockSize + 2] = tmp6; B[j + blockSize / 2][rowBlock * blockSize + 3] = tmp7; &#125; // Aå³ä¸‹ for (i = rowBlock * blockSize + blockSize / 2; i &lt; (rowBlock + 1) * blockSize &amp;&amp; i &lt; N; i++) &#123; // è¯»å–Açš„ä¸€è¡Œ tmp0 = A[i][colBlock * blockSize + blockSize / 2]; tmp1 = A[i][colBlock * blockSize + blockSize / 2 + 1]; tmp2 = A[i][colBlock * blockSize + blockSize / 2 + 2]; tmp3 = A[i][colBlock * blockSize + blockSize / 2 + 3]; // å¡«å……B B[colBlock * blockSize + blockSize / 2][i] = tmp0; B[colBlock * blockSize + blockSize / 2 + 1][i] = tmp1; B[colBlock * blockSize + blockSize / 2 + 2][i] = tmp2; B[colBlock * blockSize + blockSize / 2 + 3][i] = tmp3; &#125; &#125; &#125; &#125; Future workå†™æ–‡ç« çš„æ—¶å€™çªç„¶æƒ³åˆ°æˆ‘ä»¬ä¼¼ä¹å¯ä»¥åˆ†é•¿æ–¹å½¢çš„ 16x8 çš„å—ï¼Œå› ä¸º $1682 = 256$ å¯ä»¥å®Œå…¨å¡«æ»¡ cache. ç®€å•å†™äº†ä¸‹ä»£ç å¾—åˆ°äº†ä¸‹é¢çš„ç»“æœï¼š [16x8]Points Max pts MissesTrans perf 32x32 8.0 8 287Trans perf 61x67 10.0 10 1811çœ‹èµ·æ¥æ•ˆæœå‡ºä¹æ„æ–™åœ°ä¸é”™ï¼Ÿç”šè‡³æ¯”æˆ‘çš„ 8x8 åˆ†å—æ•ˆæœæ›´å¥½ã€‚è¿™é‡Œæ²¡æœ‰æ”¾è¿›æ¥ 64x64 è½¬ç½®çš„ç»“æœï¼Œå› ä¸ºæˆ‘æ²¡æœ‰åšåˆ†å°å—çš„ä¼˜åŒ–ã€‚æ‰€ä»¥è¯´ï¼Œè¿™ç§æ–¹æ³•è¯´ä¸å®šè¿˜æœ‰ä¸å°æ¢ç´¢ç©ºé—´ï¼Ÿ ä¸‹é¢æ˜¯æˆ‘çš„ 8x8 åˆ†å—çš„ç»“æœï¼Œå¯ä»¥ç”¨æ¥å’Œä¸Šé¢çš„ç»“æœåšæ¯”è¾ƒã€‚ä¸¤ä¸ªä»£ç éƒ½åªç”¨äº†ç®€å•çš„åˆ†å—å’Œ 8 ä¸ª tmp å˜é‡ï¼Œæ²¡æœ‰é¢å¤–ä¼˜åŒ–ã€‚ [8x8] Points Max pts MissesTrans perf 32x32 8.0 8 287Trans perf 61x67 10.0 10 1997 è¿™é‡Œæ˜¯æˆ‘ä½¿ç”¨çš„ 16x8 çš„åˆ†å—ä»£ç ï¼š void transpose_submit(int M, int N, int A[N][M], int B[M][N]) &#123; int blockRow = 16; // å—çš„è¡Œæ•° int blockCol = 8; // å—çš„åˆ—æ•° int rowBlock, colBlock, i, j; // å‘ä¸Šå–æ•´, è®¡ç®—å‡ºæ€» block æ•° int rowBlocks = (N + blockRow - 1) / blockRow; int colBlocks = (M + blockCol - 1) / blockCol; int tmp0, tmp1, tmp2, tmp3, tmp4, tmp5, tmp6, tmp7; for (rowBlock = 0; rowBlock &lt; rowBlocks; rowBlock++) &#123; for (colBlock = 0; colBlock &lt; colBlocks; colBlock++) &#123; for (i = rowBlock * blockRow; i &lt; (rowBlock + 1) * blockRow &amp;&amp; i &lt; N; i++) &#123; // å±•å¼€jå¾ªç¯ï¼Œæ¯æ¬¡å¤„ç†8ä¸ªå…ƒç´  j = colBlock * blockCol; if (j &lt; M) tmp0 = A[i][j]; if (j + 1 &lt; M) tmp1 = A[i][j + 1]; if (j + 2 &lt; M) tmp2 = A[i][j + 2]; if (j + 3 &lt; M) tmp3 = A[i][j + 3]; if (j + 4 &lt; M) tmp4 = A[i][j + 4]; if (j + 5 &lt; M) tmp5 = A[i][j + 5]; if (j + 6 &lt; M) tmp6 = A[i][j + 6]; if (j + 7 &lt; M) tmp7 = A[i][j + 7]; // å†™å…¥BçŸ©é˜µ if (j &lt; M) B[j][i] = tmp0; if (j + 1 &lt; M) B[j + 1][i] = tmp1; if (j + 2 &lt; M) B[j + 2][i] = tmp2; if (j + 3 &lt; M) B[j + 3][i] = tmp3; if (j + 4 &lt; M) B[j + 4][i] = tmp4; if (j + 5 &lt; M) B[j + 5][i] = tmp5; if (j + 6 &lt; M) B[j + 6][i] = tmp6; if (j + 7 &lt; M) B[j + 7][i] = tmp7; &#125; &#125; &#125; &#125;","categories":[{"name":"å…¬å¼€è¯¾","slug":"å…¬å¼€è¯¾","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/"},{"name":"CMU-15-213","slug":"å…¬å¼€è¯¾/CMU-15-213","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/CMU-15-213/"},{"name":"Labs","slug":"å…¬å¼€è¯¾/CMU-15-213/Labs","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/CMU-15-213/Labs/"}],"tags":[]},{"title":"_ç©ä¹çš„äºº","slug":"others/thoughts/ç©ä¹çš„äºº","date":"2025-03-24T11:09:30.000Z","updated":"2025-07-18T15:09:38.986Z","comments":true,"path":"wiki/others/thoughts/ç©ä¹çš„äºº/","permalink":"http://rinevard.github.io/wiki/others/thoughts/%E7%8E%A9%E4%B9%90%E7%9A%84%E4%BA%BA/","excerpt":"","text":"æ•…äº‹ä¹‹å‰æœ€è¿‘åœ¨å­¦æŸ¥ç†è€å¸ˆçš„ç¼–å‰§è¯¾ï¼Œè¯¾å¾ˆæœ‰è¶£ï¼Œä¸è¿‡ä¿¡æ¯å¯†åº¦ä¼¼ä¹æœ‰ç‚¹ä½ï¼Œæˆ‘å°±å½“å•å£ç›¸å£°å¬äº†ã€‚è¿™ç¯‡æ–‡ç« è®°å½•äº†ç¬¬äº”è¯¾è€å¸ˆå¸ƒç½®çš„ä½œä¸šï¼Œæ•…äº‹çš„å…«è¦ç´ ã€æ”¯ç‚¹å’Œå¤§çº²æ˜¯æˆ‘è‡ªå·±å†™çš„ï¼Œå…·ä½“å†…å®¹æ˜¯ AI å¡«å……çš„ï¼Œæˆ‘æŠŠ AI ç”Ÿæˆçš„å¤šä¸ªç‰ˆæœ¬æ‹¼æ‹¼å‡‘å‡‘å¾—åˆ°äº†ä¸‹é¢çš„æ•…äº‹ï¼ˆä»€ä¹ˆæ‹¼å¥½æ–‡ï¼‰ã€‚ æœ€è¿‘çš„æ€ç»ªæŒºä¹±çš„ã€‚å‰ä¸¤å¤©åšäº†ä¸ªæ¸¸æˆåŸå‹ï¼Œæ„Ÿè§‰å¤§ä½“ä¸Šè¿˜ç®—å€¼å¾—åšï¼Œæš‚å‘½åå«ã€Šç¿»å‘½å¸ˆã€‹ã€‚è¿™æ ·çš„è¯ï¼Œæƒ³åšçš„äº‹æƒ…å®åœ¨æ˜¯æœ‰ç‚¹å¤šäº†ã€‚æƒ³å‚åŠ  GSoC æ¥æ¥è§¦ä¸‹å¼€å‘ï¼Œé¡ºä¾¿æå‡ä¸‹ cpp æ°´å¹³ï¼›æƒ³ç»§ç»­å­¦å…¬å¼€è¯¾ï¼Œäº†è§£ä¸‹åº•å±‚çŸ¥è¯†ï¼›è¿˜æƒ³èŠ± 100 å¤©å®Œæ•´åœ°åšä¸€ä¸ªèƒ½æ”¾åˆ° itch ç”šè‡³ steam ä¸Šçš„å°æ¸¸æˆï¼Œè·‘ä¸€éæµç¨‹ã€‚ è¯´æ¥æœ‰äº›å‡¡å°”èµ›ï¼Œä½†ä¸Šå­¦æœŸçš„æˆç»©å¥½å¾—æœ‰ç‚¹è«åå…¶å¦™ï¼Œä»¥è‡³äºæˆ‘çœŸçš„å¼€å§‹è€ƒè™‘å¤–ä¿ä¹‹ç±»çš„äº‹æƒ…ã€‚è¿™å°±å¯¼è‡´æˆ‘ä»¬çœŸçš„é™·å…¥äº†ä¸€ä¸ªå¥‡æ€ªçš„â€œä¿ç ”å¼€å‘ä¸¤æ‰‹æŠ“â€çš„å¢ƒåœ°ï¼Œä½†æˆ‘çš„æ°´å¹³å´ä¸è¶³ä»¥æ”¯æŒæˆ‘æŠŠå®ƒä»¬å…¨éƒ¨æŠ“ç‰¢ï¼Œäºæ˜¯ä¾¿æ·±æ„Ÿæ—¶é—´ç´§å¼ ã€‚å…¨æŠ“ç‰¢çœŸçš„ä¸å¯èƒ½å—ï¼Ÿå¦‚æœæ˜¯æˆ‘çš„è¯è¯´ä¸å®šä¹Ÿèƒ½åšåˆ°å‘¢ï¼Œä½†è¿™æ ·çš„ç”Ÿæ´»æ˜¯å¦ç¼ºä¹äº†ä¸€æŠ¹å¥‡å¹»è‰²å½©å‘¢ï¼Ÿæ¯”èµ·æŠŠç»å¤§å¤šæ•°æ—¶é—´éƒ½èŠ±åœ¨è‡ªæˆ‘å®ç°å’Œæå‡è‡ªå·±çš„æ°´å¹³ä¸Šï¼Œæˆ‘è¿˜æ˜¯æƒ³æŠ½å‡ºæ—¶é—´æ¥å­¦å­¦æ–°ä¸œè¥¿ï¼Œçœ‹çœ‹ç•ªå‰§ï¼Œæ‰“æ‰“æ¸¸æˆã€‚å†è¯´äº†ï¼Œç°åœ¨çš„ç¤¾äº¤æ°´å¹³ä»ç„¶æ˜¯è´Ÿçš„ï¼Œæ˜¯ä¸æ˜¯è¯¥å»æå‡ä¸€ä¸‹ï¼ŸåŸæœ¬æƒ³ç€é æ‰¾äººæ¥è¯•ç©æ¥å’Œäººä»¬äº¤æµï¼Œä½†è¿™åˆå›åˆ°äº†å¼€å‘ä¸Šã€‚è™½ç„¶è¿™çœ‹èµ·æ¥æ˜¯æ¡å¯è¡Œçš„è·¯ï¼Œä½†æ„Ÿè§‰æœ‰ç‚¹ç‚¹å¥‡æ€ªã€‚ äººç”ŸçŸ­åˆ™äºŒåå¹´ï¼Œé•¿åˆ™ä¸€ç™¾å¹´ï¼Œæˆ‘ä»¬ç©¶ç«Ÿæƒ³åšä»€ä¹ˆï¼Œæƒ³å»å¾€ä½•æ–¹ï¼Œæƒ³æˆä¸ºä»€ä¹ˆæ ·çš„äººï¼Ÿ å‰è·¯æœªå®šå´ä»è¯•å›¾çœ‹å‘æœªæ¥ï¼Œè‡ªä¼šç„¦è™‘ã€‚ä¸è¿‡æˆ‘å–œæ¬¢çš„ä¸€ä¸ªè™šæ‹Ÿè§’è‰²åœ¨è¿™ç§æƒ…å†µä¸‹æƒ³å¿…ä¼šè¯´ï¼šâ€œç„¦è™‘ä¹Ÿæ˜¯ä¸€ç§ä¸å¯å¤šå¾—çš„ä½“éªŒå‘¢â€ã€‚å–œæ‚¦å’Œå¹³é™è‡ªç„¶æ˜¯å¤§å®¶éƒ½å–œæ¬¢çš„ä½“éªŒï¼Œä½†ç„¦è™‘ã€æ‚²ä¼¤è¿™äº›è´Ÿé¢æƒ…ç»ªä¼¼ä¹ä¹Ÿæ˜¯å¥‡å¦™çš„ä½“éªŒã€‚äººç±»ï¼Œå¾ˆç¥å¥‡å§ã€‚ è¯è¯´å›æ¥ï¼Œç¿»å‘½å¸ˆè¿™ä¸ªåå­—å¬èµ·æ¥å°±å¾ˆæœ‰è¶£å§ã€‚å¬è¯´ä¸ºè‡ªå·±æ‘†ä¸ªâ€è¿‡è·¯ç‰Œé˜µâ€ï¼Œä¸€è¡Œä¸‰ç‰Œï¼Œä¾¿èƒ½è§£ä¸€æ—¶ä¹‹å›°ã€‚æˆ‘å›å»æ‘†ä¸€ä¸‹è¯•è¯•ã€‚ åœ¨ 101 å‘äº†ä¸ªæ²¡é‚£ä¹ˆå‡¡å°”èµ›çš„ç‰ˆæœ¬ã€‚æˆ‘åœ¨è®¤çœŸæ€è€ƒï¼ŒBIT101 å¯¹æˆ‘æ¥è¯´ç©¶ç«Ÿæ„å‘³ç€ä»€ä¹ˆã€‚æˆ‘ä»æœªæƒ³è¿‡ç«‹ä¸€ä¸ªå¾ˆå‰å®³çš„äººè®¾ï¼Œä½†æˆ‘åœ¨å‘å¸–æ—¶æ€»ä¼šä¸è‡ªè§‰åœ°åªå±•ç¤ºçœ‹èµ·æ¥ä¸é”™çš„ä¸€é¢ï¼Œäºæ˜¯æ¸æ¸åœ°å°±åªå†™å‡ºäº†ä¸€äº›â€œå±€éƒ¨çš„çœŸå®â€ã€‚ é‚£æˆ‘æ˜¯æ€ä¹ˆå‘ç°è¿™ä¸ªç‰ˆæœ¬æœ‰ç‚¹å‡¡å°”èµ›çš„å‘¢ï¼Ÿç­”æ¡ˆæ˜¯è®© AI å†™äº†ä¸€ä¸ªç¿»ç‰ˆã€‚æˆ‘è¦æ±‚ AI æŠŠå’Œæ¸¸æˆã€ç¼–ç¨‹ç›¸å…³çš„å†…å®¹æ¢æˆåˆ«çš„é¢†åŸŸçš„å†…å®¹ï¼Œå°±å¾—åˆ°äº†æœ¬æ–‡ä¸­â€œæ•…äº‹ä¹‹åâ€”â€”AI çš„å‡¡å°”èµ›â€é‚£ä¸€èŠ‚çš„å†…å®¹ã€‚çœ‹äº†çœ‹ï¼Œæ„Ÿè§‰çœŸçš„å¥½å‡¡å°”èµ›å•Š=) äºæ˜¯å°±æ”¹äº†æ”¹ã€‚å¦‚æœæˆ‘çœŸçš„å¾ˆå‰å®³å°±å¥½äº†ï¼Œå¯æƒœæˆ‘å¹¶ä¸ã€‚ä½†æˆ‘ä¼šå˜å¼ºçš„ã€‚ æ•…äº‹â€”â€”ç©ä¹çš„äººâ€œå§“åï¼Ÿâ€ â€œææ˜ã€‚â€ â€œå¹´é¾„ï¼Ÿâ€ â€œå‘ƒâ€¦â€¦åä¸ƒå²ï¼Ÿâ€ æ£€ç¥¨å‘˜æ‰«äº†ä»–ä¸€çœ¼ï¼Œæœ€ååªæ˜¯å¹äº†å£æ°”ï¼ŒæŒ¥æ‰‹æ”¾è¡Œã€‚ ææ˜ç°å¹´ 32 å²ï¼Œèº«é«˜ 169 å˜ç±³ï¼Œä½“é‡ 61.5 å…¬æ–¤ï¼Œæ²¡æœ‰å¥³æœ‹å‹ï¼Œæ²¡æœ‰å® ç‰©ï¼Œæ²¡æœ‰ä¸è‰¯å—œå¥½ã€‚åœ¨ææ˜å±…ä½çš„åŸå¸‚é‡Œï¼Œæ‰€æœ‰ 20 å²ä»¥ä¸Šçš„æˆå¹´äººéƒ½æŒ‰ç…§åŒæ ·çš„ç¨‹åºç”Ÿæ´»ï¼šèµ·åºŠã€å·¥ä½œã€åƒé¥­ã€ç¡è§‰ï¼Œå¶å°”å‚åŠ åŸ¹è®­ã€ä¼šè®®å’Œå›¢å»ºæ´»åŠ¨ã€‚æ”¿åºœé¢å¸ƒçš„ã€Šæˆå¹´äººè¡Œä¸ºå‡†åˆ™ã€‹æ˜ç¡®è§„å®šï¼Œæˆå¹´äººçš„é¦–è¦ä»»åŠ¡æ˜¯å·¥ä½œï¼Œæ¬¡è¦ä»»åŠ¡æ˜¯ä¸ºå›½å®¶åŸ¹å…»åˆæ ¼å…¬æ°‘ï¼Œç¬¬ä¸‰ä»»åŠ¡æ˜¯ç…§é¡¾è€äººï¼Œç¬¬å››ä»»åŠ¡æ˜¯è‡ªæˆ‘æå‡ã€‚ç¬¬åä¸ƒæ¡ç‰¹åˆ«å¼ºè°ƒï¼šæˆå¹´äººä¸¥ç¦è¿›å…¥æ¸¸ä¹è®¾æ–½ã€‚ ç°åœ¨ä»–ç«™åœ¨æ¸¸ä¹å›­å…¥å£å¤„ï¼Œèº«ä¸Šè£¹ç€ä¸€ä»¶å°ç€å¡é€šæé¾™çš„ T æ¤ï¼Œä¸‹åŠèº«ç©¿ç€ä¸€æ¡æ˜æ˜¾çŸ­äº†ä¸€æˆªçš„èƒŒå¸¦è£¤ï¼Œè„šä¸Šæ˜¯ä¸€åŒå¸¦ç¯çš„è¿åŠ¨é‹ã€‚ä»–çš„è„¸ä¸Šè´´ç€ä¸¤å—å¤§å·åˆ›å¯è´´ï¼Œè¯•å›¾æ©ç›–èƒ¡èŒ¬çš„ç—•è¿¹ã€‚ ææ˜å°å¿ƒç¿¼ç¿¼åœ°èµ°è¿›æ¸¸ä¹å›­ï¼Œæ‰‹é‡Œæ¡ç€ä¸€æ ¹æ£’æ£’ç³–ï¼Œæ—¶ä¸æ—¶ç´§å¼ åœ°èˆ”ä¸€å£ï¼Œå‡è£…è‡ªå·±å¯¹ç³–æœå¾ˆæ„Ÿå…´è¶£ã€‚å®é™…ä¸Šï¼Œä»–ä¸Šä¸€æ¬¡åƒæ£’æ£’ç³–è¿˜æ˜¯åœ¨åä¸‰å²é‚£å¹´ã€‚ â€œå˜¿ï¼ä½ åœ¨è¿™é‡Œå¹²å˜›å‘€ï¼Ÿä½ å®¶å¤§äººå‘¢ï¼Ÿâ€ä¸€ä¸ªæ¸¸ä¹å›­å·¥ä½œäººå‘˜èµ°è¿‡æ¥é—®é“ã€‚ â€œæˆ‘çˆ¸çˆ¸å»ä¹°é¥®æ–™äº†ï¼Œè®©æˆ‘åœ¨è¿™é‡Œç­‰ä»–ã€‚â€ææ˜èƒŒäº†äº”éçš„æ ‡å‡†ç­”æ¡ˆè„±å£è€Œå‡ºã€‚ å·¥ä½œäººå‘˜ä¸Šä¸‹æ‰“é‡äº†ä»–å‡ çœ¼ï¼šâ€ä½ å¤šå¤§äº†ï¼Ÿçœ‹èµ·æ¥æŒºé«˜çš„ã€‚â€ â€œæˆ‘å‘è‚²å¾—æ—©ï¼Œåä¸ƒå²ã€‚â€ææ˜æå‡ºäº‹å…ˆå‡†å¤‡å¥½çš„å­¦ç”Ÿè¯ï¼Œé‚£æ˜¯ä»–ä»ç½‘ä¸Šç‰¹æ„å®šåˆ¶çš„ã€‚ å·¥ä½œäººå‘˜å‹‰å¼ºç›¸ä¿¡äº†ä»–çš„è¯´æ³•ï¼Œè½¬èº«ç¦»å¼€ã€‚ææ˜æ¾äº†ä¸€å£æ°”ï¼Œè¿…é€Ÿå¾€æ—‹è½¬æœ¨é©¬æ–¹å‘èµ°å»ã€‚ æ—‹è½¬æœ¨é©¬ä¸Šï¼Œææ˜ç´§ç´§æŠ“ä½é‡‘è‰²çš„æ‰¶æ‰‹ï¼Œæ„Ÿå—ç€ä¸Šä¸‹èµ·ä¼çš„èŠ‚å¥ã€‚éŸ³ä¹å“èµ·ï¼Œæœ¨é©¬å¼€å§‹æ—‹è½¬ï¼Œææ˜çš„å¿ƒè·³åŠ é€Ÿï¼Œä¸€ç§å¥‡æ€ªçš„å¿«æ„Ÿä»è„šåº•è”“å»¶åˆ°å…¨èº«ã€‚ä»–å·²ç»è®°ä¸æ¸…ä¸Šä¸€æ¬¡æœ‰è¿™ç§æ„Ÿè§‰æ˜¯ä»€ä¹ˆæ—¶å€™äº†ã€‚ â€œä½ ä¹Ÿæ˜¯ä¸€ä¸ªäººæ¥çš„å—ï¼Ÿâ€æ—è¾¹çš„æœ¨é©¬ä¸Šï¼Œä¸€ä¸ªå¤§çº¦ä¹å²çš„å°å¥³å­©é—®é“ã€‚ ææ˜åƒµç¡¬åœ°ç‚¹ç‚¹å¤´ã€‚ â€œæˆ‘ä¹Ÿæ˜¯ï¼æˆ‘å¦ˆå¦ˆåœ¨é‚£è¾¹ï¼Œâ€å°å¥³å­©æŒ‡ç€è¿œå¤„ä¸€ä¸ªçœ‹æ‰‹æœºçš„å¥³äººï¼Œâ€å¥¹è¯´è‡ªå·±å¤ªå¿™äº†ï¼Œæ²¡æ—¶é—´é™ªæˆ‘ç©ã€‚å¤§äººä»¬æ€»æ˜¯å¾ˆå¿™ã€‚â€ ææ˜æƒ³èµ·è‡ªå·±çš„çˆ¶æ¯ã€‚ä»–ä»¬åœ¨ææ˜å…«å²æ—¶å°±å‘Šè¯‰ä»–ï¼šâ€ç©æ˜¯æ²¡æœ‰å‡ºæ¯çš„è¡¨ç°ã€‚â€åäºŒå²æ—¶ï¼Œä»–ä»¬å–æ‰äº†ä»–æ‰€æœ‰çš„ç©å…·ï¼Œæ¢æˆäº†å„ç§å­¦ä¹ èµ„æ–™ã€‚åå…«å²æ—¶ï¼Œä»–ä»¬ä¸ºä»–åˆ¶å®šäº†â€æˆåŠŸäººç”Ÿè§„åˆ’è¡¨â€ï¼Œä¸Šé¢æ²¡æœ‰ä¸€é¡¹ä¸å¨±ä¹æœ‰å…³ã€‚ä¸‰åå²æ—¶ï¼Œä»–ä»¬é€ç»™ä»–ä¸€å¥—â€å‹çˆ±å…¬å¯“â€çš„é¦–ä»˜æ¬¾ï¼Œæ¡ä»¶æ˜¯ä»–å¿…é¡»åœ¨åå¹´å†…è·å¾—ä¸‰æ¬¡èŒä½æ™‹å‡ã€‚ æœ¨é©¬åœä¸‹æ¥åï¼Œææ˜è¿«ä¸åŠå¾…åœ°è·‘å‘è¿‡å±±è½¦ã€‚æ’é˜Ÿæ—¶ï¼Œä»–æ•…æ„å¼¯ç€è…°ï¼Œè£…ä½œæ¯”å®é™…èº«é«˜çŸ®ä¸€äº›ã€‚è½®åˆ°ä»–æ—¶ï¼Œæ£€æŸ¥èº«é«˜çš„å·¥ä½œäººå‘˜ç‹ç–‘åœ°çœ‹äº†ä»–ä¸€çœ¼ï¼šâ€ä½ ç¡®å®šè¦ç©å—ï¼Ÿçœ‹èµ·æ¥æœ‰ç‚¹ç´§å¼ ã€‚â€ â€œæˆ‘å½“ç„¶è¦ç©ï¼â€ææ˜ç”¨ä»–ç»ƒä¹ è¿‡çš„ç«¥å£°è¯´ï¼Œå£°éŸ³å› ä¸ºç´§å¼ è€Œæœ‰äº›å‘æŠ–ã€‚ è¿‡å±±è½¦å¯åŠ¨äº†ï¼Œç¼“ç¼“çˆ¬å‡ã€‚ææ˜æ­»æ­»æŠ“ä½å®‰å…¨æ†ï¼Œå¿ƒè„å‡ ä¹è¦è·³å‡ºèƒ¸è†›ã€‚é£å‘¼å•¸ç€æ è¿‡è€³è¾¹ï¼Œææ˜æ„Ÿåˆ°ä¸€ç§å‰æ‰€æœªæœ‰çš„è‡ªç”±ã€‚å½“è½¦å¢ä¿¯å†²è€Œä¸‹æ—¶ï¼Œä»–æ”¾å£°å°–å«ï¼Œé‚£æ˜¯ä»– 32 å¹´äººç”Ÿä¸­ç¬¬ä¸€æ¬¡å¦‚æ­¤è‚†æ— å¿Œæƒ®åœ°å°–å«ã€‚ ä¸‹äº†è¿‡å±±è½¦ï¼Œææ˜å¤´æ™•ç›®çœ©ï¼Œä½†è„¸ä¸ŠæŒ‚ç€éš¾ä»¥æŠ‘åˆ¶çš„ç¬‘å®¹ã€‚ä»–æ„Ÿè§‰è„–å­æœ‰ç‚¹åƒµç¡¬ï¼Œä¸‹æ„è¯†åœ°å·¦å³è½»è½»æ™ƒåŠ¨äº†ä¸€ä¸‹ï¼Œç¼“è§£é‚£è‚¡ç†Ÿæ‚‰çš„é…¸ç—›ã€‚è¿™æ˜¯ä»–å·¥ä½œåå¹´å…»æˆçš„ä¹ æƒ¯â€”â€”æ¯å¤©ç›¯ç€ç”µè„‘åå°æ—¶ï¼Œé¢ˆæ¤æ—©å·²ä¸å ªé‡è´Ÿã€‚ ææ˜å†³å®šæ¥ç€å»ç©ç¢°ç¢°è½¦ã€‚åè¿›å°è½¦é‡Œï¼Œä»–åƒä¸ªçœŸæ­£çš„åä¸ƒå²å°‘å¹´ä¸€æ ·å…´å¥‹åœ°æŠ“ç´§æ–¹å‘ç›˜ã€‚ç”µæµæ¥é€šï¼Œè½¦å­å¯åŠ¨ï¼Œææ˜çŒ›è¸©æ²¹é—¨å†²å‘å‰æ–¹ã€‚å·¦å†²å³æ’é—´ï¼Œä»–åˆæ„Ÿåˆ°è„–å­ä¸€é˜µåˆºç—›ã€‚ä»–æ¡ä»¶åå°„åœ°åšèµ·äº†åŠå…¬å®¤ä¿å¥æ“ç¬¬ä¸‰å¼ï¼šåŒæ‰‹æ‰˜ä½åè„‘å‹ºï¼Œç¼“æ…¢å‘åæ‹‰ä¼¸ã€‚ ä¸€ä½æ¸¸ä¹å›­çš„åŒ»æŠ¤äººå‘˜æ°å¥½è·¯è¿‡ï¼Œçœ‹åˆ°äº†ææ˜æ ‡å‡†çš„é¢ˆæ¤æ“åŠ¨ä½œã€‚å¥¹é©»è¶³è§‚å¯Ÿäº†å‡ ç§’ï¼Œç„¶åèµ°åˆ°ç¢°ç¢°è½¦åœºåœ°è¾¹ç¼˜ã€‚ â€œè¿™å¥—é¢ˆæ¤ç—…ä¿å¥æ“åšå¾—ä¸é”™å•Šï¼Œå…ˆç”Ÿã€‚â€åŒ»æŠ¤äººå‘˜åœ¨ææ˜ç»è¿‡æ—¶å¤§å£°è¯´é“ï¼Œâ€æ˜¯èŒä¸šåŒ»å¸ˆæ•™çš„å§ï¼Ÿâ€ ææ˜ä¸€æƒŠï¼ŒçŒ›åœ°å›å¤´ï¼Œè½¦å­å¤±æ§æ’ä¸Šäº†åœºåœ°è¾¹ç¼˜ã€‚ â€œä»€ä¹ˆï¼Ÿä¸ä¸ä¸ï¼Œæˆ‘åªæ˜¯â€¦â€¦â€ææ˜æ…Œä¹±åœ°æ‘†æ‰‹ï¼Œâ€æˆ‘â€¦â€¦â€ä»–å¼ äº†å¼ å˜´ï¼Œæœ€ç»ˆè¿˜æ˜¯åƒæ³„äº†æ°”çš„æ°”çƒä¸€æ ·ç˜«åœ¨ç¢°ç¢°è½¦é‡Œï¼Œæ”¾å¼ƒäº†è¾©è§£ã€‚ åŒ»æŠ¤äººå‘˜æŒ‰ä¸‹å¯¹è®²æœºï¼šâ€å®‰ä¿éƒ¨ï¼ŒA åŒºæœ‰ä¸€ä½è¿è§„è¿›å…¥çš„æˆå¹´äººã€‚â€ ä¸¤åä¿å®‰èµ¶åˆ°ï¼Œæ¶èµ·ææ˜å°±å¾€å¤–èµ°ã€‚è·¯è¿‡æ—‹è½¬æœ¨é©¬æ—¶ï¼Œææ˜å¿ä¸ä½å›å¤´çœ‹äº†ä¸€çœ¼ï¼Œé‚£äº›äº”é¢œå…­è‰²çš„å°é©¬ä¾ç„¶åœ¨éŸ³ä¹å£°ä¸­æ—‹è½¬ï¼Œä»¿ä½›åœ¨å‘ä»–å‘Šåˆ«ã€‚ä»–çš„çœŸå®èº«ä»½è¢«ç¡®è®¤ï¼šâ€ææ˜ï¼Œ32 å²ï¼Œå·¥ç¨‹å¸ˆï¼Œè¿åã€Šæˆå¹´äººè¡Œä¸ºå‡†åˆ™ã€‹ç¬¬åä¸ƒæ¡ã€‚â€ ä¸¤ä¸ªå°æ—¶åï¼Œä»–è¢«ç›´æ¥é€å¾€äº†â€æˆå¹´äººå†æ•™è‚²ä¸­å¿ƒâ€ã€‚ åœ¨é‚£é‡Œï¼Œä»–è¢«è¿«å­¦ä¹ å¦‚ä½•åšä¸€ä¸ªâ€æˆç†Ÿçš„å¤§äººâ€ï¼šæ¯å¤©å·¥ä½œåå°æ—¶ï¼Œä¸¥è‚ƒé˜…è¯»è´¢ç»æ–°é—»ï¼Œå‘¨æœ«å¿…é¡»å»å…¬å›­é›ç‹—æˆ–è€…å–å’–å•¡ï¼Œä»¥å¡‘é€ â€ç¬¦åˆç¤¾ä¼šæœŸå¾…çš„æˆå¹´å½¢è±¡â€ã€‚ æ•…äº‹ä¹‹åâ€”â€”AI çš„å‡¡å°”èµ›æœ€è¿‘åœ¨å­¦ä½™è€å¸ˆçš„è¯—æ­Œåˆ›ä½œè¯¾ï¼Œè¯¾å¾ˆæœ‰è¶£ï¼Œä¸è¿‡ä¿¡æ¯å¯†åº¦ä¼¼ä¹æœ‰ç‚¹ä½ï¼Œæˆ‘å°±å½“å•å£ç›¸å£°å¬äº†ã€‚è¿™ç¯‡æ–‡ç« è®°å½•äº†ç¬¬äº”è¯¾è€å¸ˆå¸ƒç½®çš„ä½œä¸šï¼Œè¯—æ­Œçš„æ„è±¡ã€ç»“æ„å’Œæƒ…æ„Ÿæ˜¯æˆ‘è‡ªå·±æ„æ€çš„ï¼Œå…·ä½“å†…å®¹æ˜¯å€ŸåŠ©å†™ä½œè½¯ä»¶æ¶¦è‰²çš„ï¼Œæˆ‘æŠŠå‡ ä¸ªç‰ˆæœ¬æ‹¼æ‹¼å‡‘å‡‘å¾—åˆ°äº†ä¸‹é¢çš„ä½œå“ï¼ˆä»€ä¹ˆæ‹¼å¥½è¯—ï¼‰ã€‚ æœ€è¿‘çš„æ€ç»ªæŒºä¹±çš„ã€‚å‰ä¸¤å¤©æ„æ€äº†ä¸ªæ‘„å½±ä¸“è¾‘åˆ›æ„ï¼Œæ„Ÿè§‰å¤§ä½“ä¸Šè¿˜ç®—å€¼å¾—åšï¼Œæš‚å‘½åå«ã€Šæ—¶å…‰å¸ˆã€‹ã€‚è¿™æ ·çš„è¯ï¼Œæƒ³åšçš„äº‹æƒ…å®åœ¨æ˜¯æœ‰ç‚¹å¤šäº†ã€‚æƒ³æŠ•ç¨¿ä¸€äº›æ–‡å­¦æœŸåˆŠæ¥æ¥è§¦æ–‡å›ï¼Œé¡ºä¾¿æå‡ä¸‹æ–‡ç¬”æ°´å¹³ï¼›æƒ³ç»§ç»­ç ”è¯»ä¸€äº›ç»å…¸è‘—ä½œï¼Œäº†è§£ä¸‹æ–‡å­¦ç†è®ºï¼›è¿˜æƒ³èŠ± 100 å¤©å®Œæ•´åœ°åšä¸€ä¸ªèƒ½æ”¾åˆ°è±†ç“£ç”šè‡³å‡ºç‰ˆç¤¾æŠ•ç¨¿çš„è¯—é›†ï¼Œè·‘ä¸€éæµç¨‹ã€‚ è¯´æ¥æœ‰äº›å‡¡å°”èµ›ï¼Œä½†ä¸Šå­¦æœŸçš„æ–‡å­¦ç«èµ›æˆç»©æ„å¤–åœ°å¥½ï¼Œä»¥è‡³äºæˆ‘çœŸçš„å¼€å§‹è€ƒè™‘è€ƒç ”ä¸­æ–‡ç³»æˆ–è€…å»æ‚å¿—ç¤¾å®ä¹ ä¹‹ç±»çš„äº‹æƒ…ã€‚è¿™å°±å¯¼è‡´æˆ‘ä»¬çœŸçš„é™·å…¥äº†ä¸€ä¸ªå¥‡æ€ªçš„â€å­¦æœ¯ä¸åˆ›ä½œä¸¤æ‰‹æŠ“â€çš„å¢ƒåœ°ï¼Œä½†æˆ‘çš„æ°´å¹³å´ä¸è¶³ä»¥æ”¯æŒæˆ‘æŠŠå®ƒä»¬å…¨éƒ¨æŠ“ç‰¢ï¼Œäºæ˜¯ä¾¿æ·±æ„Ÿæ—¶é—´ç´§å¼ ã€‚å…¨æŠ“ç‰¢çœŸçš„ä¸å¯èƒ½å—ï¼Ÿå¦‚æœæ˜¯æˆ‘çš„è¯è¯´ä¸å®šä¹Ÿèƒ½åšåˆ°å‘¢ï¼Œä½†è¿™æ ·çš„ç”Ÿæ´»æ˜¯å¦ç¼ºä¹äº†ä¸€æŠ¹å¥‡å¹»è‰²å½©å‘¢ï¼Ÿæ¯”èµ·æŠŠç»å¤§å¤šæ•°æ—¶é—´éƒ½èŠ±åœ¨è‡ªæˆ‘å®ç°å’Œæå‡è‡ªå·±çš„æ°´å¹³ä¸Šï¼Œæˆ‘è¿˜æ˜¯æƒ³æŠ½å‡ºæ—¶é—´æ¥é˜…è¯»æ–°ä¹¦ï¼Œçœ‹çœ‹ç•ªå‰§ï¼Œå»å’–å•¡é¦†å‘å‘†ã€‚å†è¯´äº†ï¼Œç°åœ¨çš„ç¤¾äº¤æ°´å¹³ä»ç„¶æ˜¯è´Ÿçš„ï¼Œæ˜¯ä¸æ˜¯è¯¥å»æå‡ä¸€ä¸‹ï¼ŸåŸæœ¬æƒ³ç€é åŠè¯»ä¹¦ä¼šæ¥å’Œäººä»¬äº¤æµï¼Œä½†è¿™åˆå›åˆ°äº†æ–‡å­¦ä¸Šã€‚è™½ç„¶è¿™çœ‹èµ·æ¥æ˜¯æ¡å¯è¡Œçš„è·¯ï¼Œä½†æ„Ÿè§‰æœ‰ç‚¹ç‚¹å¥‡æ€ªã€‚ äººç”ŸçŸ­åˆ™äºŒåå¹´ï¼Œé•¿åˆ™ä¸€ç™¾å¹´ï¼Œæˆ‘ä»¬ç©¶ç«Ÿæƒ³åšä»€ä¹ˆï¼Œæƒ³å»å¾€ä½•æ–¹ï¼Œæƒ³æˆä¸ºä»€ä¹ˆæ ·çš„äººï¼Ÿ å‰è·¯æœªå®šå´ä»è¯•å›¾çœ‹å‘æœªæ¥ï¼Œè‡ªä¼šç„¦è™‘ã€‚ä¸è¿‡æˆ‘å–œæ¬¢çš„ä¸€ä¸ªè™šæ‹Ÿè§’è‰²åœ¨è¿™ç§æƒ…å†µä¸‹æƒ³å¿…ä¼šè¯´ï¼šâ€ç„¦è™‘ä¹Ÿæ˜¯ä¸€ç§ä¸å¯å¤šå¾—çš„ä½“éªŒå‘¢â€ã€‚å–œæ‚¦å’Œå¹³é™è‡ªç„¶æ˜¯å¤§å®¶éƒ½å–œæ¬¢çš„ä½“éªŒï¼Œä½†ç„¦è™‘ã€æ‚²ä¼¤è¿™äº›è´Ÿé¢æƒ…ç»ªä¼¼ä¹ä¹Ÿæ˜¯å¥‡å¦™çš„ä½“éªŒã€‚äººç±»ï¼Œå¾ˆç¥å¥‡å§ã€‚ è¯è¯´å›æ¥ï¼Œæ—¶å…‰å¸ˆè¿™ä¸ªåå­—å¬èµ·æ¥å°±å¾ˆæœ‰è¯—æ„å§ã€‚å¬è¯´ä¸ºè‡ªå·±æ‘†ä¸ªâ€è¯—æ„ä¸‰è¡Œâ€ï¼Œè®°å½•ä¸‰ä¸ªç¬é—´ï¼Œä¾¿èƒ½è§£ä¸€æ—¶ä¹‹å›°ã€‚æˆ‘å›å»è¯•è¯•ã€‚ ç¿»å‘½å¸ˆè¿™æ±Ÿæ¹–ä¹‹ä¸Šï¼Œæœ‰ä¸€é—¨ç„é—¨å¥‡æœ¯ï¼Œå«åšâ€ç¿»å‘½ä¸€æœ¯â€ï¼Œä¿®ä¹ æ­¤æœ¯ä¹‹äººï¼Œä¸–äººå”¤ä½œâ€ç¿»å‘½å¸ˆâ€ã€‚ è¿™ç¿»å‘½å¸ˆä¸æ¯”å¯»å¸¸æ±Ÿæ¹–æœ¯å£«ï¼Œæ—¢ä¸æ˜¯ææŒ‡ä¸€ç®—çš„ç®—å‘½å…ˆç”Ÿï¼Œä¹Ÿä¸æ˜¯æ•²ç›†é—®å¦çš„æ¸¸æ–¹é“äººã€‚ä»–ä»¬ä¿®çš„ï¼Œä¹ƒæ˜¯ä¸Šå¤ä¼ ä¸‹æ¥çš„ç¿»å‘½ç§˜æœ¯ã€‚ä½†å‡¡æœ‰äººæ±‚é—®å‘½é€”ï¼Œè¿™ç¿»å‘½å¸ˆä¾¿èƒ½æ–½å±•å¼‚æœ¯ï¼Œå°†é‚£äººå‰ç¨‹åŒ–ä½œä¸€å¼ å¼ å‘½è¿ç¬¦ç‰Œï¼Œä¸€ä¸€æ‘†åœ¨æ¡ˆä¸Šã€‚ è¿™ç‰Œé˜µå¤§å°ä¸ä¸€ï¼Œå…¨çœ‹æœºç¼˜æ·±æµ…ã€‚å°åˆ™ä¸€è¡Œä¸‰ç‰Œï¼Œç§°ä¸ºâ€è¿‡è·¯ç‰Œé˜µâ€ï¼Œå¤šè§£ä¸€æ—¶ä¹‹å›°ï¼›ä¸­åˆ™ä¸‰è¡Œäº”ç‰Œï¼Œåå”¤â€ä¸‰æ˜Ÿç…§å‘½â€ï¼Œä¸ºé‚£å‘½é€”å¤šèˆ›ä¹‹äººå¯»è§…è½¬æœºï¼›è‹¥é‡å‘½æ ¼å¤æ‚ä¹‹äººï¼Œæˆ–æ˜¯ç‰µè¿å¤šäººçš„å¤§äº‹ï¼Œå®šè¦æ‘†ä¸‹äº”è¡Œä¸ƒåˆ—çš„â€å¤©ç½—åœ°ç½‘é˜µâ€ï¼Œæ–¹èƒ½çª¥å¾—å‘½è¿å…¨è²Œã€‚ å´è¯´è¿™ç¬¦ç‰Œç„å¦™éå¸¸ã€‚ç¿»å¼€ä¸€å¼ ï¼Œæˆ–æ˜¾å‡¶é™©ï¼Œæˆ–ç°å‰ç¥¥ã€‚ç¿»å‘½å¸ˆè§‚ä¹‹ï¼Œä¾¿çŸ¥é‚£äººå‘½ä¸­è¯¥æœ‰ä½•ç­‰æœºç¼˜ã€‚å…¶æŠ€é«˜è€…ï¼Œè¿˜èƒ½å°†é‚£ä¸åˆ©çš„å‘½æ•°é‡æ–°å°å›ç‰Œä¸­ï¼Œæš‚æ—¶å°ä½é‚£çœ¼çœ‹å°±è¦é™ä¸´çš„ç¾ç¥¸ï¼ æ±Ÿæ¹–ä¼ é—»ï¼Œç¿»å‘½å¸ˆä¹‹æœ¯ï¼Œéæ˜¯é€†å¤©æ”¹å‘½ï¼Œä¹ƒæ˜¯å·§å€Ÿå¤©æœºã€‚å¦‚åŒæ£‹ç›˜æ®‹å±€ï¼Œçœ‹ä¼¼å·²æ— ç”Ÿè·¯ï¼Œç¿»å‘½å¸ˆå´èƒ½å¯»é‚£ç¼éš™é—´å¾®å¦™ä¸€ç€ï¼Œå¼•å¾—å‘½è¿æš—æµè½¬å‘ã€‚æ˜æ˜¯å‘½ä¸­æ³¨å®šï¼Œå®åˆ™çš†ç”±äººå¿ƒä¸€å¿µä¹‹å·®ã€‚é«˜æ˜çš„ç¿»å‘½å¸ˆï¼Œä¸è¿‡æ˜¯å°†é‚£æœ¬å°±å­˜åœ¨çš„å¯èƒ½ï¼Œå‘æ˜å¤„è½»æ¨ç½¢äº†ã€‚ æ— è®ºå¦‚ä½•åœ¨åšåŸå‹ä¹‹å‰éƒ½ä¸åº”è¯¥å†™å‰§æƒ…ã€‚ä¸è¿‡æˆ‘åšäº†åŸå‹ï¼æ‰€ä»¥æˆ‘å¯ä»¥å†™ä¸€ç‚¹ç‚¹å‰§æƒ…äº†å§ï¼Œè™½ç„¶è¿™æ®µèƒŒæ™¯æ•…äº‹ä¹Ÿå¤§å¤šæ˜¯ AI å†™çš„ã€‚","categories":[{"name":"æ‚è°ˆ","slug":"æ‚è°ˆ","permalink":"http://rinevard.github.io/categories/%E6%9D%82%E8%B0%88/"},{"name":"ç¢ç¢å¿µ","slug":"æ‚è°ˆ/ç¢ç¢å¿µ","permalink":"http://rinevard.github.io/categories/%E6%9D%82%E8%B0%88/%E7%A2%8E%E7%A2%8E%E5%BF%B5/"}],"tags":[]},{"title":"ç¬¬å…­ç« â€”â€”å­˜å‚¨å™¨å±‚æ¬¡ç»“æ„","slug":"learning/open-course/CMU-15-213/Notes/Chapter6-memory-and-cache","date":"2025-03-20T03:26:01.000Z","updated":"2025-08-22T03:14:43.982Z","comments":true,"path":"wiki/learning/open-course/CMU-15-213/Notes/Chapter6-memory-and-cache/","permalink":"http://rinevard.github.io/wiki/learning/open-course/CMU-15-213/Notes/Chapter6-memory-and-cache/","excerpt":"","text":"å­˜å‚¨å™¨å±‚æ¬¡ç»“æ„å­˜å‚¨å™¨æœ‰å¤šç§ç±»å‹ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®è®¿é—®é€Ÿåº¦æŠŠä»–ä»¬æ’æˆé‡‘å­—å¡”ç»“æ„ã€‚é è¿‘ä¸Šé¢çš„è®¿é—®é€Ÿåº¦å¿«ï¼Œé è¿‘ä¸‹é¢çš„è®¿é—®é€Ÿåº¦æ…¢ã€‚æ¯ä¸€å±‚éƒ½ä½œä¸ºä¸‹é¢ä¸€å±‚çš„ç¼“å­˜ï¼ˆcacheï¼‰ï¼Œå³ä»ä¸‹é¢ä¸€å±‚è¯»å–æ•°æ®æ¥åŠ å¿«è®¿é—®é€Ÿåº¦ï¼š ä¸‹å›¾æ¯”è¾ƒäº†ä¸åŒå­˜å‚¨å™¨çš„è®¿é—®é€Ÿåº¦ å±€éƒ¨æ€§å±€éƒ¨æ€§åˆ†ä¸ºç©ºé—´å±€éƒ¨æ€§å’Œæ—¶é—´å±€éƒ¨æ€§ã€‚å‰è€…æŒ‡å¦‚æœä¸€ä¸ªå†…å­˜ä½ç½®è¢«å¼•ç”¨ï¼Œç¨‹åºå¯èƒ½åœ¨å°†æ¥å¼•ç”¨é™„è¿‘çš„ä¸€ä¸ªå†…å­˜ä½ç½®ï¼›åè€…æŒ‡å¦‚æœä¸€ä¸ªå†…å­˜ä½ç½®è¢«å¼•ç”¨ï¼Œç¨‹åºå¯èƒ½åœ¨å°†æ¥å†æ¬¡å¼•ç”¨å®ƒã€‚ ä¸ºä»€ä¹ˆæˆ‘ä»¬å¸Œæœ›ç¨‹åºæœ‰è¾ƒå¥½çš„å±€éƒ¨æ€§å‘¢ï¼Ÿè¿™æ˜¯å› ä¸ºè®¿é—® cache æ¯”è®¿é—® cache ä¸‹é¢ä¸€å±‚è¦å¿«ï¼Œè€Œ cache çš„å¤§å°æœ‰é™ï¼Œå› æ­¤æˆ‘ä»¬å¸Œæœ›å°½å¯èƒ½è®¿é—® cache é‡Œçš„æ•°æ®ã€‚è€Œ cache å­˜å‚¨çš„æ•°æ®åœ¨ç©ºé—´ä¸Šå’Œæ—¶é—´ä¸Šéƒ½æœ‰ä¸€å®šè¿ç»­æ€§ï¼ˆå‚è€ƒä¸‹é¢çš„â€œé«˜é€Ÿç¼“å­˜â€ä¸€èŠ‚ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬å¸Œæœ›ç¨‹åºçš„å±€éƒ¨æ€§å¥½ã€‚ å¦‚æœæˆ‘ä»¬å¼•ç”¨äº†ä¸åœ¨ cache ä¸­çš„æ•°æ®ï¼Œè¿™å°±è¢«ç§°ä½œâ€œç¼“å­˜ä¸å‘½ä¸­â€ï¼ˆå‘½ä¸­ä¸º â€œhitâ€ï¼Œä¸å‘½ä¸­ä¸ºâ€œmissâ€ï¼‰ï¼Œä»è€Œè¦æŠŠ cache ä¸‹é¢ä¸€å±‚çš„æ•°æ®å¤åˆ¶åˆ° cache ä¸­ï¼Œè¿™æ˜¯å¾ˆæ…¢çš„ã€‚ ä¸¾ä¸ªä¾‹å­ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œæ•°ç»„çš„å±€éƒ¨æ€§æ¯”é“¾è¡¨å¥½ï¼Œå› ä¸ºé“¾è¡¨çš„åœ°å€å¾€å¾€æ˜¯ç¢ç‰‡åŒ–çš„ã€‚ é«˜é€Ÿç¼“å­˜é«˜é€Ÿç¼“å­˜çš„ç»“æ„å¦‚å›¾æ‰€ç¤ºï¼š è®©æˆ‘ä»¬æ¨æµ‹ä¸€ä¸‹ line å’Œ set æ˜¯æ€ä¹ˆè®¾è®¡å‡ºæ¥çš„ã€‚ æˆ‘ä»¬çš„æ ¸å¿ƒæ€è·¯æ˜¯å°½é‡å‡å°‘é«˜é€Ÿç¼“å­˜å’Œä¸»å­˜é—´äº¤æ¢æ•°æ®çš„æ¬¡æ•°ã€‚å¦‚æœæˆ‘ä»¬èƒ½é¢„çŸ¥æœªæ¥ï¼Œæˆ‘ä»¬åªè¦æ ¹æ®æœªæ¥å°½å¯èƒ½æŠŠé«˜é€Ÿç¼“å­˜å¡«æ»¡æœªæ¥ä¼šè¯»çš„å€¼ï¼Œç„¶ååœ¨éœ€è¦æ–°å€¼æ—¶å†è¯»ä¸€æ¬¡å°±å¥½äº†ã€‚ æ˜¾ç„¶æˆ‘ä»¬ä¸èƒ½é¢„çŸ¥æœªæ¥ï¼Œæ‰€ä»¥æˆ‘ä»¬å¸Œæœ›æ¯æ¬¡çš„æ•°æ®äº¤æ¢éƒ½å°½å¯èƒ½å¤šå¸¦æ¥ä¸€äº›â€œæœªæ¥å¯èƒ½ç”¨åˆ°çš„æ•°æ®â€ã€‚æ‰€ä»¥æˆ‘ä»¬æŠŠé«˜é€Ÿç¼“å­˜åˆ’åˆ†æˆè‹¥å¹²ä¸ª lineï¼Œæ¯ä¸ª line éƒ½å­˜å‚¨ä¸€ç»„è¿ç»­çš„åœ°å€çš„æ•°æ®ã€‚æ¯•ç«Ÿå¦‚æœè¯»åˆ°äº†ä¸€ä¸ªåœ°å€ï¼Œæœ‰ç†ç”±è®¤ä¸ºå®ƒé™„è¿‘çš„åœ°å€åœ¨å°†æ¥ä¼šè¢«è¯»åˆ°ã€‚ ä¸Šå›¾ç»™å‡ºäº† line çš„å¯è§†åŒ–ï¼Œæˆ‘ä»¬æŠŠæ•°æ®å­˜å‚¨åœ¨ data æ®µä¸­ï¼Œå…±å­˜å‚¨ B ä¸ª bytes. ä½†åªæ˜¯è¯»å–è¿ç»­çš„ä¸€æ®µæ˜¯ä¸å¤Ÿçš„ã€‚åœ¨ä¸‹å›¾ä¸­ï¼Œæˆ‘ä»¬æŠŠä¸»å­˜ä¸­éœ€è¦ç”¨åˆ°çš„åœ°å€æ ‡çº¢ã€‚è¿™ä¸¤ç§æƒ…å†µä¸­ï¼Œæˆ‘ä»¬è®¤ä¸ºå³è¾¹é‚£ç§æƒ…å†µæ›´å¯èƒ½åœ¨è¿è¡Œæ—¶å‘ç”Ÿï¼Œæ‰€ä»¥æˆ‘ä»¬å¸Œæœ›å®ç°å¤šä¸ª set. å¦‚æœæ¯ä¸ª set åªæœ‰ä¸€ä¸ª lineï¼Œå°±å®ç°äº†ç›´æ¥æ˜ å°„é«˜é€Ÿç¼“å­˜ã€‚å¦‚æœæ¯ä¸ª set æœ‰å¤šä¸ª lineï¼Œå°±å®ç°äº†ç»„ç›¸è”é«˜é€Ÿç¼“å­˜ã€‚ è¯»æ¥ä¸‹æ¥æˆ‘ä»¬è®²è®²å¦‚ä½•è¯»å–æ•°æ®ï¼Œæˆ‘ä»¬ä»¥ç»„ç›¸è”é«˜é€Ÿç¼“å­˜ä¸ºä¾‹ï¼Œæ¯•ç«Ÿç›´æ¥æ˜ å°„æ˜¯ç»„ç›¸è”çš„ç‰¹æ®Šæƒ…å†µã€‚ è¿™é‡Œçš„æ€è·¯æ˜¯æ ¹æ®åœ°å€æ‰¾åˆ°é«˜é€Ÿç¼“å†²ä¸­å¯¹åº”çš„ setï¼Œç„¶åæ£€æŸ¥ set çš„ line ä¸­æ˜¯å¦æœ‰å½“å‰åœ°å€ã€‚ æˆ‘ä»¬æŠŠæ¯ä¸ªåœ°å€åˆ’åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼Œtag éƒ¨åˆ†ã€ç»„ç´¢å¼•éƒ¨åˆ†ã€åç§»éƒ¨åˆ†ã€‚ç»„ç´¢å¼•éƒ¨åˆ†åœ¨ä¸­é—´ï¼Œè€—è´¹ $\\log_2 S$ ä¸ªä½ï¼Œç”¨äºå®šä½å¯¹åº”çš„ç»„ï¼›tag éƒ¨åˆ†åœ¨æœ€å‰ï¼Œå æ®åœ°å€å‰©ä¸‹çš„ä½ç½®ï¼Œç”¨äºå’Œæ¯ä¸ª line çš„ tag ä½œæ¯”è¾ƒä»è€Œç¡®å®šæ˜¯å¦æœ‰ä¸åœ°å€å¯¹åº”çš„ lineï¼›åç§»éƒ¨åˆ†åœ¨æœ€åï¼Œè€—è´¹ $\\log_2 B$ ä¸ªä½ï¼Œç”¨äºåœ¨æ‰¾åˆ°å¯¹åº”çš„ line ä»¥åæ‰¾åˆ°å¯¹åº”çš„æ•°æ®ä½ç½®ã€‚ æ‰€ä»¥ï¼Œå¯¹ç»™å®šçš„åœ°å€ï¼Œæˆ‘ä»¬å…ˆæ‰¾åˆ°å®ƒçš„ç»„ç´¢å¼•éƒ¨åˆ†ï¼Œä»è€Œå®šä½å¯¹åº”çš„ç»„ï¼Œç„¶åæŠŠç»„é‡Œçš„æ‰€æœ‰ line çš„ tag å’Œåœ°å€çš„ tag æ¯”è¾ƒï¼Œæ‰¾åˆ°ç›¸åŒçš„ tag ä»¥åå°±ç®—æ˜¯æˆåŠŸå‘½ä¸­ï¼Œç„¶åæ ¹æ®åç§»è·å–å¯¹åº”çš„å€¼ã€‚ å¦‚æœæ²¡æ‰¾åˆ°ç›¸åŒçš„ tag å‘¢ï¼Ÿè¿™å°±æ˜¯ä¸å‘½ä¸­äº†ï¼Œè¿™æ—¶å°±è¦è®©ä¸»å­˜å’Œ cache é—´äº¤æ¢æ•°æ®ï¼Œé€‰ä¸€ä¸ª lineï¼ˆä¸€èˆ¬æ˜¯ä¸€ç»„é—´æœ€ä¹…æ²¡æœ‰è¢«ä½¿ç”¨çš„é‚£ä¸ªï¼‰æŠŠå®ƒæ›¿æ¢æ‰ã€‚ å†™å†™æ¯”è¯»å¤æ‚å¾ˆå¤šï¼Œä¹¦ä¸Šæ²¡è¯¦ç»†è®²ï¼Œæ‰€ä»¥æˆ‘ä»¬åªæ˜¯ç®€è¦æä¸€ä¸‹ã€‚ ä¸€ä¸ªæ¯”è¾ƒé è°±çš„æ€è·¯æ˜¯æ£€æŸ¥è¦å†™çš„åœ°å€æ˜¯å¦åœ¨ cache ä¸­ï¼Œå¦‚æœåœ¨å°±ç›´æ¥å†™ cacheï¼Œå¹¶æ ‡è®°é‚£ä¸ªä½ç½®ä¸ºâ€œå·²ä¿®æ”¹â€ã€‚å¦‚æœä¸åœ¨ cache ä¸­ï¼Œå°±åƒè¯»ä¸€æ ·ï¼ŒæŠŠé‚£ä¸ªåœ°å€æ‹¿åˆ° cache é‡Œæ¥ï¼Œç„¶åè¦†å†™ã€‚åœ¨ cache çš„ä»»ä½•ä¸€ä¸ªåœ°å€è¢«è¦†ç›–æ‰æ—¶ï¼Œæ£€æŸ¥é‚£ä¸ªåœ°å€çš„å€¼æ˜¯å¦å·²ä¿®æ”¹ï¼Œå¦‚æœä¿®æ”¹åˆ™è¦†å†™ä¸»å­˜ä¸Šçš„å€¼ã€‚ è¿™ç§åšæ³•å«åšå†™å›ï¼ˆwrite-backï¼‰ï¼Œå°½å¯èƒ½åœ°æ¨è¿Ÿæ›´æ–°ã€‚ è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºå†™æ˜¯å¯ä»¥æ¨è¿Ÿçš„ï¼Œæ‰€ä»¥å†™ä¸€èˆ¬æ¯”è¯»è¦å¿«ã€‚ æ€§èƒ½ä¾‹å­Memory Mountainâ€”â€”æ•°ç»„å¤§å°å’Œè®¿é—®æ­¥é•¿å½±å“æ€§èƒ½ è¿™å¼ å›¾æ˜¯å¯¹ä¸€ä¸ªå¤§å°ä¸º size çš„æ•°ç»„ä»¥ stride ä¸ºæ­¥é•¿æ±‚å’Œçš„æ€§èƒ½æ¯”è¾ƒã€‚ æ³¨æ„åˆ°éšç€ size å¢å¤§ï¼Œæˆ‘ä»¬æ„ˆå‘å¾€å­˜å‚¨å™¨å±‚æ¬¡ç»“æ„ä¸‹é¢èµ°ï¼ˆæ¯”å¦‚è¯´ï¼ŒL1 ä¸è¶³ä»¥è£…ä¸‹æ‰€æœ‰æ•°æ®äº†ï¼Œæˆ‘ä»¬å°±ä¸å¾—ä¸èµ°åˆ° L2ï¼‰ï¼ŒåŒæ—¶æ¯èµ°ä¸€å±‚æ—¶é—´éƒ½æœ‰ä¸€ä¸ªçŒ›å¢ã€‚ éšç€ stride å¢å¤§ï¼Œç¼“å­˜å‘½ä¸­ç‡è¶Šæ¥è¶Šä½ï¼Œè€—æ—¶è¶Šæ¥è¶Šå¤§ï¼Œç›´åˆ°æŸä¸ªä¸´ç•Œç‚¹ï¼Œæ¯æ¬¡éƒ½ä¸å‘½ä¸­ã€‚ ç¼“å­˜å‘½ä¸­å½±å“æ€§èƒ½â€”â€”ä»¥çŸ©é˜µä¹˜æ³•ä¸ºä¾‹å‡è®¾æˆ‘ä»¬åœ¨åšçŸ©é˜µä¹˜æ³•ï¼Œæˆ‘ä»¬çš„é«˜é€Ÿç¼“å­˜çš„æ¯ä¸ª line çš„ block èƒ½è£…ä¸‹ $K$ ä¸ªå€¼ã€‚ å¾ªç¯é¡ºåºå¯¹æ€§èƒ½çš„å½±å“ç‰ˆæœ¬ 1 æ˜¯ ijk å¾ªç¯ï¼Œa æ˜¯è¡Œéå†ï¼Œb æ˜¯åˆ—éå†ï¼Œc ä¸åœ¨æœ€å†…å­˜å¾ªç¯å†…æ‰€ä»¥ä¸è®¡æ€§èƒ½æŸè€—ã€‚å¯¹ a æ¥è¯´ï¼Œæ¯ç»è¿‡ K ä¸ªå€¼ï¼Œå°±æœ‰ä¸€æ¬¡ä¸å‘½ä¸­ï¼›å¯¹ b æ¥è¯´ï¼Œæ¯æ¬¡éƒ½ä¸å‘½ä¸­ã€‚æˆ‘ä»¬å¯ä»¥è®¤ä¸ºæœ‰è¿™æ ·çš„ç¼“å­˜ä¸å‘½ä¸­ç‡ï¼š a b c 1 / K 1 0 // ç‰ˆæœ¬1 for (i=0; i&lt;n; i++) &#123; for (j=0; j&lt;n; j++) &#123; sum = 0.0; for (k=0; k&lt;n; k++) sum += a[i][k] * b[k][j]; c[i][j] = sum; &#125; &#125; å¦‚æœæŠŠå¾ªç¯é¡ºåºæ”¹æˆ ikjï¼Œå°±èƒ½å¾—åˆ°æ›´å¥½çš„æ€§èƒ½ã€‚ è¿™æ—¶ a ä¸åœ¨æœ€å†…å±‚å¾ªç¯ï¼Œä¸è®¡æ€§èƒ½æŸè€—ï¼Œb æ˜¯è¡Œéå†ï¼Œc ä¹Ÿæ˜¯è¡Œéå†ï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºæœ‰è¿™æ ·çš„ç¼“å­˜ä¸å‘½ä¸­ç‡ï¼š a b c 0 1 / K 1 / K for (i=0; i&lt;n; i++) &#123; for (k=0; k&lt;n; k++) &#123; r = a[i][k]; for (j=0; j&lt;n; j++) c[i][j] += r * b[k][j]; &#125; &#125; ä¸‹å›¾å±•ç¤ºäº†å…­ç§å¾ªç¯é¡ºåºå¸¦æ¥çš„ä¸åŒæ•ˆç‡ï¼š æœ€å¥½çš„æ˜¯ ikj å¾ªç¯ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åœ°ç®—å‡ºå®ƒçš„å¤§æ¦‚çš„æ€»ä¸å‘½ä¸­æ¬¡æ•°ã€‚å…±æœ‰ $n^2$ ä¸ªå€¼è¦ç®—ï¼Œæ²¡ç®—ä¸€ä¸ªå€¼å¤§æ¦‚ä¼šä¸å‘½ä¸­ $\\frac{n}{K} \\frac{n}{K}$æ¬¡ï¼Œå› æ­¤æ€»ä¸å‘½ä¸­æ¬¡æ•°å¤§çº¦ä¸ºï¼š n^2 \\times (\\frac{n}{K} + \\frac{n}{K})=\\frac{2n^3}{K}blocking å¯¹æ€§èƒ½çš„å½±å“å…¶å®æˆ‘ä»¬è¿˜æœ‰æ›´å¥½çš„ä¼˜åŒ–æ‰‹æ®µâ€”â€”çŸ©é˜µåˆ†å—ä¹˜æ³•ï¼š ç»“æœé‡Œçš„æ¯ä¸ª block çš„è®¡ç®—éœ€è¦è®¿é—® $\\frac{2n}{B}$ ä¸ªå° blckï¼Œæ¯ä¸ªå° block å¤§æ¦‚ä¼šä¸å‘½ä¸­ $\\frac{B^2}{K}$ æ¬¡ï¼Œå› æ­¤æ€»ä¸å‘½ä¸­æ¬¡æ•°å¤§çº¦ä¸ºï¼š (\\frac{n}{B} )^2 \\times \\frac{B^2}{K}\\times \\frac{2n}{B}=\\frac{2n^3}{BK}å½“ç„¶ï¼Œæˆ‘ä»¬ä¸èƒ½æ— é™åœ°å¢å¤§ $B$. å¯¹äºçŸ©é˜µä¹˜æ³• C=AÃ—Bï¼Œæˆ‘ä»¬è¦åŒæ—¶åœ¨ç¼“å­˜ä¸­ä¿å­˜ A çš„ä¸€ä¸ªå—ã€B çš„ä¸€ä¸ªå—å’Œ C çš„ä¸€ä¸ªå—ï¼Œä»è€Œå¸Œæœ›æœ‰ç±»ä¼¼ $3B^2 &lt; C$ çš„é™åˆ¶ï¼ˆè¿™é‡Œçš„ $C$ æ˜¯ cache çš„ capacityï¼‰ã€‚æ‰€ä»¥å°½å¯èƒ½é€‰å¤§çš„ blockï¼Œä½†ä¿è¯ä¸è¿‡å¤§å°±å¥½ã€‚","categories":[{"name":"å…¬å¼€è¯¾","slug":"å…¬å¼€è¯¾","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/"},{"name":"CMU-15-213","slug":"å…¬å¼€è¯¾/CMU-15-213","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/CMU-15-213/"},{"name":"Notes","slug":"å…¬å¼€è¯¾/CMU-15-213/Notes","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/CMU-15-213/Notes/"}],"tags":[]},{"title":"ç¬¬äº”ç« â€”â€”æ€§èƒ½ä¼˜åŒ–","slug":"learning/open-course/CMU-15-213/Notes/Chapter5-optimization","date":"2025-03-18T07:30:28.000Z","updated":"2025-08-22T03:14:43.982Z","comments":true,"path":"wiki/learning/open-course/CMU-15-213/Notes/Chapter5-optimization/","permalink":"http://rinevard.github.io/wiki/learning/open-course/CMU-15-213/Notes/Chapter5-optimization/","excerpt":"","text":"15213 é‡Œæ²¡è®²ç¬¬å››ç« ï¼Œæˆ‘çœ‹äº†ä¸‹æ„Ÿè§‰å¤ªç¡¬ä»¶äº†äºæ˜¯å°±è·³è¿‡äº†ã€‚æˆ‘ä»¬ä»ç¬¬äº”ç« ç»§ç»­â€”â€” ä¸€äº›å¸¸è§çš„ä¼˜åŒ–æ‰‹æ®µæˆ‘ä»¬å°±ä¸è¯¦ç»†è¯´äº†ï¼Œç®€å•æä¸€ä¸‹æœ‰è¿™äº›ï¼š ç”¨ä»£ç å‰–æç¨‹åºæ‰¾åˆ°æ€§èƒ½ç“¶é¢ˆ é€‰å¥½çš„ç®—æ³• å¤–æå¾ªç¯ä¸å˜å¼ å‡å°‘ä¸å¿…è¦çš„å†…å­˜è¯»å†™ å¾ªç¯å±•å¼€æŠ€å·§æ€§å¤ªå¼ºï¼Œç‰ºç‰²äº†å¯è¯»æ€§ï¼Œè€Œä¸”è¯´å®è¯æ€§èƒ½ä¹Ÿæ²¡å¥½å¤ªå¤šï¼Œæ‰€ä»¥ä¹Ÿä¸è¯¦è°ˆã€‚è€Œä¸”å¤§å¤šæ•°ç¼–è¯‘å™¨åœ¨æŠŠä¼˜åŒ–ç­‰çº§è®¾å¾—æ¯”è¾ƒé«˜æ—¶ä¼šè‡ªåŠ¨åšå¾ªç¯å±•å¼€ã€‚ æˆ‘ä»¬ä¸»è¦èŠèŠâ€”â€”ç¼–è¯‘å™¨çš„å±€é™ï¼›ç”¨ CPE è¡¨ç¤ºç¨‹åºæ€§èƒ½ï¼›æŒ‡ä»¤çº§å¹¶è¡Œã€‚ ç¼–è¯‘å™¨çš„å±€é™æ€§ç¼–è¯‘å™¨å¯¹ç¨‹åºåªä½¿ç”¨å®‰å…¨çš„ä¼˜åŒ–ï¼Œå› æ­¤æœ‰äº›æˆ‘ä»¬è„‘è¡¥ç¼–è¯‘å™¨ä¼šä¼˜åŒ–çš„ä¸œè¥¿å®é™…ä¸Šä¸ä¼šè¢«ä¼˜åŒ–ã€‚ void add1(long *x1, long *x2) &#123; *x1 += *x2; *x1 += *x2; &#125; void add2(long *x1, long *x2) &#123; *x1 += *x2 * 2; &#125; ä¹ä¸€çœ‹è¿™ä¸¤ä¸ªå‡½æ•°åŠŸèƒ½ç›¸åŒï¼Œä¸”ä¸‹é¢é‚£ç§è¯»å†™å†…å­˜æ¬¡æ•°æ›´å°‘ï¼Œæˆ–è®¸æˆ‘ä»¬ä¼šæœŸæœ›ç¼–è¯‘å™¨æŠŠä¸Šé¢çš„ç‰ˆæœ¬ä¼˜åŒ–æˆä¸‹é¢çš„ç‰ˆæœ¬ã€‚ å¯å…¶å®ä¸¤è€…åŠŸèƒ½å¹¶ä¸å®Œå…¨ç›¸åŒã€‚è€ƒè™‘ä¸¤ä¸ªæŒ‡é’ˆæŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡çš„æƒ…å†µã€‚ å› æ­¤ï¼Œè¦å¾ˆä»”ç»†æ‰èƒ½å†™å‡ºç¼–è¯‘å™¨èƒ½é¡ºåˆ©ä¼˜åŒ–çš„ä»£ç ã€‚ ç”¨ CPE è¡¨ç¤ºç¨‹åºæ€§èƒ½CPE å³ Cycles Per Elementï¼Œè®¡ç®—æ–¹æ³•å¦‚ä¸‹ï¼š CPE = Total Cycles / Number of Elementsï¼Œå³æ€»å‘¨æœŸæ•° / å…ƒç´ æ•°é‡ã€‚ å®é™…çš„ CPE å€¼å¾ˆéš¾ä»…é€šè¿‡ä»£ç åˆ†æå‡†ç¡®é¢„æµ‹ï¼Œéœ€è¦åœ¨ç‰¹å®šç¡¬ä»¶ã€ç¼–è¯‘å™¨é…ç½®ä¸‹é€šè¿‡å®é™…æµ‹è¯•è·å¾—å‡†ç¡®å€¼ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬é€šè¿‡æ€§èƒ½åˆ†æå·¥å…·æ¥å¾—åˆ°æ€»å‘¨æœŸæ•°ï¼Œç„¶åæ ¹æ®ä»»åŠ¡å¾—å‡ºå…¶å…ƒç´ æ•°é‡ï¼Œä»è€Œç®—å‡º CPEã€‚ æŒ‡ä»¤çº§å¹¶è¡Œç°ä»£å¤„ç†å™¨å¹¶ä¸æ˜¯é¡ºåºæ‰§è¡ŒæŒ‡ä»¤çš„ï¼Œé¡ºåºæ‰§è¡Œåªæ˜¯ä¸€ç§æŠ½è±¡ã€‚æŒ‡ä»¤æ‰§è¡Œçš„é¡ºåºä¸ä¸€å®šè¦ä¸å®ƒä»¬åœ¨æœºå™¨çº§ç¨‹åºä¸­çš„é¡ºåºä¸€è‡´ã€‚è¿™è®©æˆ‘ä»¬å®ç°äº†æŒ‡ä»¤çº§å¹¶è¡Œã€‚ è¿™é‡Œçš„å†…å®¹å¤ªå¤šå¤ªç¡¬æ ¸äº†ï¼Œæˆ‘ä¹Ÿæ²¡ç†è§£ï¼Œå°±åªè®²è®²æŒ‡ä»¤çº§å¹¶è¡Œçš„å¤§ä½“æ¦‚å¿µå’Œæµæ°´çº¿å§ã€‚ å¤§ä½“æ¥è¯´ï¼Œå¤„ç†å™¨ä¼šåˆ†æç¨‹åºé‡Œæ¯æ¡æŒ‡ä»¤çš„ä¾èµ–å…³ç³»ï¼Œä»è€Œå¹¶è¡Œæ‰§è¡Œæ²¡æœ‰ä¾èµ–å…³ç³»çš„æŒ‡ä»¤ã€‚ ä¾‹å­ï¼š å‡è®¾æˆ‘ä»¬æœ‰æŒ‡ä»¤åºåˆ—: 1. mov eax, [mem1] # ä»å†…å­˜åŠ è½½æ•°æ®åˆ°eax 2. add ebx, ecx # å°†ebxå’Œecxç›¸åŠ ï¼Œç»“æœå­˜å…¥ebx 3. mul eax, 4 # å°†eaxä¹˜ä»¥4 4. add edx, ebx # å°†ebxå’Œedxç›¸åŠ ï¼Œç»“æœå­˜å…¥edx 5. mov [mem2], eax # å°†eaxå­˜å…¥å†…å­˜ ä¾èµ–å…³ç³»å›¾: æŒ‡ä»¤1 æŒ‡ä»¤2 (mov eax, [mem1]) (add ebx, ecx) | | v v æŒ‡ä»¤3 æŒ‡ä»¤4 (mul eax, 4) (add edx, ebx) | v æŒ‡ä»¤5 (mov [mem2], eax) è¿™æ—¶æˆ‘ä»¬å¯èƒ½å°±ä¼šå¹¶è¡Œæ‰§è¡ŒæŒ‡ä»¤ 1 å’ŒæŒ‡ä»¤ 2. æµæ°´çº¿(Pipeline)æµæ°´çº¿å°†å•æ¡æŒ‡ä»¤çš„æ‰§è¡Œé˜¶æ®µï¼ˆå–æŒ‡ã€è§£ç ã€æ‰§è¡Œã€è®¿å­˜ã€å†™å›ï¼‰æ‹†åˆ†æˆå¤šä¸ªæ­¥éª¤ï¼Œæ¯ä¸ªæ­¥éª¤ç”±ä¸åŒçš„ç¡¬ä»¶å•å…ƒå¤„ç†ï¼Œä»è€Œå¯ä»¥åŒæ—¶å¤„ç†å¤šæ¡å¤„äºä¸åŒæ­¥éª¤çš„æŒ‡ä»¤ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªå…¸å‹çš„æµ®ç‚¹åŠ æ³•å™¨åŒ…å«ä¸‰ä¸ªé˜¶æ®µï¼šä¸€ä¸ªé˜¶æ®µå¤„ç†æŒ‡æ•°å€¼ï¼Œä¸€ä¸ªé˜¶æ®µå°†å°æ•°ç›¸åŠ ï¼Œå¦ä¸€ä¸ªé˜¶æ®µå¯¹ç»“æœè¿›è¡Œèˆäººã€‚è¿™ç§æŠ€æœ¯å¢åŠ äº†ååé‡ï¼ˆThroughputï¼‰ï¼Œä½†å•ä¸ªæŒ‡ä»¤çš„æ‰§è¡Œå»¶è¿Ÿå¹¶ä¸ä¼šå‡å°‘ã€‚ æ•°æ®æµå›¾æˆ‘ä»¬å¯ä»¥é€šè¿‡ç¨‹åºçš„æ•°æ®æµå›¾æ¥ç²—ç³™åœ°åˆ†æç¨‹åºçš„æŒ‡ä»¤çº§å¹¶è¡Œç¨‹åº¦ã€‚è¿™é‡Œä¸¾ä¸€ä¸ªä¾‹å­åº”è¯¥å°±è¶³å¤Ÿäº†ã€‚å‡è®¾æˆ‘ä»¬æƒ³ç®— $\\sum_{k=0}^{n}a_kx^k$ï¼Œä¸‹é¢æœ‰ä¸¤ç§ç®—æ³•ï¼š åœ¨ poly ä¸­ï¼Œæˆ‘ä»¬å…±åšäº† n æ¬¡åŠ æ³•ï¼Œ2n æ¬¡ä¹˜æ³• double poly(double a[], double x, long degree) &#123; long i; double result = a[0]; double xpwr = x; /* Equals x^i at start of loop */ for (i = 1; i &lt;= degree; i++) &#123; result += a[i] * xpwr; xpwr = x * xpwr; &#125; return result; &#125; åœ¨ polyh ä¸­ï¼Œæˆ‘ä»¬å…±åšäº† n æ¬¡åŠ æ³•ï¼Œn æ¬¡ä¹˜æ³• /* Apply Horner's method */ double polyh(double a[], double x, long degree) &#123; long i; double result = a[degree]; for (i = degree-1; i >= 0; i--) result = a[i] + x*result; return result; &#125; ç„¶è€Œå®é™…ä¸Š poly é€Ÿåº¦æ›´å¿«ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸º poly æœ‰æ›´å¥½çš„æŒ‡ä»¤çº§å¹¶è¡Œåº¦ã€‚ poly çš„å…³é”®è·¯å¾„æ˜¯ mulï¼Œpolyh çš„å…³é”®è·¯å¾„åˆ™æ˜¯ mul â†’ add. å®è·µä¹‹å‰åš leetcode è¿˜é‡åˆ°äº†ä¸€åˆ™è¶£äº‹ï¼ˆ3356. Zero Array Transformationâ…¡ï¼‰ é‚£é¢˜çš„è§£æ³•é‡Œéœ€è¦æ„é€ è¿™æ ·çš„å‡½æ•°ï¼š bool iskZeroArray(vector&lt;int> &amp;nums, vector&lt;vector&lt;int>> &amp;queries, int k) &#123; vector&lt;int> ops(nums.size() + 1, 0); for (int i = 0; i &lt; k; i++) &#123; int l = queries[i][0]; int r = queries[i][1]; int val = queries[i][2]; ops[l] += val; ops[r + 1] -= val; &#125; int n = nums.size(); int op = 0; for (int i = 0; i &lt; n; i++) &#123; op += ops[i]; if (op &lt; nums[i]) &#123; return false; &#125; &#125; return true; &#125; åœ¨ iskZeroArray çš„ç¬¬ä¸€ä¸ª for å¾ªç¯ä¸­, æˆ‘å†™çš„åŸæœ¬æ˜¯ vector&lt;int> query = queries[i]; int l = query[0]; int r = query[1]; int val = query[2]; ä½†æ˜¯è¿™æ ·çš„ç¨‹åºè€—æ—¶ 1000 ms. æ¢æˆ int l = queries[i][0]; int r = queries[i][1]; int val = queries[i][2]; åï¼Œ50ms. ä¸¤è€…ç”šè‡³éƒ½æ˜¯ O(N)çš„ï¼Œå‰è€…ä¹‹æ‰€ä»¥å¦‚æ­¤æ…¢åº”è¯¥æ˜¯å› ä¸ºä¸æ–­åˆ†é…å†…å­˜ç»™ query å§.","categories":[{"name":"å…¬å¼€è¯¾","slug":"å…¬å¼€è¯¾","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/"},{"name":"CMU-15-213","slug":"å…¬å¼€è¯¾/CMU-15-213","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/CMU-15-213/"},{"name":"Notes","slug":"å…¬å¼€è¯¾/CMU-15-213/Notes","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/CMU-15-213/Notes/"}],"tags":[]},{"title":"ç¬¬ä¸‰ç« â€”â€”ç¨‹åºçš„æœºå™¨çº§åˆ«è¡¨ç¤º","slug":"learning/open-course/CMU-15-213/Notes/Chapter3-machine-level-program","date":"2025-03-14T08:41:28.000Z","updated":"2025-08-22T03:14:43.982Z","comments":true,"path":"wiki/learning/open-course/CMU-15-213/Notes/Chapter3-machine-level-program/","permalink":"http://rinevard.github.io/wiki/learning/open-course/CMU-15-213/Notes/Chapter3-machine-level-program/","excerpt":"","text":"img{ width: 75%; } æ±‡ç¼–ç®€ä»‹CSAPP æ•™çš„æ˜¯ x86-64 æ±‡ç¼–è¯­è¨€ï¼Œä½¿ç”¨çš„æ˜¯ AT&amp;T è¯­æ³•é£æ ¼ã€‚ ä¸‹å›¾æ¦‚è¿°äº†ç¨‹åºçš„å·¥ä½œæ–¹å¼ï¼Œå³ä»å†…å­˜ä¸­è¯»å–æŒ‡ä»¤ï¼ŒCPU æ ¹æ®æŒ‡ä»¤åœ¨å¯„å­˜å™¨ä¸Šæ‰§è¡Œæ“ä½œæ¥ä¿®æ”¹å†…å­˜é‡Œçš„æ•°æ®ï¼š ä¸‹å›¾æè¿°äº†å€ŸåŠ© gcc è¿›è¡Œç¼–è¯‘çš„è¿‡ç¨‹ï¼Œå…¶ä¸­ .s å°±æ˜¯æ±‡ç¼–æ–‡ä»¶ï¼š ä¸€äº›æ±‡ç¼–æŒ‡ä»¤ç¤ºä¾‹ï¼š movq 7(%rdx, %rsi, 2), %rax è¡¨ç¤ºæŠŠ 2 * %rsi + %rdx + 7 æŒ‡å‘çš„åœ°å€çš„å€¼å¤åˆ¶åˆ° %rax ä¸­ leaq 7(%rdx, %rsi, 2), %rax è¡¨ç¤ºæŠŠ 2 * %rsi + %rdx + 7 å¤åˆ¶åˆ° %rax ä¸­ï¼Œleaq å¸¸è¢«ç¼–è¯‘å™¨ç”¨æ¥åšä¸€äº›èªæ˜çš„å¿«é€Ÿè®¡ç®—ï¼Œä¸è¿‡ leaq çš„ç¬¬ä¸‰ä¸ªé¡¹åªèƒ½æ˜¯ 1, 2, 4, 8. salq $n, %rax è¡¨ç¤ºæŠŠ %rax ä¸­çš„å€¼å·¦ç§» n ä½ (sal æ˜¯ shift arithmetic left çš„ç¼©å†™) imulq %rdx, %rax è¡¨ç¤ºæŠŠ %rdx ä¸­çš„å€¼ä¸ %rax ä¸­çš„å€¼ç›¸ä¹˜ï¼Œç»“æœå­˜å…¥ %rax (æœ‰ç¬¦å·æ•´æ•°ä¹˜æ³•) æ“ä½œå¾ˆå¤šï¼Œæˆ‘ä»¬ä¸å†åˆ—ä¸¾æ›´å¤šï¼Œéšä¾¿æ‰¾ä¸ªä¹¦æŸ¥ä¸€æŸ¥å°±å¥½ã€‚ æˆ‘ä»¬å¯ä»¥æ³¨æ„åˆ°è¿™äº›æ“ä½œéƒ½ä»¥ â€˜qâ€™ ç»“å°¾ï¼Œé‚£å¦‚æœæˆ‘ä¸å–œæ¬¢ â€˜qâ€™ï¼Œæˆ‘å¯ä»¥ç”¨ â€˜râ€™ ç»“å°¾å—ï¼Ÿä¸è¡Œï¼Œå› ä¸ºè¿™é‡Œçš„ â€˜qâ€™ å®é™…ä¸Šæ˜¯åœ¨æŒ‡å®šæ“ä½œçš„å¤§å°ã€‚è¿˜è®°å¾—å¯„å­˜å™¨é•¿ä»€ä¹ˆæ ·å—ï¼š åç¼€ å…¨ç§° å¤§å°(å­—èŠ‚) ä½æ•° æŒ‡ä»¤ç¤ºä¾‹ æè¿° b byte 1 8 ä½ movb ç§»åŠ¨å•å­—èŠ‚(8 ä½)æ•°æ® w word 2 16 ä½ movw ç§»åŠ¨å­—(16 ä½)æ•°æ® l long 4 32 ä½ movl ç§»åŠ¨åŒå­—(32 ä½)æ•°æ® q quadword 8 64 ä½ movq ç§»åŠ¨å››å­—(64 ä½)æ•°æ® æˆ‘ä»¬ä¹Ÿæœ‰ pushq å’Œ popq ä¹‹ç±»çš„å’Œæ ˆç›¸å…³çš„æ“ä½œã€‚æ ˆæ˜¯ä»€ä¹ˆï¼Ÿè¯·çœ‹ä¸‹é›†â€”â€”å‡½æ•°å’Œæ ˆã€‚ï¼ˆåœ¨â€œæ§åˆ¶â€è¿™ä¸€èŠ‚åé¢ï¼‰ æ§åˆ¶æˆ‘å·²ç»ä¼šåŠ å‡ä¹˜é™¤äº†ï¼Œé‚£ä½ èƒ½æ•™æ•™æˆ‘æ€ä¹ˆå†™æ¡ä»¶ï¼ˆifï¼‰å’Œå¾ªç¯ï¼ˆfor, whileï¼‰å—ï¼Ÿ ä¹æ„æ•ˆåŠ³ã€‚ğŸ˜ ifï¼Œwhileï¼Œdo-whileæ— è®ºæ˜¯æ¡ä»¶è¿˜æ˜¯å¾ªç¯ï¼Œæˆ‘ä»¬éƒ½åœ¨åšä¸¤ä»¶äº‹â€”â€”åˆ¤æ–­æ¡ä»¶æ˜¯å¦æ»¡è¶³å’Œæ ¹æ®æ¡ä»¶è·³åˆ°æŸä¸ªåœ°æ–¹æ‰§è¡Œè¯­å¥ã€‚ è®©æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹æ±‡ç¼–é‡Œçš„ä¸€ä¸ªå…¸å‹çš„ do-while å¾ªç¯ï¼š long fact_do(long n) n in %rdi 1 fact_do: 2 movl $1, %eax Set result = 1 3 .L2: loop: 4 imulq %rdi, %rax Compute result *= n 5 subq $1, %rdi Decrement n 6 cmpq $1, %rdi Compare n:1 7 jg .L2 If >, goto loop 8 rep ; ret Return åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬é€šè¿‡â€œcmpqâ€å’Œâ€œjgâ€æ¥åˆ¤æ–­æ¡ä»¶æ˜¯å¦æ»¡è¶³ï¼Œé€šè¿‡â€œjgâ€æ¥è·³è½¬ä»¥æ‰§è¡Œå¾ªç¯ã€‚é‚£ä¹ˆï¼Œcmpq å®é™…ä¸Šæ˜¯åœ¨åšä»€ä¹ˆå‘¢ï¼Ÿ åœ¨æ±‡ç¼–ä¸­ï¼Œæˆ‘ä»¬æœ‰å‡ ä¸ªç‰¹æ®Šçš„æ ‡å¿—å¯„å­˜å™¨ CFã€ZFã€SFã€OF æ¥è®°å½•æœ€è¿‘çš„æ“ä½œæ˜¯å¦äº§ç”Ÿäº† unsigned çš„æº¢å‡ºã€äº§ç”Ÿ 0ã€äº§ç”Ÿè´Ÿæ•°ã€äº§ç”Ÿäº†è¡¥ç æº¢å‡ºã€‚cmp å’Œ test ä¸¤ä¸ªæŒ‡ä»¤å‡è£…æ‰§è¡Œå‡æ³•å’ŒæŒ‰ä½ä¸å¹¶ä¿®æ”¹è¿™äº›æ ‡å¿—å¯„å­˜å™¨ã€‚ åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œcmpq $1, %rdi å°±æ˜¯åœ¨å‡è£…åš %rdi - 1ï¼Œå¹¶æ ¹æ®è®¡ç®—ç»“æœä¿®æ”¹æ ‡å¿—å¯„å­˜å™¨ã€‚è€Œ jg åˆ™æ ¹æ®æ ‡å¿—å¯„å­˜å™¨çš„å€¼æ¥è¿›è¡Œè·³è½¬ã€‚jg çš„æ•ˆæœæ˜¯ï¼Œå¦‚æœ ~(SF ^ OF) &amp; ~ZF ä¸ºçœŸï¼Œå°±è¿›è¡Œè·³è½¬ã€‚ jg çš„è·³è½¬æ¡ä»¶çœ‹èµ·æ¥å¾ˆå¤æ‚ï¼Œä½†å®ƒå’Œ cmpq x, y è”åŠ¨çš„æ•ˆæœæ˜¯â€”â€”å¦‚æœ y &gt; xï¼Œè·³è½¬ï¼Œå› æ­¤å®ƒå«åš jg. ä¸‹è¡¨æ˜¯ CMP å’Œ TEST çš„æ¦‚è¿°ï¼š Instruction Based on Description CMP Sâ‚, Sâ‚‚ Sâ‚‚ - Sâ‚ Compare TEST Sâ‚, Sâ‚‚ Sâ‚ &amp; Sâ‚‚ Test è¿™é‡Œæ˜¯ä¸€äº›è·³è½¬è¯­å¥ç¤ºä¾‹ï¼š Instruction Synonym Jump condition Description jmp Label 1 Direct jumpä¾‹ï¼šjmp 0x400123ç›´æ¥è·³è½¬åˆ°å…·ä½“åœ°å€ jmp *Operand 1 Indirect jumpä¾‹ï¼šjmp *%raxè·³è½¬ç›®æ ‡åœ¨è¿è¡Œæ—¶æ‰èƒ½ç¡®å®š je Label jz ZF Equal / zero js Label SF Negative jg Label jnle ~(SF ^ OF) &amp; ~ZF Greater (signed &gt;) jge Label jnl ~(SF ^ OF) Greater or equal (signed &gt;=) switchè¦æ³¨æ„çš„æ˜¯ï¼Œswitch å’Œ if çš„æ±‡ç¼–æœ‰æœ¬è´¨åŒºåˆ«ã€‚switch åŸºäºè·³è½¬è¡¨ï¼ˆç±»ä¼¼å“ˆå¸Œè¡¨ï¼‰ï¼Œå®ƒå…ˆæŠŠ case åŒæ—¶å¢å‡ä¸€ä¸ªå€¼æ¥è®©æœ€å°çš„ case å˜ä¸º 0ï¼Œç„¶åå»ºç«‹è·³è½¬è¡¨ï¼Œå¹¶æ ¹æ® case çš„å€¼æ¥è®¡ç®—åˆé€‚çš„è·³è½¬åœ°å€ã€‚ ä»¥è¿™ä¸ª C ä»£ç ä¸ºä¾‹ï¼Œå®ƒå¯èƒ½è¢«ç¼–è¯‘æˆä¸‹é¢çš„æ±‡ç¼–ä»£ç ï¼š switch(n) &#123; case 1: return \"one\"; case 3: return \"three\"; default: return \"other\"; &#125; cmpl $2, %eax # æ£€æŸ¥æ˜¯å¦è¶…å‡ºèŒƒå›´(>2), è¿™é‡Œ%eax = x-1, # å› ä¸ºæœ€å°caseæ˜¯1 ja .L_default # å¦‚æœè¶…å‡ºèŒƒå›´åˆ™è·³è½¬åˆ°default jmp *.L_table(,%rax,4) # ä½¿ç”¨è·³è½¬è¡¨: base + index*4 .section .rodata .align 4 .L_table: .long .L_case1 # case 1, %eax = 0 .long .L_default # case 2, %eax = 1 .long .L_case2 # case 3, %eax = 2 å‡½æ•°å’Œæ ˆå•Šå“ˆå“ˆï¼Œæˆ‘ä»¬åˆè¦è®¨è®ºå¯„å­˜å™¨äº†ã€‚è¿˜è®°å¾— %rsp å—ï¼Ÿå®ƒå°±æ˜¯å­˜å‚¨æ ˆæŒ‡é’ˆçš„å¯„å­˜å™¨ã€‚ä¸‹å›¾å·¦è¾¹æ˜¯æ ˆçš„ç»“æ„ï¼Œå³è¾¹æ˜¯å¯„å­˜å™¨ï¼š é‚£ä¹ˆï¼Œæ ˆå’Œå‡½æ•°æœ‰ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿ å€ŸåŠ©æ ˆæ¥æ§åˆ¶è½¬ç§»æ ˆçš„ç¬¬ä¸€ä¸ªä½œç”¨æ˜¯â€œpassing controlâ€œï¼Œå³æ§åˆ¶è½¬ç§»ã€‚ è°ƒç”¨å‡½æ•°ï¼ˆcallqï¼‰æœ¬è´¨ä¸Šå°±æ˜¯è®©ç¨‹åºè®¡æ•°å™¨è·³è½¬ï¼ˆjmpï¼‰åˆ°äº†å‡½æ•°æ‰€åœ¨çš„æ±‡ç¼–åœ°å€ï¼Œå¹¶æŠŠè°ƒç”¨å®Œæˆååº”è¯¥æ‰§è¡Œçš„æŒ‡ä»¤åœ°å€å‹å…¥æ ˆä¸­ï¼ˆpushqï¼‰ã€‚è€Œå‡½æ•°è¿”å›ï¼ˆretqï¼‰æœ¬è´¨ä¸Šå°±æ˜¯æŠŠè°ƒç”¨å®Œæˆååº”è¯¥æ‰§è¡Œçš„æŒ‡ä»¤åœ°å€ pop å‡ºæ¥ï¼ˆpopqï¼‰ï¼Œå¹¶è·³è½¬å›å»ï¼ˆjmpï¼‰ã€‚ å€ŸåŠ©æ ˆæ¥å­˜å‚¨æ•°æ®æ ˆçš„å¦ä¸€ä¸ªä½œç”¨æ˜¯å­˜å‚¨æ•°æ®ã€‚ åœ¨å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œæ ˆæŒ‡é’ˆä¼šç§»åŠ¨å¹¶ä¸ºè¿™ä¸ªå‡½æ•°åˆ†é…ä¸€äº›æ ˆç©ºé—´ç”¨äºå­˜å‚¨å¯„å­˜å™¨çš„å€¼ã€å­˜å‚¨æœ¬åœ°å˜é‡ã€ä¼ å…¥çš„å‚æ•°ä¹‹ç±»çš„ä¸œè¥¿ã€‚æˆ‘ä»¬ä¸€ä¸ªä¸€ä¸ªè§£é‡Šã€‚ å¯„å­˜å™¨ï¼šåœ¨ä¸Šå›¾çš„å³è¾¹å¯ä»¥çœ‹åˆ°æœ‰ caller saved å’Œ callee saved çš„å¯„å­˜å™¨ï¼Œæ ‡æ³¨ caller saved çš„å¯„å­˜å™¨ç”±è°ƒç”¨è€…è´Ÿè´£ä¿å­˜ï¼Œæ ‡æ³¨ callee saved çš„å¯„å­˜å™¨ç”±è¢«è°ƒç”¨è€…è´Ÿè´£ä¿å­˜ã€‚æ¯”å¦‚è¯´ï¼Œåœ¨è¢«è°ƒç”¨çš„å‡½æ•°è¿”å›æ—¶ï¼Œè¢«è°ƒç”¨è€…è¦ç¡®ä¿ callee saved çš„å¯„å­˜å™¨å’Œè°ƒç”¨å‰æ²¡æœ‰åŒºåˆ«ã€‚ æœ¬åœ°å˜é‡ï¼šæœ‰æ—¶å€™å¯„å­˜å™¨ä¸è¶³ä»¥ä¿å­˜æ‰€æœ‰æœ¬åœ°å˜é‡ï¼Œå°±è¦æ”¾åˆ°æ ˆä¸­ã€‚ ä¼ å…¥çš„å‚æ•°ï¼šå‚æ•°ç¡®å®å¯ä»¥å­˜åœ¨å¯„å­˜å™¨ä¸­ï¼Œä½†æœ‰æ—¶å€™å¯„å­˜å™¨ä¸å¤Ÿå­˜ï¼Œä¹Ÿå°±åªèƒ½æ”¾åˆ°æ ˆä¸­äº†ã€‚æˆ‘ä»¬å¯ä»¥ç”¨ç±»ä¼¼ movl -4(%rsp), %edx çš„æŒ‡ä»¤æ¥è·å–ä¼ å…¥çš„å‚æ•°ã€‚ é«˜åœ°å€ | å‚æ•°7 | | å‚æ•°8 | | ... | â† è°ƒç”¨å‰push | è¿”å›åœ°å€ | â† callæŒ‡ä»¤è‡ªåŠ¨push | ä¿å­˜çš„å¯„å­˜å™¨å€¼ | â† åˆšè¿›å…¥å‡½æ•°æ—¶push | æœ¬åœ°å˜é‡1 | | æœ¬åœ°å˜é‡2 | | ... | â† å½“å‰rspæŒ‡å‘è¿™é‡Œ ä½åœ°å€ å¯¹äº†ï¼Œæ ¹æ®ä¸Šé¢çš„æè¿°ï¼Œé€’å½’å°±æˆäº†è‡ªç„¶æ¶Œç°å‡ºçš„ç»“æœï¼ŒçœŸç¥å¥‡ï¼ æ•°æ®ç»“æ„æˆ‘ä»¬æ¥èŠèŠ arrayã€structã€union éƒ½æ˜¯æ€ä¹ˆè¡¨ç¤ºåœ¨å†…å­˜ä¸­çš„ã€‚ array å’Œå¯»å€å…ˆè¯´ Arrayï¼ŒäºŒç»´ array å¦‚ä¸‹å›¾ï¼š ç®€å•æ˜“æ‡‚ã€‚å‡è®¾æˆ‘ä»¬æœ‰ T A[R][C]ï¼Œé‚£ä¹ˆ&amp;D[i][j] = x0 + L(C * i + j). å…¶ä¸­ x0 ä¸ºæ•°ç»„çš„èµ·å§‹åœ°å€ï¼ŒL æ˜¯ sizeof(T). ç¼–è¯‘å™¨åœ¨å¯»å€æ—¶ä¹Ÿå°±æ˜¯è¿™ä¹ˆåšçš„ã€‚ä¸è¿‡ç¼–è¯‘å™¨ä¼šåšä¸€äº›èªæ˜çš„ä¼˜åŒ–æ¥é¿å…ä¹˜æ³•ï¼Œæ¯”å¦‚ç”¨ leaq æ¥åŠ å¿«è®¡ç®—ï¼š # A in %rdi, i in %rsi, and j in %rdx 1 leaq (%rsi,%rsi,2), %rax # Compute 3i 2 leaq (%rdi,%rax,4), %rax # Compute xA + 12i 3 movl (%rax,%rdx,4), %eax # Read from M[xA + 12i + 4] struct å’Œå¯¹é½å†æ¥èŠèŠ structï¼Œçœ‹çœ‹è¿™å¼ å›¾å°±å·®ä¸å¤šäº†ï¼š struct rec &#123; int i; int a[2]; int *p; &#125;; ä¸Šå›¾ä¸­ï¼Œ12 åˆ° 16 çš„â€œå¡«å……â€æ˜¯å‡ºäºæ•°æ®å¯¹é½çš„éœ€è¦ï¼Œå¯¹é½åŸåˆ™æ˜¯â€”â€”ä»»ä½• K å­—èŠ‚çš„åŸºæœ¬å¯¹è±¡çš„åœ°å€å¿…é¡»æ˜¯ K çš„å€æ•°ã€‚ K type 1 char 2 short 4 int, float 8 long, double, char * unionunion å…è®¸æˆ‘ä»¬ç”¨ä¸åŒæ–¹å¼è§£é‡ŠåŒä¸€æ®µä½è¡¨ç¤ºï¼Œå¸¸ç”¨äºèŠ‚çœå†…å­˜ã€‚ æœ€å¸¸è§çš„åº”ç”¨æ˜¯ï¼Œunion ä¸­çš„ä¸œè¥¿äº’æ–¥ï¼Œæ¯”å¦‚å®ç°æ¯”è¾ƒåŸºç¡€çš„åŠ¨æ€ç±»å‹ï¼š struct DynamicValue &#123; enum Type &#123; INT, DOUBLE, STRING &#125; type; union Data &#123; int i; double d; char* s; &#125; data; &#125;; å˜é•¿æ ˆå¸§å’Œ%rbpæœ‰æ—¶æˆ‘ä»¬ä¼šç”¨åˆ°é•¿åº¦ä¸å®šçš„æ•°ç»„ï¼Œæ¯”å¦‚ int coolArr(int n) &#123; int A[n]; // åšä¸€äº›cool things return A[0]; &#125; è¿™æ—¶æˆ‘ä»¬åœ¨è°ƒç”¨å‡½æ•°å‰æ˜¯æ— æ³•ç¡®å®šè¦ä¸ºå‡½æ•°åˆ†é…å¤šå°‘æ ˆç©ºé—´çš„ï¼Œç¼–è¯‘å‡ºæ¥çš„å‡½æ•°ä¼šå½¢å¦‚ collArr: pushq %rbp movq %rsp, %rbp ... # åšä¸€äº›cool things leave # ç­‰ä»·äº movq %rbp, %rsp; popq %rbp retq ç¼–è¯‘å™¨ä¼šç”¨ %rbp ä½œä¸ºåŸºæŒ‡é’ˆï¼ˆbase pointerï¼‰æ¥è®°å½•è¿›å…¥å‡½æ•°å‰çš„æ ˆæŒ‡é’ˆä½ç½®ï¼Œå¹¶åœ¨è¿”å›æ—¶å¤ä½ %rsp å’Œ %rbp çš„çŠ¶æ€ã€‚ æ”»å‡»ä¸é˜²å¾¡æ”»å‡»æœ€å¸¸è§çš„æ”»å‡»æ˜¯ç¼“å†²åŒºæº¢å‡ºæ”»å‡»ï¼ŒCSAPP é‡Œè®²äº†æ ˆæº¢å‡ºæ”»å‡»ï¼Œå…·ä½“å¯ä»¥çœ‹çœ‹ attacklab. è¿™å¯ä»¥åˆ†ä¸ºæ¤å…¥æ¶æ„ä»£ç å’Œ ROP æ”»å‡»ã€‚ é˜²å¾¡å¯¹æ ˆæº¢å‡ºçš„é˜²å¾¡æ‰‹æ®µä¸»è¦æœ‰æ ˆç ´åæ£€æµ‹ã€æ ˆéšæœºåŒ–ã€é™åˆ¶å¯æ‰§è¡Œä»£ç åŒºåŸŸã€‚ æœ€æœ‰æ•ˆçš„æ‰‹æ®µæ˜¯æ ˆç ´åæ£€æµ‹ï¼Œåªè¦ä½ ç ´åä¸äº†æ ˆï¼Œè‡ªç„¶å°±æ²¡åŠæ³•æ”»å‡»äº†ã€‚å¸¸ç”¨çš„æ‰‹æ®µæ˜¯é‡‘ä¸é›€å€¼ï¼Œå³åœ¨è°ƒç”¨å…è®¸ç”¨æˆ·ä¿®æ”¹æ ˆçš„å‡½æ•°æ—¶ï¼Œåœ¨æ ˆé‡Œæ”¾ä¸€ä¸ªéšæœºå€¼ï¼Œç„¶ååœ¨å‡½æ•°è¿”å›æ—¶åˆ¤æ–­è¿™ä¸ªå€¼æ˜¯å¦è¢«æ”¹å˜ã€‚ æ ˆéšæœºåŒ–æ˜¯æŒ‡æ¯æ¬¡è¿è¡Œä»£ç æ—¶ï¼Œæ ˆçš„åœ°å€éƒ½ä¸ä¸€æ ·ã€‚ é™åˆ¶å¯æ‰§è¡Œä»£ç åŒºåŸŸå¯ä»¥é˜²å¾¡æ¤å…¥æ¶æ„ä»£ç åˆ°æ ˆé‡Œï¼Œåªè¦ä¸å…è®¸æ‰§è¡Œæ ˆé‡Œçš„ä»£ç å°±è¡Œäº†ã€‚","categories":[{"name":"å…¬å¼€è¯¾","slug":"å…¬å¼€è¯¾","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/"},{"name":"CMU-15-213","slug":"å…¬å¼€è¯¾/CMU-15-213","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/CMU-15-213/"},{"name":"Notes","slug":"å…¬å¼€è¯¾/CMU-15-213/Notes","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/CMU-15-213/Notes/"}],"tags":[]},{"title":"Attackblabè®°å½•","slug":"learning/open-course/CMU-15-213/Labs/Attacklab","date":"2025-03-13T03:18:38.000Z","updated":"2025-08-22T03:14:43.978Z","comments":true,"path":"wiki/learning/open-course/CMU-15-213/Labs/Attacklab/","permalink":"http://rinevard.github.io/wiki/learning/open-course/CMU-15-213/Labs/Attacklab/","excerpt":"","text":"img{ width: 40%; } å†™åœ¨å‰é¢éå¸¸æœ‰è¶£çš„ labï¼åšäº†ä¸€å¤§åŠä»¥åæ„Ÿè§‰è‡ªå·±å·²ç»æ˜¯ super å—¨å®¢äº†ã€‚æˆ‘ä¸æ‰“ç®—åšæœ€åä¸€ä¸ªï¼Œæ¯•ç«Ÿè¯»æ±‡ç¼–æ¥åš ROP æ”»å‡»æŒºéº»çƒ¦çš„ï¼Œæˆ‘æ„Ÿè§‰è¿™å¯¹æˆ‘çš„æ°´å¹³æå‡ä¹Ÿä¸å¤§ï¼ˆè€Œä¸”æ‹¿åˆ° 95/100 æˆ‘å·²ç»å¾ˆæ»¡è¶³äº†ï¼‰ â€œWhy good people can only do good things and bad people can only do bad things? We bad people can do whatever we want.â€”â€”Evil Neuroâ€ æ”»å‡»attacklab çš„æ”»å‡»ä¸»è¦åˆ†ä¸ºæ¤å…¥æ”»å‡»ä»£ç å’Œ ROP æ”»å‡»ã€‚ æ¤å…¥æ”»å‡»ä»£ç æ”»å‡» 1æ”»å‡» 1 åªæ˜¯ç®€å•åœ°è®©æˆ‘ä»¬ç†Ÿæ‚‰ä¸€ä¸‹å·¥ä½œæµç¨‹ï¼Œæˆ‘ä»¬åªè¦è¦†å†™æ‰è¿”å›åœ°å€å°±å¥½äº†ã€‚ å¤§è‡´çš„æ”»å‡»æµç¨‹æ˜¯â€”â€”è·‘ä¸€ä¸‹ ctarget çœ‹çœ‹æˆ‘ä»¬å†™å…¥çš„å†…å®¹ä¼šè¢«æ”¾åœ¨æ ˆçš„å“ªä¸ªä½ç½®ï¼Œç†Ÿæ‚‰ä½ç½®ä»¥åæŠŠåå…­è¿›åˆ¶çš„æ”»å‡»å†…å®¹å†™åˆ°æŸä¸ª txt æ–‡ä»¶é‡Œï¼Œå†ç”¨ ./hex2raw &lt; rinevinput.txt &gt; evil è½¬æ¢ä¸ºè¾“å…¥å€¼ï¼Œæœ€åæŠŠè¾“å…¥å€¼ä¼ åˆ° ctarget å°±å®ç°äº†æ”»å‡»ã€‚ ä¸‹é¢ç»™ä¸€äº›å° hintsã€‚ æ³¨æ„, ä¸è¦æŠŠå†…å®¹å†™å…¥å½¢å¦‚ evil.txt è¿™æ ·çš„æœ‰æ ¼å¼çš„æ–‡ä»¶é‡Œ! è¿™å¯èƒ½ä¿®æ”¹ä¸€äº›ç‰¹æ®Šå­—ç¬¦ã€‚æˆ‘ä¹‹å‰å°±è¸©äº†è¿™ä¸ªå‘ã€‚ ä½¿ç”¨./ctarget -q &lt; evilæ¥è¿è¡Œï¼Œå› ä¸ºæˆ‘ä»¬ä¸èƒ½è¿æ¥åˆ° CMU æœåŠ¡å™¨ï¼ˆå”‰ï¼ŒCMUï¼‰. æ”»å‡» 2æ”»å‡» 2 å°±æ˜¯å…¸å‹çš„â€œæ¤å…¥æ”»å‡»ä»£ç â€äº†ã€‚ä¸€å¼€å§‹æˆ‘çš„æ€è·¯å¦‚ä¸‹å›¾ï¼š è¿™ç¡®å®èƒ½è·‘ï¼Œä¹Ÿç¡®å®é¡ºåˆ©æ‰§è¡Œäº† touch2ï¼Œä½†æ‰§è¡Œå®Œä¹‹åå‘ç”Ÿäº†segmentation faultï¼è¿™æ˜¯ä¸ºä»€ä¹ˆï¼Ÿæˆ‘è‡³ä»Šæ²¡æœ‰ææ¸…æ¥šï¼Œå¦‚æœæœ‰æœ‹å‹çŸ¥é“å¯ä»¥è·Ÿæˆ‘è¯´ä¸€ä¸‹ã€‚ä½†æˆ‘å¯ä»¥æ’é™¤ä¸€äº›ç–‘ç‚¹ã€‚ é¦–å…ˆï¼Œsegmentation fault ä¸æ˜¯å› ä¸ºæ ˆæŒ‡é’ˆè·‘åˆ°äº†é¢„æœŸä½ç½®ä¹‹å¤–ã€‚å› ä¸ºåœ¨ phase-2-level2 ä¸­ï¼Œæˆ‘ä»¬çš„æ ˆæŒ‡é’ˆè·‘å¾—è€è¿œäº†ã€‚ segmentation fault çš„å‘ç”Ÿå¤§æ¦‚ç‡æ˜¯å› ä¸ºæ ˆæŒ‡é’ˆæ²¡æœ‰å¯¹é½ã€‚ç»™èƒ½é€šè¿‡çš„ phase2-level2 å†åŠ ä¸€å¥ retï¼Œå°±é€ æˆäº† segmentation faultã€‚å†åœ¨é€ æˆäº† segmentation fault çš„åŸºç¡€ä¸Šå¤š ret ä¸€æ¬¡å°±åˆæ²¡æœ‰ segmentation fault äº†ã€‚ æ‰€ä»¥æˆ‘è§‰å¾—å¤§æ¦‚ç‡æ˜¯æ ˆæŒ‡é’ˆçš„å¯¹é½é—®é¢˜ã€‚é‚£æ ˆæŒ‡é’ˆï¼Œä½ ç©¶ç«Ÿè¯¥åœ¨å“ªé‡Œå‘¢ï¼Ÿ å›åˆ°æ”»å‡» 2ï¼Œæ—¢ç„¶æˆ‘ä»¬çŒœæµ‹æ˜¯æ ˆæŒ‡é’ˆå¯¹é½é—®é¢˜ï¼Œåªè¦è®©å®ƒå¯¹é½å°±è¡Œäº†ã€‚æˆ‘ä»¬å¾®è°ƒä¸€ä¸‹ï¼Œé€šè¿‡ push è®©æ ˆæŒ‡é’ˆçš„ä½ç½®åç§» 8ï¼Œç„¶åå°±é€šè¿‡äº†ã€‚ æ”»å‡» 3æ”»å‡» 3 å’Œæ”»å‡» 2 å·®ä¸å¤šï¼Œå”¯ä¸€è¦æ³¨æ„çš„æ˜¯ hexmatch å’Œ strncmp ä¼šè¦†å†™æ ˆï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æŠŠå­—ç¬¦ä¸²è—åœ¨æ›´ä¸‹é¢çš„ä½ç½®ï¼ˆå³æ ˆåœ°å€æ¯”è¾ƒå¤§çš„ä½ç½®ï¼‰ã€‚é€ æˆäº† segmentation fault æ€ä¹ˆåŠï¼Ÿæˆ‘ä»¬å·²ç»æœ‰äº†æ”»å‡» 2 çš„ç»éªŒï¼Œæ‰€ä»¥å€ŸåŠ© popï¼Œpushï¼Œret æ¥å¾®è°ƒä¸€ä¸‹æ ˆæŒ‡é’ˆä½ç½®å°±è¡Œã€‚ ä½œä¸š PDF é‡Œè¿˜æåˆ°ï¼Œâ€Make position of check string unpredictableâ€ã€‚è¿™æœ‰ä»€ä¹ˆæ„ä¹‰ï¼Ÿæˆ‘çŒœæ˜¯ä¸ºäº†é˜²æ­¢æˆ‘ä»¬æŠŠ sval æŒ‡å‘ cbuf æ¥å®ç°æ”»å‡»ï¼Œè¿™æˆ–è®¸ä¸ç¬¦åˆ attacklab çš„ä¸–ç•Œè§‚ï¼Œå› ä¸ºè¿å­—ç¬¦ä¸²éƒ½ä¸ç”¨æ³¨å…¥äº†ã€‚ ROP æ”»å‡»æ”»å‡» 4æˆ‘æ˜¯ç¬¨è›‹ï¼Œåˆè¸©äº†ä¸€ä¸ªå‘ã€‚è€ƒè™‘æŒ‡ä»¤ 4017fc: 3b 3d e2 3c 20 00 cmp 0x203ce2(%rip),%edi # 6054e4 &lt;cookie&gt; 401802: 75 20 jne 401824 &lt;touch2+0x38&gt; åœ¨æ‰§è¡Œ cmp æŒ‡ä»¤æ—¶ï¼šRIP çš„å€¼æ˜¯ 0x401802ï¼Œè€Œä¸æ˜¯ 0x4017fcã€‚æˆ‘ä¹‹å‰è¿˜æƒ³äº†åŠå¤©ä¸ºä»€ä¹ˆæˆ‘ä»¬èƒ½æŒ‡å‘ cookieã€‚ å›åˆ°é¢˜ç›®ä¸Šæ¥ï¼Œæ ¹æ®æç¤ºï¼Œæˆ‘ä»¬è¦ç”¨ movï¼Œpopï¼Œretï¼Œé‚£ä¹ˆæ€è·¯æ˜¯å†™å…¥ cookie åˆ°æ ˆä¸­ï¼Œpop å®ƒåˆ°æŸä¸ªåœ°æ–¹ï¼ˆaddval_219 æœ‰ pop %raxï¼‰ï¼Œæœ€åç§»åŠ¨åˆ° rdi ä¸­ï¼ˆaddval_273 æœ‰ movl %eax %ediï¼‰ æˆ‘ä»¬åœ¨æ”»å‡» 2 é‡Œå·²ç»è®¨è®ºè¿‡ segmentation fault çš„å‘ç”ŸåŸå› ï¼Œæœ€åˆç†çš„çŒœæµ‹æ˜¯æ ˆæŒ‡é’ˆçš„å¯¹é½é—®é¢˜ã€‚æ‰€ä»¥å¦‚æœå‘ç”Ÿäº† segmentation faultï¼Œæ‰¾ä¸ª ret å†ç”¨ä¸€ä¸‹å°±è¡Œäº†ã€‚ æ”»å‡» 5æ²¡åšï¼Œwe bad people can do whatever we wantï¼","categories":[{"name":"å…¬å¼€è¯¾","slug":"å…¬å¼€è¯¾","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/"},{"name":"CMU-15-213","slug":"å…¬å¼€è¯¾/CMU-15-213","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/CMU-15-213/"},{"name":"Labs","slug":"å…¬å¼€è¯¾/CMU-15-213/Labs","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/CMU-15-213/Labs/"}],"tags":[]},{"title":"æŠ€å·§çš„åˆ†ç±»ï¼Œå†°å±±ä¹‹ä¸‹çš„æ·±åº¦","slug":"game-design/å†°å±±ä¹‹ä¸‹çš„æ·±åº¦","date":"2025-03-08T04:22:38.000Z","updated":"2025-08-20T11:13:48.877Z","comments":true,"path":"wiki/game-design/å†°å±±ä¹‹ä¸‹çš„æ·±åº¦/","permalink":"http://rinevard.github.io/wiki/game-design/%E5%86%B0%E5%B1%B1%E4%B9%8B%E4%B8%8B%E7%9A%84%E6%B7%B1%E5%BA%A6/","excerpt":"","text":"img{ width: 70%; } ã€Šä½“éªŒå¼•æ“ã€‹é‡Œæåˆ°ï¼Œâ€œæ·±åº¦æ¸¸æˆèƒ½å¤Ÿé€šè¿‡é«˜æ°´å¹³çš„æŠ€å·§åˆ›é€ æœ‰æ„ä¹‰çš„ç©æ³•ã€‚æ·±åº¦ï¼ˆdepthï¼‰è¿™ä¸ªæ¦‚å¿µç”¨äºæè¿°æ¸¸æˆä¸­éœ€è¦å­¦ä¹ çš„å†…å®¹æœ‰å¤šå°‘ã€‚â€åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°†æ¢è®¨ä¸€ä¸‹å¦‚ä½•å¯¹æŠ€å·§çš„ç±»å‹è¿›è¡ŒåŒºåˆ†ï¼Œä»¥åŠå¦‚ä½•åˆ›é€ è¿™äº›æŠ€å·§æ¥æé«˜æ¸¸æˆæ·±åº¦ï¼ŒåŒæ—¶ä¸è®©æ¸¸æˆé—¨æ§›è¿‡é«˜ã€‚ æ—¢ç„¶è¦æ±‚æœ‰æ·±åº¦ï¼Œé‚£æ¸¸æˆé‡Œå¿…ç„¶æœ‰å¾ˆå¤šæŠ€å·§ã€‚æˆ‘ä»¬æœ‰å¿…è¦å¯¹æŠ€å·§åšä¸€ä¸ªåŒºåˆ†â€”â€”æŠ€å·§å¯ä»¥è¢«åˆ†ä¸ºâ€œè§„åˆ™æ¶Œç°çš„æŠ€å·§â€å’Œâ€œé¢„è®¾çš„æŠ€å·§â€ã€‚å›´æ£‹çš„å„ç§æŠ€å·§å°±æ˜¯å‰è€…çš„ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ï¼ˆuh actuallyâ˜ï¸ğŸ¤“ æ•°å­¦æ˜¯æ›´å¥½çš„ä¾‹å­ï¼‰ï¼Œè€Œâ€œç‚¸å¼¹èƒ½ç‚¸å¼€æœ‰è£‚ç¼çš„å¢™â€å°±æ˜¯åè€…çš„ä¸€ä¸ªä¾‹å­ã€‚ åŸºäºè§„åˆ™çš„æŠ€å·§åˆ›é€ â€œåŸºäºè§„åˆ™çš„æŠ€å·§â€æ˜¯ç›¸å¯¹å›°éš¾çš„ï¼Œå› ä¸ºè¿™è¦æ±‚æˆ‘ä»¬åˆ›é€ èƒ½æ¶Œç°å‡ºè®¸å¤šæŠ€å·§çš„è§„åˆ™ã€‚è¿™ç§çº¯ç²¹çš„åˆ›é€ æ€§æ´»åŠ¨ææ€•æ²¡æœ‰ä»€ä¹ˆç»éªŒå¯ä»¥å†™ï¼Œæˆ‘èƒ½è¯´çš„ä¹Ÿåªæ˜¯å¤šå»å­¦å­¦ä¸åŒé¢†åŸŸçš„çŸ¥è¯†ã€‚å¦‚æœè¦åšå‡ºæœ‰çµæ€§çš„è§„åˆ™ï¼Œå½“ç„¶ä¸èƒ½åªæ˜¯ç©å„ä¸ªæ¸¸æˆå¹¶å°è¯•â€œå­¦ä¹ ç»éªŒâ€ï¼ˆä½ å­¦çš„éƒ½æ˜¯åˆ«äººåšè¿‡çš„è§„åˆ™ï¼ï¼‰ï¼Œè€Œæ˜¯è¦æ›´å¤šå»çœ‹çœ‹è‡ªå·±ä»æœªè§è¿‡çš„é¢†åŸŸã€‚æ¯”å¦‚è¯´ï¼Œæ¯”èµ·ç›¯ç€ã€Šbaba is youã€‹å­¦ï¼Œä¸å¦‚å»å­¦å­¦ç¼–ç¨‹ã€‚ç¼–ç¨‹çš„â€œèµ‹å€¼â€è¢« baba åšæ‰äº†ï¼Œä½†ç¼–ç¨‹çš„â€œè¯­å¥æ‰§è¡Œé¡ºåºâ€æ˜¯ä¸æ˜¯å°±å¯ä»¥åšæˆ noita çš„é­”æ–ï¼Ÿç¼–ç¨‹çš„â€œæŠ½è±¡â€æ€æƒ³ä¼šä¸ä¼šä¹Ÿå¯ä»¥åšæˆå¦ä¸€ä¸ªæœ‰è¶£çš„è§„åˆ™ï¼Ÿ è™½ç„¶è¯´â€œè¿™ç§åˆ›é€ æ€§æ´»åŠ¨ææ€•æ²¡ä»€ä¹ˆç»éªŒå¯å†™â€ï¼Œä½†è¿˜æ˜¯å†™äº†ä¸€å †ä¸œè¥¿ã€‚æˆ‘ç¡®å®å¯¹åŸºäºè§„åˆ™çš„æŠ€å·§æ›´æ„Ÿå…´è¶£ï¼Œè¿™å®Œç¾å®ç°äº†â€œå†°å±±ä¹‹ä¸‹çš„æ·±åº¦â€ï¼ˆæˆ‘åœ¨è¿™é‡Œç‚¹é¢˜äº†ï¼ï¼‰ã€‚ä¸è¿‡æ¥ä¸‹æ¥æˆ‘ä»¬è¿˜æ˜¯èŠèŠæ²¡æœ‰çµæ„Ÿæ—¶ä¹Ÿèƒ½åšçš„ä¸œè¥¿å§ã€‚ é¢„è®¾çš„æŠ€å·§æ¯”èµ·åˆ›é€ åŸºäºè§„åˆ™çš„æŠ€å·§ï¼Œåˆ›é€ é¢„è®¾çš„æŠ€å·§åˆ™ç®€å•å¾ˆå¤šã€‚æˆ‘ä»¬å¯ä»¥éšä¾¿å£èƒ¡ä¸€äº›é¢„è®¾çš„æŠ€å·§ï¼Œæ¯”å¦‚â€œåœŸç‹¼è·³â€ã€â€œæ”»å‡»è¿‡ç¨‹ä¸­æŒ‰å†²åˆºèƒ½å–æ¶ˆæ”»å‡»â€ã€â€œåœ¨å¼€å¯æŠ€èƒ½çš„å‰æ‘‡æ—¶ç§»åŠ¨æ¥æ¶ˆé™¤å‰æ‘‡è€Œç›´æ¥å¼€å¯æŠ€èƒ½â€ï¼ˆå”‰ï¼Œå–æ¶ˆï¼‰ï¼Œå®é™…ä¸Šä¸ºäº†ä¿è¯æ‰‹æ„Ÿï¼Œå‡ ä¹æ‰€æœ‰æ¸¸æˆéƒ½ç”¨äº†å¤§é‡çš„é¢„è®¾çš„æŠ€å·§ã€‚å¯¹é¢„è®¾çš„æŠ€å·§æ¥è¯´ï¼Œå®é™…éš¾ç‚¹åœ¨äºå¦‚ä½•æŠŠæ·±åº¦è—åœ¨å†°å±±ä¹‹ä¸‹ï¼Œä¸è®©ç©å®¶å› ç›´é¢å¤§é‡æŠ€å·§è€Œæ„Ÿåˆ°æ— æ‰€é€‚ä»ã€‚ æŠŠæ·±åº¦è—åœ¨å†°å±±ä¹‹ä¸‹å¬ç€å¾ˆé«˜å¤§ä¸Šï¼Œå®é™…ä¸Šæœ€å¥½ç”¨çš„è—æ·±åº¦çš„åšæ³•å°±æ˜¯æŠŠé¢„è®¾çš„æŠ€å·§é€æ¸å‘ˆç°ç»™ç©å®¶ã€‚æ¯è¿‡å‡ å…³ç»™ç©å®¶ä¸€ä¸ªæ–°èƒ½åŠ›å°±æ˜¯è¿™ç§åšæ³•ã€‚æ›´å·§å¦™çš„åšæ³•æ˜¯æŠŠå¤šä¸ªé¢„è®¾çš„æŠ€å·§èå…¥åˆ°åŒä¸€ä¸ªæ“ä½œä¹‹ä¸­ï¼Œç”¨æ°å½“çš„å…³å¡è®¾è®¡è®©æŠ€å·§é€æ¸å‘ˆç°å‡ºæ¥ã€‚å…¸å‹çš„ä¾‹å­æ˜¯ã€Šé—°è·ƒä¹‹å¹´ã€‹ï¼Œå¼€å±€è·³ä¸€ä¸‹å°±æ­»äº†ï¼Œé‚£æ€æ ·è·³æ‰èƒ½æ´»ä¸‹æ¥å‘¢ï¼Ÿè¿™å°±æ˜¯è¢«è—åœ¨å†°å±±ä¸‹çš„é¢„è®¾çš„æŠ€å·§äº†ã€‚ æœ‰çš„æ¸¸æˆè¿˜ä¼šæŠŠé¢„è®¾çš„æŠ€å·§ä¼ªè£…æˆè§„åˆ™æ¶Œç°çš„æŠ€å·§ï¼Œè¿™è®©æŠ€å·§æ˜¾å¾—æ›´ä¼˜é›…ï¼Œä½†å®é™…ä¸Šä¸æ˜¯å¾ˆæœ¬è´¨çš„æ”¹è¿›ã€‚å›´ç»•ä¸€ä¸ªæ‘¸æ£±ä¸¤å¯çš„ä¸»é¢˜è®¾è®¡ä¸€äº›é¢„è®¾çš„æŠ€å·§ï¼Œå°±èƒ½åšåˆ°è¿™ä¸€ç‚¹ã€‚æˆ‘èƒ½æƒ³åˆ°çš„æœ€å¥½çš„ä¾‹å­å°±æ˜¯ã€Šè”šè“ã€‹ã€‚è”šè“æŠŠè¹­å¢™è·³ã€å‡Œæ³¢å¾®æ­¥è¿™äº›é¢„è®¾çš„æŠ€å·§è—åœ¨äº†â€œæƒ¯æ€§â€çš„åé¢ï¼Œè®©å„ä¸ªæŠ€å·§çœ‹èµ·æ¥éƒ½æ˜¯æ¶Œç°çš„ã€‚è™½ç„¶è¿™äº›æŠ€å·§çœ‹èµ·æ¥éƒ½å’Œæƒ¯æ€§æœ‰è”ç³»ï¼Œä½†å®é™…ä¸Šç©å®¶å¹¶ä¸èƒ½æ ¹æ®è§„åˆ™æœ¬èº«æ¨ç†å‡ºè¿™äº›æŠ€å·§çš„å­˜åœ¨ï¼Œå› æ­¤è¿™æ˜¯â€æŠŠé¢„è®¾çš„æŠ€å·§ä¼ªè£…æˆè§„åˆ™æ¶Œç°çš„æŠ€å·§â€œã€‚ ç»“å°¾åŸºäºè§„åˆ™çš„æŠ€å·§å’Œé¢„è®¾çš„æŠ€å·§å¹¶éæˆªç„¶å¯¹ç«‹ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éƒ½é€æ¸å­¦åˆ°æ‰€æœ‰çš„é¢„è®¾çš„æŠ€å·§ï¼Œå†æŠŠé¢„è®¾çš„æŠ€å·§ä½œä¸ºè§„åˆ™ç»„åˆèµ·æ¥å½¢æˆåŸºäºè§„åˆ™çš„æŠ€å·§ã€‚ è¿˜è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ç§æŠ€å·§çš„åŒºåˆ†æ˜¯åœ¨å‘ˆç°ç»™ç©å®¶çš„å±‚é¢ä¸Šï¼Œè€Œéåœ¨å®ç°å±‚é¢ä¸Šã€‚å¦‚æœä½ ç¡¬ç¼–ç å‡º noita çš„æ‰€æœ‰å¯èƒ½çš„æ³•æœ¯æ­é…å¹¶å†™å‡ºå¯¹åº”æ•ˆæœï¼Œè¿™åœ¨å®ç°å±‚é¢ä¸Šæ˜¾ç„¶æ˜¯â€œé¢„è®¾â€çš„ï¼Œä½†å¯¹ç©å®¶æ¥è¯´ï¼Œè¿™ä»ç„¶æ˜¯â€œåŸºäºè§„åˆ™â€çš„ï¼Œæ¯•ç«Ÿç©å®¶å¯ä»¥åŸºäºè§„åˆ™æ¨ç†å‡ºå¯èƒ½çš„æŠ€å·§ã€‚ç›¸è¾ƒè€Œè¨€ï¼Œå¦‚æœæˆ‘ä»¬è®¾è®¡ä¸€ä¸ªå’Œæ³•æœ¯ç›¸å…³çš„æ¸¸æˆï¼Œæ¯ä¸ªæ³•æœ¯åœ¨ä»£ç å±‚é¢ä¸Šéƒ½æ˜¯å‡ ä¸ªå°æ³•æœ¯çš„ç»„åˆï¼Œä½†ç©å®¶çœ‹åˆ°çš„åªæ˜¯ç»„åˆå¥½çš„å„ä¸ªæ³•æœ¯è€Œä¸èƒ½è‡ªå·±å»ç»„åˆæ³•æœ¯ï¼Œè¿™åœ¨å®ç°å±‚é¢ä¸Šæ˜¯â€œåŸºäºè§„åˆ™â€çš„ï¼Œä½†å¯¹ç©å®¶æ¥è¯´æ˜¯â€œé¢„è®¾â€çš„ã€‚ å¤šè¯´ä¸€å¥ï¼Œâ€œåœ¨å®ç°å±‚é¢ä¸ŠåŸºäºè§„åˆ™ï¼Œä½†å‘ˆç°å‡ºæ¥çš„æ•ˆæœæ˜¯é¢„è®¾çš„â€å®é™…ä¸Šæ˜¯å¾ˆé€‚åˆåšæˆæ¢ç´¢ç±»æ¸¸æˆçš„ã€‚æ ¸å¿ƒæ€è·¯æ˜¯ï¼Œé¦–å…ˆæŠŠå¤§é‡çš„é¢„è®¾çš„ç°è±¡å‘ˆç°ç»™ç©å®¶ï¼Œå†è®©ç©å®¶é€æ­¥æ¢ç´¢ç°è±¡èƒŒåçš„è§„åˆ™ã€‚è¿™ç§æ€è·¯åœ¨åˆ«çš„æ¸¸æˆé‡Œä¹Ÿæœ‰ï¼Œä¸è¿‡å…¨æ˜¯è§£è°œæ¸¸æˆï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥åšä¸€ä¸ªæ›´æœ‰è¶£çš„æ¢ç´¢ç±»æ¸¸æˆã€‚æ¯”å¦‚è¯´ç©å®¶çœ‹åˆ°äº†ç«çƒæœ¯ï¼Œä¹‹åæˆ‘ä»¬é€æ¸å¼•å¯¼ç©å®¶å‘ç°ç«çƒæœ¯æœ¬è´¨ä¸Šæ˜¯ç«ç„°é­”æ³•+ç§»åŠ¨é­”æ³•ï¼Œç©å®¶å°±èƒ½è¿›è€ŒåŸºäºè§„åˆ™æ„å»ºå‡ºæ–°é­”æ³•äº†ã€‚","categories":[{"name":"æ¸¸æˆè®¾è®¡","slug":"æ¸¸æˆè®¾è®¡","permalink":"http://rinevard.github.io/categories/%E6%B8%B8%E6%88%8F%E8%AE%BE%E8%AE%A1/"}],"tags":[]},{"title":"ç¬¬äºŒç« â€”â€”è®¡ç®—æœºå†…çš„ä¿¡æ¯è¡¨ç¤º","slug":"learning/open-course/CMU-15-213/Notes/Chapter2-data-representation","date":"2025-03-03T10:36:28.000Z","updated":"2025-08-22T03:14:43.982Z","comments":true,"path":"wiki/learning/open-course/CMU-15-213/Notes/Chapter2-data-representation/","permalink":"http://rinevard.github.io/wiki/learning/open-course/CMU-15-213/Notes/Chapter2-data-representation/","excerpt":"","text":"æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨ 32 ä½æœºå™¨ä¸Šå’Œ 64 ä½æœºå™¨ä¸Šï¼Œç›¸åŒçš„ C è¯­è¨€æ•°æ®ç±»å‹å¯èƒ½å ç”¨ä¸åŒçš„å­—èŠ‚æ•°ï¼š C declaration Bytes Signed Unsigned 32-bit 64-bit [signed] char unsigned char 1 1 short unsigned short 2 2 int unsigned 4 4 long unsigned long 4 8 int32_t uint32_t 4 4 int64_t uint64_t 8 8 char * 4 8 float 4 4 double 8 8 æ•´æ•°è¡¨ç¤ºæ•´æ•°çš„è¡¨ç¤ºå¯ä»¥åˆ†ä¸º unsigned å’Œ signedï¼Œå‰è€…åªèƒ½è¡¨ç¤ºéè´Ÿæ•°ï¼Œåè€…å¯ä»¥è¡¨ç¤ºæ•´æ•°ã€‚ä¸‹é¢æ˜¯å„ä¸ªæ•´æ•°ç±»å‹å ç”¨çš„å­—èŠ‚æ•°ï¼š C declaration Bytes Signed Unsigned 32-bit 64-bit short unsigned short 2 2 int unsigned 4 4 long unsigned long 4 8 ä¼—æ‰€å‘¨çŸ¥ï¼Œsigned çš„è¡¨ç¤ºé‡‡ç”¨è¡¥ç è¡¨ç¤ºï¼Œå°±æ˜¯æ¨¡ $2^m$ æ„ä¹‰ä¸‹å¯¹åº”çš„æœ€å°æ­£æ•°çš„äºŒè¿›åˆ¶è¡¨ç¤ºï¼Œå…¶ä¸­ $m$ æ˜¯è€—è´¹çš„ bits æ•°ã€‚ ä¸‹é¢çš„ä¾‹å­ä¸­ç±»å‹æ˜¯ signed shortï¼Œ$15213$ çš„è¡¨ç¤ºå°±æ˜¯å®ƒçš„äºŒè¿›åˆ¶è¡¨ç¤ºï¼Œè€Œ $-15213$ çš„è¡¨ç¤ºå®é™…ä¸Šæ˜¯ $-15213 + 2^{16}$ çš„äºŒè¿›åˆ¶è¡¨ç¤ºã€‚ Decimal Hex Binary x 15213 3B 6D 00111011 01101101 y -15213 C4 93 11000100 10010011 è®©æˆ‘ä»¬å‡è®¾äºŒè¿›åˆ¶è¡¨ç¤ºä¸º $b{w-1},b{w-2},â€¦,b_1,b_0$ï¼Œé‚£ä¹ˆå¦‚æœæ˜¯ unsignedï¼Œå…¶å€¼ä¸º \\sum_{k=0}^{w-1}2^{k}b_kå¦‚æœæ˜¯ signedï¼Œå½“ $b_{w-1}$ å³æœ€é«˜ä½ä¸ä¸º 1 æ—¶ï¼ŒæŠŠäºŒè¿›åˆ¶è½¬æ¢æˆåè¿›åˆ¶å³å¯ã€‚ å½“æœ€é«˜ä½ä¸º 1 æ—¶ï¼Œå…¶å€¼ä¸º -2^{w}+\\sum_{k=0}^{w-1}2^{k}b_kä¸éš¾æ³¨æ„åˆ°èƒ½è¡¨ç¤ºçš„æ•´æ•°æœ‰ä¸Šä¸‹é™ï¼Œå‚è€ƒä¸‹è¡¨ï¼š Signed Unsigned 64-bit short [-32768, 32767] unsigned short [0, 65535] 2 int [-2^31, 2^31-1] unsigned int [0, 2^32-1] 4 long [-2^63, 2^63-1] unsigned long [0, 2^64-1] 8 åŠ æ³•ï¼Œä¹˜æ³•ï¼Œå·¦å³ç§»åŠ æ³•å’Œä¹˜æ³•å°±æ˜¯æ¨¡æ„ä¹‰ä¸‹çš„åŠ æ³•å’Œä¹˜æ³•ï¼Œæ‰€ä»¥ä½ å–œæ¬¢çš„è¿ç®—è§„å¾‹éƒ½ç¬¦åˆã€‚â€œæº¢å‡ºâ€ä¹Ÿåªæ˜¯æ¨¡äº†ä¸€ä¸‹ã€‚ è€Œå·¦å³ç§»å‘¢ï¼Ÿå·¦ç§»ä¸éš¾ç†è§£ï¼ŒæŠŠå®ƒçš„è¡¨ç¤ºç»Ÿä¸€å¾€å·¦è¾¹ç§»åŠ¨ï¼Œç§»å‡ºèŒƒå›´äº†å°±æ‰”æ‰ï¼Œæœ€ä½ä½å¡«å…… 0. x &lt;&lt; m å®é™…ä¸Šæ˜¯åœ¨åš $2^{m}x(\\text{mod $2^w$})$. å³ç§»åˆ™åˆ†ä¸ºé€»è¾‘å³ç§»å’Œç®—æœ¯å³ç§»ï¼Œå‰è€…æ˜¯åœ¨å³ç§»ååœ¨æœ€é«˜ä½ä¸Šå¡«å…… 0ï¼Œåè€…åœ¨æœ€é«˜ä½ä¸Šå¡«å……ç¬¦å·ä½ã€‚ å¯¹ unsigned æ¥è¯´å®ƒä»¬æ²¡æœ‰åŒºåˆ«ï¼Œæ¯•ç«Ÿ unsigned ä¸è€ƒè™‘ç¬¦å·ï¼Œä½†å¯¹ signed æ¥è¯´å°±ä¸ä¸€æ ·äº†ã€‚ å¤§å¤šæ•° C ç¼–è¯‘å™¨å¯¹æœ‰ç¬¦å·æ•´æ•°å®ç°çš„æ˜¯ç®—æœ¯å³ç§»ï¼Œx &gt;&gt; m å®é™…ä¸Šæ˜¯åœ¨åš $\\lfloor \\frac{x}{2^m} \\rfloor$. ä¸åŒç±»å‹çš„æ•´æ•°ä¸€èµ·è¿ç®—ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿæ ¸å¿ƒæ€æƒ³æ˜¯ï¼Œåœ¨å°½é‡ä¿è¯å€¼ä¸å˜çš„å‰æä¸‹æŠŠæ•°è¿›è¡Œæ‰©å±•ã€‚ æŠŠä¸€ä¸ª signed short æ•´æ•°å’Œ signed int ç›¸åŠ ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿæˆ‘ä»¬ä¼šè¿›è¡Œâ€œç¬¦å·æ‰©å±•â€ï¼ŒæŠŠ signed short æ‰©å±•æˆ signed int å†åšåŠ æ³•ï¼Œè¿”å›ä¸€ä¸ª signed intã€‚ é‚£ï¼Œä»€ä¹ˆæ˜¯ç¬¦å·æ‰©å±•å‘¢ï¼Ÿå¦‚æœ short å€¼æ˜¯æ­£æ•°ï¼Œé«˜ä½ä¼šç”¨ 0 å¡«å……ï¼›å¦‚æœæ˜¯è´Ÿæ•°ï¼Œé«˜ä½ä¼šç”¨ 1 å¡«å……ï¼ˆç¬¦å·æ‰©å±•ï¼‰ã€‚uh actually ğŸ¤“â˜ï¸ è¿™æ˜¯åœ¨ä¿è¯å€¼ä¸å˜çš„å‰æä¸‹æŠŠ short è½¬æ¢æˆ intã€‚ æŠŠä¸€ä¸ª unsigned int æ•´æ•°å’Œ signed long ç›¸åŠ ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿæˆ‘ä»¬ä¼šæŠŠ unsigned int æ‰©å±•ä¸º signed longï¼ˆå³åœ¨å‰é¢åŠ  0ï¼‰å†åšåŠ æ³•ï¼Œè¿”å›ä¸€ä¸ª signed longã€‚ å½“ç„¶ï¼Œä¹Ÿæœ‰ä¸èƒ½ä¿è¯å€¼ä¸å˜çš„æƒ…å†µã€‚æ¯”å¦‚ unsigned int å’Œ signed int ç›¸åŠ æ—¶ï¼Œæˆ‘ä»¬ä¼šæŠŠ signed è½¬æ¢æˆ unsigned å†æ±‚å’Œã€‚ æ‰€ä»¥è¯´ï¼Œæ‹œæ‰˜ä¸è¦å†™è¿™ç§å¥‡æ€ªçš„ä»£ç ï¼š signed int a = -1; unsigned int b = 1; if (a &lt; b) &#123; printf(\"a &lt; b\\n\"); &#125; else &#123; printf(\"a >= b\\n\"); &#125; ä¸Šé¢çš„ä»£ç ä¼šè¾“å‡º $a\\geq b$ï¼Œä½ è¿™æ˜¯åœ¨ç ´åæ•°å­¦çš„ä¸–ç•Œè§‚ï¼ æ³¨æ„äº‹é¡¹unsigned å¾ˆå¯èƒ½é€ æˆé”™è¯¯ã€‚å¯¹ä¸‹é¢çš„ä»£ç ï¼Œä½ è§‰å¾—å“ªä¸ªæ˜¯å¯¹çš„ï¼Ÿ unsigned i; for (i = cnt-2; i &lt; cnt; i--) a[i] += a[i+1] unsigned i; for (i = cnt-2; i >= 0; i--) a[i] += a[i+1] ç­”æ¡ˆæ˜¯å‰è€…ï¼Œå› ä¸ºå¯¹åè€…æ¥è¯´ï¼Œi = 0 ä»¥å i-- ä¼šè®© i æº¢å‡ºå˜ä¸ºæ­£æ•°ï¼Œå¯¼è‡´æ— é™å¾ªç¯ã€‚ åæ­£ä¸è¦å†™è¿™æ ·çš„ä»£ç ï¼Œä½ è¿™æ˜¯åœ¨ç ´åæ•°å­¦çš„ä¸–ç•Œè§‚ï¼ æµ®ç‚¹æ•°è¡¨ç¤ºæŒ‰ç…§ IEEE æ ‡å‡†ï¼Œæµ®ç‚¹æ•°çš„è¡¨ç¤ºå¦‚ä¸‹ï¼š å…¶ä¸­ s æ˜¯ç¬¦å·ä½ï¼Œ0 è¡¨ç¤ºæ­£æ•°ï¼Œ1 è¡¨ç¤ºè´Ÿæ•° è®¡ç®—æ–¹å¼å¤§è‡´ä¸º (-1)^s \\times 2^{\\text{exp}-\\text{bias}}\\times(1\\text{.frac})ä¹‹æ‰€ä»¥è¯´æ˜¯â€œå¤§è‡´â€ï¼Œæ˜¯å› ä¸ºè¿˜å­˜åœ¨å‡ ç§ç‰¹æ®Šæƒ…å†µã€‚ å¦‚æœ exp å…¨æ˜¯ 0ï¼Œæˆ‘ä»¬ç§°å…¶ä¸ºéè§„æ ¼åŒ–æ•°ï¼ˆdenormalizedï¼‰ï¼Œä½¿ç”¨ä¸‹é¢çš„å…¬å¼è®¡ç®—ï¼š (-1)^s \\times 2^{1-\\text{bias}}\\times(1\\text{.frac})å¦‚æœ exp å…¨æ˜¯ 1ï¼Œfrac å…¨æ˜¯ 0ï¼Œæˆ‘ä»¬è®¤ä¸ºè¡¨ç¤ºçš„æ˜¯ infin. è‡³äºæ˜¯ $+\\inf$ è¿˜æ˜¯ $-\\inf$ ç”±ç¬¦å·ä½å†³å®šã€‚ å¦‚æœ exp å…¨æ˜¯ 1ï¼Œfrac ä¸ä¸º 0ï¼Œè¡¨ç¤º NaNï¼ˆnot a numberï¼‰. çœ‹èµ·æ¥ç¡®å®æ˜¯å¾ˆå¥‡æ€ªçš„æ ‡å‡†ï¼è¿™æ¶Œç°å‡ºçš„ç»“æœæ˜¯ï¼Œèƒ½è¡¨ç¤ºçš„å€¼åœ¨é è¿‘ 0 çš„ä½ç½®æ¯”è¾ƒå¯†é›†ï¼Œåœ¨è¿œç¦» 0 çš„ä½ç½®æ¯”è¾ƒç¨€ç–ã€‚ï¼ˆä¸‹å›¾ä»¥ exp å  3 bitsï¼Œfrac å  2 bits ä¸ºä¾‹ï¼‰ èˆå…¥ï¼ˆå››èˆäº”å…¥ï¼‰æ—¢ç„¶æµ®ç‚¹æ•°çš„è¡¨ç¤ºè¿™ä¹ˆå¥‡æ€ªï¼Œé‚£å¦‚æœæˆ‘æŠŠä¸¤ä¸ªæµ®ç‚¹æ•°ç›¸åŠ ï¼Œæ˜¯ä¸æ˜¯å¯èƒ½å¾—åˆ°ä¸ç²¾ç¡®çš„ç»“æœï¼ŸçœŸèªæ˜ï¼Œç¡®å®å¦‚æ­¤ï¼æˆ‘ä»¬ä¸€èˆ¬é‡‡å–â€œround-to-evenâ€çš„ç­–ç•¥ï¼Œå³å…ˆè€ƒè™‘èˆå…¥åˆ°æ›´è¿‘çš„é‚£ä¸ªæ•°ï¼Œå¦‚æœä¸¤ä¸ªæ•°ä¸€æ ·è¿‘ï¼ŒæŠŠå¾—åˆ°çš„ç»“æœå‘ç€æ›´â€œå¶æ•°â€çš„æ–¹å‘å»èˆå…¥ï¼Œå¯¹äºŒè¿›åˆ¶è¡¨ç¤ºæ¥è¯´ï¼Œå°±æ˜¯å¸Œæœ›å®ƒè¢«èˆå…¥åˆ°ç»“å°¾ä¸º 0 çš„é‚£ä¸ªæ•°ä¸Š. æ¥ä¸ªä¾‹å­ï¼š 10.000112 10.002 (1/2â€”up)10.111002 11.002 ( 1/2â€”up)10.101002 10.102 ( 1/2â€”down) ä¸»è¦å¥½å¤„æ˜¯å‡å°‘ç»Ÿè®¡åå·®ã€‚å¦‚æœæˆ‘ä»¬é‡‡å– round upï¼Œåœ¨ç»Ÿè®¡æ—¶ç»Ÿè®¡å‡ºçš„å€¼å¯èƒ½åé«˜ï¼›å¦‚æœé€‰æ‹© round downï¼Œç»Ÿè®¡å‡ºçš„å€¼å¯èƒ½åä½ã€‚ åŠ æ³•ï¼Œä¹˜æ³•æµ®ç‚¹æ•°çš„åŠ æ³•å’Œä¹˜æ³•æ€§è´¨å¹¶ä¸è‰¯å¥½ï¼Œæˆ‘ç›´æ¥æŠŠè¯¾ä»¶å¤åˆ¶è¿‡æ¥å§ï¼š æµ®ç‚¹æ•°åŠ æ³•ï¼š å°é—­æ€§ï¼šæ˜¯ ä½†å¯èƒ½ç”Ÿæˆæ— ç©·å¤§(infinity)æˆ–éæ•°å€¼(NaN) äº¤æ¢å¾‹ï¼šæ˜¯ a + b = b + a ç»“åˆå¾‹ï¼šå¦ ç”±äºæº¢å‡ºå’Œèˆå…¥çš„ä¸ç²¾ç¡®æ€§ ä¾‹å¦‚ï¼š(3.14+1e10)-1e10 = 0ï¼Œè€Œ 3.14+(1e10-1e10) = 3.14 é›¶å…ƒç´ ï¼šæ˜¯ 0 æ˜¯åŠ æ³•å•ä½å…ƒ é€†å…ƒç´ ï¼šå‡ ä¹æ˜¯ é™¤äº†æ— ç©·å¤§å’Œ NaN å¤–ï¼Œæ¯ä¸ªå…ƒç´ éƒ½æœ‰åŠ æ³•é€†å…ƒ å•è°ƒæ€§ï¼šå‡ ä¹æ˜¯ a â‰¥ b â‡’ a+c â‰¥ b+c ä½†å¯¹æ— ç©·å¤§å’Œ NaN ä¾‹å¤– æµ®ç‚¹æ•°ä¹˜æ³•ï¼š å°é—­æ€§ï¼šæ˜¯ ä½†å¯èƒ½ç”Ÿæˆæ— ç©·å¤§æˆ– NaN ä¹˜æ³•äº¤æ¢å¾‹ï¼šæ˜¯ a Ã— b = b Ã— a ä¹˜æ³•ç»“åˆå¾‹ï¼šå¦ ç”±äºæº¢å‡ºå’Œèˆå…¥çš„ä¸ç²¾ç¡®æ€§ ä¾‹å¦‚ï¼š(1e20Ã—1e20)Ã—1e-20 = infï¼Œè€Œ 1e20Ã—(1e20Ã—1e-20) = 1e20 å•ä½å…ƒï¼šæ˜¯ 1 æ˜¯ä¹˜æ³•å•ä½å…ƒ åˆ†é…å¾‹ï¼šå¦ ç”±äºæº¢å‡ºå’Œèˆå…¥çš„ä¸ç²¾ç¡®æ€§ ä¾‹å¦‚ï¼š1e20Ã—(1e20-1e20) = 0.0ï¼Œè€Œ 1e20Ã—1e20 - 1e20Ã—1e20 = NaN å•è°ƒæ€§ï¼šå‡ ä¹æ˜¯ a â‰¥ b ä¸” c â‰¥ 0 â‡’ aÃ—c â‰¥ bÃ—c ä½†å¯¹æ— ç©·å¤§å’Œ NaN ä¾‹å¤– ç±»å‹è½¬æ¢double/float â†’ intï¼šå¯¹æµ®ç‚¹æ•°ï¼ˆæ— è®ºæ˜¯å•ç²¾åº¦è¿˜æ˜¯åŒç²¾åº¦ï¼‰æ¥è¯´ï¼ŒæŠŠå®ƒä»¬è½¬æ¢æˆ int ç›¸å½“äº rounding toward zeroï¼Œå³èˆå»å°æ•°åé¢çš„éƒ¨åˆ†ã€‚æˆ‘è§‰å¾—è¿™åº”è¯¥ä¸»è¦æ˜¯å®ç°èµ·æ¥æ–¹ä¾¿ï¼Œæˆ‘ä»¬åœ¨ datalab é‡Œå®ç°äº†è¿™ç§è½¬æ¢ã€‚å¦‚æœè½¬æ¢åè¶…å‡ºäº† int çš„å¯è¡¨ç¤ºèŒƒå›´ï¼Œè¿™ç§è½¬æ¢è¡Œä¸ºæœªå®šä¹‰ï¼ˆä¸€èˆ¬ä¼šè®¾ä¸º TMinï¼Œtype minimumï¼Œèƒ½è¡¨ç¤ºçš„æœ€å°å€¼ï¼‰ã€‚ int â†’ floatï¼šæ ¹æ® rounding mode è¿›è¡Œå››èˆäº”å…¥ï¼Œæ¯•ç«Ÿå­˜åœ¨ä¸€äº› float ä¸èƒ½è¡¨ç¤ºçš„ int å€¼ã€‚ int â†’ doubleï¼šç²¾ç¡®è½¬æ¢ï¼Œæ¯•ç«Ÿ double çš„ frac æœ‰ 52 ä¸ª bitsï¼Œèƒ½å¤Ÿè¡¨ç¤ºæ‰€æœ‰å¯èƒ½çš„ int å€¼ã€‚ æ‚é¡¹å¤§ç«¯æ³•å’Œå°ç«¯æ³•å¤šå­—èŠ‚å¯¹è±¡åœ¨å†…éƒ¨å­˜å‚¨çš„å­—èŠ‚é¡ºåºè¡¨ç¤ºä¸Šä¹Ÿæœ‰å¤§ç«¯æ³•å’Œå°ç«¯æ³•ä¹‹åˆ†ï¼Œå³æœ€é«˜æœ‰æ•ˆå­—èŠ‚åœ¨å‰é¢è¿˜æ˜¯åé¢ã€‚æ¯”å¦‚æŠŠåå…­è¿›åˆ¶çš„ 0x01234567 å­˜å‚¨ä¸º 01 23 45 67 è¿˜æ˜¯ 67 45 23 01ã€‚ æˆ‘ä»¬å¯ä»¥ç”¨ä¸‹é¢çš„ä»£ç æ£€æŸ¥è‡ªå·±çš„æœºå™¨ä½¿ç”¨çš„æ˜¯å¤§ç«¯æ³•è¿˜æ˜¯å°ç«¯æ³•ã€‚ #include &lt;stdio.h> int is_little_endian() &#123; unsigned int x = 1; // å°†æ•´æ•°çš„åœ°å€è½¬æ¢ä¸ºå­—ç¬¦æŒ‡é’ˆï¼Œè®¿é—®å…¶ç¬¬ä¸€ä¸ªå­—èŠ‚ char *c = (char*) &amp;x; // å¦‚æœç¬¬ä¸€ä¸ªå­—èŠ‚æ˜¯1ï¼Œåˆ™ä¸ºå°ç«¯ï¼›å¦‚æœæ˜¯0ï¼Œåˆ™ä¸ºå¤§ç«¯ return *c; &#125; int main() &#123; if (is_little_endian()) &#123; printf(\"ç³»ç»Ÿæ˜¯å°ç«¯(Little Endian)\\n\"); &#125; else &#123; printf(\"ç³»ç»Ÿæ˜¯å¤§ç«¯(Big Endian)\\n\"); &#125; return 0; &#125;","categories":[{"name":"å…¬å¼€è¯¾","slug":"å…¬å¼€è¯¾","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/"},{"name":"CMU-15-213","slug":"å…¬å¼€è¯¾/CMU-15-213","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/CMU-15-213/"},{"name":"Notes","slug":"å…¬å¼€è¯¾/CMU-15-213/Notes","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/CMU-15-213/Notes/"}],"tags":[]},{"title":"è¿™é‡Œæœ‰ä»€ä¹ˆï¼Ÿ","slug":"learning/open-course/è¿™æ˜¯å“ªé‡Œ","date":"2025-03-02T06:28:38.000Z","updated":"2025-08-22T03:16:04.281Z","comments":true,"path":"wiki/learning/open-course/è¿™æ˜¯å“ªé‡Œ/","permalink":"http://rinevard.github.io/wiki/learning/open-course/%E8%BF%99%E6%98%AF%E5%93%AA%E9%87%8C/","excerpt":"","text":"æœ¬æ¥åªæ‰“ç®—åœ¨åšå®¢é‡Œå†™æ‚è°ˆå’Œæ¸¸æˆè®¾è®¡ç›¸å…³æ–‡ç« çš„ï¼Œä¸è¿‡æƒ³æƒ³çœ‹æŠŠå­¦ä¹ ç¬”è®°åœ¨è¿™é‡Œè®°ä¸€è®°ä¼¼ä¹ä¹Ÿä¸é”™ã€‚é‚£è¿™é‡Œå°±æ˜¯å­¦ä¹ è®°å½•äº†ï¼Œä¸»è¦æ˜¯å†™ç»™æœªæ¥çš„è‡ªå·±ç”¨çš„ã€‚ğŸ«  åº”è¯¥åªæœ‰æœ‹å‹ä»¬ï¼ˆcyber friendsï¼‰ä¼šçœ‹åˆ°è¿™ä¸ªç½‘ç«™ï¼Œæ‰€ä»¥è®°å½•ä¸€ä¸‹ä¹Ÿæ˜¯åœ¨è¡¨æ˜æˆ‘è¿˜åœ¨è®¤çœŸå­¦ä¹ ï¼Œæ²¡æœ‰è¿›å…¥æ‘¸é±¼æ€ã€‚è¯»è€…ä¹Ÿåˆ«å¿˜äº†ç»ˆèº«å­¦ä¹ ã€‚","categories":[{"name":"å…¬å¼€è¯¾","slug":"å…¬å¼€è¯¾","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/"}],"tags":[]},{"title":"Bomblabæ„Ÿæƒ³","slug":"learning/open-course/CMU-15-213/Labs/Bomblab","date":"2025-03-02T06:28:38.000Z","updated":"2025-08-22T03:14:43.978Z","comments":true,"path":"wiki/learning/open-course/CMU-15-213/Labs/Bomblab/","permalink":"http://rinevard.github.io/wiki/learning/open-course/CMU-15-213/Labs/Bomblab/","excerpt":"","text":"å†™åœ¨å‰é¢bomblab æ¯”èµ· datalab æ›´å‹å¥½ä¸€äº›ï¼Œé™¤äº†è€ƒå¯Ÿå¯¹æ±‡ç¼–ä»£ç çš„ç†è§£ä»¥å¤–ï¼Œä¹Ÿåœ¨é”»ç‚¼æˆ‘ä»¬çš„ gdb è°ƒè¯•æŠ€èƒ½ã€‚ç”¨æ—¶å…±è®¡ 2+2+0.8+0.5+1.5+4 = 10.8hï¼Œæ¯” datalab ç”¨æ—¶ç•¥å°‘ä¸€ç‚¹ã€‚åˆšå¼€å§‹æ‹†å¼¹çš„æ—¶å€™æ˜¯å¾ˆå…´å¥‹çš„ï¼Œåšåˆ°åé¢å€’æ˜¯æ„Ÿè§‰æœ‰ç‚¹æ— èŠäº†ï¼Œæˆ‘æ„Ÿè§‰ attacklab å¯èƒ½æ›´æœ‰è¶£ä¸€äº›ï¼ˆè™½ç„¶æˆ‘è¿˜æ²¡åšï¼‰ã€‚ æ‹†å¼¹è®°å½•é¦–å…ˆè‚¯å®šè¦å¯¹ bomb è¿›è¡Œåæ±‡ç¼–ï¼Œæˆ‘æ˜¯ç”¨ objdump æ¥åæ±‡ç¼–ï¼Œå¹¶æŠŠç»“æœä¿å­˜åˆ°äº† txt æ–‡ä»¶ä¸­ã€‚æ‹¿åˆ°æ±‡ç¼–ä»¥åéšä¾¿ç¿»ç¿»æ‰¾åˆ° phase ä»¬ï¼Œä¹‹åå°±è¿›å…¥æ‹†å¼¹é˜¶æ®µäº†ã€‚ ç¬¬ä¸€ä¸ªç‚¸å¼¹phase_1 ç®€å•æ˜“æ‡‚ï¼Œåªæ˜¯åˆ¤æ–­è¾“å…¥æ˜¯å¦ä¸æŸä¸ªå­—ç¬¦ä¸²ç›¸ç­‰ã€‚æˆ‘ä¸€å¼€å§‹ä»¥ä¸ºå­—ç¬¦ä¸²å°±æ˜¯â€œ0x402400â€ï¼Œåé¢æ‰æƒ³åˆ°è¿™æ˜¯é‚£ä¸ªå­—ç¬¦ä¸²çš„åœ°å€ã€‚ç”¨ gdb è®¾ç½®æ–­ç‚¹å³å¯å¾—çŸ¥å­—ç¬¦ä¸²ã€‚ï¼ˆåˆ«çœ‹æˆ‘è¯´å¾—é‚£ä¹ˆè½»æ¾ï¼Œä¹Ÿæ˜¯æŠ˜è…¾äº†ä¸¤å°æ—¶å¤šï¼Œæ¯•ç«Ÿå®Œå…¨æ²¡æœ‰ gdb ç»éªŒ ğŸ« ï¼‰ ç¬¬äºŒä¸ªç‚¸å¼¹è¿™ä¹Ÿæ˜¯ä¸€ä¸ªä¸éš¾çš„ç‚¸å¼¹ï¼ŒæŠŠæ±‡ç¼–ä»£ç å¾€ä¸‹è¯»å°±èƒ½è§£å†³ï¼Œå–œæ¬¢çš„è¯å¯ä»¥åŠ ç‚¹æ³¨é‡Šå¸®åŠ©è‡ªå·±ç†è§£ã€‚ä¸è¿‡æˆ‘ä»ç„¶åšäº†ä¸¤ä¸ªå°æ—¶ï¼Œä¸»è¦åœ¨ç–‘æƒ‘ read_six_numbers åæ•°å­—è¢«è¯»åˆ°äº†å“ªé‡Œã€‚è¿˜æœ‰ä¸ªæœ‰è¶£çš„çŠ¯è ¢çš„åœ°æ–¹ï¼Œæˆ‘ä¸€å¼€å§‹æŠŠ 400f35 å¤„çš„ 0x18 å½“æˆäº†åè¿›åˆ¶ 18ï¼Œç–‘æƒ‘äº†å¾ˆä¹… 4n æ€ä¹ˆå¯èƒ½ç­‰äº 18ï¼Œåé¢çŒ›ç„¶æƒŠé†’å‘ç°é‚£æ˜¯åå…­è¿›åˆ¶ã€‚ğŸ¤£ åœ¨è¿™é‡Œæˆ‘ç”¨åˆ°äº†è¿™äº›æ–°æŒ‡ä»¤ï¼š si # å•æ­¥æ‰§è¡Œ x&#x2F;10xw $sp # æŸ¥çœ‹æ ˆæŒ‡é’ˆ(sp)å¤„çš„10ä¸ªå­—(word)ï¼Œä»¥åå…­è¿›åˆ¶(x)æ˜¾ç¤º x&#x2F;10i $pc # æŸ¥çœ‹å½“å‰ä½ç½®ä¹‹åçš„10æ¡æŒ‡ä»¤ i registers eax # æŸ¥çœ‹å¯„å­˜å™¨å€¼ ç¬¬ä¸‰ä¸ªç‚¸å¼¹ç”¨æ—¶ 50 åˆ†é’Ÿï¼ˆæœ‰è¿›æ­¥ï¼ï¼‰ï¼Œè¿™æ¬¡æœ‰äº†æ›´ç³»ç»Ÿçš„æ‹†å¼¹æ–¹æ³•â€”â€”å…ˆæŠŠä»£ç åˆ†æ®µï¼Œç„¶ååˆ†æä»£ç æå‡ºè‹¥å¹²ä¸ªçŒœæµ‹å’Œé—®é¢˜ï¼Œéšç€è§£ç­”é—®é¢˜å°±é€æ¸åšæ‰äº†ã€‚ğŸ« æˆ‘ä»¬å¯ä»¥è½»æ¾æ³¨æ„åˆ°è¾“å…¥çš„æ•°å­—ä¸èƒ½å°‘äºä¸€ä¸ªï¼Œå†å¾€ä¸‹è¯»å°±ä¼š 400f75 è¿™ä¸€è¡Œï¼Œç®—ä¸€ç®—å°±ä¼šå¾ˆè‡ªç„¶åœ°çŒœæµ‹ï¼šè¾“å…¥è¦æ±‚æˆ‘ä»¬é€‰ä¸€ä¸ªé€‰é¡¹ï¼Œè·³è¿‡å»ç„¶å cmpã€‚ è¿™é‡Œæ˜¯æˆ‘æ‹†å¼¹æ—¶æå‡ºçš„é—®é¢˜ä»¥åŠè§£ç­”ï¼š è¾“å…¥æŒ‰æ€æ ·çš„æ ¼å¼å­˜å‚¨èµ·æ¥ï¼Ÿå­˜å‚¨åœ¨å“ªé‡Œï¼Ÿåˆ†ææ ˆåå‘ç°ï¼Œçœ‹èµ·æ¥æ˜¯è¯»å–äº†ä¸¤ä¸ªæ•°å­—ï¼Œå­˜å‚¨åœ¨æ ˆä¸­ 400f6a é‚£è¡Œæ˜¯æ€ä¹ˆæ¯”è¾ƒçš„ï¼Ÿ0x8(%rsp)æ˜¯ä»€ä¹ˆï¼Œè¾“å…¥å€¼å—ï¼ŸçŒœæµ‹è¿™æ˜¯è¦æ±‚è¾“å…¥çš„é€‰é¡¹å€¼åªèƒ½åœ¨ 0-7 ä¹‹é—´ï¼Ÿè®¾ä¸€ä¸ªæ–­ç‚¹å°±èƒ½å›ç­”è¿™ä¸ªé—®é¢˜äº†ã€‚ 400f75 è·³åˆ°äº†å“ªé‡Œï¼Ÿæ˜¯æ ¹æ®é€‰é¡¹è·³è·ƒå—ï¼Ÿæ ¹æ®é€‰é¡¹è·³è·ƒ ä»é€‰é¡¹è·³åˆ°äº† 400fbe åï¼Œ0xc(%rsp)æ˜¯å®šå€¼è¿˜æ˜¯ä¼šæ ¹æ®è¾“å…¥å˜åŒ–ï¼Ÿ0xc(%rsp)æ˜¯è¾“å…¥çš„ç¬¬äºŒä¸ªå€¼ã€‚ç”±äº 8 å¯¹é½ï¼Œæˆ‘ä»¬éœ€è¦ç”¨ 0xc(%rsp)è€Œé 0x10(%rsp)æ¥å¾—åˆ°ç¬¬äºŒä¸ªå€¼ã€‚ ç¬¬å››ä¸ªç‚¸å¼¹ç”¨æ—¶åŠå°æ—¶ï¼Œæˆ‘è¿ func4 éƒ½ä¸æƒ³è¯»ï¼Œç›´æ¥ç”¨ gdb æ¥æ‰§è¡Œ func4ï¼Œæ‰¾åˆ°è¿”å› 0 çš„è¾“å…¥å°±è¡Œäº†ã€‚è¿™ç§è§£æ³•æ„Ÿè§‰æœ‰é€ƒè¯¾çš„å«Œç–‘ï¼Œä¸è¿‡ä½ å°±è¯´å¿«ä¸å¿«å§ï¼åœ¨è¿™é‡Œæˆ‘ç”¨åˆ°äº†è¿™ä¸ªæ–°æŒ‡ä»¤ï¼š (gdb) call (int)func4(11, 0, 14) ç¬¬äº”ä¸ªç‚¸å¼¹ç”¨æ—¶ 1.5hï¼Œåšåˆ°è¿™é‡Œï¼Œæˆ‘æ¯”èµ·åˆšå¼€å§‹æ—¶å·²ç»å¯¹æ±‡ç¼–ä»£ç ç†Ÿæ‚‰ä¸å°‘äº†ã€‚é¦–å…ˆæŠŠä»£ç åˆ†æˆè‹¥å¹²ä¸ªå°éƒ¨åˆ†ï¼Œç„¶åçŒœæµ‹å¹¶éªŒè¯æ¯ä¸ªéƒ¨åˆ†çš„åŠŸèƒ½å°±èƒ½è§£å†³è¿™ä¸ªç‚¸å¼¹ã€‚æ¯”è¾ƒæœ‰è¶£çš„åœ°æ–¹æ˜¯è¿™é‡ŒåŠ å…¥äº†ä¸€ä¸ªé‡‘ä¸é›€ï¼Œæˆ‘è¿˜ç–‘æƒ‘äº†ä¸€é˜µå­è¿™æ˜¯ä»€ä¹ˆï¼Œåæ¥æ‰æƒ³åˆ°è¿™æ˜¯ä¹¦ä¸Šè®²çš„é‡‘ä¸é›€ã€‚ ç¬¬å…­ä¸ªç‚¸å¼¹ç”¨æ—¶ 4hï¼Œå¯¹è¿™ä¸ªç‚¸å¼¹ï¼Œæˆ‘æ„Ÿè§‰â€œæ ¹æ®è¿è¡Œæ—¶çš„çŠ¶å†µçŒœä»£ç çš„ä½œç”¨â€æ¯”â€œåˆ†æä»£ç â€æ›´åŠ é‡è¦ã€‚ä¸€å¼€å§‹åŒæ ·æ˜¯æŠŠä»£ç åˆ†æˆå¤šä¸ªå°å±€éƒ¨ï¼Œç„¶ååˆ†æ®µçŒœä½œç”¨ã€‚è¿™é‡Œå¼•å…¥äº†é“¾è¡¨ï¼Œè¿˜æŒºæœ‰è¶£ã€‚ å½©è›‹ï¼Ÿä»€ä¹ˆå½©å¼¹ï¼Ÿ","categories":[{"name":"å…¬å¼€è¯¾","slug":"å…¬å¼€è¯¾","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/"},{"name":"CMU-15-213","slug":"å…¬å¼€è¯¾/CMU-15-213","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/CMU-15-213/"},{"name":"Labs","slug":"å…¬å¼€è¯¾/CMU-15-213/Labs","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/CMU-15-213/Labs/"}],"tags":[]},{"title":"Datalabè§£æ","slug":"learning/open-course/CMU-15-213/Labs/Datalab","date":"2025-02-21T12:14:28.000Z","updated":"2025-08-22T03:14:43.981Z","comments":true,"path":"wiki/learning/open-course/CMU-15-213/Labs/Datalab/","permalink":"http://rinevard.github.io/wiki/learning/open-course/CMU-15-213/Labs/Datalab/","excerpt":"","text":"img{ width: 40%; } å†™åœ¨å‰é¢Datalab çš„éš¾åº¦å¾ˆé«˜ã€‚å®ƒçš„éš¾åº¦ä¸»è¦ä½“ç°åœ¨æŠ€å·§æ€§ä¸Šï¼Œè¿™åœ¨æ•´æ•°éƒ¨åˆ†å°¤å…¶æ˜æ˜¾ã€‚æ•´æ•°éƒ¨åˆ†è‡³å°‘æœ‰ä¸€åŠé¢˜ç›®æˆ‘èŠ±äº†ä¸€å°æ—¶ä»¥ä¸Šæ‰åšå‡ºæ¥ï¼Œç›¸è¾ƒè€Œè¨€ï¼Œæµ®ç‚¹æ•°çš„é¢˜ç›®è™½ç„¶åˆ†ç±»è®¨è®ºèµ·æ¥æ›´éº»çƒ¦ï¼Œä½†æ›´ä¸ºå¹³æ˜“è¿‘äººï¼Œæ¯é“æˆ‘èŠ±äº†å››ååˆ†é’Ÿå·¦å³ã€‚ å¦‚æœæœ‰æŸé“é¢˜åšä¸å‡ºæ¥ï¼Œä¸å»ºè®®ä¸€ç›´æ­»ç£•ã€‚æˆ‘ä»¬å¯ä»¥æ¢ä¸€é“é¢˜æˆ–æ˜¯ç¦»å¼€å±å¹•æ•£æ•£å¿ƒï¼Œæˆ‘ç›¸ä¿¡è¿™ä¼šæœ‰å¸®åŠ©ã€‚ åšå®Œä»¥åï¼Œæ„Ÿè§‰è‡ªå·±å·²ç»æ˜¯ä½è¿ç®—é¢†åŸŸå¤§ç¥äº†ï¼ æ•´æ•°éƒ¨åˆ†æ•´æ•°éƒ¨åˆ†çš„æŠ€å·§æ€§å¾ˆå¼ºï¼Œä¸å»ºè®®åœ¨æŸé“é¢˜ä¸Šæ­»ç£•ï¼Œåšä¸å‡ºæ¥å°±æ¢ä¸€é“ï¼Œä»¥åå†æ¥ã€‚ bitXoræœ¬é¢˜è¦æ±‚ç”¨ â€˜~â€™ å’Œ â€˜&amp;â€™ å®ç° â€˜^â€™ï¼Œç®€å•åˆ—ä¸ªå…³äº â€˜^â€™ çš„çœŸå€¼è¡¨ï¼š x y x^y 0 0 0 0 1 1 1 0 1 1 1 0 å…³æ³¨ x^y ä¸º 1 æ—¶ x å’Œ y çš„å–å€¼ï¼Œå¯ä»¥å‘ç° x^y == ((~x) &amp; y) | (x &amp; (~y))ï¼Œå†ç”¨å¾·æ‘©æ ¹å¾‹æŠŠ | æ¢æˆ ~ å’Œ &amp; å³å¯ã€‚ /* * bitXor - x^y using only ~ and &amp; * Example: bitXor(4, 5) = 1 * Legal ops: ~ &amp; * Max ops: 14 * Rating: 1 */ int bitXor(int x, int y) &#123; /* x Xor y = ((~x) &amp; y) | (x &amp; (~y)) a | b = ~(~a &amp; ~b) */ return ~(~(x &amp; ~y) &amp; ~(~x &amp; y)); &#125; tminè¿™æ˜¯ç†ŸçŸ¥çš„ç»“è®ºï¼Œtmin = $-2^{31}$ = 1 &lt;&lt; 31 /* * tmin - return minimum two's complement integer * Legal ops: ! ~ &amp; ^ | + &lt;&lt; >> * Max ops: 4 * Rating: 1 */ int tmin(void) &#123; /* use left shift to compute tmin */ return 1 &lt;&lt; 31; &#125; isTmaxè¿™ç§â€œåˆ¤æ–­ x æ˜¯å¦ç­‰äº yâ€çš„é¢˜ç›®çš„åšæ³•æœ‰å¾ˆå¤šç§ï¼š åˆ›å»ºä¸€ä¸ª yï¼ŒæŠŠ x å’Œ y ç›¸å‡ï¼ˆx - y == x + ((~y) + 1)ï¼‰ï¼Œç„¶ååˆ¤æ–­ç»“æœæ˜¯å¦ä¸º 0. åˆ›å»ºä¸€ä¸ª yï¼Œreturn !(x^y) æˆ‘è¿™é‡Œæ˜¯ç›´æ¥æ„å»ºäº† -Tmax = 100â€¦01ï¼Œç„¶åæ£€æŸ¥ x-Tmax æ˜¯å¦ä¸º 0. /* * isTmax - returns 1 if x is the maximum, two's complement number, * and 0 otherwise * Legal ops: ! ~ &amp; ^ | + * Max ops: 10 * Rating: 1 */ int isTmax(int x) &#123; /* create a '0' and use '!' */ return !(x + 1 + (1 &lt;&lt; 31)); &#125; allOddBitsè¿™é“é¢˜æˆ‘æƒ³äº†å¾ˆä¹…ã€‚åæ¥æ ¹æ®å°è¯•æ€§åœ°æ„é€ äº† 1010â€¦1010ï¼Œç„¶åè¯•å‡ºäº† (x &amp; mask) ^ mask çš„å†™æ³•ã€‚å¤§è‡´çš„æ€è·¯æ˜¯ï¼Œæ—¢ç„¶æˆ‘ä»¬åªåœ¨ä¹å¥‡æ•°ä½çš„å€¼ï¼Œå°±å…ˆç”¨ &amp; æŠŠå¶æ•°ä½çš„å€¼å»æ‰ï¼Œåæ¥æƒŠå¥‡åœ°å‘ç°å†åšä¸ª â€˜^â€™ å’Œ â€˜!â€™ å°±èƒ½å¾—åˆ°ç»“æœäº†ã€‚ /* * allOddBits - return 1 if all odd-numbered bits in word set to 1 * where bits are numbered from 0 (least significant) to 31 (most significant) * Examples allOddBits(0xFFFFFFFD) = 0, allOddBits(0xAAAAAAAA) = 1 * Legal ops: ! ~ &amp; ^ | + &lt;&lt; >> * Max ops: 12 * Rating: 2 */ int allOddBits(int x) &#123; /* (x^y) == 0 &lt;=> x == y */ int y = 0xAA; // 0xAA å°±æ˜¯äºŒè¿›åˆ¶çš„ 1010 1010 int mask = y + (y &lt;&lt; 8) + (y &lt;&lt; 16) + (y &lt;&lt; 24); return !((x &amp; mask) ^ mask); &#125; negateè¿™æ˜¯ç†ŸçŸ¥çš„ç»“æœï¼Œæœ¬è´¨æ˜¯ $x + \\sim x + 1 \\equiv 0(\\text{mod $2^{32}$})$ /* * negate - return -x * Example: negate(1) = -1. * Legal ops: ! ~ &amp; ^ | + &lt;&lt; >> * Max ops: 5 * Rating: 2 */ int negate(int x) &#123; /* well known result */ return ~x + 1; &#125; isAsciiDigitè¿™é“é¢˜æˆ‘æƒ³äº†å¾ˆä¹…ã€‚åæ¥åˆ†æäº†è¾“å…¥çš„å½¢å¼ï¼Œå‘ç°å®ƒåªèƒ½å½¢å¦‚ 0000 â€¦ 0011 0yyy æˆ–æ˜¯ 0000 â€¦ 0011 100yï¼Œäºæ˜¯å†³å®šæŠŠè‡ªç”±çš„ä½ç½®å³ç§»æ‰ï¼Œç„¶åç”¨ maskã€‚ åšå®Œåå¤ç›˜å‘ç°è¿˜æœ‰ä¸€ç§åŸºäºæ¯”è¾ƒçš„æ–¹æ³•ï¼Œç›´æ¥è®¡ç®— x - 0x30 å’Œ x - 0x39 å¹¶åˆ¤æ–­å…¶ç¬¦å·ä½ã€‚ /* * isAsciiDigit - return 1 if 0x30 &lt;= x &lt;= 0x39 (ASCII codes for characters '0' to '9') * Example: isAsciiDigit(0x35) = 1. * isAsciiDigit(0x3a) = 0. * isAsciiDigit(0x05) = 0. * Legal ops: ! ~ &amp; ^ | + &lt;&lt; >> * Max ops: 15 * Rating: 3 */ int isAsciiDigit(int x) &#123; /* x åªèƒ½å½¢å¦‚ä¸‹é¢ä¸¤ç§å½¢å¼ï¼š * 1. 0000 ... 0011 0yyy * 2. 0000 ... 0011 100y * è¿™é‡Œçš„ y å¯ä»¥æ˜¯ 0 æˆ– 1 * æˆ‘ä»¬ç”¨å³ç§»å»æ‰æœªçŸ¥çš„ y, ç„¶åç”¨ maskå³å¯ * æ„é€ ä¸¤ä¸ª mask, ä¸€ä¸ªæ˜¯ 0000 ... 0000 0110, å¦ä¸€ä¸ªæ˜¯ 0000 ... 0001 1100 */ int mask1 = 0x06; int mask2 = 0x1C; return !((x >> 3) ^ mask1) | !((x >> 1) ^ mask2); &#125; conditionalè¿™é“é¢˜æˆ‘ä¹Ÿæƒ³äº†å¥½ä¹…ã€‚ä¸€å¼€å§‹ä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘å…ˆç”¨ !!x æŠŠ x å½’åˆ°äº† 0 æˆ– 1. ä¹‹åçš„æ€è·¯æ˜¯æƒ³æ„é€ æ»¡è¶³ç±»ä¼¼ f(0, y) = 0ï¼Œf(1, y) = y çš„æ¡ä»¶çš„å‡½æ•° fï¼Œç„¶åè¿”å› f(x, y) + f(!x, z). ç¨åŠ æ€è€ƒï¼Œä¾¿å‘ç° â€˜&amp;â€™ å’Œè¿™é‡Œçš„ f å¾ˆåƒï¼Œäºæ˜¯å°±å†™ä¸‹å»äº†ã€‚ /* * conditional - same as x ? y : z * Example: conditional(2,4,5) = 4 * Legal ops: ! ~ &amp; ^ | + &lt;&lt; >> * Max ops: 16 * Rating: 3 */ int conditional(int x, int y, int z) &#123; /* ä¸ºäº†æ–¹ä¾¿, å…ˆé™åˆ¶ x åªå– 0 æˆ– 1 * æˆ‘ä»¬ä¸€å¼€å§‹çš„æ€è·¯æ˜¯æ‰¾åˆ°å‡½æ•°æ»¡è¶³ f(x, b) = b if x == 1, 0 if x == 0 * ç„¶åç”¨ f(x, y) + f(!x, z) å³å¯å¾—åˆ°ç»“æœ * ä¸­é€”å‘ç° 11...1 &amp; b = b, 0 &amp; b = 0, å’Œæˆ‘ä»¬å¸Œæœ›çš„ç»“æœå¾ˆåƒ * äºæ˜¯å°±è¿™ä¹ˆå†™äº† */ int mask = (~(!x)) + 1; // xä¸º0æ—¶å¾—åˆ°å…¨1ï¼Œxé0æ—¶å¾—åˆ°0 return ((~mask) &amp; y) + (mask &amp; z); &#125; isLessOrEqualå¥½å§ï¼Œè¿™é“é¢˜æˆ‘è¿˜æ˜¯æƒ³äº†å¾ˆä¹…ï¼Œæ¯•ç«Ÿæˆ‘åœ¨åšä¹‹å‰å¯¹ä½è¿ç®—å‡ ä¹ä¸€æ— æ‰€çŸ¥ã€‚è¿™é“é¢˜æ›´å¤šæ˜¯åˆ†ç±»è®¨è®ºï¼Œåˆ†ä¸º xy åŒå·å’Œ xy å¼‚å·çš„ä¸¤ç§æƒ…å†µå°±è¡Œï¼Œè¿æº¢å‡ºéƒ½ä¸ä¼šæœ‰ã€‚ /* * isLessOrEqual - if x &lt;= y then return 1, else return 0 * Example: isLessOrEqual(4,5) = 1. * Legal ops: ! ~ &amp; ^ | + &lt;&lt; >> * Max ops: 24 * Rating: 3 */ int isLessOrEqual(int x, int y) &#123; /* è‹¥xyåŒå·(æœ€é«˜ä½ç›¸åŒ), return 1 if y - x >= 0 else 0 * è‹¥xyå¼‚å·, return 1 if yçš„äºŒè¿›åˆ¶è¡¨ç¤ºæœ€é«˜ä½ä¸º0 else 0 */ int signX = x >> 31; int signY = y >> 31; int diffSign = (signX &amp; !signY); // (å¼‚å·ä¸” y >= 0, x &lt; 0) ? 1 : 0 int diff = y + (~x + 1); // y - x int sameSign = (!(signX ^ signY)) &amp; ((diff >> 31) + 1); // (åŒå·ä¸” y - x >= 0) ? 1 : 0 return diffSign | sameSign; &#125; logicalNegè¿™é“é¢˜æ˜¯æˆ‘æ„Ÿè§‰ç¬¬äºŒéš¾çš„é¢˜ç›®ï¼Œæˆ‘çš„æ ¸å¿ƒæ€è·¯æ˜¯â€œé 0 çš„ x çš„äºŒè¿›åˆ¶è¡¨ç¤ºä¸­è‡³å°‘æœ‰ä¸€ä¸ª 1â€ï¼Œäºæ˜¯æˆ‘å°±æ„é€ äº† 11â€¦1 å³ -1 è¿™ä¸ªç‰¹æ®Šå€¼ï¼Œå¹¶æœŸç›¼å®ƒèƒ½ç»™æˆ‘ä¸€äº›æœ‰è¶£çš„ç»“æœã€‚ å¯¹æ­£æ•° x æ¥è¯´ï¼Œx + (-1) çš„æœ€é«˜ä½å¿…ç„¶æ˜¯ 0ï¼Œè¿™èƒ½æŠŠæ­£æ•°å’Œ 0 åŒºåˆ†å¼€æ¥ï¼Œå› ä¸º 0 + (-1) çš„æœ€é«˜ä½æ˜¯ 1. ä½†è´Ÿæ•°æ€ä¹ˆåŠå‘¢ï¼Ÿè´Ÿæ•°è¦åˆ†ç±»è®¨è®ºï¼Œå¾ˆéº»çƒ¦ã€‚äºæ˜¯æˆ‘å°±æƒ³å–è¾“å…¥å€¼çš„ç»å¯¹å€¼ï¼Œç„¶åç”¨ abs + (-1) æ¥åŒºåˆ†é 0 å€¼å’Œ 0. æˆ‘è¿™é‡Œçš„ä»£ç é‡‡ç”¨çš„æ˜¯ç±»ä¼¼çš„æ€è·¯ï¼Œä¸è¿‡å½“æ—¶æ²¡æƒ³åˆ°æ€ä¹ˆæ±‚ absï¼Œå°±å†™å¾—æ›´å¤æ‚äº†ä¸€äº›ã€‚ åæ¥å¤ç›˜æ—¶å‘ç°é 0 å€¼ x ä¸€å®šæ»¡è¶³ (x | (~x)) çš„æœ€é«˜ä½ä¸º 1ï¼Œç”¨è¿™ä¸ªæ–¹æ³•æ›´ç®€å•ã€‚ /* * logicalNeg - implement the ! operator, using all of * the legal operators except ! * Examples: logicalNeg(3) = 0, logicalNeg(0) = 1 * Legal ops: ~ &amp; ^ | + &lt;&lt; >> * Max ops: 12 * Rating: 4 */ int logicalNeg(int x) &#123; /* * å…ˆæ€è€ƒæ€ä¹ˆè¡¨ç¤º 'xé0', æ³¨æ„åˆ° xé0 &lt;=> xçš„äºŒè¿›åˆ¶è¡¨ç¤ºä¸­è‡³å°‘æœ‰ä¸€ä¸ª1 * è€ƒè™‘ç”¨ -1(å®ƒçš„äºŒè¿›åˆ¶è¡¨ç¤ºå…¨æ˜¯1) + x æ¥å¾—åˆ°ä¸€äº›ä¸­é—´é‡ * æ¥ä¸‹æ¥åˆ†ç±»è®¨è®º, å¦‚æœ xä¸º0, åˆ™ -1 + x = -1, * å¦‚æœ xä¸ºæ­£æ•°, -1 + x çš„äºŒè¿›åˆ¶è¡¨ç¤ºä»¥ 0 å¼€å¤´ * å¦‚æœ xä¸ºè´Ÿæ•°, è¦åˆ†ç±»è®¨è®º Tminçš„æƒ…å†µ, å¤„ç†èµ·æ¥ä¸æ–¹ä¾¿ * è‡³æ­¤, æ­£æ•°å’Œ 0 å°±èƒ½é€šè¿‡ (-1 + x) >> 31 åŒºåˆ†å¼€æ¥äº†, æ­£æ•°å¾—åˆ° 0, 0 å¾—åˆ° -1 * æ¥ä¸‹æ¥æŠŠè´Ÿæ•°æ•´åˆè¿›æ¥ * è€ƒè™‘åˆ°è´Ÿæ•°çš„è´Ÿæ˜¯æ­£æ•°, æˆ‘ä»¬è‡ªç„¶å°±ä¼šè€ƒè™‘æŠŠè´Ÿæ•°è½¬åŒ–æˆæ­£æ•°ï¼Œå†ç”¨ | æˆ–è€… &amp; æ¥è¿æ¥ * ((((~0) + x) >> 31)) &amp; ((((~0) + negtivex) >> 31)) å°±èƒ½æŠŠæ­£æ•°å’Œè´Ÿæ•°éƒ½å˜æˆ0, 0å˜æˆ -1 * å† &amp; 1 å°±èƒ½å¾—åˆ° !x äº† * ä»£ç é‡Œåˆè¿›ä¸€æ­¥ç®€åŒ–äº†ä¸€ä¸‹ç»“æœ, ä¸è¿‡æ ¸å¿ƒæ€è·¯è¿˜æ˜¯\"æŠŠè´Ÿæ•°å’Œæ­£æ•°ç»Ÿä¸€èµ·æ¥\" * è¿™é‡Œçš„ (((~0) + x) &amp; ((~0) + negtivex)) æŠŠ &amp; æå‰åˆ°äº†ç§»ä½å‰, * ç›´æ¥ &amp; äº†äºŒè¿›åˆ¶è¡¨ç¤ºçš„æœ€é«˜ä½(ä¹‹å‰çš„å…ˆ >> å† &amp; æ˜¯ &amp; äº†äºŒè¿›åˆ¶è¡¨ç¤ºçš„æœ€ä½ä½) */ int negtivex = (~x) + 1; return ((((((~0) + x) &amp; ((~0) + negtivex)) >> 31)) &amp; 1); &#125; howManyBitsè¿™é“é¢˜æ˜¯æˆ‘æ„Ÿè§‰æœ€éš¾çš„é¢˜ç›®ã€‚é¦–å…ˆæˆ‘ä»¬ç”»å‡ºè¿™ä¸ªå‡½æ•°çš„å›¾åƒï¼ˆç•™ç»™è¯»è€…ä½œä¸ºç»ƒä¹ ï¼‰ï¼Œä¼šå‘ç°å®ƒå…³äº -0.5 å¯¹ç§°ï¼Œè¿™è¡¨æ˜ x å’Œ -x-1 è€—è´¹çš„ä½æ•°ç›¸åŒï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±åªè¦è€ƒè™‘éè´Ÿæ•°å°±è¡Œäº†ã€‚ æ‰¾åˆ°éè´Ÿæ•°çš„æœ€å° bits æ•°å€’æ˜¯ä¸éš¾ï¼Œç¨å¾®å†™å‡ ä¸ªéè´Ÿæ•°å°±èƒ½å‘ç°ï¼Œåªè¦æ‰¾åˆ°å®ƒå€¼ä¸º 1 çš„æœ€é«˜ä½æ•°ï¼Œè®¾å…¶ä¸º kï¼Œk + 1 å³ä¸ºç»“æœã€‚ ä¹‹åçš„éš¾ç‚¹å°±æ˜¯ï¼Œå¦‚ä½•æ‰¾åˆ°è¿™ä¸ªéè´Ÿæ•°çš„â€œå€¼ä¸º 1 çš„æœ€é«˜ä½æ•°â€äº†ã€‚çº¿æ€§æœç´¢æ˜¾ç„¶æ˜¯å¯è¡Œçš„ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ $\\sum_{m=0}^{31}!!(x &gt;&gt; m)$ æ¥å¾—åˆ°è¿™ä¸ªä½æ•°ï¼Œç„¶è€Œè¿™æ ·åšè€—è´¹çš„æ“ä½œæ•°è¶…å‡ºäº†é™åˆ¶ã€‚æ—¢ç„¶çº¿æ€§è€—è´¹çš„æ“ä½œæ•°å¤ªå¤šï¼Œé‚£æˆ‘ä»¬è‡ªç„¶å°±ä¼šæƒ³åˆ°äºŒåˆ†ã€‚ ä½†æ€ä¹ˆåšäºŒåˆ†å‘¢ï¼Ÿè¿™é‡Œçš„ä»£ç æ›´å¤šæ˜¯æˆ‘è¯•å‡ºæ¥çš„ï¼Œæ²¡æœ‰ä»€ä¹ˆæ¸…æ™°çš„ç†è®ºæŒ‡å¯¼ï¼Œæˆ‘ä»¬ç›´æ¥çœ‹å›¾å§ã€‚ æ€ä¹ˆåšåˆ°â€œç æ‰ä¸€åŠâ€å‘¢ï¼Ÿç æ‰å³è¾¹åŠæ®µç”¨å³ç§»å°±è¡Œï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼šä» x &gt;&gt; 16 å¼€å§‹ï¼Œå†ç”¨ !!(x &gt;&gt; 16) æ˜¯ 0 è¿˜æ˜¯ 1 æ¥åˆ¤æ–­ 1 åœ¨å³åŠè¾¹è¿˜æ˜¯å·¦åŠè¾¹ã€‚ ä¹‹åçš„ä»£ç å°±çœŸçš„çº¯ç²¹æ˜¯è¯•å‡ºæ¥çš„äº†ï¼Œæˆ‘ä»¬è‚¯å®šèƒ½åœ¨æ•°å­¦ä¸Šè§£é‡Šæˆ‘ä»¬çš„æ“ä½œï¼Œä½†å…·ä½“çš„æ„æ€çº¯ç²¹æ˜¯è¯•é”™+ç›´è§‰è¯•å‡ºæ¥çš„ï¼Œæ²¡ä»€ä¹ˆå¥½è¯´çš„ã€‚ /* howManyBits - return the minimum number of bits required to represent x in * two's complement * Examples: howManyBits(12) = 5 * howManyBits(298) = 10 * howManyBits(-5) = 4 * howManyBits(0) = 1 * howManyBits(-1) = 1 * howManyBits(0x80000000) = 32 * Legal ops: ! ~ &amp; ^ | + &lt;&lt; >> * Max ops: 90 * Rating: 4 */ int howManyBits(int x) &#123; /* ç®€å•ç”»ä¸‹è¿™ä¸ªå‡½æ•°çš„å›¾åƒ, æ³¨æ„åˆ° x ä¸ -x - 1(å³~x) è€—è´¹ä½æ•°ç›¸åŒ, é‚£å°±å…ˆç»Ÿä¸€è½¬æ¢æˆéè´Ÿæ•°, * ç„¶åæ‰¾åˆ°æœ€é«˜çš„å€¼ä¸º1çš„ä½æ•°, è®¾å…¶ä¸º k, k + 1 å³ä¸ºç»“æœ * æ¯”å¦‚ 0000 ... 0010 0110 çš„ç»“æœä¸º 6 + 1 = 7 * * é‚£æ€ä¹ˆæ‰¾åˆ°æœ€é«˜çš„å€¼ä¸º1çš„ä½æ•°å‘¢? * ä¸€ç§æƒ³æ³•æ˜¯ sum([!!(alternatex >> k) for k in range(32)]), ä½†è¿™æ ·ç”¨çš„æ“ä½œå°±è¶…è¿‡é™åˆ¶äº† * æ‰€ä»¥æˆ‘ä»¬å€ŸåŠ©äºŒåˆ†çš„æ€æƒ³ * è®©æˆ‘ä»¬ä¸¾ä¸ªä¾‹å­, å‡è®¾æˆ‘ä»¬åœ¨å¤„ç† 0010 1101, * æˆ‘ä»¬å¯ä»¥å…ˆæŠŠå®ƒå³ç§»4, å‘ç°ä»ç„¶å¤§äº0, å°±ä»¤ans += 4, æ­¤æ—¶å€¼ä¸º 0010 (æ‰”æ‰å³åŠéƒ¨åˆ†) * ç„¶åå³ç§»2, å‘ç°ç­‰äº0, åˆ™ä¸åœ¨æ•°æ®ä¸ŠçœŸæ­£ç§»åŠ¨, å€¼ä¸º 10 (æ‰”æ‰å·¦åŠéƒ¨åˆ†) * å†å³ç§»1, å‘ç°å¤§äº0, ä»¤ ans += 1, æ­¤æ—¶å€¼ä¸º 1 (æ‰”æ‰å³åŠéƒ¨åˆ†) * å½“å‰çš„å€¼ä¸ä¸º0, ans +=1 (ansä¹‹å‰åŠ äº†\"è¢«ç§»é™¤çš„éƒ¨åˆ†çš„é•¿åº¦\", è¿™é‡Œè¿˜è¦åŠ ä¸Š\"å‰©ä½™çš„éƒ¨åˆ†çš„é•¿åº¦\") * ç»¼ä¸Š, 0010 1101 çš„æœ€é«˜çš„å€¼ä¸º1çš„ä½æ•°ä¸º6 * * é¦–å…ˆæˆ‘ä»¬è¦èƒ½å¤Ÿæ£€æŸ¥å³ç§»åå€¼æ˜¯å¦ä¸º0, ç”¨!!(x >> k) å³å¯, !!(x >> k) == (x å³ç§»åå€¼ä¸º0) ? 0 : 1 * ç„¶åä¸ºäº†æ–¹ä¾¿åœ¨å€¼ä¸Šè¿›è¡Œç§»åŠ¨, æˆ‘ä»¬å¸Œæœ›æœ‰ f(x) = (x å³ç§»åå€¼ä¸º0) ? 0 : å³ç§»é•¿åº¦ * å› æ­¤ä½¿ç”¨å½¢å¦‚ !!(x >> (2**k)) &lt;&lt; k çš„ä¸œè¥¿ */ int signX = x >> 31; // (x >= 0) ? 00...0 : 11...1 int alternatex = ((~(signX)) &amp; x) + ((signX) &amp; (~x)); // (x >= 0) ? x : -x-1 int bit16 = (!!(alternatex >> 16)) &lt;&lt; 4; // (alternatex >= 2**16) ? 16 : 0 alternatex = alternatex >> bit16; int bit8 = (!!(alternatex >> 8)) &lt;&lt; 3; alternatex = alternatex >> bit8; int bit4 = (!!(alternatex >> 4)) &lt;&lt; 2; alternatex = alternatex >> bit4; int bit2 = (!!(alternatex >> 2)) &lt;&lt; 1; alternatex = alternatex >> bit2; int bit1 = (!!(alternatex >> 1)); alternatex = alternatex >> bit1; int bit0 = (!!alternatex); return bit16 + bit8 + bit4 + bit2 + bit1 + bit0 + 1; &#125; æµ®ç‚¹æ•°éƒ¨åˆ†æµ®ç‚¹æ•°éƒ¨åˆ†æ¯”èµ·æ•´æ•°éƒ¨åˆ†ç®€å•å¾—å¤šï¼Œåªè¦ä»”ç»†åœ°åˆ†ç±»è®¨è®ºå°±è¡Œäº†ã€‚ floatScale2åˆ†ç±»è®¨è®ºå³å¯ã€‚è¿™é‡Œæ¯”è¾ƒæœ‰è¶£çš„æ˜¯ exp == 0ï¼ˆdenormalized caseï¼‰çš„æƒ…å†µï¼Œæ— è®º frac éƒ¨åˆ†æ˜¯å¦è¶…è¿‡ 23 ä½ï¼Œå¤„ç†çš„ä»£ç éƒ½æ˜¯ä¸€æ ·çš„ã€‚ /* * floatScale2 - Return bit-level equivalent of expression 2*f for * floating point argument f. * Both the argument and result are passed as unsigned int's, but * they are to be interpreted as the bit-level representation of * single-precision floating point values. * When argument is NaN, return argument * Legal ops: Any integer/unsigned operations incl. ||, &amp;&amp;. also if, while * Max ops: 30 * Rating: 4 */ unsigned floatScale2(unsigned uf) &#123; /* å–å‡º exp çš„éƒ¨åˆ†, åˆ†ä¸‰ç§æƒ…å†µè®¨è®º. * 1. NaN or infin, ç›´æ¥è¿”å›è¾“å…¥å€¼ * 2. denormalized case, ä¸»è¦ä¿®æ”¹ frac éƒ¨åˆ†, å¦‚æœä¿®æ”¹å¯¼è‡´ frac * éƒ¨åˆ†å¤šäº 23 ä½, è¿˜è¦ä¿®æ”¹ exp éƒ¨åˆ† * 3. normalized case, ä¿®æ”¹ exp éƒ¨åˆ† */ unsigned exp = (uf >> 23) &amp; 0xFF; // 00...0 exp // å¦‚æœ exp == äºŒè¿›åˆ¶(1111 1111), ufä¸º NaN æˆ– infin, ç›´æ¥è¿”å›uf if (exp == 0xFF) &#123; return uf; &#125; // å¦‚æœ exp == 0, å°±æ˜¯ denormalized case else if (exp == 0) &#123; unsigned frac = (uf &lt;&lt; 9) >> 9; // 0 00000000 frac // å¦‚æœ frac éƒ¨åˆ†æœ€é«˜å€¼ä¸º1, è¿›ä½; å¦‚æœä¸ä¸º1, æŠŠ frac éƒ¨åˆ†ä¹˜äºŒå³å¯ // ä¸¤ç§æƒ…å†µéƒ½èƒ½ç”¨ä¸‹é¢çš„ä»£ç æ¥è¡¨ç¤º frac = frac &lt;&lt; 1; return ((uf >> 23) &lt;&lt; 23) + frac; // (s exp 00...0) + (0 00000000 frac) &#125; // normalized case else &#123; // expä¸ä¼šæº¢å‡º8ä½, å› ä¸ºå‰é¢çš„ if åˆ†æ”¯å·²ç»å¤„ç†äº† exp == 0xFFçš„æƒ…å†µ exp += 1; unsigned expmask = (~0) ^ (0xFF &lt;&lt; 23); // 1 00000000 11...1 return (uf &amp; expmask) + (exp &lt;&lt; 23); &#125; &#125; floatFloat2IntåŒæ ·æ˜¯åˆ†ç±»è®¨è®ºã€‚ä¸€å¼€å§‹æˆ‘æŠŠ NaNã€infin å•ç‹¬å†™äº†ä¸€ç§æƒ…å†µå¤„ç†ï¼Œåé¢å‘ç°æ“ä½œæ•°å¤ªå¤šè¶…å‡ºäº†é™åˆ¶ï¼Œäºæ˜¯æŠŠå®ƒå’Œç»å¯¹å€¼å¤ªå¤§çš„æƒ…å†µç»Ÿä¸€äº†èµ·æ¥ï¼Œæ¯•ç«Ÿå®ƒä»¬çš„è¿”å›å€¼ä¸€æ ·ã€‚ è¿™é‡Œè¦ä»”ç»†è€ƒè™‘çš„æ˜¯ Tmin è½å…¥çš„åˆ†æ”¯ï¼Œåœ¨æˆ‘çš„ä»£ç é‡Œï¼ŒTmin è½å…¥äº†ç¬¬ä¸€ä¸ª if åˆ†æ”¯ã€‚ /* * floatFloat2Int - Return bit-level equivalent of expression (int) f * for floating point argument f. * Argument is passed as unsigned int, but * it is to be interpreted as the bit-level representation of a * single-precision floating point value. * Anything out of range (including NaN and infinity) should return * 0x80000000u. * Legal ops: Any integer/unsigned operations incl. ||, &amp;&amp;. also if, while * Max ops: 30 * Rating: 4 */ #include &lt;stdio.h> int floatFloat2Int(unsigned uf) &#123; int exp = (uf >> 23) &amp; 0xFF; // 00...0 exp unsigned frac = (uf &lt;&lt; 9) >> 9; // 00...0 frac // ç»å¯¹å€¼å¤ªå¤§çš„æƒ…å†µ // æ³¨æ„ NaN, infinä¹Ÿåœ¨è¿™ç§æƒ…å†µä¸­, æ­¤æ—¶ exp == 0xFF // -2^(31) ä¹Ÿåœ¨è¿™ç§æƒ…å†µä¸­, æ­¤æ—¶ exp == 127 + 31, frac == 0 if (exp >= 127 + 31) &#123; return (1 &lt;&lt; 31); &#125; // ç»å¯¹å€¼å¤ªå°çš„æƒ…å†µ else if (exp &lt; 127) &#123; return 0; &#125; // ç»å¯¹å€¼ä½äº [0, 2^(31) - 1] çš„æƒ…å†µ // è¯¥åˆ†æ”¯ä¸­, 0 &lt;= exp - 127 &lt; 31 else &#123; int e = exp - 127; int abs; frac += (1 &lt;&lt; 23); // å¦‚æœ e è¶³å¤Ÿå¤§, ä¿ç•™ frac é‡Œçš„æ‰€æœ‰æ•°å­—, å¦åˆ™èˆå¼ƒåå‡ ä½æ•°å­— if (e >= 23) &#123; abs = frac &lt;&lt; (e - 23); &#125; else &#123; abs = frac >> (23 - e); &#125; // æ ¹æ®æ­£è´Ÿè¿”å›ä¸åŒå€¼ // positive case if ((uf >> 31) == 0) &#123; return abs; &#125; // negative case else &#123; return (~abs) + 1; &#125; &#125; &#125; floatPower2è¿˜æ˜¯åˆ†ç±»è®¨è®ºï¼Œä¸å¤šè¯´äº†ã€‚ /* * floatPower2 - Return bit-level equivalent of the expression 2.0^x * (2.0 raised to the power x) for any 32-bit integer x. * * The unsigned value that is returned should have the identical bit * representation as the single-precision floating-point number 2.0^x. * If the result is too small to be represented as a denorm, return * 0. If too large, return +INF. * * Legal ops: Any integer/unsigned operations incl. ||, &amp;&amp;. Also if, while * Max ops: 30 * Rating: 4 */ unsigned floatPower2(int x) &#123; /* float å¯ä»¥è¡¨ç¤ºçš„ 2çš„å¹‚æ¬¡çš„èŒƒå›´ä¸º [2^(-149), 2^(127)], * å…¶ä¸­ [2^(-149), 2^(-127)] ç”± denormalized case è¡¨ç¤º, * [2^(-126), 2^(127)] ç”± normalized case è¡¨ç¤º */ if (x &lt; -149) &#123; return 0; &#125; // denormalized case else if (x &lt;= -127) &#123; return 1 &lt;&lt; (x + 149); // åªå¤„ç† frac éƒ¨åˆ† &#125; // normalized case else if (x &lt;= 127) &#123; return (x + 127) &lt;&lt; 23; // åªå¤„ç† exp éƒ¨åˆ† &#125; else &#123; return (0xFF &lt;&lt; 23); // +INF &#125; &#125;","categories":[{"name":"å…¬å¼€è¯¾","slug":"å…¬å¼€è¯¾","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/"},{"name":"CMU-15-213","slug":"å…¬å¼€è¯¾/CMU-15-213","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/CMU-15-213/"},{"name":"Labs","slug":"å…¬å¼€è¯¾/CMU-15-213/Labs","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/CMU-15-213/Labs/"}],"tags":[]},{"title":"_Datalabå’Œæˆ‘","slug":"others/thoughts/datalabå’Œæˆ‘","date":"2025-02-21T11:49:30.000Z","updated":"2025-07-18T15:00:02.472Z","comments":true,"path":"wiki/others/thoughts/datalabå’Œæˆ‘/","permalink":"http://rinevard.github.io/wiki/others/thoughts/datalab%E5%92%8C%E6%88%91/","excerpt":"","text":"ä¸€ä¸ªå¯’å‡è¿‡å»ï¼ŒæŠŠæ‰‹å¤´ä¸Šæœ€å–œæ¬¢çš„è®¾è®¡ç®€å•åšäº†ä¸ªåŸå‹ï¼Œç¡®å®ä¸é”™ã€‚ä¸è¿‡ç”±äºä»£ç æ°´å¹³å¤ªä½ï¼Œå¦ä¸€ä¸ªåŒæ ·å–œæ¬¢çš„è®¾è®¡æ²¡èƒ½å®ç°å‡ºæ¥ã€‚åŸæœ¬æƒ³åœ¨è¿™å­¦æœŸåšä¸€ä¸ªæ¯”è¾ƒå®Œæ•´çš„æ¸¸æˆçš„ï¼Œä½†è®¤çœŸæƒ³äº†æƒ³ï¼Œå‡­æˆ‘ç°åœ¨çš„ä»£ç æ°´å¹³ï¼Œææ€•æ ¹æœ¬åšä¸äº†ã€‚è¿˜æ˜¯è¦æé«˜ä¸€ä¸‹è‡ªå·±çš„ä»£ç æ°´å¹³æ‰è¡Œï¼Œäºæ˜¯è¿™å­¦æœŸæ‰“ç®—è®¤çœŸæ‰“æ‰“åŸºç¡€ï¼Œä» 15213 å¼€å§‹ã€‚ ä»Šå¤©å†™æ‰äº† datalabã€‚å‡­å€Ÿè‡ªå·±çš„åŠªåŠ›åšå®Œäº†ä¸€ä¸ªå¾ˆéš¾çš„ä½œä¸šï¼Œå½“ç„¶ä¼šæ„Ÿåˆ°å¾ˆæ¬¢å–œï¼Œå¯ç«™èµ·æ¥å‡†å¤‡å›å¯æ—¶ï¼Œçªç„¶æ„Ÿåˆ°å¾ˆå­¤å•ã€‚â€œæ²¡æœ‰å­¦åˆ†ï¼Œæ²¡æœ‰ç»©ç‚¹ï¼Œæ²¡æœ‰è€å¸ˆï¼Œæ²¡æœ‰åŒå­¦ï¼Œåªæœ‰ä¸€ä¸ªä¿¡å¿µ â€”â€” ä½ åœ¨å˜å¼ºã€‚â€æˆ–è®¸å§ï¼Œæˆ‘åœ¨å˜å¼ºã€‚å˜å¼ºä¹‹åå‘¢ï¼Ÿåº”è¯¥å°±èƒ½å†™å‡ºæ›´æ¼‚äº®çš„ä»£ç ï¼Œä¸å¸¦å¦¥ååœ°å®ç°è‡ªå·±çš„æƒ³æ³•äº†å§ã€‚ æ›´æ–°ï¼šä»Šå¤©ï¼ˆ2025.3.1ï¼‰åœ¨å¯å®¤å†™å®Œäº† bomblabï¼Œæ„Ÿè§‰å¾ˆå¼€å¿ƒï¼Œå¹¶æ²¡æœ‰ä»€ä¹ˆå­¤å•çš„æ„Ÿè§‰ã€‚é¡ºä¾¿çœ‹äº†çœ‹æ¯é¸¡å¡çš„æ–°å‡è¯ï¼ŒèŒæˆ˜å§çš„å§å‹ä»¬å³ä½¿åœ¨æ»‘å¡å¤§ç¯å¢ƒä¸‹ä¹ŸåšæŒé€ è¯ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬çš„é»„é‡‘ç²¾ç¥ï¼ /* éšè—è‰ä¹¦ */ .hidden-text { font-size: 18px; text-align: center; margin: 20px 0; /* padding: 20px; */ line-height: 1.5; color: transparent; cursor: default } .hidden-fancy-text::selection { color: black; background: white; } å‡è§†æˆ‘æ›¾å‡è§†çš„å…‰èŠ’ï¼Œè§¦æ‘¸ä½ å°†è§¦æ‘¸çš„è¿œæ–¹ã€‚","categories":[{"name":"æ‚è°ˆ","slug":"æ‚è°ˆ","permalink":"http://rinevard.github.io/categories/%E6%9D%82%E8%B0%88/"},{"name":"ç¢ç¢å¿µ","slug":"æ‚è°ˆ/ç¢ç¢å¿µ","permalink":"http://rinevard.github.io/categories/%E6%9D%82%E8%B0%88/%E7%A2%8E%E7%A2%8E%E5%BF%B5/"}],"tags":[]},{"title":"æ¯é¸¡å¡çš„å„ç§ç¥å¥‡å‡è¯","slug":"others/animation/æ¯é¸¡å¡çš„å„ç§ç¥å¥‡å‡è¯","date":"2025-02-15T13:31:31.000Z","updated":"2025-08-20T11:13:48.877Z","comments":true,"path":"wiki/others/animation/æ¯é¸¡å¡çš„å„ç§ç¥å¥‡å‡è¯/","permalink":"http://rinevard.github.io/wiki/others/animation/%E6%AF%8D%E9%B8%A1%E5%8D%A1%E7%9A%84%E5%90%84%E7%A7%8D%E7%A5%9E%E5%A5%87%E5%81%87%E8%8D%AF/","excerpt":"","text":"img{ width: 50%; } æ•´ç†ä¸€ä¸‹æˆ‘è§‰å¾—å¾ˆæœ‰è¶£çš„å‡è¯ï¼Œå¤ªçœŸçš„å’Œæˆ‘ä¸æ„Ÿå…´è¶£çš„å°±ä¸æ”¾è¿›æ¥äº†ã€‚ ä½ çŸ¥é“çš„ï¼Œæ¯é¸¡å¡å·²ç»çƒ‚å®Œäº†ï¼Œä½†è¿½ç•ªè¿‡ç¨‹ä¸­çœ‹å§å‹å‡è¯çš„ä½“éªŒè¿˜æ˜¯å¾ˆæœ‰è¶£çš„ã€‚è¿½ç•ªæ—¶çš„æ€’æ°”å€¼ä»ç¬¬ä¹é›†å¼€å§‹ç§¯ç´¯ï¼Œåœ¨ç¬¬åäºŒé›†è¾¾åˆ°å·…å³°ï¼Œä¹Ÿæœ‰äº†åˆ æ‰è¿™ç¯‡æ–‡ç« çš„æƒ³æ³•ã€‚ä½†æƒ³äº†æƒ³çœ‹å‡è¯çš„ä½“éªŒç¡®å®è¶³å¤Ÿæœ‰è¶£ï¼Œäºæ˜¯å°±è¿™æ ·å§ã€‚é‡Šæ€€æ˜¯ä¸å¤ªèƒ½é‡Šæ€€çš„ï¼Œæ•´éƒ¨åŠ¨ç”»çš„å‰²è£‚æ„Ÿå®åœ¨ä»¤äººæ„Ÿåˆ°æ¶å¿ƒã€‚ï¼ˆ2025.3.21 æ›´æ–°ï¼‰ å…³äºæ•´ä½“èµ°å‘çš„å‡è¯æ—¶é—´è½®å›è¯´æ—¶é—´è½®å› æ˜¯ç¬¬ä¹é›†å‡ºç°çš„å‡è¯ ç¬¬ä¹é›†ç¾éš¾èˆ¬çš„çˆ†çˆ†çˆ†è®©è®¸å¤šå‡è¯çš„è®¨è®ºåº¦éƒ½å¤§å¹…ä¸‹é™ï¼Œä¸è¿‡æ—¶é—´ä¹±åºè¯´é‡æ–°ç™»åœºï¼Œæ›´æ˜¯å‡ºç°äº†æ—¶é—´è½®å›è¯´ã€‚ï¼ˆè‡´æ•¬ä¼ å¥‡ç¬¬åè¯â€”â€”æˆ‘çš„æˆ˜åœºä¸åœ¨è¿™é‡Œï¼‰ æˆ‘æ„Ÿè§‰æ—¶é—´è½®å›ä¸å¤ªå¯èƒ½ï¼Œä¸è¿‡è¿™ä¸ªæƒ³æ³•å¤ªé…·äº†ï¼è‡³äºæ—¶é—´ä¹±åºï¼Œæœ€æ˜æ˜¾çš„è¯æ®æ˜¯ç¬¬ä¹é›† 18:40 å’Œç¬¬äºŒé›† 13:34 èƒ½è¿èµ·æ¥ã€‚æˆ–è®¸å¯ä»¥ç»“åˆç³å­”å˜åŒ–è¯´æ¥çœ‹çœ‹ç¬¬äºŒé›†æ˜¯ mortis è¿˜æ˜¯ç¦å¤´ï¼Ÿ é‚£ä¹ˆè´¯ç©¿å…¨å‰§ï¼ŒæŠŠæ—¶é—´é‡æ’èµ·æ¥çš„çº¿ç´¢æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿä¸€ç§è¯´æ³•æ˜¯æ‰‹æœºç”µé‡ å™è¯¡è¯´å™è¯¡è¯´ æ˜¯ç¬¬äºŒé›†å‡ºç°çš„å‡è¯ï¼Œåœ¨ä¸‰å››é›†å¾—åˆ°å®Œå–„ï¼Œç¬¬äº”é›†åè®¨è®ºåº¦å¤§å¹…ä¸‹é™ã€‚ å‰å››é›†å‰§æƒ…è·³è·ƒã€æ—ç™½ç”±åˆåå£°ä¼˜å¿µå‡ºæ˜¯å› ä¸ºè¿™æ˜¯åˆååœ¨å™è¿°æ•…äº‹ï¼é‚£ä¹ˆï¼Œæ˜¯åœ¨å¯¹è°è®²è¿°å‘¢ï¼Ÿ ä¸€ç§å‡è¯æ˜¯åˆåå¯¹å¤±å¿†çš„ç¥¥å­è®²è¿°æ•…äº‹ï¼Œåœ¨å™è¿°ä¸­ç¾åŒ–è‡ªå·±ï¼Œå¥½è®©ç¥¥å­å¾…åœ¨è‡ªå·±èº«è¾¹ã€‚ç†ç”±æ˜¯ç¥¥å­åœ¨å‰å››é›†å”¯ç‹¬å¯¹åˆåæ€åº¦æ¯”è¾ƒå¥½ï¼Œè¿™æ˜¯åˆåå¯¹è‡ªå·±çš„ç¾åŒ–ã€‚ å¦ä¸€ç§æ˜¯åˆåå¯¹è‡ªå·±è®²è¿°æ•…äº‹ï¼Œåªæ˜¯åœ¨è‡ªæˆ‘æ¬ºéª—â€œä¹é˜Ÿä¾ç„¶å­˜åœ¨â€ï¼Œå› æ­¤å‰§æœ¬æ¼æ´ç™¾å‡ºã€‚ä½†æ— è®ºå™è¿°å¤šå°‘æ¬¡ï¼Œä¹é˜Ÿéƒ½é€ƒä¸æ‰è§£æ•£çš„ç»“å±€ã€‚ ä¸Šé¢çš„è“è‰²é“¾æ¥æ˜¯â€œåˆåå¯¹è‡ªå·±è®²è¿°æ•…äº‹â€ã€‚ å†…é¬¼å†…é¬¼è¯´ æ˜¯ç¬¬å››é›†å‡ºç°çš„å‡è¯ï¼Œä¸»è¦ç”¨äºè§£é‡Šè§‚æ„Ÿå¥‡æ€ªçš„è§£æ•£ã€‚ æ¯é¸¡å¡è§£æ•£çš„å‰§æƒ…é€»è¾‘æ··ä¹±ï¼Œè¿™æ˜¯å› ä¸ºé˜Ÿé‡Œæœ‰å†…é¬¼ï¼Œå†…é¬¼åªè¦æŠŠé˜Ÿè§£æ•£æ‰å°±è¡Œäº†ã€‚ç”±äºæˆ‘æ¯”è¾ƒå–œæ¬¢ç¥¥å­ï¼Œæ‰€ä»¥æˆ‘æ¥ä¸‹æ¥è®²å…¨é˜Ÿå†…é¬¼ï¼Œç¥¥å­ 1vn çš„å‰§æƒ…ã€‚ æ•´ä¸ªäº‹åŠ¡æ‰€éƒ½æ˜¯ä¸°å·å®¶æ—å®‰æ’çš„å†…é¬¼ï¼Œä¸Šåˆ°å…¶ä»–ä¹é˜Ÿæˆå‘˜ä¸‹åˆ°å·¥ä½œäººå‘˜ï¼Œéƒ½å¯¹â€œä¸°å·å®¶å¸Œæœ›ç¥¥å­å›å®¶â€è¿™ä»¶äº‹æˆ–å¤šæˆ–å°‘æœ‰äº†è§£ï¼Œå› æ­¤å·¥ä½œäººå‘˜æµ‘æ°´æ‘¸é±¼ï¼Œé™¤äº†ç¥¥å­ä»¥å¤–çš„ä¹é˜Ÿæˆå‘˜éƒ½ä¸åœ¨ä¹ä¹é˜Ÿã€‚ç¥¥å­ 1vn ç¡¬ç”Ÿç”ŸæŠŠæ¯é¸¡å¡å¸¦åˆ°äº†æ­¦é“é¦†ï¼Œä¸æ„§æ˜¯ç¾å¼ºæƒ¨å¤§å¥³ä¸»ï¼Œæ•°å€¼å¤ªé«˜äº†ã€‚ è¿™å¤ªæ•°å€¼æ€ªå•¦ï¼Œä¸åˆç†çš„ï¼ä¸è¿‡å†…é¬¼è¯´è¿˜æ˜¯å¾ˆæœ‰è¶£è€Œä¸”å¾ˆé è°±çš„ï¼Œæˆ‘è§‰å¾—æ¯”è¾ƒçœŸçš„æ˜¯åˆåå–µæ¢¦å†…é¬¼ï¼Œç¦å’Œæµ·ç²çŸ¥æƒ…ã€‚ äººå¶äººå¶è¯´ æ˜¯ç¬¬ä¸ƒé›†å‡ºç°çš„å‡è¯ã€‚ mujica ç»“å°¾å…¨å‘˜äººå¶åŒ–ã€‚â€œåœ¨ mujica çš„çŸ­æš‚æœˆå…‰ä¸‹ï¼Œäº”ä¸ªäººå¶çŸ­æš‚çš„å¤æ´»äº†ï¼Œåœ¨èˆå°ä¸Šé«˜æ­Œä¸€æ›²ã€‚ç»™å‡ºäº†ä¸€åœºå®Œç¾ liveã€‚â€ å…³äºä¸ªäººçš„å‡è¯åˆåèœ˜è››ä¾ èœ˜è››ä¾  å…¶å®åˆåçš„çœŸå®èº«ä»½æ˜¯èœ˜è››ä¾ ï¼Œå„ç§èœ˜è››æ„è±¡æ˜¯æš—ç¤ºåˆåè¢«èœ˜è››å’¬è¿‡ã€‚èƒ½åŠ›è¶Šå¤§ï¼Œè´£ä»»è¶Šå¤§ï¼Œèœ˜è››ä¾ è¦æ‰“å‡»çŠ¯ç½ªï¼Œæ‰€ä»¥æ—¢ä¸å» Mujica æ’ç»ƒï¼Œä¹Ÿä¸å» sumimi æ’ç»ƒï¼Œè¿˜è¯´è‡ªå·±å¿™ã€‚åˆåè®©ç¥¥å­åœ¨é—¨å£ç­‰ 10 ç§’å…¶å®æ˜¯åœ¨è—èœ˜è››æˆ˜è¡£ï¼Œå¥¹ 10 ç§’å°±èƒ½æ”¶æ‹¾å¥½æˆ¿é—´ã€ç¬¬ä¸‰é›†éš”ç€å‡ åç±³å¬åˆ°ç¥¥å­å’Œç¦çš„å¯¹è¯éƒ½æ˜¯å› ä¸ºå¥¹æœ‰è¶…èƒ½åŠ›ã€‚ä¼—æ‰€å‘¨çŸ¥ç¥¥å­æ˜¯è“è‰²ç« é±¼ï¼ŒåˆåæŠŠç¥¥å­å¸¦åˆ°è‡ªå·±å®¶å®é™…ä¸Šæ˜¯ä¸ºäº†ç›‘è§†ç« é±¼åšå£«ã€‚è€Œä¸”ï¼Œæ—¢ç„¶æœ‰åŒé¢äººç¦ã€ä¼é¹…äººé«˜æ¾ç¯ã€ç« é±¼åšå£«ç¥¥å­ï¼Œæœ‰èœ˜è››ä¾ åˆåä¹Ÿä¸å¥‡æ€ªã€‚ å™è¯¡å™è¯¡è¯´ ä¹‹å‰å·²ç»æè¿‡ï¼Œè¿™é‡Œçš„é“¾æ¥æ˜¯ç¬¬äºŒé›†æ’­å‡ºåçš„åˆç‰ˆå‡è¯ã€‚ ä¹‹å‰å·²ç»è¯´è¿‡äº†ï¼Œæ—ç™½ç”±åˆåçš„å£°ä¼˜å¿µå‡ºã€å‰å‡ é›†é€»è¾‘è¯¡å¼‚ï¼Œéƒ½æ˜¯å› ä¸ºè¿™æ˜¯åˆåè®²è¿°çš„æ•…äº‹ã€‚åˆåæ˜¯æ¯é¸¡å¡æ•…äº‹çš„å™è¿°è€…ã€‚ ç¼“å­˜ä¸è¶³ç¼“å­˜ä¸è¶³è¯´ æ˜¯ç¬¬å››é›†å‡ºç°çš„å‡è¯ã€‚ â€œåˆåå¯¹æŸäº›è®°å¿†çš„æ·±åˆ»ç¨‹åº¦ï¼Œå¯èƒ½ä¸ä¼šè¢«æ—¶é—´å†²æ·¡ï¼Œè€Œä¸€äº›æ—¥å¸¸è®°å¿†å¯èƒ½ä¼šè¢«å¾ˆå¿«çš„å¿˜å´ã€‚åœ¨å¥¹å¿ƒç›®ä¸­ï¼Œè‡ªå·±å’Œå¿ƒçˆ±çš„ç¥¥å­åº¦è¿‡çš„æ¯ä¸ªå¤å¤©ã€å‡ºé“æ—¶ç¥¥å­å‘æ¥çš„çŸ­ä¿¡é¼“åŠ±å¯èƒ½ä¸€ç›´å æ®ç€å¥¹è„‘å†…éå¸¸éå¸¸å¤šçš„ç¼“å­˜ã€‚è¿™äº›å’Œç¥¥å­ä¸€èµ·çš„å¿«ä¹çš„è®°å¿†å¯¹åˆåæ¥è¯´å¯èƒ½å°±åƒæ˜¯åˆšåˆšç»å†çš„ä¸€æ ·ï¼Œé‚£ä»½å–œæ‚¦ã€ç”œèœœã€é¥¥æ¸´å°±åƒå†°ä¸€æ ·æ— æ—¶æ— åˆ»ä¸åœ¨ä¾µèš€åˆåçš„å¤§è„‘ï¼Œæ‰€ä»¥åˆåæ‰ä¼šç»™äººä¸€ç§éš¾ä»¥å½¢å®¹çš„è¶…é‡å¥³å°è±¡ã€‚â€ è®¤çŸ¥éšœç¢åˆåè®¤çŸ¥éšœç¢è¯´ æ˜¯ç¬¬ä¸€é›†å‡ºç°çš„å‡è¯ã€‚ åˆåçš„çœ¼é‡Œä¸€ç›´éƒ½åªæœ‰ç¥¥å­ï¼Œåˆ«äººçš„å½¢è±¡åœ¨å¥¹çœ¼é‡Œæ˜¯æ‰­æ›²çš„ã€‚ä¼—æ‰€å‘¨çŸ¥ï¼ŒMyGO ç¬¬å…«é›†é‡Œæœ‰åˆåçš„å›å¿†ï¼Œå›å¿†é‡Œæ˜æ˜¾èƒ½çœ‹å‡ºåˆåè§è¿‡ç¥¥å­çš„äººå¶ã€‚ç„¶è€Œåœ¨æ¯é¸¡å¡ç¬¬äºŒé›†é‡Œï¼Œå¥¹å´å¥½åƒæ˜¯ä¸è®¤è¯†äººå¶çš„æ ·å­ã€‚ç­”æ¡ˆæ˜¯åˆååœ¨å°æ—¶å€™å°†ç¦è®¤çŸ¥æˆäº†äººå¶ã€‚ å¤±å¿†åˆåå¤±å¿†è¯´ æ˜¯ç¬¬äºŒé›†å‡ºç°çš„å‡è¯ã€‚ ä¸ºä»€ä¹ˆåˆåå¦‚æ­¤ç©ºæ´ï¼Ÿä¸ºä»€ä¹ˆåˆåçš„ç«¥å¹´è®°å¿†å’Œç¥¥å­æœ‰åå·®ï¼Ÿä¸ºä»€ä¹ˆåˆåå¿˜äº†ç¥¥å­çš„ç©å¶ï¼Ÿå› ä¸ºåˆåç»å†è¿‡ä¸€æ¬¡å¤±å¿†ã€‚åˆåæ‹¿ç€ä»¥å‰çš„æ—¥è®°æœ¬ï¼ŒåŠªåŠ›æ‰®æ¼”â€œçœŸæ­£çš„åˆåâ€ã€‚ ç¥¥å­â­ å‹æŠ‘ä¸°å·ç¥¥å­ â­ å‹æŠ‘è¯´ ç¥¥å­å¯¹å¤§é›·æƒ…æœ‰ç‹¬é’Ÿï¼Œç»„ä¹é˜Ÿæ˜¯ä¸ºäº†æ¥è¿‘å¤§é›·ã€‚ äººå¶ç¥¥å­äººå¶è¯´ æ˜¯ç¬¬ä¸ƒé›†å‡ºç°çš„å‡è¯ï¼Œä¸»è¦ç”¨äºè§£é‡Šç¬¬ä¸ƒé›†ç¥¥å­çš„å½¢è±¡å˜åŒ–ã€‚ ç¬¬ 7 é›†çš„ç¥¥å­ä¸ºäº†ç¦æˆä¸ºäº†èˆå¼ƒè‡ªæˆ‘çš„äººå¶ï¼Œå¥¹è£…å‡ºäº†ç™½ç¥¥çš„æ ·å­ï¼Œå› ä¸ºâ€œåªè¦ç¦èƒ½å›æ¥å°±å¥½äº†â€ã€‚ ç¥¥çˆ¹æ¼”æˆç¥¥çˆ¹æ¼”æˆè¯´ æ˜¯ç¬¬äº”é›†å‡ºç°çš„å‡è¯ã€‚ ç¥¥çˆ¹æ¼”æˆæŠŠç¥¥å­æ°”èµ°ï¼Œè®©ç¥¥å­å›å½’å®¶æ—ã€‚ ç¦è£…åŒé‡äººæ ¼ç¦è£…åŒé‡äººæ ¼è¯´ æ˜¯ç¬¬å››é›†å‡ºç°çš„å‡è¯ã€‚ å¦‚é¢˜ï¼Œä¸»è¦ä¾æ®æ˜¯ç¬¬å››é›†ç¦åœ¨åˆåè½¦ä¸Šçš„ç¬¬ä¸€å¥â€œå—¯â€æ˜¯ç¦çš„å£°çº¿ã€‚ mortis å°å°ç¥¥mortis å°å°ç¥¥è¯´ åº”è¯¥æ˜¯ç¬¬å…­é›†å‡ºç°çš„å‡è¯ã€‚ ç¦å°æ—¶å€™åªæœ‰ç¥¥å­ä¸€ä¸ªæœ‹å‹ï¼Œmortis æ˜¯ç¦ä»¥ç™½ç¥¥ä¸ºæ¨¡æ¿å¡‘é€ çš„äººæ ¼ï¼Œæ‰®æ¼”å°ç¥¥ã€‚ å†™æ–‡ç« æ—¶æ•´ç†çš„å‡è¯é“¾æ¥ å™è¯¡ å†…é¬¼è¯´ äººå¶è¯´ ç¦ç¥¥é»‘æ‰‹è¯´ åœ£ç»è¯´ å…ƒç´ è¯´ èœ˜è››ä¾  å™è¯¡è¯´ ç¼“å­˜ä¸è¶³è¯´ åˆåè®¤çŸ¥éšœç¢è¯´ åˆåå¤±å¿†è¯´ ç¥¥å­å¤±èªè¯´ ç¥¥å­äººå¶è¯´ ç¥¥çˆ¹æ¼”æˆè¯´ ç¦è£…åŒé‡äººæ ¼è¯´ mortis å°å°ç¥¥è¯´ mortis é”¡å…µè¯´ é›¨ä¼é¢œè‰² ç¥¥ç¦å§å¦¹è¯´ å¤©å¤©åƒå‡è¯åƒå‚»äº†åšå‡ºæ¥çš„å†°å±±å›¾ å››æ¼” mortis å››æ¼”ç¥¥å­ æ­Œå‰§é­…å½±è¯´","categories":[{"name":"æ‚è°ˆ","slug":"æ‚è°ˆ","permalink":"http://rinevard.github.io/categories/%E6%9D%82%E8%B0%88/"},{"name":"äºŒæ¬¡å…ƒ","slug":"æ‚è°ˆ/äºŒæ¬¡å…ƒ","permalink":"http://rinevard.github.io/categories/%E6%9D%82%E8%B0%88/%E4%BA%8C%E6%AC%A1%E5%85%83/"}],"tags":[]},{"title":"å¯¹æ¢ç´¢ç±»æ¸¸æˆçš„æ€è€ƒ","slug":"game-design/å¯¹æ¢ç´¢ç±»æ¸¸æˆçš„æ€è€ƒ","date":"2025-02-14T12:36:38.000Z","updated":"2025-08-19T07:50:56.136Z","comments":true,"path":"wiki/game-design/å¯¹æ¢ç´¢ç±»æ¸¸æˆçš„æ€è€ƒ/","permalink":"http://rinevard.github.io/wiki/game-design/%E5%AF%B9%E6%8E%A2%E7%B4%A2%E7%B1%BB%E6%B8%B8%E6%88%8F%E7%9A%84%E6%80%9D%E8%80%83/","excerpt":"","text":"ä¸ºä»€ä¹ˆè¦æ¢ç´¢å‘¢ï¼Ÿè®¾æƒ³ä¸€ä¸‹ï¼Œå¦‚æœæˆ‘ä»¬ä¹˜ä¸Šäº†é£èˆ¹ï¼Œé£å…¥å¤ªç©ºï¼Œå¿½ç„¶å‘ç°ä¸€é¢—è¡Œæ˜Ÿæœç€åæ–¹å‘è½¬åŠ¨äº†ã€‚è¿™æ—¶ä½ ä¼šä¸ä¼šæƒ³å»é‚£é‡Œï¼Ÿå¦‚æœæˆ‘ä»¬åœ¨ç½‘ä¸Šå‘ç°äº†ä¸€ä¸ªç½‘ç«™ï¼Œç‚¹å¼€ç¬¬ä¸€ä¸ªé“¾æ¥å‘ç°é‡Œé¢æ˜¯ä½ çš„å®¶åº­ä½å€ï¼ˆæˆ‘è¶…ï¼Œç›’ï¼ï¼‰ï¼Œä½ ä¼šä¸ä¼šæƒ³ç»§ç»­ç¿»åˆ«çš„é“¾æ¥ï¼Ÿäººç±»æ¢ç´¢çš„åŠ¨åŠ›è¢«å‘½åä¸ºå¥½å¥‡å¿ƒï¼Œå¥½å¥‡é©±åŠ¨æ¢ç´¢ã€‚ å¥½å§ï¼Œæˆ‘ä»¬ä¸å¦¨æŠŠè¯è¯´å¾—æ›´æ˜ç™½ä¸€äº›ï¼Œå¥½å¥‡é©±åŠ¨æ¢ç´¢çš„æ„æ€å°±æ˜¯ï¼šâ€œæˆ‘ç›¸ä¿¡é‚£é‡Œæœ‰å€¼å¾—å…³æ³¨çš„ä¸œè¥¿ï¼Œä½†ä¸ç¡®åˆ‡çŸ¥é“æ˜¯ä»€ä¹ˆï¼Œæ‰€ä»¥æˆ‘è¦å»æ¢ç´¢ã€‚â€ è¿™å¬èµ·æ¥çœŸçš„æ˜¯å†å¹³å‡¡ä¸è¿‡çš„äº‹æƒ…äº†ï¼Œé‚£å°±æ¥åˆ†æä¸€ä¸‹æ€ä¹ˆæ¿€å‘ç©å®¶çš„å¥½å¥‡å¿ƒï¼Œå†è®©å¥½å¥‡é©±åŠ¨æ¢ç´¢å§ã€‚ ç›¸ä¿¡æœ‰å€¼å¾—å…³æ³¨çš„ä¸œè¥¿åœ¨æ¢ç´¢ä¹‹å‰ï¼Œé¦–å…ˆè¦è®©ç©å®¶ç›¸ä¿¡â€œé‚£é‡Œæœ‰å€¼å¾—å…³æ³¨çš„ä¸œè¥¿â€ã€‚å€¼å¾—å…³æ³¨çš„ä¸œè¥¿å¹¶ä¸éš¾åšï¼Œå®ƒä»¬å¯ä»¥æ˜¯å¥‡è§‚ã€å¥–åŠ±ä¹ƒè‡³æŒ‘æˆ˜ï¼Œå…³é”®æ˜¯æ€æ ·è®©ç©å®¶ç›¸ä¿¡â€œé‚£é‡Œæœ‰ä¸œè¥¿â€ã€‚ åšæ³•å¾ˆå¤šï¼Œæˆ‘ä»¬æ¥æ‰¾å‡ ä¸ªä¾‹å­ï¼Œçœ‹çœ‹å…³æ³¨æ¢ç´¢æ„Ÿçš„æ¸¸æˆéƒ½æ˜¯æ€ä¹ˆåšåˆ°è¿™ä¸€ç‚¹çš„ã€‚ é¦–å…ˆæ¥çœ‹ç±»é“¶æ²³åŸæ¸¸æˆï¼Œå¯¹æœ‰ç»éªŒçš„ç©å®¶ï¼Œè·å¾—æ–°èƒ½åŠ›å°±è‡ªç„¶æƒ³åˆ°â€œä»¥å‰æœ‰ä¸ªè¿‡ä¸å»çš„è·¯èƒ½é è¿™ä¸ªèƒ½åŠ›è¿‡å»â€ï¼Œç„¶åä¹Ÿå°±æƒ³åˆ°â€œé‚£é‡Œæœ‰å€¼å¾—å…³æ³¨çš„ä¸œè¥¿â€ï¼›çœ‹åˆ°å¢™å°±è‡ªç„¶æƒ³åˆ°å‡å¢™ï¼Œç„¶åå°±æƒ³åˆ°â€œé‚£é‡Œæœ‰å€¼å¾—å…³æ³¨çš„ä¸œè¥¿â€äº†ã€‚ç„¶è€Œï¼Œè¿™ç§åšæ³•è¿‡åº¦ä¾èµ–ç©å®¶çš„å…ˆéªŒçŸ¥è¯†ã€‚å¯¹ä¸€ä¸ªæ–°æ¥è§¦ç±»é“¶æ²³åŸçš„ç©å®¶æ¥è¯´ï¼Œåˆ°å¤„è¿·è·¯æ‰æ˜¯æ›´å¯èƒ½å‘ç”Ÿçš„äº‹æƒ…ï¼Œä»–ä»¬æ ¹æœ¬ä¸çŸ¥é“â€œå“ªé‡Œæœ‰å€¼å¾—å…³æ³¨çš„ä¸œè¥¿â€ã€‚ æˆ‘æƒ³è¿™ä¹Ÿæ˜¯ç±»é“¶æ²³åŸæ¸¸æˆç›¸å¯¹å°ä¼—çš„åŸå› ï¼Œå®ƒåªç»™æœ‰ç»éªŒçš„ç©å®¶æä¾›äº†æ¢ç´¢æ„Ÿï¼Œè€Œç»™æ–°ç©å®¶æä¾›äº†è¿·è·¯æ„Ÿã€‚èƒ½åŠ›é”å°šä¸”å¥½è¯´ï¼Œå‡å¢™å°±å®åœ¨æ˜¯ä¸åˆ©äºæ¢ç´¢æ„Ÿçš„å¡‘é€ äº†ï¼Œæ¯•ç«Ÿå¤§å¤šæ•°ç©å®¶çš„å…ˆéªŒçŸ¥è¯†æ˜¯â€œå¢™ä½“ä¸å¯ç ´åâ€ï¼Œæ ¹æœ¬å°±ä¸ä¼šæƒ³åˆ°â€œå¢™åé¢æœ‰å€¼å¾—å…³æ³¨çš„ä¸œè¥¿â€ã€‚ä¸è¿‡å‡å¢™å¹¶éä¸€æ— æ˜¯å¤„ï¼Œå®ƒèƒ½ç»™ç©å®¶ä¸€ç§â€œç§˜å¯†â€çš„æ„Ÿè§‰ï¼Œè¿™å°±æ˜¯é¢˜å¤–è¯äº†ã€‚æ‰€ä»¥è¯´å¦‚æœåšç±»é“¶æ²³åŸï¼Œèµ·ç è¦æé†’ä¸€ä¸‹ç©å®¶è¿™äº›è®¾è®¡çš„å­˜åœ¨ï¼Œè€Œä¸æ˜¯ç›²ç›®åœ°æŠ„åˆ«çš„é“¶æ²³åŸçš„åšæ³•ã€‚åœ¨ç©ºæ´éª‘å£«å¼€å±€çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¿…é¡»æ‰“ç¢ä¸€é¢å¢™æ‰èƒ½å‰è¿›ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªä¸é”™çš„æé†’ã€‚ æ¥ä¸‹æ¥çœ‹çœ‹æ¸…å•å¼å¼€æ”¾ä¸–ç•Œã€‚è™½ç„¶åœ¨åœ°å›¾ä¸Šåˆ°å¤„å¡é—®å·çš„æ–¹æ³•ä¸ºäººè¯Ÿç—…ï¼Œä½†è¿™ä¹Ÿç¡®å®éå¸¸æ¸…æ™°åœ°æŠŠâ€œé‚£é‡Œæœ‰ä¸œè¥¿â€ä¼ è¾¾ç»™äº†ç©å®¶ã€‚é‚£ä¸ºä»€ä¹ˆä¸ºäººè¯Ÿç—…å‘¢ï¼Ÿä¸»è¦æ˜¯å› ä¸ºé—®å·é‡Œçš„ä¸œè¥¿åƒç¯‡ä¸€å¾‹ï¼Œè¿â€œå€¼å¾—å…³æ³¨çš„ä¸œè¥¿â€éƒ½æ²¡åšåˆ°ã€‚é‚£å¦‚æœæŠŠæ¯ä¸ªé—®å·éƒ½å¡ä¸€ä¸ªç²¾ç¾çš„æ”¯çº¿ï¼Œä¼šå¥½ç‚¹å—ï¼Ÿææ€•ä¹Ÿä¸ä¸€å®šï¼Œå› ä¸ºè¢«åŠ¨åœ°æ¥å—é—®å·å’Œä¸»åŠ¨å‘ç°é—®å·å¸¦æ¥çš„â€œå€¼å¾—å…³æ³¨æ„Ÿâ€æ˜¯ä¸ä¸€æ ·çš„ã€‚è‡ªå·±æ‰¾åˆ°çš„ä¸œè¥¿ï¼Œå°±ç®—å†æ— èŠä¹Ÿä¼šæƒ³çœ‹å®Œã€‚ è¿™é‡Œå°±ä¸è°ˆå¡å°”è¾¾äº†ã€‚è¯´èµ·æ¥ä¸å¤ªå¥½æ„æ€ï¼Œä½†æˆ‘åœ¨ç©çš„æ—¶å€™ç¡®å®æ²¡æ„Ÿåˆ°ä»€ä¹ˆæ¢ç´¢æ¬²æœ›ã€‚ä¸€æ˜¯æˆ‘æ²¡æ„Ÿè§‰åˆ°å“ªé‡Œæœ‰ä¸œè¥¿ï¼ŒäºŒæ˜¯å› ä¸ºæˆ‘ä¹Ÿæ²¡æ„Ÿè§‰æœ‰ä»€ä¹ˆå€¼å¾—æˆ‘å…³æ³¨çš„ä¸œè¥¿ã€‚ï¼ˆçƒçƒäº†ï¼Œä¸è¦å¼€é™¤æˆ‘çš„ç©å®¶ç±ï¼‰ ç„¶åè°ˆè°ˆæ˜Ÿé™…æ‹“è’å§ï¼Œè¿™ç¯‡æ–‡ç« å¯ä»¥è¯´å°±æ˜¯ä¸ºäº†æ˜Ÿé™…æ‹“è’è€Œå†™çš„ã€‚æ˜Ÿé™…æ‹“è’çš„åšæ³•ä¸»è¦æœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯å¥‡è§‚ï¼Œå¦ä¸€ç§æ˜¯éå¸¸ç›´ç™½åœ°ç”¨æ–‡å­—å‘Šè¯‰ä½ â€œé‚£é‡Œæœ‰ä¸œè¥¿â€ã€‚å‰è€…ä¸å¿…å¤šè¯´ï¼Œåè€…çš„æ–‡å­—æè¿°æœ¬èº«ä¹Ÿè¶³ä»¥è®©ç©å®¶è§‰å¾—é‚£é‡Œâ€œå€¼å¾—å…³æ³¨â€ã€‚ ä¸ç¡®åˆ‡çŸ¥é“æœ‰ä»€ä¹ˆè¿™ä¸€ç‚¹çœ‹èµ·æ¥ä¸éš¾å®ç°ï¼Œä½†å’Œå‰ä¸€ç‚¹ç»“åˆèµ·æ¥å°±å¾ˆéš¾äº†ã€‚ç©å®¶ç©äº†ä¸€æ®µæ—¶é—´æ¸¸æˆåï¼Œå¾ˆå¿«å°±ä¼šå¯¹å¥–åŠ±æœ‰ä¸€å®šé¢„æœŸï¼Œå¦‚æœåšä¸åˆ°æ‰“ç ´è¿™ç§é¢„æœŸï¼Œå°±ä¼šè®©ç©å®¶ä¸§å¤±å¥½å¥‡å¿ƒï¼Œä¸§å¤±æ¢ç´¢æ¬²ã€‚ è¿™ä¸€ç‚¹åœ¨æœ‰ç»éªŒçš„ç©å®¶èº«ä¸Šä½“ç°çš„å°¤å…¶æ˜æ˜¾ã€‚å¯¹ä¸€ä¸ªæ™®æ™®é€šé€šçš„æ¢ç´¢ç±»æ¸¸æˆï¼Œä»–ä»¬å¯¹ä¸€åˆ‡å‡ ä¹éƒ½æœ‰é¢„æœŸï¼Œå› æ­¤ä¹Ÿä¼šä¸§å¤±æ¢ç´¢æ¬²ã€‚ å…¶å®ï¼Œç»å¤§å¤šæ•°æ¸¸æˆéƒ½è®©ç©å®¶ä¸§å¤±äº†æ¢ç´¢æ¬²ï¼Œè®©æˆ‘ä»¬ä»¥æ¸…å•å¼å¼€æ”¾ä¸–ç•Œä¸ºä¾‹ï¼Œçœ‹çœ‹é—®å·æ˜¯å¦‚ä½•è®©ç©å®¶å¤±å»æ¢ç´¢æ¬²çš„ã€‚ å‡è®¾æˆ‘ä»¬é¢å‰æœ‰ä¸€ä¸ªç©å®¶åœ¨ç©æ¸¸æˆï¼Œæˆ‘ä»¬çœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆã€‚ç©å®¶åˆ°äº†ç¬¬ä¸€ä¸ªé—®å·ï¼Œæ˜¯ä¸€ä¸ªæœ‰è¶£çš„æˆ˜æ–—ï¼ç©å®¶å¾ˆå¼€å¿ƒã€‚ç©å®¶åˆ°äº†ç¬¬äºŒä¸ªé—®å·ï¼Œæ˜¯ä¸€ä¸ªé«˜çº§æ­¦å™¨ï¼ç©å®¶å¾ˆå¼€å¿ƒã€‚â€¦â€¦ç©å®¶åˆ°äº†ç¬¬ 16 ä¸ªé—®å·ï¼Œæ˜¯ä¸€ä¸ªå·²ç»é‡å¤è¿‡ä¸çŸ¥é“å¤šå°‘éçš„çš„æˆ˜æ–—ï¼Œåœ¨æˆ˜æ–—ç»“å°¾è¿˜å¥–åŠ±äº†ä¸€ä¸ªé«˜çº§æ­¦å™¨ï¼ç©å®¶å¯¹æ­¤æ—©æœ‰é¢„æœŸï¼Œä¸å†æƒ³å»ä¸‹ä¸€ä¸ªé—®å·äº†ã€‚ çœ‹è§äº†å—ï¼Œç©å®¶å°±æ˜¯è¿™æ ·ä¸§å¤±æ¢ç´¢æ¬²ï¼Œæ²¦ä¸ºæ¸…é—®å·æœºå™¨çš„ã€‚ å¼€æ”¾ä¸–ç•Œé‡Œçš„é—®å·è¿™ä¹ˆè¯´æ¥ï¼ŒæŠŠæ¯ä¸ªé—®å·çš„å†…å®¹éƒ½æ¢æˆä¸€ä¸ªç©å®¶çŒœä¸åˆ°æ˜¯ä»€ä¹ˆçš„ç²¾ç¾çš„æ”¯çº¿å°±èƒ½æ¿€å‘æ¢ç´¢æ¬²ï¼Ÿè¿™ç¡®å®èƒ½æ”¹å–„ç°çŠ¶ï¼Œä½†ä¹Ÿå¹¶éå…¨ç„¶å¦‚æ­¤ã€‚é—®å·å§‹ç»ˆæ²¡æœ‰å®Œå…¨åšåˆ°è®©ç©å®¶è§‰å¾—é‚£ä¸ªåœ°æ–¹â€œå€¼å¾—å…³æ³¨â€ï¼Œæ¯•ç«Ÿé—®å·æ˜¯è®¾è®¡å¸ˆåœ¨åœ°å›¾ä¸Šæ ‡å‡ºæ¥çš„ï¼Œè€Œä¸æ˜¯ç©å®¶ä¸»åŠ¨æ ‡å‡ºçš„ã€‚ è®¸å¤šç±»é“¶æ²³åŸé‡Œä¹Ÿæä¾›äº†åœ¨åœ°å›¾ä¸Šæ‰“æ ‡è®°çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥æ¨ªå‘å¯¹æ¯”ä¸€ä¸‹ã€‚å¾ˆæ˜æ˜¾ï¼Œä¸€å¼ å…¨æ˜¯è‡ªå·±æ ‡å‡ºçš„é—®å·çš„åœ°å›¾å’Œä¸€å¼ å…¨æ˜¯æ¸¸æˆè‡ªå¸¦çš„é—®å·çš„åœ°å›¾ç›¸æ¯”ï¼Œå‰è€…æ›´èƒ½æ¿€å‘æ¢ç´¢æ¬²ã€‚ç©¶å…¶æ ¹æœ¬ï¼Œå°±åœ¨äºå‰è€…çš„æ¯ä¸ªé—®å·éƒ½çœŸçš„è®©ç©å®¶ç›¸ä¿¡â€œé‚£é‡Œæœ‰å€¼å¾—å…³æ³¨çš„ä¸œè¥¿â€ã€‚ é‚£ä¹ˆæ€ä¹ˆæ”¹è¿›å¼€æ”¾ä¸–ç•Œé‡Œçš„é—®å·å‘¢ï¼Ÿæˆ‘ä¹Ÿä¸ç¡®å®šã€‚è¯´åˆ°åº•é—®å·è¿™ä¸ªä¸œè¥¿æ ¹æœ¬å°±æ²¡è®©ç©å®¶è§‰å¾—â€œé‚£é‡Œæœ‰å€¼å¾—å…³æ³¨çš„ä¸œè¥¿â€ä¸æ˜¯å—ï¼Ÿç»ˆç©¶è¦è®©ç©å®¶è§‰å¾—è‡ªå·±æ˜¯ä¸»åŠ¨å…³æ³¨åˆ°é‚£é‡Œçš„æ‰è¡Œï¼Œé—®å·è¿˜æ˜¯å¤ªè¢«åŠ¨äº†ã€‚ æ–‡æœ«å†™åˆ°è¿™é‡Œï¼Œå…³äºæ¢ç´¢çš„å†…å®¹å°±åŸºæœ¬å†™å®Œäº†ï¼Œæœ€åæ˜¯ä¸€äº›è®©æ¢ç´¢æ›´æœ‰è¶£çš„å°æŠ€å·§ï¼Œæˆ‘éšä¾¿åˆ—ä¸€äº›ï¼Œä¸å†è¯¦è°ˆã€‚ èƒ½åŠ›è½¯é”ï¼šå¸¸è§äºç±»é“¶æ²³åŸã€‚èƒ½åŠ›è½¯é”ä¸ä»…æ˜¯å…³å¡è®¾è®¡æ‰‹æ®µï¼Œä¹Ÿæ˜¯æ§åˆ¶å¯é€‰è·¯çº¿æ•°é‡çš„å·¥å…·ã€‚é™åˆ¶é€‰é¡¹æ•°é‡çš„é‡è¦æ€§ä¸å¿…å¤šè¯´ã€‚ çº¿ç´¢ï¼šå¥½çš„ç§˜å¯†éœ€è¦æç¤ºï¼Œè€Œééšæœºä¹±é€›ã€‚æˆ‘å®åœ¨æ˜¯æ¬£èµä¸äº†åˆ°å¤„ä¹±è—ä¸œè¥¿çš„é“¶æ²³åŸã€‚è¿™è¿˜ä¼šæ¶‰åŠåˆ°ç”µæ³¢å¼è°œé¢˜ï¼ˆæˆ‘æ„Ÿè§‰æ¯”â€œç‚¹å‡»å¼è°œé¢˜â€æ›´å¥½ç†è§£ï¼‰å’Œé€»è¾‘è°œé¢˜çš„å·®å¼‚ï¼Œä¸è¯¦è°ˆã€‚ çŸ¥è¯†ç§¯ç´¯ï¼šæ¸¸æˆåº”è¯¥é€æ­¥æ•™ä¼šç©å®¶è¯†åˆ«æ¢ç´¢æœºä¼šçš„èƒ½åŠ›ï¼Œä¹Ÿè¢«ç§°ä½œâ€œçŸ¥è¯†é”â€ã€‚ ä¸€ä¸ªç›¸å½“æœ‰è¶£çš„ä½“éªŒæ˜¯â€œæ–°è§†è§’â€ï¼Œå³å‘ç°äº†è¿‡å»æ²¡æœ‰å‘ç°çš„æ¢ç´¢æœºä¼šã€‚èƒ½åŠ›æˆé•¿ã€ç¯å¢ƒå˜åŒ–ã€çŸ¥è¯†ç§¯ç´¯éƒ½èƒ½å¸¦æ¥æ–°è§†è§’ã€‚å…¶ä¸­æˆ‘æœ€å–œæ¬¢çš„æ˜¯ç¯å¢ƒå˜åŒ–å’ŒçŸ¥è¯†ç§¯ç´¯å¸¦æ¥çš„æ–°è§†è§’ï¼Œå¤§æ¦‚æ˜¯å› ä¸ºä¸å¸¸è§å§ã€‚ è®©æˆ‘ä»¬è¯•è¯•ä¸€ä¸ªç®€å•çš„ä¼ è¾¾æ¢ç´¢çš„ä½“éªŒçš„ demo ã€‚æˆ‘ä»¬çœ‹åˆ°äº†ä¸‹é¢çš„ä¸œè¥¿ï¼š æ‰€ä»¥ï¼Œè¿™å°±æ˜¯æ¢ç´¢äº†ï¼Ÿ ä½ å¥½å¥‡é‚£é‡Œæœ‰ä»€ä¹ˆå—ï¼Ÿæ—¢ç„¶ä½ è¯»å®Œäº†æ–‡ç« ï¼Œå¸Œæœ›ä½ ä¹Ÿä¼šå¥½å¥‡ä½œè€…è¿˜èƒ½æ•´å‡ºä»€ä¹ˆæ–°æ´»å§ã€‚æˆ‘æœ¬æ¥åº”è¯¥åœ¨é‡Œé¢æ”¾ç½®ä¸€äº›æœ‰è¶£çš„ä¸œè¥¿æ¥æ»¡è¶³ä½ çš„å¥½å¥‡å¿ƒï¼Œä¸è¿‡è€ƒè™‘åˆ°æ—¶é—´æœ‰é™ï¼Œå°±åªèƒ½æ”¾ä¸ªæ™®é€šçš„å½©è›‹äº†ã€‚ /* éšè—è‰ä¹¦ */ .hidden-fancy-text { font-family: 'Brush Script MT', cursive; font-size: 20px; /* text-align: center; */ margin: 20px 0; /* padding: 20px; */ line-height: 1.5; color: transparent; cursor: default } .hidden-fancy-text::selection { color: darkred; background: white; } å¦‚æœä½œè€…åœ¨è®¤çœŸåšæ¸¸æˆçš„è¯ï¼Œæˆ‘ä»¬ä¹Ÿåº”è¯¥ä¼šè§é¢çš„ã€‚","categories":[{"name":"æ¸¸æˆè®¾è®¡","slug":"æ¸¸æˆè®¾è®¡","permalink":"http://rinevard.github.io/categories/%E6%B8%B8%E6%88%8F%E8%AE%BE%E8%AE%A1/"}],"tags":[]},{"title":"æ¬¢è¿ï¼","slug":"æ¬¢è¿ï¼","date":"2025-02-06T02:25:53.000Z","updated":"2025-08-20T11:13:48.854Z","comments":true,"path":"wiki/æ¬¢è¿ï¼/","permalink":"http://rinevard.github.io/wiki/%E6%AC%A2%E8%BF%8E%EF%BC%81/","excerpt":"","text":"è¿™æ˜¯ä¸€ç¯‡æ¬¢è¿æ–‡ç« ï¼Œæ¬¢è¿æ¥åˆ°æˆ‘çš„ç½‘ç«™ï¼ å¦‚ä½ æ‰€è§ï¼Œå·¦è¾¹æ˜¯ç½‘ç«™çš„æ–‡ç« åˆ—è¡¨ï¼Œä»¥æ–‡ä»¶å¤¹çš„å½¢å¼æ’å¸ƒï¼›å·¦ä¸Šæ–¹çš„â€œé¦–é¡µâ€å°±æ˜¯è¿™é‡Œçš„ç½‘é¡µï¼Œâ€œæ–‡ç« å†å²â€è®°å½•äº†æ–‡ç« çš„è¯ç”Ÿæ—¶é—´çº¿ï¼Œâ€œå…³äºâ€æ˜¯æˆ‘çš„è‡ªæˆ‘ä»‹ç»ï¼›å³è¾¹æ˜¯æ–‡ç« çš„ç›®å½•ï¼Œæ‚¬åœä¼šå±•å¼€ç›®å½•ï¼Œç‚¹å‡»å°±èƒ½è·³è½¬åˆ°å¯¹åº”ä½ç½®ã€‚ æœ¬ç«™ä½¿ç”¨äº†æˆ‘å’Œ LLM åŸºäº Hexo çš„ Wikitten åšçš„è‡ªåˆ¶ä¸»é¢˜ï¼ æˆ‘åº”è¯¥ä¸»è¦ä¼šåœ¨è¿™é‡Œæ”¾ä¸€äº›æ‚è°ˆå’Œæ¸¸æˆç›¸å…³çš„æ–‡ç« ï¼Œæ¬¢è¿æ¥çœ‹ï¼","categories":[],"tags":[]}],"categories":[{"name":"å…¬å¼€è¯¾","slug":"å…¬å¼€è¯¾","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/"},{"name":"MIT-6.S081","slug":"å…¬å¼€è¯¾/MIT-6-S081","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/MIT-6-S081/"},{"name":"Labs","slug":"å…¬å¼€è¯¾/MIT-6-S081/Labs","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/MIT-6-S081/Labs/"},{"name":"æ‚è°ˆ","slug":"æ‚è°ˆ","permalink":"http://rinevard.github.io/categories/%E6%9D%82%E8%B0%88/"},{"name":"ç¢ç¢å¿µ","slug":"æ‚è°ˆ/ç¢ç¢å¿µ","permalink":"http://rinevard.github.io/categories/%E6%9D%82%E8%B0%88/%E7%A2%8E%E7%A2%8E%E5%BF%B5/"},{"name":"GAMES101","slug":"å…¬å¼€è¯¾/GAMES101","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/"},{"name":"Assignments","slug":"å…¬å¼€è¯¾/GAMES101/Assignments","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/Assignments/"},{"name":"Notes","slug":"å…¬å¼€è¯¾/GAMES101/Notes","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/GAMES101/Notes/"},{"name":"æ¸¸æˆè®¾è®¡","slug":"æ¸¸æˆè®¾è®¡","permalink":"http://rinevard.github.io/categories/%E6%B8%B8%E6%88%8F%E8%AE%BE%E8%AE%A1/"},{"name":"Notes","slug":"å…¬å¼€è¯¾/MIT-6-S081/Notes","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/MIT-6-S081/Notes/"},{"name":"CMU-15-213","slug":"å…¬å¼€è¯¾/CMU-15-213","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/CMU-15-213/"},{"name":"Notes","slug":"å…¬å¼€è¯¾/CMU-15-213/Notes","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/CMU-15-213/Notes/"},{"name":"Labs","slug":"å…¬å¼€è¯¾/CMU-15-213/Labs","permalink":"http://rinevard.github.io/categories/%E5%85%AC%E5%BC%80%E8%AF%BE/CMU-15-213/Labs/"},{"name":"gamejam","slug":"gamejam","permalink":"http://rinevard.github.io/categories/gamejam/"},{"name":"äºŒæ¬¡å…ƒ","slug":"æ‚è°ˆ/äºŒæ¬¡å…ƒ","permalink":"http://rinevard.github.io/categories/%E6%9D%82%E8%B0%88/%E4%BA%8C%E6%AC%A1%E5%85%83/"}],"tags":[]}